/*
Three r88
来自QQ群 117844722 的群友 Too 的分享
使用方法 const THREE = require('./path/three.js')
*/
'use strict';Object.defineProperty(exports,'__esModule',{value:!0});var THREE={name:'three'};exports.default=THREE,function(No){function Fo(){}function Go(Eg,bg){this.x=Eg||0,this.y=bg||0}function Ho(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],0<arguments.length&&console.error('THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.')}function Vo(Eg,bg,Tg,Sg){this._x=Eg||0,this._y=bg||0,this._z=Tg||0,this._w=void 0===Sg?1:Sg}function Wo(Eg,bg,Tg){this.x=Eg||0,this.y=bg||0,this.z=Tg||0}function Xo(){this.elements=[1,0,0,0,1,0,0,0,1],0<arguments.length&&console.error('THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.')}function jo(Eg,bg,Tg,Sg,Mg,Ag,wg,Rg,Lg,Pg){Object.defineProperty(this,'id',{value:Uu++}),this.uuid=Iu.generateUUID(),this.name='',this.image=void 0===Eg?jo.DEFAULT_IMAGE:Eg,this.mipmaps=[],this.mapping=void 0===bg?jo.DEFAULT_MAPPING:bg,this.wrapS=void 0===Tg?Nm:Tg,this.wrapT=void 0===Sg?Nm:Sg,this.magFilter=void 0===Mg?Hm:Mg,this.minFilter=void 0===Ag?Vm:Ag,this.anisotropy=void 0===Lg?1:Lg,this.format=void 0===wg?au:wg,this.type=void 0===Rg?Wm:Rg,this.offset=new Go(0,0),this.repeat=new Go(1,1),this.center=new Go(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Xo,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0===Pg?Tu:Pg,this.version=0,this.onUpdate=null}function Yo(Eg,bg,Tg,Sg){this.x=Eg||0,this.y=bg||0,this.z=Tg||0,this.w=void 0===Sg?1:Sg}function qo(Eg,bg,Tg){this.uuid=Iu.generateUUID(),this.width=Eg,this.height=bg,this.scissor=new Yo(0,0,Eg,bg),this.scissorTest=!1,this.viewport=new Yo(0,0,Eg,bg),void 0===(Tg=Tg||{}).minFilter&&(Tg.minFilter=Hm),this.texture=new jo(void 0,void 0,Tg.wrapS,Tg.wrapT,Tg.magFilter,Tg.minFilter,Tg.format,Tg.type,Tg.anisotropy,Tg.encoding),this.depthBuffer=void 0===Tg.depthBuffer||Tg.depthBuffer,this.stencilBuffer=void 0===Tg.stencilBuffer||Tg.stencilBuffer,this.depthTexture=void 0===Tg.depthTexture?null:Tg.depthTexture}function Zo(Eg,bg,Tg){qo.call(this,Eg,bg,Tg),this.activeCubeFace=0,this.activeMipMapLevel=0}function Jo(Eg,bg,Tg,Sg,Mg,Ag,wg,Rg,Lg,Pg,Cg,Ig){jo.call(this,null,Ag,wg,Rg,Lg,Pg,Sg,Mg,Cg,Ig),this.image={data:Eg,width:bg,height:Tg},this.magFilter=void 0===Lg?Fm:Lg,this.minFilter=void 0===Pg?Fm:Pg,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}function Qo(Eg,bg,Tg,Sg,Mg,Ag,wg,Rg,Lg,Pg){jo.call(this,Eg=void 0===Eg?[]:Eg,bg=void 0===bg?wm:bg,Tg,Sg,Mg,Ag,wg,Rg,Lg,Pg),this.flipY=!1}function Ko(){this.seq=[],this.map={}}function $o(Eg,bg,Tg){var Sg=Eg[0];if(0>=Sg||0<Sg)return Eg;var Mg=bg*Tg,Ag=Bu[Mg];if(void 0===Ag&&(Ag=new Float32Array(Mg),Bu[Mg]=Ag),0!==bg){Sg.toArray(Ag,0);for(var wg=1,Rg=0;wg!==bg;++wg)Rg+=Tg,Eg[wg].toArray(Ag,Rg)}return Ag}function es(Eg,bg){var Tg=Fu[bg];void 0===Tg&&(Tg=new Int32Array(bg),Fu[bg]=Tg);for(var Sg=0;Sg!==bg;++Sg)Tg[Sg]=Eg.allocTextureUnit();return Tg}function ts(Eg,bg){Eg.uniform1f(this.addr,bg)}function rs(Eg,bg){Eg.uniform1i(this.addr,bg)}function as(Eg,bg){void 0===bg.x?Eg.uniform2fv(this.addr,bg):Eg.uniform2f(this.addr,bg.x,bg.y)}function is(Eg,bg){void 0===bg.x?void 0===bg.r?Eg.uniform3fv(this.addr,bg):Eg.uniform3f(this.addr,bg.r,bg.g,bg.b):Eg.uniform3f(this.addr,bg.x,bg.y,bg.z)}function os(Eg,bg){void 0===bg.x?Eg.uniform4fv(this.addr,bg):Eg.uniform4f(this.addr,bg.x,bg.y,bg.z,bg.w)}function ns(Eg,bg){Eg.uniformMatrix2fv(this.addr,!1,bg.elements||bg)}function ss(Eg,bg){void 0===bg.elements?Eg.uniformMatrix3fv(this.addr,!1,bg):(Gu.set(bg.elements),Eg.uniformMatrix3fv(this.addr,!1,Gu))}function ls(Eg,bg){void 0===bg.elements?Eg.uniformMatrix4fv(this.addr,!1,bg):(zu.set(bg.elements),Eg.uniformMatrix4fv(this.addr,!1,zu))}function ds(Eg,bg,Tg){var Sg=Tg.allocTextureUnit();Eg.uniform1i(this.addr,Sg),Tg.setTexture2D(bg||Du,Sg)}function ps(Eg,bg,Tg){var Sg=Tg.allocTextureUnit();Eg.uniform1i(this.addr,Sg),Tg.setTextureCube(bg||Nu,Sg)}function cs(Eg,bg){Eg.uniform2iv(this.addr,bg)}function ms(Eg,bg){Eg.uniform3iv(this.addr,bg)}function us(Eg,bg){Eg.uniform4iv(this.addr,bg)}function gs(Eg,bg){Eg.uniform1fv(this.addr,bg)}function fs(Eg,bg){Eg.uniform1iv(this.addr,bg)}function hs(Eg,bg){Eg.uniform2fv(this.addr,$o(bg,this.size,2))}function ys(Eg,bg){Eg.uniform3fv(this.addr,$o(bg,this.size,3))}function xs(Eg,bg){Eg.uniform4fv(this.addr,$o(bg,this.size,4))}function vs(Eg,bg){Eg.uniformMatrix2fv(this.addr,!1,$o(bg,this.size,4))}function _s(Eg,bg){Eg.uniformMatrix3fv(this.addr,!1,$o(bg,this.size,9))}function Es(Eg,bg){Eg.uniformMatrix4fv(this.addr,!1,$o(bg,this.size,16))}function bs(Eg,bg,Tg){var Sg=bg.length,Mg=es(Tg,Sg);Eg.uniform1iv(this.addr,Mg);for(var Ag=0;Ag!==Sg;++Ag)Tg.setTexture2D(bg[Ag]||Du,Mg[Ag])}function Ts(Eg,bg,Tg){var Sg=bg.length,Mg=es(Tg,Sg);Eg.uniform1iv(this.addr,Mg);for(var Ag=0;Ag!==Sg;++Ag)Tg.setTextureCube(bg[Ag]||Nu,Mg[Ag])}function Ss(Eg,bg,Tg){this.id=Eg,this.addr=Tg,this.setValue=function(Sg){return 5126===Sg?ts:35664===Sg?as:35665===Sg?is:35666===Sg?os:35674===Sg?ns:35675===Sg?ss:35676===Sg?ls:35678===Sg||36198===Sg?ds:35680===Sg?ps:5124===Sg||35670===Sg?rs:35667===Sg||35671===Sg?cs:35668===Sg||35672===Sg?ms:35669===Sg||35673===Sg?us:void 0}(bg.type)}function Ms(Eg,bg,Tg){this.id=Eg,this.addr=Tg,this.size=bg.size,this.setValue=function(Sg){return 5126===Sg?gs:35664===Sg?hs:35665===Sg?ys:35666===Sg?xs:35674===Sg?vs:35675===Sg?_s:35676===Sg?Es:35678===Sg?bs:35680===Sg?Ts:5124===Sg||35670===Sg?fs:35667===Sg||35671===Sg?cs:35668===Sg||35672===Sg?ms:35669===Sg||35673===Sg?us:void 0}(bg.type)}function As(Eg){this.id=Eg,Ko.call(this)}function ws(Eg,bg){Eg.seq.push(bg),Eg.map[bg.id]=bg}function Rs(Eg,bg,Tg){var Sg=Eg.name,Mg=Sg.length;for(Hu.lastIndex=0;;){var Ag=Hu.exec(Sg),wg=Hu.lastIndex,Rg=Ag[1],Lg=']'===Ag[2],Pg=Ag[3];if(Lg&&(Rg|=0),void 0===Pg||'['===Pg&&wg+2===Mg){ws(Tg,void 0===Pg?new Ss(Rg,Eg,bg):new Ms(Rg,Eg,bg));break}var Cg=Tg.map[Rg];void 0===Cg&&ws(Tg,Cg=new As(Rg)),Tg=Cg}}function Ls(Eg,bg,Tg){Ko.call(this),this.renderer=Tg;for(var Sg=Eg.getProgramParameter(bg,Eg.ACTIVE_UNIFORMS),Mg=0;Mg<Sg;++Mg){var Ag=Eg.getActiveUniform(bg,Mg),wg=Ag.name;Rs(Ag,Eg.getUniformLocation(bg,wg),this)}}function Ps(Eg,bg,Tg){return void 0===bg&&void 0===Tg?this.set(Eg):this.setRGB(Eg,bg,Tg)}function Cs(Eg,bg){this.min=void 0===Eg?new Go(1/0,1/0):Eg,this.max=void 0===bg?new Go(-1/0,-1/0):bg}function Is(Eg,bg,Tg,Sg,Mg){function Ag(){var Ng=new Float32Array([-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,1,0,1]),Bg=new Uint16Array([0,1,2,0,2,3]);wg=bg.createBuffer(),Rg=bg.createBuffer(),bg.bindBuffer(bg.ARRAY_BUFFER,wg),bg.bufferData(bg.ARRAY_BUFFER,Ng,bg.STATIC_DRAW),bg.bindBuffer(bg.ELEMENT_ARRAY_BUFFER,Rg),bg.bufferData(bg.ELEMENT_ARRAY_BUFFER,Bg,bg.STATIC_DRAW),Ug=bg.createTexture(),Dg=bg.createTexture(),Tg.bindTexture(bg.TEXTURE_2D,Ug),bg.texImage2D(bg.TEXTURE_2D,0,bg.RGB,16,16,0,bg.RGB,bg.UNSIGNED_BYTE,null),bg.texParameteri(bg.TEXTURE_2D,bg.TEXTURE_WRAP_S,bg.CLAMP_TO_EDGE),bg.texParameteri(bg.TEXTURE_2D,bg.TEXTURE_WRAP_T,bg.CLAMP_TO_EDGE),bg.texParameteri(bg.TEXTURE_2D,bg.TEXTURE_MAG_FILTER,bg.NEAREST),bg.texParameteri(bg.TEXTURE_2D,bg.TEXTURE_MIN_FILTER,bg.NEAREST),Tg.bindTexture(bg.TEXTURE_2D,Dg),bg.texImage2D(bg.TEXTURE_2D,0,bg.RGBA,16,16,0,bg.RGBA,bg.UNSIGNED_BYTE,null),bg.texParameteri(bg.TEXTURE_2D,bg.TEXTURE_WRAP_S,bg.CLAMP_TO_EDGE),bg.texParameteri(bg.TEXTURE_2D,bg.TEXTURE_WRAP_T,bg.CLAMP_TO_EDGE),bg.texParameteri(bg.TEXTURE_2D,bg.TEXTURE_MAG_FILTER,bg.NEAREST),bg.texParameteri(bg.TEXTURE_2D,bg.TEXTURE_MIN_FILTER,bg.NEAREST),Lg={vertexShader:['uniform lowp int renderType;','uniform vec3 screenPosition;','uniform vec2 scale;','uniform float rotation;','uniform sampler2D occlusionMap;','attribute vec2 position;','attribute vec2 uv;','varying vec2 vUV;','varying float vVisibility;','void main() {','\tvUV = uv;','\tvec2 pos = position;','\tif ( renderType == 2 ) {','\t\tvec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );','\t\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );','\t\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );','\t\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );','\t\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );','\t\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );','\t\tvisibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );','\t\tvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );','\t\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );','\t\tvVisibility =        visibility.r / 9.0;','\t\tvVisibility *= 1.0 - visibility.g / 9.0;','\t\tvVisibility *=       visibility.b / 9.0;','\t\tvVisibility *= 1.0 - visibility.a / 9.0;','\t\tpos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;','\t\tpos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;','\t}','\tgl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );','}'].join('\n'),fragmentShader:['uniform lowp int renderType;','uniform sampler2D map;','uniform float opacity;','uniform vec3 color;','varying vec2 vUV;','varying float vVisibility;','void main() {','\tif ( renderType == 0 ) {','\t\tgl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );','\t} else if ( renderType == 1 ) {','\t\tgl_FragColor = texture2D( map, vUV );','\t} else {','\t\tvec4 texture = texture2D( map, vUV );','\t\ttexture.a *= opacity * vVisibility;','\t\tgl_FragColor = texture;','\t\tgl_FragColor.rgb *= color;','\t}','}'].join('\n')},Pg=function(Fg){var zg=bg.createProgram(),Gg=bg.createShader(bg.FRAGMENT_SHADER),Hg=bg.createShader(bg.VERTEX_SHADER),Og='precision '+Mg.precision+' float;\n';return bg.shaderSource(Gg,Og+Fg.fragmentShader),bg.shaderSource(Hg,Og+Fg.vertexShader),bg.compileShader(Gg),bg.compileShader(Hg),bg.attachShader(zg,Gg),bg.attachShader(zg,Hg),bg.linkProgram(zg),zg}(Lg),Cg={vertex:bg.getAttribLocation(Pg,'position'),uv:bg.getAttribLocation(Pg,'uv')},Ig={renderType:bg.getUniformLocation(Pg,'renderType'),map:bg.getUniformLocation(Pg,'map'),occlusionMap:bg.getUniformLocation(Pg,'occlusionMap'),opacity:bg.getUniformLocation(Pg,'opacity'),color:bg.getUniformLocation(Pg,'color'),scale:bg.getUniformLocation(Pg,'scale'),rotation:bg.getUniformLocation(Pg,'rotation'),screenPosition:bg.getUniformLocation(Pg,'screenPosition')}}var wg,Rg,Lg,Pg,Cg,Ig,Ug,Dg;this.render=function(Ng,Bg,Fg,zg){if(0!==Ng.length){var Gg=new Wo,Hg=zg.w/zg.z,Og=.5*zg.z,Vg=.5*zg.w,Wg=16/zg.w,kg=new Go(Wg*Hg,Wg),Xg=new Wo(1,1,0),jg=new Go(1,1),Yg=new Cs;Yg.min.set(zg.x,zg.y),Yg.max.set(zg.x+(zg.z-16),zg.y+(zg.w-16)),void 0===Pg&&Ag(),Tg.useProgram(Pg),Tg.initAttributes(),Tg.enableAttribute(Cg.vertex),Tg.enableAttribute(Cg.uv),Tg.disableUnusedAttributes(),bg.uniform1i(Ig.occlusionMap,0),bg.uniform1i(Ig.map,1),bg.bindBuffer(bg.ARRAY_BUFFER,wg),bg.vertexAttribPointer(Cg.vertex,2,bg.FLOAT,!1,16,0),bg.vertexAttribPointer(Cg.uv,2,bg.FLOAT,!1,16,8),bg.bindBuffer(bg.ELEMENT_ARRAY_BUFFER,Rg),Tg.disable(bg.CULL_FACE),Tg.buffers.depth.setMask(!1);for(var qg=0,Zg=Ng.length;qg<Zg;qg++){Wg=16/zg.w,kg.set(Wg*Hg,Wg);var Jg=Ng[qg];if(Gg.set(Jg.matrixWorld.elements[12],Jg.matrixWorld.elements[13],Jg.matrixWorld.elements[14]),Gg.applyMatrix4(Fg.matrixWorldInverse),Gg.applyMatrix4(Fg.projectionMatrix),Xg.copy(Gg),jg.x=zg.x+Xg.x*Og+Og-8,jg.y=zg.y+Xg.y*Vg+Vg-8,!0===Yg.containsPoint(jg)){Tg.activeTexture(bg.TEXTURE0),Tg.bindTexture(bg.TEXTURE_2D,null),Tg.activeTexture(bg.TEXTURE1),Tg.bindTexture(bg.TEXTURE_2D,Ug),bg.copyTexImage2D(bg.TEXTURE_2D,0,bg.RGB,jg.x,jg.y,16,16,0),bg.uniform1i(Ig.renderType,0),bg.uniform2f(Ig.scale,kg.x,kg.y),bg.uniform3f(Ig.screenPosition,Xg.x,Xg.y,Xg.z),Tg.disable(bg.BLEND),Tg.enable(bg.DEPTH_TEST),bg.drawElements(bg.TRIANGLES,6,bg.UNSIGNED_SHORT,0),Tg.activeTexture(bg.TEXTURE0),Tg.bindTexture(bg.TEXTURE_2D,Dg),bg.copyTexImage2D(bg.TEXTURE_2D,0,bg.RGBA,jg.x,jg.y,16,16,0),bg.uniform1i(Ig.renderType,1),Tg.disable(bg.DEPTH_TEST),Tg.activeTexture(bg.TEXTURE1),Tg.bindTexture(bg.TEXTURE_2D,Ug),bg.drawElements(bg.TRIANGLES,6,bg.UNSIGNED_SHORT,0),Jg.positionScreen.copy(Xg),Jg.customUpdateCallback?Jg.customUpdateCallback(Jg):Jg.updateLensFlares(),bg.uniform1i(Ig.renderType,2),Tg.enable(bg.BLEND);for(var Qg=0,Kg=Jg.lensFlares.length,$g;Qg<Kg;Qg++)$g=Jg.lensFlares[Qg],.001<$g.opacity&&.001<$g.scale&&(Xg.x=$g.x,Xg.y=$g.y,Xg.z=$g.z,Wg=$g.size*$g.scale/zg.w,kg.x=Wg*Hg,kg.y=Wg,bg.uniform3f(Ig.screenPosition,Xg.x,Xg.y,Xg.z),bg.uniform2f(Ig.scale,kg.x,kg.y),bg.uniform1f(Ig.rotation,$g.rotation),bg.uniform1f(Ig.opacity,$g.opacity),bg.uniform3f(Ig.color,$g.color.r,$g.color.g,$g.color.b),Tg.setBlending($g.blending,$g.blendEquation,$g.blendSrc,$g.blendDst),Sg.setTexture2D($g.texture,1),bg.drawElements(bg.TRIANGLES,6,bg.UNSIGNED_SHORT,0))}}Tg.enable(bg.CULL_FACE),Tg.enable(bg.DEPTH_TEST),Tg.buffers.depth.setMask(!0),Tg.reset()}}}function Us(Eg,bg,Tg,Sg,Mg,Ag,wg,Rg,Lg){jo.call(this,Eg,bg,Tg,Sg,Mg,Ag,wg,Rg,Lg),this.needsUpdate=!0}function Ds(Eg,bg,Tg,Sg,Mg){function Ag(){var Fg=new Float32Array([-0.5,-0.5,0,0,0.5,-0.5,1,0,0.5,0.5,1,1,-0.5,0.5,0,1]),zg=new Uint16Array([0,1,2,0,2,3]);Rg=bg.createBuffer(),Lg=bg.createBuffer(),bg.bindBuffer(bg.ARRAY_BUFFER,Rg),bg.bufferData(bg.ARRAY_BUFFER,Fg,bg.STATIC_DRAW),bg.bindBuffer(bg.ELEMENT_ARRAY_BUFFER,Lg),bg.bufferData(bg.ELEMENT_ARRAY_BUFFER,zg,bg.STATIC_DRAW),Pg=function(){var Og=bg.createProgram(),Vg=bg.createShader(bg.VERTEX_SHADER),Wg=bg.createShader(bg.FRAGMENT_SHADER);return bg.shaderSource(Vg,['precision '+Mg.precision+' float;','#define SHADER_NAME SpriteMaterial','uniform mat4 modelViewMatrix;','uniform mat4 projectionMatrix;','uniform float rotation;','uniform vec2 scale;','uniform vec2 uvOffset;','uniform vec2 uvScale;','attribute vec2 position;','attribute vec2 uv;','varying vec2 vUV;','varying float fogDepth;','void main() {','\tvUV = uvOffset + uv * uvScale;','\tvec2 alignedPosition = position * scale;','\tvec2 rotatedPosition;','\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;','\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;','\tvec4 mvPosition;','\tmvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );','\tmvPosition.xy += rotatedPosition;','\tgl_Position = projectionMatrix * mvPosition;','\tfogDepth = - mvPosition.z;','}'].join('\n')),bg.shaderSource(Wg,['precision '+Mg.precision+' float;','#define SHADER_NAME SpriteMaterial','uniform vec3 color;','uniform sampler2D map;','uniform float opacity;','uniform int fogType;','uniform vec3 fogColor;','uniform float fogDensity;','uniform float fogNear;','uniform float fogFar;','uniform float alphaTest;','varying vec2 vUV;','varying float fogDepth;','void main() {','\tvec4 texture = texture2D( map, vUV );','\tgl_FragColor = vec4( color * texture.xyz, texture.a * opacity );','\tif ( gl_FragColor.a < alphaTest ) discard;','\tif ( fogType > 0 ) {','\t\tfloat fogFactor = 0.0;','\t\tif ( fogType == 1 ) {','\t\t\tfogFactor = smoothstep( fogNear, fogFar, fogDepth );','\t\t} else {','\t\t\tconst float LOG2 = 1.442695;','\t\t\tfogFactor = exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 );','\t\t\tfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );','\t\t}','\t\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );','\t}','}'].join('\n')),bg.compileShader(Vg),bg.compileShader(Wg),bg.attachShader(Og,Vg),bg.attachShader(Og,Wg),bg.linkProgram(Og),Og}(),Cg={position:bg.getAttribLocation(Pg,'position'),uv:bg.getAttribLocation(Pg,'uv')},Ig={uvOffset:bg.getUniformLocation(Pg,'uvOffset'),uvScale:bg.getUniformLocation(Pg,'uvScale'),rotation:bg.getUniformLocation(Pg,'rotation'),scale:bg.getUniformLocation(Pg,'scale'),color:bg.getUniformLocation(Pg,'color'),map:bg.getUniformLocation(Pg,'map'),opacity:bg.getUniformLocation(Pg,'opacity'),modelViewMatrix:bg.getUniformLocation(Pg,'modelViewMatrix'),projectionMatrix:bg.getUniformLocation(Pg,'projectionMatrix'),fogType:bg.getUniformLocation(Pg,'fogType'),fogDensity:bg.getUniformLocation(Pg,'fogDensity'),fogNear:bg.getUniformLocation(Pg,'fogNear'),fogFar:bg.getUniformLocation(Pg,'fogFar'),fogColor:bg.getUniformLocation(Pg,'fogColor'),fogDepth:bg.getUniformLocation(Pg,'fogDepth'),alphaTest:bg.getUniformLocation(Pg,'alphaTest')};var Gg=document.createElement('canvas');Gg.width=8,Gg.height=8;var Hg=Gg.getContext('2d');Hg.fillStyle='white',Hg.fillRect(0,0,8,8),Ug=new Us(Gg)}function wg(Fg,zg){return Fg.renderOrder===zg.renderOrder?Fg.z===zg.z?zg.id-Fg.id:zg.z-Fg.z:Fg.renderOrder-zg.renderOrder}var Dg=new Wo,Ng=new Vo,Bg=new Wo,Rg,Lg,Pg,Cg,Ig,Ug;this.render=function(Fg,zg,Gg){if(0!==Fg.length){void 0===Pg&&Ag(),Tg.useProgram(Pg),Tg.initAttributes(),Tg.enableAttribute(Cg.position),Tg.enableAttribute(Cg.uv),Tg.disableUnusedAttributes(),Tg.disable(bg.CULL_FACE),Tg.enable(bg.BLEND),bg.bindBuffer(bg.ARRAY_BUFFER,Rg),bg.vertexAttribPointer(Cg.position,2,bg.FLOAT,!1,16,0),bg.vertexAttribPointer(Cg.uv,2,bg.FLOAT,!1,16,8),bg.bindBuffer(bg.ELEMENT_ARRAY_BUFFER,Lg),bg.uniformMatrix4fv(Ig.projectionMatrix,!1,Gg.projectionMatrix.elements),Tg.activeTexture(bg.TEXTURE0),bg.uniform1i(Ig.map,0);var Hg=0,Og=0,Vg=zg.fog;Vg?(bg.uniform3f(Ig.fogColor,Vg.color.r,Vg.color.g,Vg.color.b),Vg.isFog?(bg.uniform1f(Ig.fogNear,Vg.near),bg.uniform1f(Ig.fogFar,Vg.far),bg.uniform1i(Ig.fogType,1),Hg=1,Og=1):Vg.isFogExp2&&(bg.uniform1f(Ig.fogDensity,Vg.density),bg.uniform1i(Ig.fogType,2),Hg=2,Og=2)):(bg.uniform1i(Ig.fogType,0),Hg=0,Og=0);for(var Wg=0,kg=Fg.length;Wg<kg;Wg++)(jg=Fg[Wg]).modelViewMatrix.multiplyMatrices(Gg.matrixWorldInverse,jg.matrixWorld),jg.z=-jg.modelViewMatrix.elements[14];Fg.sort(wg);for(var Xg=[],Wg=0,kg=Fg.length;Wg<kg;Wg++){var jg=Fg[Wg],Yg=jg.material;if(!1!==Yg.visible){jg.onBeforeRender(Eg,zg,Gg,void 0,Yg,void 0),bg.uniform1f(Ig.alphaTest,Yg.alphaTest),bg.uniformMatrix4fv(Ig.modelViewMatrix,!1,jg.modelViewMatrix.elements),jg.matrixWorld.decompose(Dg,Ng,Bg),Xg[0]=Bg.x,Xg[1]=Bg.y;var qg=0;zg.fog&&Yg.fog&&(qg=Og),Hg!=qg&&(bg.uniform1i(Ig.fogType,qg),Hg=qg),null===Yg.map?(bg.uniform2f(Ig.uvOffset,0,0),bg.uniform2f(Ig.uvScale,1,1)):(bg.uniform2f(Ig.uvOffset,Yg.map.offset.x,Yg.map.offset.y),bg.uniform2f(Ig.uvScale,Yg.map.repeat.x,Yg.map.repeat.y)),bg.uniform1f(Ig.opacity,Yg.opacity),bg.uniform3f(Ig.color,Yg.color.r,Yg.color.g,Yg.color.b),bg.uniform1f(Ig.rotation,Yg.rotation),bg.uniform2fv(Ig.scale,Xg),Tg.setBlending(Yg.blending,Yg.blendEquation,Yg.blendSrc,Yg.blendDst,Yg.blendEquationAlpha,Yg.blendSrcAlpha,Yg.blendDstAlpha,Yg.premultipliedAlpha),Tg.buffers.depth.setTest(Yg.depthTest),Tg.buffers.depth.setMask(Yg.depthWrite),Tg.buffers.color.setMask(Yg.colorWrite),Sg.setTexture2D(Yg.map||Ug,0),bg.drawElements(bg.TRIANGLES,6,bg.UNSIGNED_SHORT,0),jg.onAfterRender(Eg,zg,Gg,void 0,Yg,void 0)}}Tg.enable(bg.CULL_FACE),Tg.reset()}}}function Ns(){Object.defineProperty(this,'id',{value:ju++}),this.uuid=Iu.generateUUID(),this.name='',this.type='Material',this.fog=!0,this.lights=!0,this.blending=kc,this.side=Fc,this.flatShading=!1,this.vertexColors=Hc,this.opacity=1,this.transparent=!1,this.blendSrc=im,this.blendDst=om,this.blendEquation=Zc,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=gm,this.depthTest=!0,this.depthWrite=!0,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.overdraw=0,this.visible=!0,this.userData={},this.needsUpdate=!0}function Bs(Eg){Ns.call(this),this.type='MeshDepthMaterial',this.depthPacking=Pu,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.setValues(Eg)}function Fs(Eg){Ns.call(this),this.type='MeshDistanceMaterial',this.referencePosition=new Wo,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.lights=!1,this.setValues(Eg)}function zs(Eg,bg){this.min=void 0===Eg?new Wo(1/0,1/0,1/0):Eg,this.max=void 0===bg?new Wo(-1/0,-1/0,-1/0):bg}function Gs(Eg,bg){this.center=void 0===Eg?new Wo:Eg,this.radius=void 0===bg?0:bg}function Hs(Eg,bg){this.normal=void 0===Eg?new Wo(1,0,0):Eg,this.constant=void 0===bg?0:bg}function Os(Eg,bg,Tg,Sg,Mg,Ag){this.planes=[void 0===Eg?new Hs:Eg,void 0===bg?new Hs:bg,void 0===Tg?new Hs:Tg,void 0===Sg?new Hs:Sg,void 0===Mg?new Hs:Mg,void 0===Ag?new Hs:Ag]}function Vs(Eg,bg,Tg){function Sg(Yg,qg,Zg,Jg,Qg,Kg){var $g=Yg.geometry,ef=null,tf=Ng,rf=Yg.customDepthMaterial;if(Zg&&(tf=Bg,rf=Yg.customDistanceMaterial),rf)ef=rf;else{var af=!1;qg.morphTargets&&($g&&$g.isBufferGeometry?af=$g.morphAttributes&&$g.morphAttributes.position&&0<$g.morphAttributes.position.length:$g&&$g.isGeometry&&(af=$g.morphTargets&&0<$g.morphTargets.length)),Yg.isSkinnedMesh&&!1===qg.skinning&&console.warn('THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:',Yg);var of=Yg.isSkinnedMesh&&qg.skinning,nf=0;af&&(nf|=Ig),of&&(nf|=Ug),ef=tf[nf]}if(Eg.localClippingEnabled&&!0===qg.clipShadows&&0!==qg.clippingPlanes.length){var sf=ef.uuid,lf=qg.uuid,df=Fg[sf];void 0===df&&(df={},Fg[sf]=df);var pf=df[lf];void 0===pf&&(pf=ef.clone(),df[lf]=pf),ef=pf}ef.visible=qg.visible,ef.wireframe=qg.wireframe;var cf=qg.side;return jg.renderSingleSided&&cf==Gc&&(cf=Fc),jg.renderReverseSided&&(cf===Fc?cf=zc:cf===zc&&(cf=Fc)),ef.side=cf,ef.clipShadows=qg.clipShadows,ef.clippingPlanes=qg.clippingPlanes,ef.clipIntersection=qg.clipIntersection,ef.wireframeLinewidth=qg.wireframeLinewidth,ef.linewidth=qg.linewidth,Zg&&ef.isMeshDistanceMaterial&&(ef.referencePosition.copy(Jg),ef.nearDistance=Qg,ef.farDistance=Kg),ef}function Mg(Yg,qg,Zg,Jg){if(!1!==Yg.visible){if(Yg.layers.test(qg.layers)&&(Yg.isMesh||Yg.isLine||Yg.isPoints)&&Yg.castShadow&&(!Yg.frustumCulled||Ag.intersectsObject(Yg))){Yg.modelViewMatrix.multiplyMatrices(Zg.matrixWorldInverse,Yg.matrixWorld);var Qg=bg.update(Yg),Kg=Yg.material;if(Array.isArray(Kg))for(var $g=Qg.groups,ef=0,tf=$g.length;ef<tf;ef++){var rf=$g[ef],af=Kg[rf.materialIndex];af&&af.visible&&(of=Sg(Yg,af,Jg,Cg,Zg.near,Zg.far),Eg.renderBufferDirect(Zg,null,Qg,of,Yg,rf))}else if(Kg.visible){var of=Sg(Yg,Kg,Jg,Cg,Zg.near,Zg.far);Eg.renderBufferDirect(Zg,null,Qg,of,Yg,null)}}for(var nf=Yg.children,sf=0,lf=nf.length;sf<lf;sf++)Mg(nf[sf],qg,Zg,Jg)}}for(var Ag=new Os,wg=new Ho,Rg=new Go,Lg=new Go(Tg,Tg),Pg=new Wo,Cg=new Wo,Ig=1,Ug=2,Ng=[,,,,],Bg=[,,,,],Fg={},zg=[new Wo(1,0,0),new Wo(-1,0,0),new Wo(0,0,1),new Wo(0,0,-1),new Wo(0,1,0),new Wo(0,-1,0)],Gg=[new Wo(0,1,0),new Wo(0,1,0),new Wo(0,1,0),new Wo(0,1,0),new Wo(0,0,1),new Wo(0,0,-1)],Hg=[new Yo,new Yo,new Yo,new Yo,new Yo,new Yo],Og=0;Og!==1+(Ig|Ug);++Og){var Vg=0!=(Og&Ig),Wg=0!=(Og&Ug),kg=new Bs({depthPacking:Cu,morphTargets:Vg,skinning:Wg});Ng[Og]=kg;var Xg=new Fs({morphTargets:Vg,skinning:Wg});Bg[Og]=Xg}var jg=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Nc,this.renderReverseSided=!0,this.renderSingleSided=!0,this.render=function(Yg,qg,Zg){if(!1!==jg.enabled&&(!1!==jg.autoUpdate||!1!==jg.needsUpdate)&&0!==Yg.length){var Jg=Eg.context,Qg=Eg.state;Qg.disable(Jg.BLEND),Qg.buffers.color.setClear(1,1,1,1),Qg.buffers.depth.setTest(!0),Qg.setScissorTest(!1);for(var $g=0,ef=Yg.length,Kg;$g<ef;$g++){var tf=Yg[$g],rf=tf.shadow,af=tf&&tf.isPointLight;if(void 0!==rf){var of=rf.camera;if(Rg.copy(rf.mapSize),Rg.min(Lg),af){var nf=Rg.x,sf=Rg.y;Hg[0].set(2*nf,sf,nf,sf),Hg[1].set(0,sf,nf,sf),Hg[2].set(3*nf,sf,nf,sf),Hg[3].set(nf,sf,nf,sf),Hg[4].set(3*nf,0,nf,sf),Hg[5].set(nf,0,nf,sf),Rg.x*=4,Rg.y*=2}if(null===rf.map){rf.map=new qo(Rg.x,Rg.y,{minFilter:Fm,magFilter:Fm,format:au}),rf.map.texture.name=tf.name+'.shadowMap',of.updateProjectionMatrix()}rf.isSpotLightShadow&&rf.update(tf);var df=rf.map,pf=rf.matrix;Cg.setFromMatrixPosition(tf.matrixWorld),of.position.copy(Cg),af?(Kg=6,pf.makeTranslation(-Cg.x,-Cg.y,-Cg.z)):(Kg=1,Pg.setFromMatrixPosition(tf.target.matrixWorld),of.lookAt(Pg),of.updateMatrixWorld(),pf.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),pf.multiply(of.projectionMatrix),pf.multiply(of.matrixWorldInverse)),Eg.setRenderTarget(df),Eg.clear();for(var cf=0;cf<Kg;cf++){if(af){Pg.copy(of.position),Pg.add(zg[cf]),of.up.copy(Gg[cf]),of.lookAt(Pg),of.updateMatrixWorld();var mf=Hg[cf];Qg.viewport(mf)}wg.multiplyMatrices(of.projectionMatrix,of.matrixWorldInverse),Ag.setFromMatrix(wg),Mg(qg,Zg,of,af)}}else console.warn('THREE.WebGLShadowMap:',tf,'has no shadow.')}jg.needsUpdate=!1}}}function Ws(Eg){var Tg={};return{get:function get(Sg){return Sg.isInterleavedBufferAttribute&&(Sg=Sg.data),Tg[Sg.uuid]},remove:function remove(Sg){Sg.isInterleavedBufferAttribute&&(Sg=Sg.data);var Mg=Tg[Sg.uuid];Mg&&(Eg.deleteBuffer(Mg.buffer),delete Tg[Sg.uuid])},update:function(Sg,Mg){Sg.isInterleavedBufferAttribute&&(Sg=Sg.data);var Ag=Tg[Sg.uuid];void 0===Ag?Tg[Sg.uuid]=function(wg,Rg){var Lg=wg.array,Pg=wg.dynamic?Eg.DYNAMIC_DRAW:Eg.STATIC_DRAW,Cg=Eg.createBuffer();Eg.bindBuffer(Rg,Cg),Eg.bufferData(Rg,Lg,Pg),wg.onUploadCallback();var Ig=Eg.FLOAT;return Lg instanceof Float32Array?Ig=Eg.FLOAT:Lg instanceof Float64Array?console.warn('THREE.WebGLAttributes: Unsupported data buffer format: Float64Array.'):Lg instanceof Uint16Array?Ig=Eg.UNSIGNED_SHORT:Lg instanceof Int16Array?Ig=Eg.SHORT:Lg instanceof Uint32Array?Ig=Eg.UNSIGNED_INT:Lg instanceof Int32Array?Ig=Eg.INT:Lg instanceof Int8Array?Ig=Eg.BYTE:Lg instanceof Uint8Array&&(Ig=Eg.UNSIGNED_BYTE),{buffer:Cg,type:Ig,bytesPerElement:Lg.BYTES_PER_ELEMENT,version:wg.version}}(Sg,Mg):Ag.version<Sg.version&&(!function(wg,Rg,Lg){var Pg=Rg.array,Cg=Rg.updateRange;Eg.bindBuffer(Lg,wg),!1===Rg.dynamic?Eg.bufferData(Lg,Pg,Eg.STATIC_DRAW):-1===Cg.count?Eg.bufferSubData(Lg,0,Pg):0===Cg.count?console.error('THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually.'):(Eg.bufferSubData(Lg,Cg.offset*Pg.BYTES_PER_ELEMENT,Pg.subarray(Cg.offset,Cg.offset+Cg.count)),Cg.count=-1)}(Ag.buffer,Sg,Mg),Ag.version=Sg.version)}}}function ks(Eg,bg,Tg,Sg){this._x=Eg||0,this._y=bg||0,this._z=Tg||0,this._order=Sg||ks.DefaultOrder}function Xs(){this.mask=1}function js(){Object.defineProperty(this,'id',{value:Yu++}),this.uuid=Iu.generateUUID(),this.name='',this.type='Object3D',this.parent=null,this.children=[],this.up=js.DefaultUp.clone();var Eg=new Wo,bg=new ks,Tg=new Vo,Sg=new Wo(1,1,1);bg.onChange(function(){Tg.setFromEuler(bg,!1)}),Tg.onChange(function(){bg.setFromQuaternion(Tg,void 0,!1)}),Object.defineProperties(this,{position:{enumerable:!0,value:Eg},rotation:{enumerable:!0,value:bg},quaternion:{enumerable:!0,value:Tg},scale:{enumerable:!0,value:Sg},modelViewMatrix:{value:new Ho},normalMatrix:{value:new Xo}}),this.matrix=new Ho,this.matrixWorld=new Ho,this.matrixAutoUpdate=js.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Xs,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function Ys(){js.call(this),this.type='Camera',this.matrixWorldInverse=new Ho,this.projectionMatrix=new Ho}function qs(Eg,bg,Tg,Sg,Mg,Ag){Ys.call(this),this.type='OrthographicCamera',this.zoom=1,this.view=null,this.left=Eg,this.right=bg,this.top=Tg,this.bottom=Sg,this.near=void 0===Mg?.1:Mg,this.far=void 0===Ag?2e3:Ag,this.updateProjectionMatrix()}function Zs(Eg,bg,Tg,Sg,Mg,Ag){this.a=Eg,this.b=bg,this.c=Tg,this.normal=Sg&&Sg.isVector3?Sg:new Wo,this.vertexNormals=Array.isArray(Sg)?Sg:[],this.color=Mg&&Mg.isColor?Mg:new Ps,this.vertexColors=Array.isArray(Mg)?Mg:[],this.materialIndex=void 0===Ag?0:Ag}function Js(){Object.defineProperty(this,'id',{value:qu+=2}),this.uuid=Iu.generateUUID(),this.name='',this.type='Geometry',this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}function Qs(Eg,bg,Tg){if(Array.isArray(Eg))throw new TypeError('THREE.BufferAttribute: array should be a Typed Array.');this.uuid=Iu.generateUUID(),this.name='',this.array=Eg,this.itemSize=bg,this.count=void 0===Eg?0:Eg.length/bg,this.normalized=!0===Tg,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.onUploadCallback=function(){},this.version=0}function Ks(Eg,bg,Tg){Qs.call(this,new Int8Array(Eg),bg,Tg)}function $s(Eg,bg,Tg){Qs.call(this,new Uint8Array(Eg),bg,Tg)}function el(Eg,bg,Tg){Qs.call(this,new Uint8ClampedArray(Eg),bg,Tg)}function tl(Eg,bg,Tg){Qs.call(this,new Int16Array(Eg),bg,Tg)}function rl(Eg,bg,Tg){Qs.call(this,new Uint16Array(Eg),bg,Tg)}function al(Eg,bg,Tg){Qs.call(this,new Int32Array(Eg),bg,Tg)}function il(Eg,bg,Tg){Qs.call(this,new Uint32Array(Eg),bg,Tg)}function ol(Eg,bg,Tg){Qs.call(this,new Float32Array(Eg),bg,Tg)}function nl(Eg,bg,Tg){Qs.call(this,new Float64Array(Eg),bg,Tg)}function sl(){this.indices=[],this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function ll(Eg){if(0===Eg.length)return-1/0;for(var bg=Eg[0],Tg=1,Sg=Eg.length;Tg<Sg;++Tg)Eg[Tg]>bg&&(bg=Eg[Tg]);return bg}function dl(){Object.defineProperty(this,'id',{value:Zu+=2}),this.uuid=Iu.generateUUID(),this.name='',this.type='BufferGeometry',this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0}}function pl(Eg,bg){Js.call(this),this.type='ShapeGeometry','object'===(void 0===bg?'undefined':o(bg))&&(console.warn('THREE.ShapeGeometry: Options parameter has been removed.'),bg=bg.curveSegments),this.parameters={shapes:Eg,curveSegments:bg},this.fromBufferGeometry(new cl(Eg,bg)),this.mergeVertices()}function cl(Eg,bg){function Tg(Cg){var Ng=Mg.length/3,Bg=Cg.extractPoints(bg),Fg=Bg.shape,zg=Bg.holes,Ig,Ug,Dg;if(!1===Qu.isClockWise(Fg))for(Fg=Fg.reverse(),Ig=0,Ug=zg.length;Ig<Ug;Ig++)Dg=zg[Ig],!0===Qu.isClockWise(Dg)&&(zg[Ig]=Dg.reverse());var Gg=Qu.triangulateShape(Fg,zg);for(Ig=0,Ug=zg.length;Ig<Ug;Ig++)Dg=zg[Ig],Fg=Fg.concat(Dg);for(Ig=0,Ug=Fg.length;Ig<Ug;Ig++){var Hg=Fg[Ig];Mg.push(Hg.x,Hg.y,0),Ag.push(0,0,1),wg.push(Hg.x,Hg.y)}for(Ig=0,Ug=Gg.length;Ig<Ug;Ig++){var Og=Gg[Ig],Vg=Og[0]+Ng,Wg=Og[1]+Ng,kg=Og[2]+Ng;Sg.push(Vg,Wg,kg),Lg+=3}}dl.call(this),this.type='ShapeBufferGeometry',this.parameters={shapes:Eg,curveSegments:bg},bg=bg||12;var Sg=[],Mg=[],Ag=[],wg=[],Rg=0,Lg=0;if(!1===Array.isArray(Eg))Tg(Eg);else for(var Pg=0;Pg<Eg.length;Pg++)Tg(Eg[Pg]),this.addGroup(Rg,Lg,Pg),Rg+=Lg,Lg=0;this.setIndex(Sg),this.addAttribute('position',new ol(Mg,3)),this.addAttribute('normal',new ol(Ag,3)),this.addAttribute('uv',new ol(wg,2))}function ml(Eg,bg,Tg,Sg,Mg,Ag){Js.call(this),this.type='BoxGeometry',this.parameters={width:Eg,height:bg,depth:Tg,widthSegments:Sg,heightSegments:Mg,depthSegments:Ag},this.fromBufferGeometry(new ul(Eg,bg,Tg,Sg,Mg,Ag)),this.mergeVertices()}function ul(Eg,bg,Tg,Sg,Mg,Ag){function wg(Ng,Bg,Fg,zg,Gg,Hg,Og,Vg,Wg,kg,Xg){var $g=Wg+1,tf=0,rf=0,af=new Wo,jg,Yg;for(Yg=0;Yg<kg+1;Yg++){var of=Yg*(Og/kg)-Og/2;for(jg=0;jg<$g;jg++){var nf=jg*(Hg/Wg)-Hg/2;af[Ng]=nf*zg,af[Bg]=of*Gg,af[Fg]=Vg/2,Pg.push(af.x,af.y,af.z),af[Ng]=0,af[Bg]=0,af[Fg]=0<Vg?1:-1,Cg.push(af.x,af.y,af.z),Ig.push(jg/Wg),Ig.push(1-Yg/kg),tf+=1}}for(Yg=0;Yg<kg;Yg++)for(jg=0;jg<Wg;jg++){var sf=Ug+jg+$g*Yg,lf=Ug+jg+$g*(Yg+1),df=Ug+(jg+1)+$g*(Yg+1),pf=Ug+(jg+1)+$g*Yg;Lg.push(sf,lf,pf),Lg.push(lf,df,pf),rf+=6}Rg.addGroup(Dg,rf,Xg),Dg+=rf,Ug+=tf}dl.call(this),this.type='BoxBufferGeometry',this.parameters={width:Eg,height:bg,depth:Tg,widthSegments:Sg,heightSegments:Mg,depthSegments:Ag};var Rg=this;Eg=Eg||1,bg=bg||1,Tg=Tg||1,Sg=Math.floor(Sg)||1,Mg=Math.floor(Mg)||1;var Lg=[],Pg=[],Cg=[],Ig=[],Ug=0,Dg=0;wg('z','y','x',-1,-1,Tg,bg,Eg,Ag=Math.floor(Ag)||1,Mg,0),wg('z','y','x',1,-1,Tg,bg,-Eg,Ag,Mg,1),wg('x','z','y',1,1,Eg,Tg,bg,Sg,Ag,2),wg('x','z','y',1,-1,Eg,Tg,-bg,Sg,Ag,3),wg('x','y','z',1,-1,Eg,bg,Tg,Sg,Mg,4),wg('x','y','z',-1,-1,Eg,bg,-Tg,Sg,Mg,5),this.setIndex(Lg),this.addAttribute('position',new ol(Pg,3)),this.addAttribute('normal',new ol(Cg,3)),this.addAttribute('uv',new ol(Ig,2))}function gl(Eg,bg,Tg,Sg){Js.call(this),this.type='PlaneGeometry',this.parameters={width:Eg,height:bg,widthSegments:Tg,heightSegments:Sg},this.fromBufferGeometry(new fl(Eg,bg,Tg,Sg)),this.mergeVertices()}function fl(Eg,bg,Tg,Sg){dl.call(this),this.type='PlaneBufferGeometry',this.parameters={width:Eg,height:bg,widthSegments:Tg,heightSegments:Sg};var wg=(Eg=Eg||1)/2,Rg=(bg=bg||1)/2,Lg=Math.floor(Tg)||1,Pg=Math.floor(Sg)||1,Cg=Lg+1,Ug=Eg/Lg,Dg=bg/Pg,Ng=[],Bg=[],Fg=[],zg=[],Mg,Ag;for(Ag=0;Ag<Pg+1;Ag++){var Gg=Ag*Dg-Rg;for(Mg=0;Mg<Cg;Mg++){var Hg=Mg*Ug-wg;Bg.push(Hg,-Gg,0),Fg.push(0,0,1),zg.push(Mg/Lg),zg.push(1-Ag/Pg)}}for(Ag=0;Ag<Pg;Ag++)for(Mg=0;Mg<Lg;Mg++){var Og=Mg+Cg*Ag,Vg=Mg+Cg*(Ag+1),Wg=Mg+1+Cg*(Ag+1),kg=Mg+1+Cg*Ag;Ng.push(Og,Vg,kg),Ng.push(Vg,Wg,kg)}this.setIndex(Ng),this.addAttribute('position',new ol(Bg,3)),this.addAttribute('normal',new ol(Fg,3)),this.addAttribute('uv',new ol(zg,2))}function hl(Eg){Ns.call(this),this.type='MeshBasicMaterial',this.color=new Ps(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=vm,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap='round',this.wireframeLinejoin='round',this.skinning=!1,this.morphTargets=!1,this.lights=!1,this.setValues(Eg)}function yl(Eg){Ns.call(this),this.type='ShaderMaterial',this.defines={},this.uniforms={},this.vertexShader='void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}',this.fragmentShader='void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}',this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,void 0!==Eg&&(void 0!==Eg.attributes&&console.error('THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead.'),this.setValues(Eg))}function xl(Eg,bg){this.origin=void 0===Eg?new Wo:Eg,this.direction=void 0===bg?new Wo:bg}function vl(Eg,bg){this.start=void 0===Eg?new Wo:Eg,this.end=void 0===bg?new Wo:bg}function _l(Eg,bg,Tg){this.a=void 0===Eg?new Wo:Eg,this.b=void 0===bg?new Wo:bg,this.c=void 0===Tg?new Wo:Tg}function El(Eg,bg){js.call(this),this.type='Mesh',this.geometry=void 0===Eg?new dl:Eg,this.material=void 0===bg?new hl({color:16777215*Math.random()}):bg,this.drawMode=_u,this.updateMorphTargets()}function bl(Eg,bg){return Eg.renderOrder===bg.renderOrder?Eg.program&&bg.program&&Eg.program!==bg.program?Eg.program.id-bg.program.id:Eg.material.id===bg.material.id?Eg.z===bg.z?Eg.id-bg.id:Eg.z-bg.z:Eg.material.id-bg.material.id:Eg.renderOrder-bg.renderOrder}function Tl(Eg,bg){return Eg.renderOrder===bg.renderOrder?Eg.z===bg.z?Eg.id-bg.id:bg.z-Eg.z:Eg.renderOrder-bg.renderOrder}function Sl(){var bg={};return{get:function(Tg,Sg){var Mg=Tg.id+','+Sg.id,Ag=bg[Mg];return void 0===Ag&&(Ag=new function(){var wg=[],Rg=0,Lg=[],Pg=[];return{opaque:Lg,transparent:Pg,init:function init(){Rg=0,Lg.length=0,Pg.length=0},push:function push(Cg,Ig,Ug,Dg,Ng){var Bg=wg[Rg];void 0===Bg?(Bg={id:Cg.id,object:Cg,geometry:Ig,material:Ug,program:Ug.program,renderOrder:Cg.renderOrder,z:Dg,group:Ng},wg[Rg]=Bg):(Bg.id=Cg.id,Bg.object=Cg,Bg.geometry=Ig,Bg.material=Ug,Bg.program=Ug.program,Bg.renderOrder=Cg.renderOrder,Bg.z=Dg,Bg.group=Ng),(!0===Ug.transparent?Pg:Lg).push(Bg),Rg++},sort:function sort(){1<Lg.length&&Lg.sort(bl),1<Pg.length&&Pg.sort(Tl)}}},bg[Mg]=Ag),Ag},dispose:function dispose(){bg={}}}}function Ml(Eg,bg){return Math.abs(bg[1])-Math.abs(Eg[1])}function Al(){var Eg=new function(){var Ag={};return{get:function get(wg){if(void 0!==Ag[wg.id])return Ag[wg.id];var Rg;switch(wg.type){case'DirectionalLight':Rg={direction:new Wo,color:new Ps,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Go};break;case'SpotLight':Rg={position:new Wo,direction:new Wo,color:new Ps,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Go};break;case'PointLight':Rg={position:new Wo,color:new Ps,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Go,shadowCameraNear:1,shadowCameraFar:1e3};break;case'HemisphereLight':Rg={direction:new Wo,skyColor:new Ps,groundColor:new Ps};break;case'RectAreaLight':Rg={color:new Ps,position:new Wo,halfWidth:new Wo,halfHeight:new Wo};}return Ag[wg.id]=Rg,Rg}}},bg={hash:'',ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},Tg=new Wo,Sg=new Ho,Mg=new Ho;return{setup:function setup(Ag,wg,Rg){for(var Lg=0,Pg=0,Cg=0,Ig=0,Ug=0,Dg=0,Ng=0,Bg=0,Fg=Rg.matrixWorldInverse,zg=0,Gg=Ag.length;zg<Gg;zg++){var Hg=Ag[zg],Og=Hg.color,Vg=Hg.intensity,Wg=Hg.distance,kg=Hg.shadow&&Hg.shadow.map?Hg.shadow.map.texture:null;if(Hg.isAmbientLight)Lg+=Og.r*Vg,Pg+=Og.g*Vg,Cg+=Og.b*Vg;else if(Hg.isDirectionalLight)(jg=Eg.get(Hg)).color.copy(Hg.color).multiplyScalar(Hg.intensity),jg.direction.setFromMatrixPosition(Hg.matrixWorld),Tg.setFromMatrixPosition(Hg.target.matrixWorld),jg.direction.sub(Tg),jg.direction.transformDirection(Fg),jg.shadow=Hg.castShadow,Hg.castShadow&&(Xg=Hg.shadow,jg.shadowBias=Xg.bias,jg.shadowRadius=Xg.radius,jg.shadowMapSize=Xg.mapSize),bg.directionalShadowMap[Ig]=kg,bg.directionalShadowMatrix[Ig]=Hg.shadow.matrix,bg.directional[Ig]=jg,Ig++;else if(Hg.isSpotLight)(jg=Eg.get(Hg)).position.setFromMatrixPosition(Hg.matrixWorld),jg.position.applyMatrix4(Fg),jg.color.copy(Og).multiplyScalar(Vg),jg.distance=Wg,jg.direction.setFromMatrixPosition(Hg.matrixWorld),Tg.setFromMatrixPosition(Hg.target.matrixWorld),jg.direction.sub(Tg),jg.direction.transformDirection(Fg),jg.coneCos=Math.cos(Hg.angle),jg.penumbraCos=Math.cos(Hg.angle*(1-Hg.penumbra)),jg.decay=0===Hg.distance?0:Hg.decay,jg.shadow=Hg.castShadow,Hg.castShadow&&(Xg=Hg.shadow,jg.shadowBias=Xg.bias,jg.shadowRadius=Xg.radius,jg.shadowMapSize=Xg.mapSize),bg.spotShadowMap[Dg]=kg,bg.spotShadowMatrix[Dg]=Hg.shadow.matrix,bg.spot[Dg]=jg,Dg++;else if(Hg.isRectAreaLight)(jg=Eg.get(Hg)).color.copy(Og).multiplyScalar(Vg/(Hg.width*Hg.height)),jg.position.setFromMatrixPosition(Hg.matrixWorld),jg.position.applyMatrix4(Fg),Mg.identity(),Sg.copy(Hg.matrixWorld),Sg.premultiply(Fg),Mg.extractRotation(Sg),jg.halfWidth.set(.5*Hg.width,0,0),jg.halfHeight.set(0,.5*Hg.height,0),jg.halfWidth.applyMatrix4(Mg),jg.halfHeight.applyMatrix4(Mg),bg.rectArea[Ng]=jg,Ng++;else if(Hg.isPointLight){if((jg=Eg.get(Hg)).position.setFromMatrixPosition(Hg.matrixWorld),jg.position.applyMatrix4(Fg),jg.color.copy(Hg.color).multiplyScalar(Hg.intensity),jg.distance=Hg.distance,jg.decay=0===Hg.distance?0:Hg.decay,jg.shadow=Hg.castShadow,Hg.castShadow){var Xg=Hg.shadow;jg.shadowBias=Xg.bias,jg.shadowRadius=Xg.radius,jg.shadowMapSize=Xg.mapSize,jg.shadowCameraNear=Xg.camera.near,jg.shadowCameraFar=Xg.camera.far}bg.pointShadowMap[Ug]=kg,bg.pointShadowMatrix[Ug]=Hg.shadow.matrix,bg.point[Ug]=jg,Ug++}else if(Hg.isHemisphereLight){var jg=Eg.get(Hg);jg.direction.setFromMatrixPosition(Hg.matrixWorld),jg.direction.transformDirection(Fg),jg.direction.normalize(),jg.skyColor.copy(Hg.color).multiplyScalar(Vg),jg.groundColor.copy(Hg.groundColor).multiplyScalar(Vg),bg.hemi[Bg]=jg,Bg++}}bg.ambient[0]=Lg,bg.ambient[1]=Pg,bg.ambient[2]=Cg,bg.directional.length=Ig,bg.spot.length=Dg,bg.rectArea.length=Ng,bg.point.length=Ug,bg.hemi.length=Bg,bg.hash=Ig+','+Ug+','+Dg+','+Ng+','+Bg+','+wg.length},state:bg}}function wl(Eg,bg,Tg){var Sg=Eg.createShader(bg);return Eg.shaderSource(Sg,Tg),Eg.compileShader(Sg),!1===Eg.getShaderParameter(Sg,Eg.COMPILE_STATUS)&&console.error('THREE.WebGLShader: Shader couldn\'t compile.'),''!==Eg.getShaderInfoLog(Sg)&&console.warn('THREE.WebGLShader: gl.getShaderInfoLog()',bg===Eg.VERTEX_SHADER?'vertex':'fragment',Eg.getShaderInfoLog(Sg),function(Mg){for(var Ag=Mg.split('\n'),wg=0;wg<Ag.length;wg++)Ag[wg]=wg+1+': '+Ag[wg];return Ag.join('\n')}(Tg)),Sg}function Rl(Eg){switch(Eg){case Tu:return['Linear','( value )'];case Su:return['sRGB','( value )'];case Au:return['RGBE','( value )'];case wu:return['RGBM','( value, 7.0 )'];case Ru:return['RGBM','( value, 16.0 )'];case Lu:return['RGBD','( value, 256.0 )'];case Mu:return['Gamma','( value, float( GAMMA_FACTOR ) )'];default:throw new Error('unsupported encoding: '+Eg);}}function Ll(Eg,bg){var Tg=Rl(bg);return'vec4 '+Eg+'( vec4 value ) { return '+Tg[0]+'ToLinear'+Tg[1]+'; }'}function Pl(Eg){return''!==Eg}function Cl(Eg,bg){return Eg.replace(/NUM_DIR_LIGHTS/g,bg.numDirLights).replace(/NUM_SPOT_LIGHTS/g,bg.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,bg.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,bg.numPointLights).replace(/NUM_HEMI_LIGHTS/g,bg.numHemiLights)}function Il(Eg){return Eg.replace(/^[ \t]*#include +<([\w\d.]+)>/gm,function(bg,Tg){var Sg=ku[Tg];if(void 0===Sg)throw new Error('Can not resolve #include <'+Tg+'>');return Il(Sg)})}function Ul(Eg){return Eg.replace(/for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,function(bg,Tg,Sg,Mg){for(var Ag='',wg=parseInt(Tg);wg<parseInt(Sg);wg++)Ag+=Mg.replace(/\[ i \]/g,'[ '+wg+' ]');return Ag})}function Dl(Eg,bg,Tg,Sg,Mg,Ag){var wg=Eg.context,Rg=Sg.defines,Lg=Mg.vertexShader,Pg=Mg.fragmentShader,Cg='SHADOWMAP_TYPE_BASIC';Ag.shadowMapType===Nc?Cg='SHADOWMAP_TYPE_PCF':Ag.shadowMapType===Bc&&(Cg='SHADOWMAP_TYPE_PCF_SOFT');var Ig='ENVMAP_TYPE_CUBE',Ug='ENVMAP_MODE_REFLECTION',Dg='ENVMAP_BLENDING_MULTIPLY';if(Ag.envMap){switch(Sg.envMap.mapping){case wm:case Rm:Ig='ENVMAP_TYPE_CUBE';break;case Im:case Um:Ig='ENVMAP_TYPE_CUBE_UV';break;case Lm:case Pm:Ig='ENVMAP_TYPE_EQUIREC';break;case Cm:Ig='ENVMAP_TYPE_SPHERE';}switch(Sg.envMap.mapping){case Rm:case Pm:Ug='ENVMAP_MODE_REFRACTION';}switch(Sg.combine){case vm:Dg='ENVMAP_BLENDING_MULTIPLY';break;case _m:Dg='ENVMAP_BLENDING_MIX';break;case Em:Dg='ENVMAP_BLENDING_ADD';}}var Fg=0<Eg.gammaFactor?Eg.gammaFactor:1,zg=function(Kg,$g,ef){return[(Kg=Kg||{}).derivatives||$g.envMapCubeUV||$g.bumpMap||$g.normalMap||$g.flatShading?'#extension GL_OES_standard_derivatives : enable':'',(Kg.fragDepth||$g.logarithmicDepthBuffer)&&ef.get('EXT_frag_depth')?'#extension GL_EXT_frag_depth : enable':'',Kg.drawBuffers&&ef.get('WEBGL_draw_buffers')?'#extension GL_EXT_draw_buffers : require':'',(Kg.shaderTextureLOD||$g.envMap)&&ef.get('EXT_shader_texture_lod')?'#extension GL_EXT_shader_texture_lod : enable':''].filter(Pl).join('\n')}(Sg.extensions,Ag,bg),Gg=function(Kg){var $g=[];for(var ef in Kg){var tf=Kg[ef];!1!==tf&&$g.push('#define '+ef+' '+tf)}return $g.join('\n')}(Rg),Hg=wg.createProgram(),Ng,Bg;Sg.isRawShaderMaterial?(0<(Ng=[Gg].filter(Pl).join('\n')).length&&(Ng+='\n'),0<(Bg=[zg,Gg].filter(Pl).join('\n')).length&&(Bg+='\n')):(Ng=['precision '+Ag.precision+' float;','precision '+Ag.precision+' int;','#define SHADER_NAME '+Mg.name,Gg,Ag.supportsVertexTextures?'#define VERTEX_TEXTURES':'','#define GAMMA_FACTOR '+Fg,'#define MAX_BONES '+Ag.maxBones,Ag.useFog&&Ag.fog?'#define USE_FOG':'',Ag.useFog&&Ag.fogExp?'#define FOG_EXP2':'',Ag.map?'#define USE_MAP':'',Ag.envMap?'#define USE_ENVMAP':'',Ag.envMap?'#define '+Ug:'',Ag.lightMap?'#define USE_LIGHTMAP':'',Ag.aoMap?'#define USE_AOMAP':'',Ag.emissiveMap?'#define USE_EMISSIVEMAP':'',Ag.bumpMap?'#define USE_BUMPMAP':'',Ag.normalMap?'#define USE_NORMALMAP':'',Ag.displacementMap&&Ag.supportsVertexTextures?'#define USE_DISPLACEMENTMAP':'',Ag.specularMap?'#define USE_SPECULARMAP':'',Ag.roughnessMap?'#define USE_ROUGHNESSMAP':'',Ag.metalnessMap?'#define USE_METALNESSMAP':'',Ag.alphaMap?'#define USE_ALPHAMAP':'',Ag.vertexColors?'#define USE_COLOR':'',Ag.flatShading?'#define FLAT_SHADED':'',Ag.skinning?'#define USE_SKINNING':'',Ag.useVertexTexture?'#define BONE_TEXTURE':'',Ag.morphTargets?'#define USE_MORPHTARGETS':'',Ag.morphNormals&&!1===Ag.flatShading?'#define USE_MORPHNORMALS':'',Ag.doubleSided?'#define DOUBLE_SIDED':'',Ag.flipSided?'#define FLIP_SIDED':'','#define NUM_CLIPPING_PLANES '+Ag.numClippingPlanes,Ag.shadowMapEnabled?'#define USE_SHADOWMAP':'',Ag.shadowMapEnabled?'#define '+Cg:'',Ag.sizeAttenuation?'#define USE_SIZEATTENUATION':'',Ag.logarithmicDepthBuffer?'#define USE_LOGDEPTHBUF':'',Ag.logarithmicDepthBuffer&&bg.get('EXT_frag_depth')?'#define USE_LOGDEPTHBUF_EXT':'','uniform mat4 modelMatrix;','uniform mat4 modelViewMatrix;','uniform mat4 projectionMatrix;','uniform mat4 viewMatrix;','uniform mat3 normalMatrix;','uniform vec3 cameraPosition;','attribute vec3 position;','attribute vec3 normal;','attribute vec2 uv;','#ifdef USE_COLOR','\tattribute vec3 color;','#endif','#ifdef USE_MORPHTARGETS','\tattribute vec3 morphTarget0;','\tattribute vec3 morphTarget1;','\tattribute vec3 morphTarget2;','\tattribute vec3 morphTarget3;','\t#ifdef USE_MORPHNORMALS','\t\tattribute vec3 morphNormal0;','\t\tattribute vec3 morphNormal1;','\t\tattribute vec3 morphNormal2;','\t\tattribute vec3 morphNormal3;','\t#else','\t\tattribute vec3 morphTarget4;','\t\tattribute vec3 morphTarget5;','\t\tattribute vec3 morphTarget6;','\t\tattribute vec3 morphTarget7;','\t#endif','#endif','#ifdef USE_SKINNING','\tattribute vec4 skinIndex;','\tattribute vec4 skinWeight;','#endif','\n'].filter(Pl).join('\n'),Bg=[zg,'precision '+Ag.precision+' float;','precision '+Ag.precision+' int;','#define SHADER_NAME '+Mg.name,Gg,Ag.alphaTest?'#define ALPHATEST '+Ag.alphaTest:'','#define GAMMA_FACTOR '+Fg,Ag.useFog&&Ag.fog?'#define USE_FOG':'',Ag.useFog&&Ag.fogExp?'#define FOG_EXP2':'',Ag.map?'#define USE_MAP':'',Ag.envMap?'#define USE_ENVMAP':'',Ag.envMap?'#define '+Ig:'',Ag.envMap?'#define '+Ug:'',Ag.envMap?'#define '+Dg:'',Ag.lightMap?'#define USE_LIGHTMAP':'',Ag.aoMap?'#define USE_AOMAP':'',Ag.emissiveMap?'#define USE_EMISSIVEMAP':'',Ag.bumpMap?'#define USE_BUMPMAP':'',Ag.normalMap?'#define USE_NORMALMAP':'',Ag.specularMap?'#define USE_SPECULARMAP':'',Ag.roughnessMap?'#define USE_ROUGHNESSMAP':'',Ag.metalnessMap?'#define USE_METALNESSMAP':'',Ag.alphaMap?'#define USE_ALPHAMAP':'',Ag.vertexColors?'#define USE_COLOR':'',Ag.gradientMap?'#define USE_GRADIENTMAP':'',Ag.flatShading?'#define FLAT_SHADED':'',Ag.doubleSided?'#define DOUBLE_SIDED':'',Ag.flipSided?'#define FLIP_SIDED':'','#define NUM_CLIPPING_PLANES '+Ag.numClippingPlanes,'#define UNION_CLIPPING_PLANES '+(Ag.numClippingPlanes-Ag.numClipIntersection),Ag.shadowMapEnabled?'#define USE_SHADOWMAP':'',Ag.shadowMapEnabled?'#define '+Cg:'',Ag.premultipliedAlpha?'#define PREMULTIPLIED_ALPHA':'',Ag.physicallyCorrectLights?'#define PHYSICALLY_CORRECT_LIGHTS':'',Ag.logarithmicDepthBuffer?'#define USE_LOGDEPTHBUF':'',Ag.logarithmicDepthBuffer&&bg.get('EXT_frag_depth')?'#define USE_LOGDEPTHBUF_EXT':'',Ag.envMap&&bg.get('EXT_shader_texture_lod')?'#define TEXTURE_LOD_EXT':'','uniform mat4 viewMatrix;','uniform vec3 cameraPosition;',Ag.toneMapping===bm?'':'#define TONE_MAPPING',Ag.toneMapping===bm?'':ku.tonemapping_pars_fragment,Ag.toneMapping===bm?'':function(Kg,$g){var ef;switch($g){case Tm:ef='Linear';break;case Sm:ef='Reinhard';break;case Mm:ef='Uncharted2';break;case Am:ef='OptimizedCineon';break;default:throw new Error('unsupported toneMapping: '+$g);}return'vec3 '+Kg+'( vec3 color ) { return '+ef+'ToneMapping( color ); }'}('toneMapping',Ag.toneMapping),Ag.dithering?'#define DITHERING':'',Ag.outputEncoding||Ag.mapEncoding||Ag.envMapEncoding||Ag.emissiveMapEncoding?ku.encodings_pars_fragment:'',Ag.mapEncoding?Ll('mapTexelToLinear',Ag.mapEncoding):'',Ag.envMapEncoding?Ll('envMapTexelToLinear',Ag.envMapEncoding):'',Ag.emissiveMapEncoding?Ll('emissiveMapTexelToLinear',Ag.emissiveMapEncoding):'',Ag.outputEncoding?function(Kg,$g){var ef=Rl($g);return'vec4 '+Kg+'( vec4 value ) { return LinearTo'+ef[0]+ef[1]+'; }'}('linearToOutputTexel',Ag.outputEncoding):'',Ag.depthPacking?'#define DEPTH_PACKING '+Sg.depthPacking:'','\n'].filter(Pl).join('\n')),Lg=Cl(Lg=Il(Lg),Ag),Pg=Cl(Pg=Il(Pg),Ag),Sg.isShaderMaterial||(Lg=Ul(Lg),Pg=Ul(Pg));var Og=Ng+Lg,Vg=Bg+Pg,Wg=wl(wg,wg.VERTEX_SHADER,Og),kg=wl(wg,wg.FRAGMENT_SHADER,Vg);wg.attachShader(Hg,Wg),wg.attachShader(Hg,kg),void 0===Sg.index0AttributeName?!0===Ag.morphTargets&&wg.bindAttribLocation(Hg,0,'position'):wg.bindAttribLocation(Hg,0,Sg.index0AttributeName),wg.linkProgram(Hg);var Xg=wg.getProgramInfoLog(Hg),jg=wg.getShaderInfoLog(Wg),Yg=wg.getShaderInfoLog(kg),qg=!0,Zg=!0;!1===wg.getProgramParameter(Hg,wg.LINK_STATUS)?(qg=!1,console.error('THREE.WebGLProgram: shader error: ',wg.getError(),'gl.VALIDATE_STATUS',wg.getProgramParameter(Hg,wg.VALIDATE_STATUS),'gl.getProgramInfoLog',Xg,jg,Yg)):''===Xg?''!==jg&&''!==Yg||(Zg=!1):console.warn('THREE.WebGLProgram: gl.getProgramInfoLog()',Xg),Zg&&(this.diagnostics={runnable:qg,material:Sg,programLog:Xg,vertexShader:{log:jg,prefix:Ng},fragmentShader:{log:Yg,prefix:Bg}}),wg.deleteShader(Wg),wg.deleteShader(kg);var Jg;this.getUniforms=function(){return void 0==Jg&&(Jg=new Ls(wg,Hg,Eg)),Jg};var Qg;return this.getAttributes=function(){return void 0==Qg&&(Qg=function(Kg,$g){for(var ef={},tf=Kg.getProgramParameter($g,Kg.ACTIVE_ATTRIBUTES),rf=0,af;rf<tf;rf++)af=Kg.getActiveAttrib($g,rf).name,ef[af]=Kg.getAttribLocation($g,af);return ef}(wg,Hg)),Qg},this.destroy=function(){wg.deleteProgram(Hg),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function get(){return console.warn('THREE.WebGLProgram: .uniforms is now .getUniforms().'),this.getUniforms()}},attributes:{get:function get(){return console.warn('THREE.WebGLProgram: .attributes is now .getAttributes().'),this.getAttributes()}}}),this.id=Ju++,this.code=Tg,this.usedTimes=1,this.program=Hg,this.vertexShader=Wg,this.fragmentShader=kg,this}function Nl(Eg,bg,Tg){function Sg(Rg,Lg){var Pg;return Rg?Rg.isTexture?Pg=Rg.encoding:Rg.isWebGLRenderTarget&&(console.warn('THREE.WebGLPrograms.getTextureEncodingFromMap: don\'t use render targets as textures. Use their .texture property instead.'),Pg=Rg.texture.encoding):Pg=Tu,Pg===Tu&&Lg&&(Pg=Mu),Pg}var Mg=[],Ag={MeshDepthMaterial:'depth',MeshDistanceMaterial:'distanceRGBA',MeshNormalMaterial:'normal',MeshBasicMaterial:'basic',MeshLambertMaterial:'lambert',MeshPhongMaterial:'phong',MeshToonMaterial:'phong',MeshStandardMaterial:'physical',MeshPhysicalMaterial:'physical',LineBasicMaterial:'basic',LineDashedMaterial:'dashed',PointsMaterial:'points',ShadowMaterial:'shadow'},wg=['precision','supportsVertexTextures','map','mapEncoding','envMap','envMapMode','envMapEncoding','lightMap','aoMap','emissiveMap','emissiveMapEncoding','bumpMap','normalMap','displacementMap','specularMap','roughnessMap','metalnessMap','gradientMap','alphaMap','combine','vertexColors','fog','useFog','fogExp','flatShading','sizeAttenuation','logarithmicDepthBuffer','skinning','maxBones','useVertexTexture','morphTargets','morphNormals','maxMorphTargets','maxMorphNormals','premultipliedAlpha','numDirLights','numPointLights','numSpotLights','numHemiLights','numRectAreaLights','shadowMapEnabled','shadowMapType','toneMapping','physicallyCorrectLights','alphaTest','doubleSided','flipSided','numClippingPlanes','numClipIntersection','depthPacking','dithering'];this.getParameters=function(Rg,Lg,Pg,Cg,Ig,Ug,Dg){var Ng=Ag[Rg.type],Bg=Dg.isSkinnedMesh?function(Gg){var Hg=Gg.skeleton.bones;if(Tg.floatVertexTextures)return 1024;var Og=Tg.maxVertexUniforms,Vg=Math.floor((Og-20)/4),Wg=Math.min(Vg,Hg.length);return Wg<Hg.length?(console.warn('THREE.WebGLRenderer: Skeleton has '+Hg.length+' bones. This GPU supports '+Wg+'.'),0):Wg}(Dg):0,Fg=Tg.precision;null!==Rg.precision&&(Fg=Tg.getMaxPrecision(Rg.precision))!==Rg.precision&&console.warn('THREE.WebGLProgram.getParameters:',Rg.precision,'not supported, using',Fg,'instead.');var zg=Eg.getRenderTarget();return{shaderID:Ng,precision:Fg,supportsVertexTextures:Tg.vertexTextures,outputEncoding:Sg(zg?zg.texture:null,Eg.gammaOutput),map:!!Rg.map,mapEncoding:Sg(Rg.map,Eg.gammaInput),envMap:!!Rg.envMap,envMapMode:Rg.envMap&&Rg.envMap.mapping,envMapEncoding:Sg(Rg.envMap,Eg.gammaInput),envMapCubeUV:!!Rg.envMap&&(Rg.envMap.mapping===Im||Rg.envMap.mapping===Um),lightMap:!!Rg.lightMap,aoMap:!!Rg.aoMap,emissiveMap:!!Rg.emissiveMap,emissiveMapEncoding:Sg(Rg.emissiveMap,Eg.gammaInput),bumpMap:!!Rg.bumpMap,normalMap:!!Rg.normalMap,displacementMap:!!Rg.displacementMap,roughnessMap:!!Rg.roughnessMap,metalnessMap:!!Rg.metalnessMap,specularMap:!!Rg.specularMap,alphaMap:!!Rg.alphaMap,gradientMap:!!Rg.gradientMap,combine:Rg.combine,vertexColors:Rg.vertexColors,fog:!!Cg,useFog:Rg.fog,fogExp:Cg&&Cg.isFogExp2,flatShading:Rg.flatShading,sizeAttenuation:Rg.sizeAttenuation,logarithmicDepthBuffer:Tg.logarithmicDepthBuffer,skinning:Rg.skinning&&0<Bg,maxBones:Bg,useVertexTexture:Tg.floatVertexTextures,morphTargets:Rg.morphTargets,morphNormals:Rg.morphNormals,maxMorphTargets:Eg.maxMorphTargets,maxMorphNormals:Eg.maxMorphNormals,numDirLights:Lg.directional.length,numPointLights:Lg.point.length,numSpotLights:Lg.spot.length,numRectAreaLights:Lg.rectArea.length,numHemiLights:Lg.hemi.length,numClippingPlanes:Ig,numClipIntersection:Ug,dithering:Rg.dithering,shadowMapEnabled:Eg.shadowMap.enabled&&Dg.receiveShadow&&0<Pg.length,shadowMapType:Eg.shadowMap.type,toneMapping:Eg.toneMapping,physicallyCorrectLights:Eg.physicallyCorrectLights,premultipliedAlpha:Rg.premultipliedAlpha,alphaTest:Rg.alphaTest,doubleSided:Rg.side===Gc,flipSided:Rg.side===zc,depthPacking:void 0!==Rg.depthPacking&&Rg.depthPacking}},this.getProgramCode=function(Rg,Lg){var Pg=[];if(Lg.shaderID?Pg.push(Lg.shaderID):(Pg.push(Rg.fragmentShader),Pg.push(Rg.vertexShader)),void 0!==Rg.defines)for(var Cg in Rg.defines)Pg.push(Cg),Pg.push(Rg.defines[Cg]);for(var Ig=0;Ig<wg.length;Ig++)Pg.push(Lg[wg[Ig]]);return Pg.push(Rg.onBeforeCompile.toString()),Pg.push(Eg.gammaOutput),Pg.join()},this.acquireProgram=function(Rg,Lg,Pg,Cg){for(var Ug=0,Dg=Mg.length,Ig,Ng;Ug<Dg;Ug++)if(Ng=Mg[Ug],Ng.code===Cg){++(Ig=Ng).usedTimes;break}return void 0===Ig&&(Ig=new Dl(Eg,bg,Cg,Rg,Lg,Pg),Mg.push(Ig)),Ig},this.releaseProgram=function(Rg){if(0==--Rg.usedTimes){var Lg=Mg.indexOf(Rg);Mg[Lg]=Mg[Mg.length-1],Mg.pop(),Rg.destroy()}},this.programs=Mg}function Bl(Eg,bg,Tg,Sg,Mg,Ag,wg){function Rg(Hg,Og){if(Hg.width>Og||Hg.height>Og){var Vg=Og/Math.max(Hg.width,Hg.height),Wg=document.createElement('canvas');return Wg.width=Math.floor(Hg.width*Vg),Wg.height=Math.floor(Hg.height*Vg),(Wg.getContext('2d').drawImage(Hg,0,0,Hg.width,Hg.height,0,0,Wg.width,Wg.height),console.warn('THREE.WebGLRenderer: image is too big ('+Hg.width+'x'+Hg.height+'). Resized to '+Wg.width+'x'+Wg.height,Hg),Wg)}return Hg}function Lg(Hg){return Iu.isPowerOfTwo(Hg.width)&&Iu.isPowerOfTwo(Hg.height)}function Pg(Hg,Og){return Hg.generateMipmaps&&Og&&Hg.minFilter!==Fm&&Hg.minFilter!==Hm}function Cg(Hg){return Hg===Fm||Hg===zm||Hg===Gm?Eg.NEAREST:Eg.LINEAR}function Ig(Hg){var Og=Hg.target;Og.removeEventListener('dispose',Ig),function(Vg){var Wg=Sg.get(Vg);if(Vg.image&&Wg.__image__webglTextureCube)Eg.deleteTexture(Wg.__image__webglTextureCube);else{if(void 0===Wg.__webglInit)return;Eg.deleteTexture(Wg.__webglTexture)}Sg.remove(Vg)}(Og),wg.textures--}function Ug(Hg){var Og=Hg.target;Og.removeEventListener('dispose',Ug),function(Vg){var Wg=Sg.get(Vg),kg=Sg.get(Vg.texture);if(Vg){if(void 0!==kg.__webglTexture&&Eg.deleteTexture(kg.__webglTexture),Vg.depthTexture&&Vg.depthTexture.dispose(),Vg.isWebGLRenderTargetCube)for(var Xg=0;6>Xg;Xg++)Eg.deleteFramebuffer(Wg.__webglFramebuffer[Xg]),Wg.__webglDepthbuffer&&Eg.deleteRenderbuffer(Wg.__webglDepthbuffer[Xg]);else Eg.deleteFramebuffer(Wg.__webglFramebuffer),Wg.__webglDepthbuffer&&Eg.deleteRenderbuffer(Wg.__webglDepthbuffer);Sg.remove(Vg.texture),Sg.remove(Vg)}}(Og),wg.textures--}function Dg(Hg,Og){var Vg=Sg.get(Hg);if(0<Hg.version&&Vg.__version!==Hg.version){var Wg=Hg.image;if(void 0===Wg)console.warn('THREE.WebGLRenderer: Texture marked for update but image is undefined',Hg);else{if(!1!==Wg.complete)return void function(kg,Xg,jg){void 0===kg.__webglInit&&(kg.__webglInit=!0,Xg.addEventListener('dispose',Ig),kg.__webglTexture=Eg.createTexture(),wg.textures++),Tg.activeTexture(Eg.TEXTURE0+jg),Tg.bindTexture(Eg.TEXTURE_2D,kg.__webglTexture),Eg.pixelStorei(Eg.UNPACK_FLIP_Y_WEBGL,Xg.flipY),Eg.pixelStorei(Eg.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Xg.premultiplyAlpha),Eg.pixelStorei(Eg.UNPACK_ALIGNMENT,Xg.unpackAlignment);var Yg=Rg(Xg.image,Mg.maxTextureSize);(function(rf){return rf.wrapS!==Nm||rf.wrapT!==Nm||rf.minFilter!==Fm&&rf.minFilter!==Hm})(Xg)&&!1===Lg(Yg)&&(Yg=function(rf){if(rf instanceof HTMLImageElement||rf instanceof HTMLCanvasElement){var af=document.createElement('canvas');return af.width=Iu.floorPowerOfTwo(rf.width),af.height=Iu.floorPowerOfTwo(rf.height),af.getContext('2d').drawImage(rf,0,0,af.width,af.height),console.warn('THREE.WebGLRenderer: image is not power of two ('+rf.width+'x'+rf.height+'). Resized to '+af.width+'x'+af.height,rf),af}return rf}(Yg));var qg=Lg(Yg),Zg=Ag.convert(Xg.format),Jg=Ag.convert(Xg.type);Ng(Eg.TEXTURE_2D,Xg,qg);var Kg=Xg.mipmaps,Qg;if(Xg.isDepthTexture){var $g=Eg.DEPTH_COMPONENT;if(Xg.type===Zm){if(!Gg)throw new Error('Float Depth Texture only supported in WebGL2.0');$g=Eg.DEPTH_COMPONENT32F}else Gg&&($g=Eg.DEPTH_COMPONENT16);Xg.format===su&&$g===Eg.DEPTH_COMPONENT&&Xg.type!==jm&&Xg.type!==qm&&(console.warn('THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture.'),Xg.type=jm,Jg=Ag.convert(Xg.type)),Xg.format===lu&&($g=Eg.DEPTH_STENCIL,Xg.type!==eu&&(console.warn('THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture.'),Xg.type=eu,Jg=Ag.convert(Xg.type))),Tg.texImage2D(Eg.TEXTURE_2D,0,$g,Yg.width,Yg.height,0,Zg,Jg,null)}else if(Xg.isDataTexture){if(0<Kg.length&&qg){for(var ef=0,tf=Kg.length;ef<tf;ef++)Qg=Kg[ef],Tg.texImage2D(Eg.TEXTURE_2D,ef,Zg,Qg.width,Qg.height,0,Zg,Jg,Qg.data);Xg.generateMipmaps=!1}else Tg.texImage2D(Eg.TEXTURE_2D,0,Zg,Yg.width,Yg.height,0,Zg,Jg,Yg.data);}else if(Xg.isCompressedTexture)for(var ef=0,tf=Kg.length;ef<tf;ef++)Qg=Kg[ef],Xg.format!==au&&Xg.format!==ru?-1<Tg.getCompressedTextureFormats().indexOf(Zg)?Tg.compressedTexImage2D(Eg.TEXTURE_2D,ef,Zg,Qg.width,Qg.height,0,Qg.data):console.warn('THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()'):Tg.texImage2D(Eg.TEXTURE_2D,ef,Zg,Qg.width,Qg.height,0,Zg,Jg,Qg.data);else if(0<Kg.length&&qg){for(var ef=0,tf=Kg.length;ef<tf;ef++)Qg=Kg[ef],Tg.texImage2D(Eg.TEXTURE_2D,ef,Zg,Zg,Jg,Qg);Xg.generateMipmaps=!1}else Tg.texImage2D(Eg.TEXTURE_2D,0,Zg,Zg,Jg,Yg);Pg(Xg,qg)&&Eg.generateMipmap(Eg.TEXTURE_2D),kg.__version=Xg.version,Xg.onUpdate&&Xg.onUpdate(Xg)}(Vg,Hg,Og);console.warn('THREE.WebGLRenderer: Texture marked for update but image is incomplete',Hg)}}Tg.activeTexture(Eg.TEXTURE0+Og),Tg.bindTexture(Eg.TEXTURE_2D,Vg.__webglTexture)}function Ng(Hg,Og,Vg){var Wg;if(Vg?(Eg.texParameteri(Hg,Eg.TEXTURE_WRAP_S,Ag.convert(Og.wrapS)),Eg.texParameteri(Hg,Eg.TEXTURE_WRAP_T,Ag.convert(Og.wrapT)),Eg.texParameteri(Hg,Eg.TEXTURE_MAG_FILTER,Ag.convert(Og.magFilter)),Eg.texParameteri(Hg,Eg.TEXTURE_MIN_FILTER,Ag.convert(Og.minFilter))):(Eg.texParameteri(Hg,Eg.TEXTURE_WRAP_S,Eg.CLAMP_TO_EDGE),Eg.texParameteri(Hg,Eg.TEXTURE_WRAP_T,Eg.CLAMP_TO_EDGE),Og.wrapS===Nm&&Og.wrapT===Nm||console.warn('THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.',Og),Eg.texParameteri(Hg,Eg.TEXTURE_MAG_FILTER,Cg(Og.magFilter)),Eg.texParameteri(Hg,Eg.TEXTURE_MIN_FILTER,Cg(Og.minFilter)),Og.minFilter!==Fm&&Og.minFilter!==Hm&&(Og.minFilter=Hm),Og.minFilter!==Fm&&Og.minFilter!==Hm&&console.warn('THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.',Og)),Wg=bg.get('EXT_texture_filter_anisotropic')){if(Og.type===Zm&&null===bg.get('OES_texture_float_linear'))return;if(Og.type===Jm&&null===bg.get('OES_texture_half_float_linear'))return;(1<Og.anisotropy||Sg.get(Og).__currentAnisotropy)&&(Eg.texParameterf(Hg,Wg.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(Og.anisotropy,Mg.getMaxAnisotropy())),Sg.get(Og).__currentAnisotropy=Og.anisotropy)}}function Bg(Hg,Og,Vg,Wg){var kg=Ag.convert(Og.texture.format),Xg=Ag.convert(Og.texture.type);Tg.texImage2D(Wg,0,kg,Og.width,Og.height,0,kg,Xg,null),Eg.bindFramebuffer(Eg.FRAMEBUFFER,Hg),Eg.framebufferTexture2D(Eg.FRAMEBUFFER,Vg,Wg,Sg.get(Og.texture).__webglTexture,0),Eg.bindFramebuffer(Eg.FRAMEBUFFER,null)}function Fg(Hg,Og){Eg.bindRenderbuffer(Eg.RENDERBUFFER,Hg),Og.depthBuffer&&!Og.stencilBuffer?(Eg.renderbufferStorage(Eg.RENDERBUFFER,Eg.DEPTH_COMPONENT16,Og.width,Og.height),Eg.framebufferRenderbuffer(Eg.FRAMEBUFFER,Eg.DEPTH_ATTACHMENT,Eg.RENDERBUFFER,Hg)):Og.depthBuffer&&Og.stencilBuffer?(Eg.renderbufferStorage(Eg.RENDERBUFFER,Eg.DEPTH_STENCIL,Og.width,Og.height),Eg.framebufferRenderbuffer(Eg.FRAMEBUFFER,Eg.DEPTH_STENCIL_ATTACHMENT,Eg.RENDERBUFFER,Hg)):Eg.renderbufferStorage(Eg.RENDERBUFFER,Eg.RGBA4,Og.width,Og.height),Eg.bindRenderbuffer(Eg.RENDERBUFFER,null)}function zg(Hg){var Og=Sg.get(Hg),Vg=!0===Hg.isWebGLRenderTargetCube;if(Hg.depthTexture){if(Vg)throw new Error('target.depthTexture not supported in Cube render targets');!function(kg,Xg){if(Xg&&Xg.isWebGLRenderTargetCube)throw new Error('Depth Texture with cube render targets is not supported');if(Eg.bindFramebuffer(Eg.FRAMEBUFFER,kg),!Xg.depthTexture||!Xg.depthTexture.isDepthTexture)throw new Error('renderTarget.depthTexture must be an instance of THREE.DepthTexture');Sg.get(Xg.depthTexture).__webglTexture&&Xg.depthTexture.image.width===Xg.width&&Xg.depthTexture.image.height===Xg.height||(Xg.depthTexture.image.width=Xg.width,Xg.depthTexture.image.height=Xg.height,Xg.depthTexture.needsUpdate=!0),Dg(Xg.depthTexture,0);var jg=Sg.get(Xg.depthTexture).__webglTexture;if(Xg.depthTexture.format===su)Eg.framebufferTexture2D(Eg.FRAMEBUFFER,Eg.DEPTH_ATTACHMENT,Eg.TEXTURE_2D,jg,0);else{if(Xg.depthTexture.format!==lu)throw new Error('Unknown depthTexture format');Eg.framebufferTexture2D(Eg.FRAMEBUFFER,Eg.DEPTH_STENCIL_ATTACHMENT,Eg.TEXTURE_2D,jg,0)}}(Og.__webglFramebuffer,Hg)}else if(Vg){Og.__webglDepthbuffer=[];for(var Wg=0;6>Wg;Wg++)Eg.bindFramebuffer(Eg.FRAMEBUFFER,Og.__webglFramebuffer[Wg]),Og.__webglDepthbuffer[Wg]=Eg.createRenderbuffer(),Fg(Og.__webglDepthbuffer[Wg],Hg)}else Eg.bindFramebuffer(Eg.FRAMEBUFFER,Og.__webglFramebuffer),Og.__webglDepthbuffer=Eg.createRenderbuffer(),Fg(Og.__webglDepthbuffer,Hg);Eg.bindFramebuffer(Eg.FRAMEBUFFER,null)}var Gg='undefined'!=typeof WebGL2RenderingContext&&Eg instanceof window.WebGL2RenderingContext;this.setTexture2D=Dg,this.setTextureCube=function(Hg,Og){var Vg=Sg.get(Hg);if(6===Hg.image.length)if(0<Hg.version&&Vg.__version!==Hg.version){Vg.__image__webglTextureCube||(Hg.addEventListener('dispose',Ig),Vg.__image__webglTextureCube=Eg.createTexture(),wg.textures++),Tg.activeTexture(Eg.TEXTURE0+Og),Tg.bindTexture(Eg.TEXTURE_CUBE_MAP,Vg.__image__webglTextureCube),Eg.pixelStorei(Eg.UNPACK_FLIP_Y_WEBGL,Hg.flipY);for(var Wg=Hg&&Hg.isCompressedTexture,kg=Hg.image[0]&&Hg.image[0].isDataTexture,Xg=[],jg=0;6>jg;jg++)Xg[jg]=Wg||kg?kg?Hg.image[jg].image:Hg.image[jg]:Rg(Hg.image[jg],Mg.maxCubemapSize);var Yg=Lg(Xg[0]),qg=Ag.convert(Hg.format),Zg=Ag.convert(Hg.type);for(Ng(Eg.TEXTURE_CUBE_MAP,Hg,Yg),jg=0;6>jg;jg++)if(Wg)for(var Qg=Xg[jg].mipmaps,Kg=0,$g=Qg.length,Jg;Kg<$g;Kg++)Jg=Qg[Kg],Hg.format!==au&&Hg.format!==ru?-1<Tg.getCompressedTextureFormats().indexOf(qg)?Tg.compressedTexImage2D(Eg.TEXTURE_CUBE_MAP_POSITIVE_X+jg,Kg,qg,Jg.width,Jg.height,0,Jg.data):console.warn('THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()'):Tg.texImage2D(Eg.TEXTURE_CUBE_MAP_POSITIVE_X+jg,Kg,qg,Jg.width,Jg.height,0,qg,Zg,Jg.data);else kg?Tg.texImage2D(Eg.TEXTURE_CUBE_MAP_POSITIVE_X+jg,0,qg,Xg[jg].width,Xg[jg].height,0,qg,Zg,Xg[jg].data):Tg.texImage2D(Eg.TEXTURE_CUBE_MAP_POSITIVE_X+jg,0,qg,qg,Zg,Xg[jg]);Pg(Hg,Yg)&&Eg.generateMipmap(Eg.TEXTURE_CUBE_MAP),Vg.__version=Hg.version,Hg.onUpdate&&Hg.onUpdate(Hg)}else Tg.activeTexture(Eg.TEXTURE0+Og),Tg.bindTexture(Eg.TEXTURE_CUBE_MAP,Vg.__image__webglTextureCube)},this.setTextureCubeDynamic=function(Hg,Og){Tg.activeTexture(Eg.TEXTURE0+Og),Tg.bindTexture(Eg.TEXTURE_CUBE_MAP,Sg.get(Hg).__webglTexture)},this.setupRenderTarget=function(Hg){var Og=Sg.get(Hg),Vg=Sg.get(Hg.texture);Hg.addEventListener('dispose',Ug),Vg.__webglTexture=Eg.createTexture(),wg.textures++;var Wg=!0===Hg.isWebGLRenderTargetCube,kg=Lg(Hg);if(Wg)for(Og.__webglFramebuffer=[],Xg=0;6>Xg;Xg++)Og.__webglFramebuffer[Xg]=Eg.createFramebuffer();else Og.__webglFramebuffer=Eg.createFramebuffer();if(Wg){Tg.bindTexture(Eg.TEXTURE_CUBE_MAP,Vg.__webglTexture),Ng(Eg.TEXTURE_CUBE_MAP,Hg.texture,kg);for(var Xg=0;6>Xg;Xg++)Bg(Og.__webglFramebuffer[Xg],Hg,Eg.COLOR_ATTACHMENT0,Eg.TEXTURE_CUBE_MAP_POSITIVE_X+Xg);Pg(Hg.texture,kg)&&Eg.generateMipmap(Eg.TEXTURE_CUBE_MAP),Tg.bindTexture(Eg.TEXTURE_CUBE_MAP,null)}else Tg.bindTexture(Eg.TEXTURE_2D,Vg.__webglTexture),Ng(Eg.TEXTURE_2D,Hg.texture,kg),Bg(Og.__webglFramebuffer,Hg,Eg.COLOR_ATTACHMENT0,Eg.TEXTURE_2D),Pg(Hg.texture,kg)&&Eg.generateMipmap(Eg.TEXTURE_2D),Tg.bindTexture(Eg.TEXTURE_2D,null);Hg.depthBuffer&&zg(Hg)},this.updateRenderTargetMipmap=function(Hg){var Og=Hg.texture;if(Pg(Og,Lg(Hg))){var Vg=Hg.isWebGLRenderTargetCube?Eg.TEXTURE_CUBE_MAP:Eg.TEXTURE_2D,Wg=Sg.get(Og).__webglTexture;Tg.bindTexture(Vg,Wg),Eg.generateMipmap(Vg),Tg.bindTexture(Vg,null)}}}function Fl(Eg,bg,Tg,Sg){Ys.call(this),this.type='PerspectiveCamera',this.fov=void 0===Eg?50:Eg,this.zoom=1,this.near=void 0===Tg?.1:Tg,this.far=void 0===Sg?2e3:Sg,this.focus=10,this.aspect=void 0===bg?1:bg,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function zl(Eg){Fl.call(this),this.cameras=Eg||[]}function Gl(Eg,bg){return{convert:function convert(Tg){var Sg;if(Tg===Dm)return Eg.REPEAT;if(Tg===Nm)return Eg.CLAMP_TO_EDGE;if(Tg===Bm)return Eg.MIRRORED_REPEAT;if(Tg===Fm)return Eg.NEAREST;if(Tg===zm)return Eg.NEAREST_MIPMAP_NEAREST;if(Tg===Gm)return Eg.NEAREST_MIPMAP_LINEAR;if(Tg===Hm)return Eg.LINEAR;if(Tg===Om)return Eg.LINEAR_MIPMAP_NEAREST;if(Tg===Vm)return Eg.LINEAR_MIPMAP_LINEAR;if(Tg===Wm)return Eg.UNSIGNED_BYTE;if(Tg===Qm)return Eg.UNSIGNED_SHORT_4_4_4_4;if(Tg===Km)return Eg.UNSIGNED_SHORT_5_5_5_1;if(Tg===$m)return Eg.UNSIGNED_SHORT_5_6_5;if(Tg===km)return Eg.BYTE;if(Tg===Xm)return Eg.SHORT;if(Tg===jm)return Eg.UNSIGNED_SHORT;if(Tg===Ym)return Eg.INT;if(Tg===qm)return Eg.UNSIGNED_INT;if(Tg===Zm)return Eg.FLOAT;if(Tg===Jm&&null!==(Sg=bg.get('OES_texture_half_float')))return Sg.HALF_FLOAT_OES;if(Tg===tu)return Eg.ALPHA;if(Tg===ru)return Eg.RGB;if(Tg===au)return Eg.RGBA;if(Tg===iu)return Eg.LUMINANCE;if(Tg===ou)return Eg.LUMINANCE_ALPHA;if(Tg===su)return Eg.DEPTH_COMPONENT;if(Tg===lu)return Eg.DEPTH_STENCIL;if(Tg===Zc)return Eg.FUNC_ADD;if(Tg===Jc)return Eg.FUNC_SUBTRACT;if(Tg===Qc)return Eg.FUNC_REVERSE_SUBTRACT;if(Tg===em)return Eg.ZERO;if(Tg===tm)return Eg.ONE;if(Tg===rm)return Eg.SRC_COLOR;if(Tg===am)return Eg.ONE_MINUS_SRC_COLOR;if(Tg===im)return Eg.SRC_ALPHA;if(Tg===om)return Eg.ONE_MINUS_SRC_ALPHA;if(Tg===nm)return Eg.DST_ALPHA;if(Tg===sm)return Eg.ONE_MINUS_DST_ALPHA;if(Tg===lm)return Eg.DST_COLOR;if(Tg===dm)return Eg.ONE_MINUS_DST_COLOR;if(Tg===pm)return Eg.SRC_ALPHA_SATURATE;if((Tg===du||Tg===pu||Tg===cu||Tg===mu)&&null!==(Sg=bg.get('WEBGL_compressed_texture_s3tc'))){if(Tg===du)return Sg.COMPRESSED_RGB_S3TC_DXT1_EXT;if(Tg===pu)return Sg.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(Tg===cu)return Sg.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(Tg===mu)return Sg.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((Tg===uu||Tg===gu||Tg===fu||Tg===hu)&&null!==(Sg=bg.get('WEBGL_compressed_texture_pvrtc'))){if(Tg===uu)return Sg.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(Tg===gu)return Sg.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(Tg===fu)return Sg.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(Tg===hu)return Sg.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(Tg===yu&&null!==(Sg=bg.get('WEBGL_compressed_texture_etc1')))return Sg.COMPRESSED_RGB_ETC1_WEBGL;if((Tg===Kc||Tg===$c)&&null!==(Sg=bg.get('EXT_blend_minmax'))){if(Tg===Kc)return Sg.MIN_EXT;if(Tg===$c)return Sg.MAX_EXT}return Tg===eu&&null!==(Sg=bg.get('WEBGL_depth_texture'))?Sg.UNSIGNED_INT_24_8_WEBGL:0}}}function Hl(Eg){function bg(){return null===Kg?cf:1}function Tg(){(Mf=new function(Yf){var qf={};return{get:function get(Zf){if(void 0!==qf[Zf])return qf[Zf];var Jf;return Jf='WEBGL_depth_texture'===Zf?Yf.getExtension('WEBGL_depth_texture')||Yf.getExtension('MOZ_WEBGL_depth_texture')||Yf.getExtension('WEBKIT_WEBGL_depth_texture'):'EXT_texture_filter_anisotropic'===Zf?Yf.getExtension('EXT_texture_filter_anisotropic')||Yf.getExtension('MOZ_EXT_texture_filter_anisotropic')||Yf.getExtension('WEBKIT_EXT_texture_filter_anisotropic'):'WEBGL_compressed_texture_s3tc'===Zf?Yf.getExtension('WEBGL_compressed_texture_s3tc')||Yf.getExtension('MOZ_WEBGL_compressed_texture_s3tc')||Yf.getExtension('WEBKIT_WEBGL_compressed_texture_s3tc'):'WEBGL_compressed_texture_pvrtc'===Zf?Yf.getExtension('WEBGL_compressed_texture_pvrtc')||Yf.getExtension('WEBKIT_WEBGL_compressed_texture_pvrtc'):'WEBGL_compressed_texture_etc1'===Zf?Yf.getExtension('WEBGL_compressed_texture_etc1'):Yf.getExtension(Zf),null===Jf&&console.warn('THREE.WebGLRenderer: '+Zf+' extension not supported.'),qf[Zf]=Jf,Jf}}}(Tf)).get('WEBGL_depth_texture'),Mf.get('OES_texture_float'),Mf.get('OES_texture_float_linear'),Mf.get('OES_texture_half_float'),Mf.get('OES_texture_half_float_linear'),Mf.get('OES_standard_derivatives'),Mf.get('OES_element_index_uint'),Mf.get('ANGLE_instanced_arrays'),Vf=new Gl(Tf,Mf),Af=new function(Yf,qf,Zf){function Jf(ch){if('highp'===ch){if(0<Yf.getShaderPrecisionFormat(Yf.VERTEX_SHADER,Yf.HIGH_FLOAT).precision&&0<Yf.getShaderPrecisionFormat(Yf.FRAGMENT_SHADER,Yf.HIGH_FLOAT).precision)return'highp';ch='mediump'}return'mediump'===ch&&0<Yf.getShaderPrecisionFormat(Yf.VERTEX_SHADER,Yf.MEDIUM_FLOAT).precision&&0<Yf.getShaderPrecisionFormat(Yf.FRAGMENT_SHADER,Yf.MEDIUM_FLOAT).precision?'mediump':'lowp'}var Kf=void 0===Zf.precision?'highp':Zf.precision,$f=Jf(Kf),Qf;$f!==Kf&&(console.warn('THREE.WebGLRenderer:',Kf,'not supported, using',$f,'instead.'),Kf=$f);var eh=!0===Zf.logarithmicDepthBuffer,th=Yf.getParameter(Yf.MAX_TEXTURE_IMAGE_UNITS),rh=Yf.getParameter(Yf.MAX_VERTEX_TEXTURE_IMAGE_UNITS),ah=Yf.getParameter(Yf.MAX_TEXTURE_SIZE),ih=Yf.getParameter(Yf.MAX_CUBE_MAP_TEXTURE_SIZE),oh=Yf.getParameter(Yf.MAX_VERTEX_ATTRIBS),nh=Yf.getParameter(Yf.MAX_VERTEX_UNIFORM_VECTORS),sh=Yf.getParameter(Yf.MAX_VARYING_VECTORS),lh=Yf.getParameter(Yf.MAX_FRAGMENT_UNIFORM_VECTORS),dh=0<rh,ph=!!qf.get('OES_texture_float');return{getMaxAnisotropy:function getMaxAnisotropy(){if(void 0!=Qf)return Qf;var ch=qf.get('EXT_texture_filter_anisotropic');return Qf=null===ch?0:Yf.getParameter(ch.MAX_TEXTURE_MAX_ANISOTROPY_EXT)},getMaxPrecision:Jf,precision:Kf,logarithmicDepthBuffer:eh,maxTextures:th,maxVertexTextures:rh,maxTextureSize:ah,maxCubemapSize:ih,maxAttributes:oh,maxVertexUniforms:nh,maxVaryings:sh,maxFragmentUniforms:lh,vertexTextures:dh,floatFragmentTextures:ph,floatVertexTextures:dh&&ph}}(Tf,Mf,Eg),(wf=new function(Yf,qf,Zf){function Jf(Dh,Nh,Bh){var Fh=new Uint8Array(4),zh=Yf.createTexture();Yf.bindTexture(Dh,zh),Yf.texParameteri(Dh,Yf.TEXTURE_MIN_FILTER,Yf.NEAREST),Yf.texParameteri(Dh,Yf.TEXTURE_MAG_FILTER,Yf.NEAREST);for(var Gh=0;Gh<Bh;Gh++)Yf.texImage2D(Nh+Gh,0,Yf.RGBA,1,1,0,Yf.RGBA,Yf.UNSIGNED_BYTE,Fh);return zh}function Qf(Dh){!0!==ch[Dh]&&(Yf.enable(Dh),ch[Dh]=!0)}function Kf(Dh){!1!==ch[Dh]&&(Yf.disable(Dh),ch[Dh]=!1)}function $f(Dh,Nh,Bh,Fh,zh,Gh,Hh,Oh){(Dh===Wc?Kf(Yf.BLEND):Qf(Yf.BLEND),Dh!==qc)?((Dh!==gh||Oh!==Eh)&&(Dh===Xc?Oh?(Yf.blendEquationSeparate(Yf.FUNC_ADD,Yf.FUNC_ADD),Yf.blendFuncSeparate(Yf.ONE,Yf.ONE,Yf.ONE,Yf.ONE)):(Yf.blendEquation(Yf.FUNC_ADD),Yf.blendFunc(Yf.SRC_ALPHA,Yf.ONE)):Dh===jc?Oh?(Yf.blendEquationSeparate(Yf.FUNC_ADD,Yf.FUNC_ADD),Yf.blendFuncSeparate(Yf.ZERO,Yf.ZERO,Yf.ONE_MINUS_SRC_COLOR,Yf.ONE_MINUS_SRC_ALPHA)):(Yf.blendEquation(Yf.FUNC_ADD),Yf.blendFunc(Yf.ZERO,Yf.ONE_MINUS_SRC_COLOR)):Dh===Yc?Oh?(Yf.blendEquationSeparate(Yf.FUNC_ADD,Yf.FUNC_ADD),Yf.blendFuncSeparate(Yf.ZERO,Yf.SRC_COLOR,Yf.ZERO,Yf.SRC_ALPHA)):(Yf.blendEquation(Yf.FUNC_ADD),Yf.blendFunc(Yf.ZERO,Yf.SRC_COLOR)):Oh?(Yf.blendEquationSeparate(Yf.FUNC_ADD,Yf.FUNC_ADD),Yf.blendFuncSeparate(Yf.ONE,Yf.ONE_MINUS_SRC_ALPHA,Yf.ONE,Yf.ONE_MINUS_SRC_ALPHA)):(Yf.blendEquationSeparate(Yf.FUNC_ADD,Yf.FUNC_ADD),Yf.blendFuncSeparate(Yf.SRC_ALPHA,Yf.ONE_MINUS_SRC_ALPHA,Yf.ONE,Yf.ONE_MINUS_SRC_ALPHA))),fh=null,hh=null,yh=null,xh=null,vh=null,_h=null):(zh=zh||Nh,Gh=Gh||Bh,Hh=Hh||Fh,Nh===fh&&zh===xh||(Yf.blendEquationSeparate(Zf.convert(Nh),Zf.convert(zh)),fh=Nh,xh=zh),Bh===hh&&Fh===yh&&Gh===vh&&Hh===_h||(Yf.blendFuncSeparate(Zf.convert(Bh),Zf.convert(Fh),Zf.convert(Gh),Zf.convert(Hh)),hh=Bh,yh=Fh,vh=Gh,_h=Hh));gh=Dh,Eh=Oh}function eh(Dh){bh!==Dh&&(Dh?Yf.frontFace(Yf.CW):Yf.frontFace(Yf.CCW),bh=Dh)}function th(Dh){Dh===Cc?Kf(Yf.CULL_FACE):(Qf(Yf.CULL_FACE),Dh!==Th&&(Dh===Ic?Yf.cullFace(Yf.BACK):Dh===Uc?Yf.cullFace(Yf.FRONT):Yf.cullFace(Yf.FRONT_AND_BACK))),Th=Dh}function rh(Dh,Nh,Bh){Dh?(Qf(Yf.POLYGON_OFFSET_FILL),Mh===Nh&&Ah===Bh||(Yf.polygonOffset(Nh,Bh),Mh=Nh,Ah=Bh)):Kf(Yf.POLYGON_OFFSET_FILL)}function ah(Dh){void 0===Dh&&(Dh=Yf.TEXTURE0+wh-1),Lh!==Dh&&(Yf.activeTexture(Dh),Lh=Dh)}var ih=new function(){var Dh=!1,Nh=new Yo,Bh=null,Fh=new Yo(0,0,0,0);return{setMask:function setMask(zh){Bh===zh||Dh||(Yf.colorMask(zh,zh,zh,zh),Bh=zh)},setLocked:function setLocked(zh){Dh=zh},setClear:function setClear(zh,Gh,Hh,Oh,Vh){!0===Vh&&(zh*=Oh,Gh*=Oh,Hh*=Oh),Nh.set(zh,Gh,Hh,Oh),!1===Fh.equals(Nh)&&(Yf.clearColor(zh,Gh,Hh,Oh),Fh.copy(Nh))},reset:function reset(){Dh=!1,Bh=null,Fh.set(-1,0,0,0)}}},oh=new function(){var Dh=!1,Nh=null,Bh=null,Fh=null;return{setTest:function setTest(zh){zh?Qf(Yf.DEPTH_TEST):Kf(Yf.DEPTH_TEST)},setMask:function setMask(zh){Nh===zh||Dh||(Yf.depthMask(zh),Nh=zh)},setFunc:function setFunc(zh){Bh!==zh&&(zh?zh===cm?Yf.depthFunc(Yf.NEVER):zh===mm?Yf.depthFunc(Yf.ALWAYS):zh===um?Yf.depthFunc(Yf.LESS):zh===gm?Yf.depthFunc(Yf.LEQUAL):zh===fm?Yf.depthFunc(Yf.EQUAL):zh===hm?Yf.depthFunc(Yf.GEQUAL):zh===ym?Yf.depthFunc(Yf.GREATER):zh===xm?Yf.depthFunc(Yf.NOTEQUAL):Yf.depthFunc(Yf.LEQUAL):Yf.depthFunc(Yf.LEQUAL),Bh=zh)},setLocked:function setLocked(zh){Dh=zh},setClear:function setClear(zh){Fh!==zh&&(Yf.clearDepth(zh),Fh=zh)},reset:function reset(){Dh=!1,Nh=null,Bh=null,Fh=null}}},nh=new function(){var Dh=!1,Nh=null,Bh=null,Fh=null,zh=null,Gh=null,Hh=null,Oh=null,Vh=null;return{setTest:function setTest(Wh){Wh?Qf(Yf.STENCIL_TEST):Kf(Yf.STENCIL_TEST)},setMask:function setMask(Wh){Nh===Wh||Dh||(Yf.stencilMask(Wh),Nh=Wh)},setFunc:function setFunc(Wh,kh,Xh){Bh===Wh&&Fh===kh&&zh===Xh||(Yf.stencilFunc(Wh,kh,Xh),Bh=Wh,Fh=kh,zh=Xh)},setOp:function setOp(Wh,kh,Xh){Gh===Wh&&Hh===kh&&Oh===Xh||(Yf.stencilOp(Wh,kh,Xh),Gh=Wh,Hh=kh,Oh=Xh)},setLocked:function setLocked(Wh){Dh=Wh},setClear:function setClear(Wh){Vh!==Wh&&(Yf.clearStencil(Wh),Vh=Wh)},reset:function reset(){Dh=!1,Nh=null,Bh=null,Fh=null,zh=null,Gh=null,Hh=null,Oh=null,Vh=null}}},sh=Yf.getParameter(Yf.MAX_VERTEX_ATTRIBS),lh=new Uint8Array(sh),dh=new Uint8Array(sh),ph=new Uint8Array(sh),ch={},mh=null,uh=null,gh=null,fh=null,hh=null,yh=null,xh=null,vh=null,_h=null,Eh=!1,bh=null,Th=null,Sh=null,Mh=null,Ah=null,wh=Yf.getParameter(Yf.MAX_COMBINED_TEXTURE_IMAGE_UNITS),Lh=null,Ph={},Ch=new Yo,Ih=new Yo,Uh={};return Uh[Yf.TEXTURE_2D]=Jf(Yf.TEXTURE_2D,Yf.TEXTURE_2D,1),Uh[Yf.TEXTURE_CUBE_MAP]=Jf(Yf.TEXTURE_CUBE_MAP,Yf.TEXTURE_CUBE_MAP_POSITIVE_X,6),ih.setClear(0,0,0,1),oh.setClear(1),nh.setClear(0),Qf(Yf.DEPTH_TEST),oh.setFunc(gm),eh(!1),th(Ic),Qf(Yf.CULL_FACE),Qf(Yf.BLEND),$f(kc),{buffers:{color:ih,depth:oh,stencil:nh},initAttributes:function initAttributes(){for(var Dh=0,Nh=lh.length;Dh<Nh;Dh++)lh[Dh]=0},enableAttribute:function enableAttribute(Dh){lh[Dh]=1,0===dh[Dh]&&(Yf.enableVertexAttribArray(Dh),dh[Dh]=1),0!==ph[Dh]&&(qf.get('ANGLE_instanced_arrays').vertexAttribDivisorANGLE(Dh,0),ph[Dh]=0)},enableAttributeAndDivisor:function enableAttributeAndDivisor(Dh,Nh){lh[Dh]=1,0===dh[Dh]&&(Yf.enableVertexAttribArray(Dh),dh[Dh]=1),ph[Dh]!==Nh&&(qf.get('ANGLE_instanced_arrays').vertexAttribDivisorANGLE(Dh,Nh),ph[Dh]=Nh)},disableUnusedAttributes:function disableUnusedAttributes(){for(var Dh=0,Nh=dh.length;Dh!==Nh;++Dh)dh[Dh]!==lh[Dh]&&(Yf.disableVertexAttribArray(Dh),dh[Dh]=0)},enable:Qf,disable:Kf,getCompressedTextureFormats:function getCompressedTextureFormats(){if(null===mh&&(mh=[],qf.get('WEBGL_compressed_texture_pvrtc')||qf.get('WEBGL_compressed_texture_s3tc')||qf.get('WEBGL_compressed_texture_etc1')))for(var Dh=Yf.getParameter(Yf.COMPRESSED_TEXTURE_FORMATS),Nh=0;Nh<Dh.length;Nh++)mh.push(Dh[Nh]);return mh},useProgram:function useProgram(Dh){return uh!==Dh&&(Yf.useProgram(Dh),uh=Dh,!0)},setBlending:$f,setMaterial:function setMaterial(Dh){Dh.side===Gc?Kf(Yf.CULL_FACE):Qf(Yf.CULL_FACE),eh(Dh.side===zc),!0===Dh.transparent?$f(Dh.blending,Dh.blendEquation,Dh.blendSrc,Dh.blendDst,Dh.blendEquationAlpha,Dh.blendSrcAlpha,Dh.blendDstAlpha,Dh.premultipliedAlpha):$f(Wc),oh.setFunc(Dh.depthFunc),oh.setTest(Dh.depthTest),oh.setMask(Dh.depthWrite),ih.setMask(Dh.colorWrite),rh(Dh.polygonOffset,Dh.polygonOffsetFactor,Dh.polygonOffsetUnits)},setFlipSided:eh,setCullFace:th,setLineWidth:function setLineWidth(Dh){Dh!==Sh&&(Yf.lineWidth(Dh),Sh=Dh)},setPolygonOffset:rh,setScissorTest:function setScissorTest(Dh){Dh?Qf(Yf.SCISSOR_TEST):Kf(Yf.SCISSOR_TEST)},activeTexture:ah,bindTexture:function bindTexture(Dh,Nh){null===Lh&&ah();var Bh=Ph[Lh];void 0===Bh&&(Bh={type:void 0,texture:void 0},Ph[Lh]=Bh),Bh.type===Dh&&Bh.texture===Nh||(Yf.bindTexture(Dh,Nh||Uh[Dh]),Bh.type=Dh,Bh.texture=Nh)},compressedTexImage2D:function compressedTexImage2D(){try{Yf.compressedTexImage2D.apply(Yf,arguments)}catch(Dh){console.error('THREE.WebGLState:',Dh)}},texImage2D:function texImage2D(){try{Yf.texImage2D.apply(Yf,arguments)}catch(Dh){console.error('THREE.WebGLState:',Dh)}},scissor:function scissor(Dh){!1===Ch.equals(Dh)&&(Yf.scissor(Dh.x,Dh.y,Dh.z,Dh.w),Ch.copy(Dh))},viewport:function viewport(Dh){!1===Ih.equals(Dh)&&(Yf.viewport(Dh.x,Dh.y,Dh.z,Dh.w),Ih.copy(Dh))},reset:function reset(){for(var Dh=0;Dh<dh.length;Dh++)1===dh[Dh]&&(Yf.disableVertexAttribArray(Dh),dh[Dh]=0);ch={},mh=null,Lh=null,Ph={},uh=null,gh=null,bh=null,Th=null,ih.reset(),oh.reset(),nh.reset()}}}(Tf,Mf,Vf)).scissor(nf.copy(uf).multiplyScalar(cf)),wf.viewport(of.copy(mf).multiplyScalar(cf)),Rf=new function(){var Yf={};return{get:function get(qf){var Zf=qf.uuid,Jf=Yf[Zf];return void 0===Jf&&(Jf={},Yf[Zf]=Jf),Jf},remove:function remove(qf){delete Yf[qf.uuid]},clear:function clear(){Yf={}}}},Lf=new Bl(Tf,Mf,wf,Rf,Af,Vf,Ef),Pf=new Ws(Tf),Cf=new function(Yf,qf,Zf){function Jf($f){var eh=$f.target,th=Qf[eh.id];for(var rh in null!==th.index&&qf.remove(th.index),th.attributes)qf.remove(th.attributes[rh]);eh.removeEventListener('dispose',Jf),delete Qf[eh.id];var ah=Kf[eh.id];ah&&(qf.remove(ah),delete Kf[eh.id]),(ah=Kf[th.id])&&(qf.remove(ah),delete Kf[th.id]),Zf.geometries--}var Qf={},Kf={};return{get:function get($f,eh){var th=Qf[eh.id];return th||(eh.addEventListener('dispose',Jf),eh.isBufferGeometry?th=eh:eh.isGeometry&&(void 0===eh._bufferGeometry&&(eh._bufferGeometry=new dl().setFromObject($f)),th=eh._bufferGeometry),Qf[eh.id]=th,Zf.geometries++,th)},update:function update($f){var eh=$f.index,th=$f.attributes;for(var rh in null!==eh&&qf.update(eh,Yf.ELEMENT_ARRAY_BUFFER),th)qf.update(th[rh],Yf.ARRAY_BUFFER);var ah=$f.morphAttributes;for(var rh in ah)for(var ih=ah[rh],oh=0,nh=ih.length;oh<nh;oh++)qf.update(ih[oh],Yf.ARRAY_BUFFER)},getWireframeAttribute:function getWireframeAttribute($f){var eh=Kf[$f.id];if(eh)return eh;var th=[],rh=$f.index,ah=$f.attributes;if(null!==rh)for(var ih=0,oh=(dh=rh.array).length;ih<oh;ih+=3){var nh=dh[ih+0],sh=dh[ih+1],lh=dh[ih+2];th.push(nh,sh,sh,lh,lh,nh)}else for(var dh=ah.position.array,ih=0,oh=dh.length/3-1;ih<oh;ih+=3){var nh=ih+0,sh=ih+1,lh=ih+2;th.push(nh,sh,sh,lh,lh,nh)}return eh=new(65535<ll(th)?il:rl)(th,1),qf.update(eh,Yf.ELEMENT_ARRAY_BUFFER),Kf[$f.id]=eh,eh}}}(Tf,Pf,Ef),If=new function(Yf,qf){var Zf={};return{update:function update(Jf){var Qf=qf.frame,Kf=Jf.geometry,$f=Yf.get(Jf,Kf);return Zf[$f.id]!==Qf&&(Kf.isGeometry&&$f.updateFromObject(Jf),Yf.update($f),Zf[$f.id]=Qf),$f},clear:function clear(){Zf={}}}}(Cf,bf),Ff=new function(Yf){var qf={},Zf=new Float32Array(8);return{update:function update(Jf,Qf,Kf,$f){var eh=Jf.morphTargetInfluences,th=eh.length,rh=qf[Qf.id];if(void 0===rh){for(rh=[],oh=0;oh<th;oh++)rh[oh]=[oh,0];qf[Qf.id]=rh}for(var ah=Kf.morphTargets&&Qf.morphAttributes.position,ih=Kf.morphNormals&&Qf.morphAttributes.normal,oh=0;oh<th;oh++)0!==(nh=rh[oh])[1]&&(ah&&Qf.removeAttribute('morphTarget'+oh),ih&&Qf.removeAttribute('morphNormal'+oh));for(oh=0;oh<th;oh++)(nh=rh[oh])[0]=oh,nh[1]=eh[oh];for(rh.sort(Ml),oh=0;8>oh;oh++){var nh=rh[oh];if(nh){var sh=nh[0],lh=nh[1];if(lh){ah&&Qf.addAttribute('morphTarget'+oh,ah[sh]),ih&&Qf.addAttribute('morphNormal'+oh,ih[sh]),Zf[oh]=lh;continue}}Zf[oh]=0}$f.getUniforms().setValue(Yf,'morphTargetInfluences',Zf)}}}(Tf),Df=new Nl(Jg,Mf,Af),Uf=new Al,Nf=new Sl,Bf=new function(Yf,qf,Zf,Jf){function Qf(ah,ih){qf.buffers.color.setClear(ah.r,ah.g,ah.b,ih,Jf)}var th=new Ps(0),rh=0,Kf,$f,eh;return{getClearColor:function getClearColor(){return th},setClearColor:function setClearColor(ah,ih){th.set(ah),Qf(th,rh=void 0===ih?1:ih)},getClearAlpha:function getClearAlpha(){return rh},setClearAlpha:function setClearAlpha(ah){Qf(th,rh=ah)},render:function render(ah,ih,oh,nh){var sh=ih.background;null===sh?Qf(th,rh):sh&&sh.isColor&&(Qf(sh,1),nh=!0),(Yf.autoClear||nh)&&Yf.clear(Yf.autoClearColor,Yf.autoClearDepth,Yf.autoClearStencil),sh&&sh.isCubeTexture?(void 0===eh&&((eh=new El(new ul(1,1,1),new yl({uniforms:Xu.cube.uniforms,vertexShader:Xu.cube.vertexShader,fragmentShader:Xu.cube.fragmentShader,side:zc,depthTest:!0,depthWrite:!1,fog:!1}))).geometry.removeAttribute('normal'),eh.geometry.removeAttribute('uv'),eh.onBeforeRender=function(lh,dh,ph){this.matrixWorld.copyPosition(ph.matrixWorld)},Zf.update(eh.geometry)),eh.material.uniforms.tCube.value=sh,ah.push(eh,eh.geometry,eh.material,0,null)):sh&&sh.isTexture&&(void 0===Kf&&(Kf=new qs(-1,1,1,-1,0,1),$f=new El(new fl(2,2),new hl({depthTest:!1,depthWrite:!1,fog:!1})),Zf.update($f.geometry)),$f.material.map=sh,Yf.renderBufferDirect(Kf,null,$f.geometry,$f.material,$f,null))}}}(Jg,wf,Cf,Wg),zf=new function(Yf,qf,Zf){var Jf;this.setMode=function(Qf){Jf=Qf},this.render=function(Qf,Kf){Yf.drawArrays(Jf,Qf,Kf),Zf.calls++,Zf.vertices+=Kf,Jf===Yf.TRIANGLES?Zf.faces+=Kf/3:Jf===Yf.POINTS&&(Zf.points+=Kf)},this.renderInstances=function(Qf,Kf,$f){var eh=qf.get('ANGLE_instanced_arrays');if(null!==eh){var th=Qf.attributes.position;th.isInterleavedBufferAttribute?($f=th.data.count,eh.drawArraysInstancedANGLE(Jf,0,$f,Qf.maxInstancedCount)):eh.drawArraysInstancedANGLE(Jf,Kf,$f,Qf.maxInstancedCount),Zf.calls++,Zf.vertices+=$f*Qf.maxInstancedCount,Jf===Yf.TRIANGLES?Zf.faces+=Qf.maxInstancedCount*$f/3:Jf===Yf.POINTS&&(Zf.points+=Qf.maxInstancedCount*$f)}else console.error('THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.')}}(Tf,Mf,bf),Gf=new function(Yf,qf,Zf){var Jf,Qf,Kf;this.setMode=function($f){Jf=$f},this.setIndex=function($f){Qf=$f.type,Kf=$f.bytesPerElement},this.render=function($f,eh){Yf.drawElements(Jf,eh,Qf,$f*Kf),Zf.calls++,Zf.vertices+=eh,Jf===Yf.TRIANGLES?Zf.faces+=eh/3:Jf===Yf.POINTS&&(Zf.points+=eh)},this.renderInstances=function($f,eh,th){var rh=qf.get('ANGLE_instanced_arrays');null===rh?console.error('THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.'):(rh.drawElementsInstancedANGLE(Jf,th,Qf,eh*Kf,$f.maxInstancedCount),Zf.calls++,Zf.vertices+=th*$f.maxInstancedCount,Jf===Yf.TRIANGLES?Zf.faces+=$f.maxInstancedCount*th/3:Jf===Yf.POINTS&&(Zf.points+=$f.maxInstancedCount*th))}}(Tf,Mf,bf),Hf=new Is(Jg,Tf,wf,Lf,Af),Of=new Ds(Jg,Tf,wf,Lf,Af),Jg.info.programs=Df.programs,Jg.context=Tf,Jg.capabilities=Af,Jg.extensions=Mf,Jg.properties=Rf,Jg.renderLists=Nf,Jg.state=wf}function Sg(Yf){Yf.preventDefault(),console.log('THREE.WebGLRenderer: Context Lost.'),Qg=!0}function Mg(){console.log('THREE.WebGLRenderer: Context Restored.'),Qg=!1,Tg()}function Ag(Yf){var qf=Yf.target;qf.removeEventListener('dispose',Ag),function(Zf){wg(Zf),Rf.remove(Zf)}(qf)}function wg(Yf){var qf=Rf.get(Yf).program;Yf.program=void 0,void 0!==qf&&Df.releaseProgram(qf)}function Rg(Yf){null!==jf&&jf(Yf),(Wf.getDevice()||window).requestAnimationFrame(Rg)}function Lg(Yf,qf,Zf){if(!1!==Yf.visible){if(Yf.layers.test(qf.layers))if(Yf.isLight)Xg.push(Yf),Yf.castShadow&&jg.push(Yf);else if(Yf.isSprite)Yf.frustumCulled&&!ff.intersectsSprite(Yf)||qg.push(Yf);else if(Yf.isLensFlare)Zg.push(Yf);else if(Yf.isImmediateRenderObject)Zf&&_f.setFromMatrixPosition(Yf.matrixWorld).applyMatrix4(vf),Yg.push(Yf,null,Yf.material,_f.z,null);else if((Yf.isMesh||Yf.isLine||Yf.isPoints)&&(Yf.isSkinnedMesh&&Yf.skeleton.update(),!Yf.frustumCulled||ff.intersectsObject(Yf))){Zf&&_f.setFromMatrixPosition(Yf.matrixWorld).applyMatrix4(vf);var Jf=If.update(Yf),Qf=Yf.material;if(Array.isArray(Qf))for(var Kf=Jf.groups,$f=0,eh=Kf.length;$f<eh;$f++){var th=Kf[$f],rh=Qf[th.materialIndex];rh&&rh.visible&&Yg.push(Yf,Jf,rh,_f.z,th)}else Qf.visible&&Yg.push(Yf,Jf,Qf,_f.z,null)}for(var ah=Yf.children,$f=0,eh=ah.length;$f<eh;$f++)Lg(ah[$f],qf,Zf)}}function Pg(Yf,qf,Zf,Jf){for(var Qf=0,Kf=Yf.length;Qf<Kf;Qf++){var $f=Yf[Qf],eh=$f.object,th=$f.geometry,rh=void 0===Jf?$f.material:Jf,ah=$f.group;if(Zf.isArrayCamera){af=Zf;for(var ih=Zf.cameras,oh=0,nh=ih.length,sh;oh<nh;oh++)if(sh=ih[oh],eh.layers.test(sh.layers)){var lh=sh.bounds,dh=lh.x*df,ph=lh.y*pf,ch=lh.z*df,mh=lh.w*pf;wf.viewport(of.set(dh,ph,ch,mh).multiplyScalar(cf)),Cg(eh,qf,sh,th,rh,ah)}}else af=null,Cg(eh,qf,Zf,th,rh,ah)}}function Cg(Yf,qf,Zf,Jf,Qf,Kf){if(Yf.onBeforeRender(Jg,qf,Zf,Jf,Qf,Kf),Yf.modelViewMatrix.multiplyMatrices(Zf.matrixWorldInverse,Yf.matrixWorld),Yf.normalMatrix.getNormalMatrix(Yf.modelViewMatrix),Yf.isImmediateRenderObject){wf.setMaterial(Qf);var $f=Ug(Zf,qf.fog,Qf,Yf);tf='',function(eh,th,rh){eh.render(function(ah){Jg.renderBufferImmediate(ah,th,rh)})}(Yf,$f,Qf)}else Jg.renderBufferDirect(Zf,qf.fog,Jf,Qf,Yf,Kf);Yf.onAfterRender(Jg,qf,Zf,Jf,Qf,Kf)}function Ig(Yf,qf,Zf){var Jf=Rf.get(Yf),Qf=Df.getParameters(Yf,Uf.state,jg,qf,hf.numPlanes,hf.numIntersection,Zf),Kf=Df.getProgramCode(Yf,Qf),$f=Jf.program,eh=!0;if(void 0===$f)Yf.addEventListener('dispose',Ag);else if($f.code!==Kf)wg(Yf);else{if(void 0!==Qf.shaderID)return;eh=!1}if(eh){if(Qf.shaderID){var th=Xu[Qf.shaderID];Jf.shader={name:Yf.type,uniforms:Wu.clone(th.uniforms),vertexShader:th.vertexShader,fragmentShader:th.fragmentShader}}else Jf.shader={name:Yf.type,uniforms:Yf.uniforms,vertexShader:Yf.vertexShader,fragmentShader:Yf.fragmentShader};Yf.onBeforeCompile(Jf.shader),$f=Df.acquireProgram(Yf,Jf.shader,Qf,Kf),Jf.program=$f,Yf.program=$f}var rh=$f.getAttributes();if(Yf.morphTargets)for(Yf.numSupportedMorphTargets=0,ah=0;ah<Jg.maxMorphTargets;ah++)0<=rh['morphTarget'+ah]&&Yf.numSupportedMorphTargets++;if(Yf.morphNormals){Yf.numSupportedMorphNormals=0;for(var ah=0;ah<Jg.maxMorphNormals;ah++)0<=rh['morphNormal'+ah]&&Yf.numSupportedMorphNormals++}var ih=Jf.shader.uniforms;(Yf.isShaderMaterial||Yf.isRawShaderMaterial)&&!0!==Yf.clipping||(Jf.numClippingPlanes=hf.numPlanes,Jf.numIntersection=hf.numIntersection,ih.clippingPlanes=hf.uniform),Jf.fog=qf,Jf.lightsHash=Uf.state.hash,Yf.lights&&(ih.ambientLightColor.value=Uf.state.ambient,ih.directionalLights.value=Uf.state.directional,ih.spotLights.value=Uf.state.spot,ih.rectAreaLights.value=Uf.state.rectArea,ih.pointLights.value=Uf.state.point,ih.hemisphereLights.value=Uf.state.hemi,ih.directionalShadowMap.value=Uf.state.directionalShadowMap,ih.directionalShadowMatrix.value=Uf.state.directionalShadowMatrix,ih.spotShadowMap.value=Uf.state.spotShadowMap,ih.spotShadowMatrix.value=Uf.state.spotShadowMatrix,ih.pointShadowMap.value=Uf.state.pointShadowMap,ih.pointShadowMatrix.value=Uf.state.pointShadowMatrix);var oh=Jf.program.getUniforms(),nh=Ls.seqWithValue(oh.seq,ih);Jf.uniformsList=nh}function Ug(Yf,qf,Zf,Jf){lf=0;var Qf=Rf.get(Zf);if(yf&&(xf||Yf!==rf)){var Kf=Yf===rf&&Zf.id===ef;hf.setState(Zf.clippingPlanes,Zf.clipIntersection,Zf.clipShadows,Yf,Qf,Kf)}!1===Zf.needsUpdate&&(void 0===Qf.program?Zf.needsUpdate=!0:Zf.fog&&Qf.fog!==qf?Zf.needsUpdate=!0:Zf.lights&&Qf.lightsHash!==Uf.state.hash?Zf.needsUpdate=!0:void 0===Qf.numClippingPlanes||Qf.numClippingPlanes===hf.numPlanes&&Qf.numIntersection===hf.numIntersection||(Zf.needsUpdate=!0)),Zf.needsUpdate&&(Ig(Zf,qf,Jf),Zf.needsUpdate=!1);var $f=!1,eh=!1,th=!1,rh=Qf.program,ah=rh.getUniforms(),ih=Qf.shader.uniforms;if(wf.useProgram(rh.program)&&($f=!0,eh=!0,th=!0),Zf.id!==ef&&(ef=Zf.id,eh=!0),$f||Yf!==rf){if(ah.setValue(Tf,'projectionMatrix',Yf.projectionMatrix),Af.logarithmicDepthBuffer&&ah.setValue(Tf,'logDepthBufFC',2/(Math.log(Yf.far+1)/Math.LN2)),rf!==(af||Yf)&&(rf=af||Yf,eh=!0,th=!0),Zf.isShaderMaterial||Zf.isMeshPhongMaterial||Zf.isMeshStandardMaterial||Zf.envMap){var oh=ah.map.cameraPosition;void 0!==oh&&oh.setValue(Tf,_f.setFromMatrixPosition(Yf.matrixWorld))}(Zf.isMeshPhongMaterial||Zf.isMeshLambertMaterial||Zf.isMeshBasicMaterial||Zf.isMeshStandardMaterial||Zf.isShaderMaterial||Zf.skinning)&&ah.setValue(Tf,'viewMatrix',Yf.matrixWorldInverse)}if(Zf.skinning){ah.setOptional(Tf,Jf,'bindMatrix'),ah.setOptional(Tf,Jf,'bindMatrixInverse');var nh=Jf.skeleton;if(nh){var sh=nh.bones;if(Af.floatVertexTextures){if(void 0===nh.boneTexture){var lh=Math.sqrt(4*sh.length);lh=Iu.ceilPowerOfTwo(lh),lh=Math.max(lh,4);var dh=new Float32Array(4*(lh*lh));dh.set(nh.boneMatrices);var ph=new Jo(dh,lh,lh,au,Zm);nh.boneMatrices=dh,nh.boneTexture=ph,nh.boneTextureSize=lh}ah.setValue(Tf,'boneTexture',nh.boneTexture),ah.setValue(Tf,'boneTextureSize',nh.boneTextureSize)}else ah.setOptional(Tf,nh,'boneMatrices')}}return eh&&(ah.setValue(Tf,'toneMappingExposure',Jg.toneMappingExposure),ah.setValue(Tf,'toneMappingWhitePoint',Jg.toneMappingWhitePoint),Zf.lights&&function(ch,mh){ch.ambientLightColor.needsUpdate=mh,ch.directionalLights.needsUpdate=mh,ch.pointLights.needsUpdate=mh,ch.spotLights.needsUpdate=mh,ch.rectAreaLights.needsUpdate=mh,ch.hemisphereLights.needsUpdate=mh}(ih,th),qf&&Zf.fog&&function(ch,mh){ch.fogColor.value=mh.color,mh.isFog?(ch.fogNear.value=mh.near,ch.fogFar.value=mh.far):mh.isFogExp2&&(ch.fogDensity.value=mh.density)}(ih,qf),Zf.isMeshBasicMaterial?Dg(ih,Zf):Zf.isMeshLambertMaterial?(Dg(ih,Zf),function(ch,mh){mh.emissiveMap&&(ch.emissiveMap.value=mh.emissiveMap)}(ih,Zf)):Zf.isMeshPhongMaterial?(Dg(ih,Zf),Zf.isMeshToonMaterial?function(ch,mh){Ng(ch,mh),mh.gradientMap&&(ch.gradientMap.value=mh.gradientMap)}(ih,Zf):Ng(ih,Zf)):Zf.isMeshStandardMaterial?(Dg(ih,Zf),Zf.isMeshPhysicalMaterial?function(ch,mh){ch.clearCoat.value=mh.clearCoat,ch.clearCoatRoughness.value=mh.clearCoatRoughness,Bg(ch,mh)}(ih,Zf):Bg(ih,Zf)):Zf.isMeshDepthMaterial?(Dg(ih,Zf),function(ch,mh){mh.displacementMap&&(ch.displacementMap.value=mh.displacementMap,ch.displacementScale.value=mh.displacementScale,ch.displacementBias.value=mh.displacementBias)}(ih,Zf)):Zf.isMeshDistanceMaterial?(Dg(ih,Zf),function(ch,mh){mh.displacementMap&&(ch.displacementMap.value=mh.displacementMap,ch.displacementScale.value=mh.displacementScale,ch.displacementBias.value=mh.displacementBias),ch.referencePosition.value.copy(mh.referencePosition),ch.nearDistance.value=mh.nearDistance,ch.farDistance.value=mh.farDistance}(ih,Zf)):Zf.isMeshNormalMaterial?(Dg(ih,Zf),function(ch,mh){mh.bumpMap&&(ch.bumpMap.value=mh.bumpMap,ch.bumpScale.value=mh.bumpScale),mh.normalMap&&(ch.normalMap.value=mh.normalMap,ch.normalScale.value.copy(mh.normalScale)),mh.displacementMap&&(ch.displacementMap.value=mh.displacementMap,ch.displacementScale.value=mh.displacementScale,ch.displacementBias.value=mh.displacementBias)}(ih,Zf)):Zf.isLineBasicMaterial?(function(ch,mh){ch.diffuse.value=mh.color,ch.opacity.value=mh.opacity}(ih,Zf),Zf.isLineDashedMaterial&&function(ch,mh){ch.dashSize.value=mh.dashSize,ch.totalSize.value=mh.dashSize+mh.gapSize,ch.scale.value=mh.scale}(ih,Zf)):Zf.isPointsMaterial?function(ch,mh){if(ch.diffuse.value=mh.color,ch.opacity.value=mh.opacity,ch.size.value=mh.size*cf,ch.scale.value=.5*pf,ch.map.value=mh.map,null!==mh.map){if(!0===mh.map.matrixAutoUpdate){var uh=mh.map.offset,gh=mh.map.repeat,fh=mh.map.rotation,hh=mh.map.center;mh.map.matrix.setUvTransform(uh.x,uh.y,gh.x,gh.y,fh,hh.x,hh.y)}ch.uvTransform.value.copy(mh.map.matrix)}}(ih,Zf):Zf.isShadowMaterial&&(ih.color.value=Zf.color,ih.opacity.value=Zf.opacity),void 0!==ih.ltcMat&&(ih.ltcMat.value=Vu.LTC_MAT_TEXTURE),void 0!==ih.ltcMag&&(ih.ltcMag.value=Vu.LTC_MAG_TEXTURE),Ls.upload(Tf,Qf.uniformsList,ih,Jg)),ah.setValue(Tf,'modelViewMatrix',Jf.modelViewMatrix),ah.setValue(Tf,'normalMatrix',Jf.normalMatrix),ah.setValue(Tf,'modelMatrix',Jf.matrixWorld),rh}function Dg(Yf,qf){Yf.opacity.value=qf.opacity,qf.color&&(Yf.diffuse.value=qf.color),qf.emissive&&Yf.emissive.value.copy(qf.emissive).multiplyScalar(qf.emissiveIntensity),qf.map&&(Yf.map.value=qf.map),qf.alphaMap&&(Yf.alphaMap.value=qf.alphaMap),qf.specularMap&&(Yf.specularMap.value=qf.specularMap),qf.envMap&&(Yf.envMap.value=qf.envMap,Yf.flipEnvMap.value=qf.envMap&&qf.envMap.isCubeTexture?-1:1,Yf.reflectivity.value=qf.reflectivity,Yf.refractionRatio.value=qf.refractionRatio),qf.lightMap&&(Yf.lightMap.value=qf.lightMap,Yf.lightMapIntensity.value=qf.lightMapIntensity),qf.aoMap&&(Yf.aoMap.value=qf.aoMap,Yf.aoMapIntensity.value=qf.aoMapIntensity);var Zf;if(qf.map?Zf=qf.map:qf.specularMap?Zf=qf.specularMap:qf.displacementMap?Zf=qf.displacementMap:qf.normalMap?Zf=qf.normalMap:qf.bumpMap?Zf=qf.bumpMap:qf.roughnessMap?Zf=qf.roughnessMap:qf.metalnessMap?Zf=qf.metalnessMap:qf.alphaMap?Zf=qf.alphaMap:qf.emissiveMap&&(Zf=qf.emissiveMap),void 0!==Zf){if(Zf.isWebGLRenderTarget&&(Zf=Zf.texture),!0===Zf.matrixAutoUpdate){var Jf=Zf.offset,Qf=Zf.repeat,Kf=Zf.rotation,$f=Zf.center;Zf.matrix.setUvTransform(Jf.x,Jf.y,Qf.x,Qf.y,Kf,$f.x,$f.y)}Yf.uvTransform.value.copy(Zf.matrix)}}function Ng(Yf,qf){Yf.specular.value=qf.specular,Yf.shininess.value=Math.max(qf.shininess,1e-4),qf.emissiveMap&&(Yf.emissiveMap.value=qf.emissiveMap),qf.bumpMap&&(Yf.bumpMap.value=qf.bumpMap,Yf.bumpScale.value=qf.bumpScale),qf.normalMap&&(Yf.normalMap.value=qf.normalMap,Yf.normalScale.value.copy(qf.normalScale)),qf.displacementMap&&(Yf.displacementMap.value=qf.displacementMap,Yf.displacementScale.value=qf.displacementScale,Yf.displacementBias.value=qf.displacementBias)}function Bg(Yf,qf){Yf.roughness.value=qf.roughness,Yf.metalness.value=qf.metalness,qf.roughnessMap&&(Yf.roughnessMap.value=qf.roughnessMap),qf.metalnessMap&&(Yf.metalnessMap.value=qf.metalnessMap),qf.emissiveMap&&(Yf.emissiveMap.value=qf.emissiveMap),qf.bumpMap&&(Yf.bumpMap.value=qf.bumpMap,Yf.bumpScale.value=qf.bumpScale),qf.normalMap&&(Yf.normalMap.value=qf.normalMap,Yf.normalScale.value.copy(qf.normalScale)),qf.displacementMap&&(Yf.displacementMap.value=qf.displacementMap,Yf.displacementScale.value=qf.displacementScale,Yf.displacementBias.value=qf.displacementBias),qf.envMap&&(Yf.envMapIntensity.value=qf.envMapIntensity)}console.log('THREE.WebGLRenderer',Pc);var Fg=void 0===(Eg=Eg||{}).canvas?document.createElement('canvas'):Eg.canvas,zg=void 0===Eg.context?null:Eg.context,Gg=void 0!==Eg.alpha&&Eg.alpha,Hg=void 0===Eg.depth||Eg.depth,Og=void 0===Eg.stencil||Eg.stencil,Vg=void 0!==Eg.antialias&&Eg.antialias,Wg=void 0===Eg.premultipliedAlpha||Eg.premultipliedAlpha,kg=void 0!==Eg.preserveDrawingBuffer&&Eg.preserveDrawingBuffer,Xg=[],jg=[],Yg=null,qg=[],Zg=[];this.domElement=Fg,this.context=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyCorrectLights=!1,this.toneMapping=Tm,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var Jg=this,Qg=!1,Kg=null,$g=null,ef=-1,tf='',rf=null,af=null,of=new Yo,nf=new Yo,sf=null,lf=0,df=Fg.width,pf=Fg.height,cf=1,mf=new Yo(0,0,df,pf),uf=new Yo(0,0,df,pf),gf=!1,ff=new Os,hf=new function(){function Yf(){rh.value!==Jf&&(rh.value=Jf,rh.needsUpdate=0<Qf),Zf.numPlanes=Qf,Zf.numIntersection=0}function qf(ah,ih,oh,nh){var sh=null===ah?0:ah.length,lh=null;if(0!==sh){if(lh=rh.value,!0!==nh||null===lh){var dh=oh+4*sh,ph=ih.matrixWorldInverse;th.getNormalMatrix(ph),(null==lh||lh.length<dh)&&(lh=new Float32Array(dh));for(var ch=0,mh=oh;ch!==sh;++ch,mh+=4)eh.copy(ah[ch]).applyMatrix4(ph,th),eh.normal.toArray(lh,mh),lh[mh+3]=eh.constant}rh.value=lh,rh.needsUpdate=!0}return Zf.numPlanes=sh,lh}var Zf=this,Jf=null,Qf=0,Kf=!1,$f=!1,eh=new Hs,th=new Xo,rh={value:null,needsUpdate:!1};this.uniform=rh,this.numPlanes=0,this.numIntersection=0,this.init=function(ah,ih,oh){var nh=0!==ah.length||ih||0!=Qf||Kf;return Kf=ih,Jf=qf(ah,oh,0),Qf=ah.length,nh},this.beginShadows=function(){$f=!0,qf(null)},this.endShadows=function(){$f=!1,Yf()},this.setState=function(ah,ih,oh,nh,sh,lh){if(!Kf||null===ah||0===ah.length||$f&&!oh)$f?qf(null):Yf();else{var dh=$f?0:Qf,ph=4*dh,ch=sh.clippingState||null;rh.value=ch,ch=qf(ah,nh,ph,lh);for(var mh=0;mh!==ph;++mh)ch[mh]=Jf[mh];sh.clippingState=ch,this.numIntersection=ih?this.numPlanes:0,this.numPlanes+=dh}}},yf=!1,xf=!1,vf=new Ho,_f=new Wo,Ef={geometries:0,textures:0},bf={frame:0,calls:0,vertices:0,faces:0,points:0};this.info={render:bf,memory:Ef,programs:null};var Tf;try{var Sf={alpha:Gg,depth:Hg,stencil:Og,antialias:Vg,premultipliedAlpha:Wg,preserveDrawingBuffer:kg};if(null===(Tf=zg||Fg.getContext('webgl',Sf)||Fg.getContext('experimental-webgl',Sf)))throw null===Fg.getContext('webgl')?'Error creating WebGL context.':'Error creating WebGL context with your selected attributes.';void 0===Tf.getShaderPrecisionFormat&&(Tf.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}}),Fg.addEventListener('webglcontextlost',Sg,!1),Fg.addEventListener('webglcontextrestored',Mg,!1)}catch(Yf){console.error('THREE.WebGLRenderer: '+Yf)}var Mf,Af,wf,Rf,Lf,Pf,Cf,If,Uf,Df,Nf,Bf,Ff,zf,Gf,Hf,Of,Vf;Tg();var Wf=new function(Yf){function qf(){if(null!==Jf&&Jf.isPresenting){var nh=Jf.getEyeParameters('left'),sh=nh.renderWidth,lh=nh.renderHeight;oh=Yf.getPixelRatio(),ih=Yf.getSize(),Yf.setDrawingBufferSize(2*sh,lh,1)}else Zf.enabled&&Yf.setDrawingBufferSize(ih.width,ih.height,oh)}var Zf=this,Jf=null,Qf=null;'undefined'!=typeof window&&'VRFrameData'in window&&(Qf=new window.VRFrameData);var Kf=new Ho,$f=new Ho,eh=new Ho,th=new Fl;th.bounds=new Yo(0,0,.5,1),th.layers.enable(1);var rh=new Fl;rh.bounds=new Yo(.5,0,.5,1),rh.layers.enable(2);var ah=new zl([th,rh]);ah.layers.enable(1),ah.layers.enable(2);var ih,oh;'undefined'!=typeof window&&window.addEventListener('vrdisplaypresentchange',qf,!1),this.enabled=!1,this.standing=!1,this.getDevice=function(){return Jf},this.setDevice=function(nh){void 0!==nh&&(Jf=nh)},this.getCamera=function(nh){if(null===Jf)return nh;Jf.depthNear=nh.near,Jf.depthFar=nh.far,Jf.getFrameData(Qf);var sh=Qf.pose;null===sh.position?nh.position.set(0,0,0):nh.position.fromArray(sh.position),null!==sh.orientation&&nh.quaternion.fromArray(sh.orientation),nh.updateMatrixWorld();var lh=Jf.stageParameters;if(this.standing&&lh&&($f.fromArray(lh.sittingToStandingTransform),eh.getInverse($f),nh.matrixWorld.multiply($f),nh.matrixWorldInverse.multiply(eh)),!1===Jf.isPresenting)return nh;th.near=nh.near,rh.near=nh.near,th.far=nh.far,rh.far=nh.far,ah.matrixWorld.copy(nh.matrixWorld),ah.matrixWorldInverse.copy(nh.matrixWorldInverse),th.matrixWorldInverse.fromArray(Qf.leftViewMatrix),rh.matrixWorldInverse.fromArray(Qf.rightViewMatrix),this.standing&&lh&&(th.matrixWorldInverse.multiply(eh),rh.matrixWorldInverse.multiply(eh));var dh=nh.parent;null!==dh&&(Kf.getInverse(dh.matrixWorld),th.matrixWorldInverse.multiply(Kf),rh.matrixWorldInverse.multiply(Kf)),th.matrixWorld.getInverse(th.matrixWorldInverse),rh.matrixWorld.getInverse(rh.matrixWorldInverse),th.projectionMatrix.fromArray(Qf.leftProjectionMatrix),rh.projectionMatrix.fromArray(Qf.rightProjectionMatrix),ah.projectionMatrix.copy(th.projectionMatrix);var ph=Jf.getLayers();if(ph.length){var ch=ph[0];null!==ch.leftBounds&&4===ch.leftBounds.length&&th.bounds.fromArray(ch.leftBounds),null!==ch.rightBounds&&4===ch.rightBounds.length&&rh.bounds.fromArray(ch.rightBounds)}return ah},this.getStandingMatrix=function(){return $f},this.submitFrame=function(){Jf&&Jf.isPresenting&&Jf.submitFrame()},this.dispose=function(){window.removeEventListener('vrdisplaypresentchange',qf)}}(Jg);this.vr=Wf;var kf=new Vs(Jg,If,Af.maxTextureSize);this.shadowMap=kf,this.getContext=function(){return Tf},this.getContextAttributes=function(){return Tf.getContextAttributes()},this.forceContextLoss=function(){var Yf=Mf.get('WEBGL_lose_context');Yf&&Yf.loseContext()},this.forceContextRestore=function(){var Yf=Mf.get('WEBGL_lose_context');Yf&&Yf.restoreContext()},this.getPixelRatio=function(){return cf},this.setPixelRatio=function(Yf){void 0!==Yf&&(cf=Yf,this.setSize(df,pf,!1))},this.getSize=function(){return{width:df,height:pf}},this.setSize=function(Yf,qf,Zf){var Jf=Wf.getDevice();Jf&&Jf.isPresenting?console.warn('THREE.WebGLRenderer: Can\'t change size while VR device is presenting.'):(df=Yf,pf=qf,Fg.width=Yf*cf,Fg.height=qf*cf,!1!==Zf&&(Fg.style.width=Yf+'px',Fg.style.height=qf+'px'),this.setViewport(0,0,Yf,qf))},this.getDrawingBufferSize=function(){return{width:df*cf,height:pf*cf}},this.setDrawingBufferSize=function(Yf,qf,Zf){df=Yf,pf=qf,cf=Zf,Fg.width=Yf*Zf,Fg.height=qf*Zf,this.setViewport(0,0,Yf,qf)},this.setViewport=function(Yf,qf,Zf,Jf){mf.set(Yf,pf-qf-Jf,Zf,Jf),wf.viewport(of.copy(mf).multiplyScalar(cf))},this.setScissor=function(Yf,qf,Zf,Jf){uf.set(Yf,pf-qf-Jf,Zf,Jf),wf.scissor(nf.copy(uf).multiplyScalar(cf))},this.setScissorTest=function(Yf){wf.setScissorTest(gf=Yf)},this.getClearColor=function(){return Bf.getClearColor()},this.setClearColor=function(){Bf.setClearColor.apply(Bf,arguments)},this.getClearAlpha=function(){return Bf.getClearAlpha()},this.setClearAlpha=function(){Bf.setClearAlpha.apply(Bf,arguments)},this.clear=function(Yf,qf,Zf){var Jf=0;(void 0===Yf||Yf)&&(Jf|=Tf.COLOR_BUFFER_BIT),(void 0===qf||qf)&&(Jf|=Tf.DEPTH_BUFFER_BIT),(void 0===Zf||Zf)&&(Jf|=Tf.STENCIL_BUFFER_BIT),Tf.clear(Jf)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.clearTarget=function(Yf,qf,Zf,Jf){this.setRenderTarget(Yf),this.clear(qf,Zf,Jf)},this.dispose=function(){Fg.removeEventListener('webglcontextlost',Sg,!1),Fg.removeEventListener('webglcontextrestored',Mg,!1),Nf.dispose(),Wf.dispose()},this.renderBufferImmediate=function(Yf,qf,Zf){wf.initAttributes();var Jf=Rf.get(Yf);Yf.hasPositions&&!Jf.position&&(Jf.position=Tf.createBuffer()),Yf.hasNormals&&!Jf.normal&&(Jf.normal=Tf.createBuffer()),Yf.hasUvs&&!Jf.uv&&(Jf.uv=Tf.createBuffer()),Yf.hasColors&&!Jf.color&&(Jf.color=Tf.createBuffer());var Qf=qf.getAttributes();if(Yf.hasPositions&&(Tf.bindBuffer(Tf.ARRAY_BUFFER,Jf.position),Tf.bufferData(Tf.ARRAY_BUFFER,Yf.positionArray,Tf.DYNAMIC_DRAW),wf.enableAttribute(Qf.position),Tf.vertexAttribPointer(Qf.position,3,Tf.FLOAT,!1,0,0)),Yf.hasNormals){if(Tf.bindBuffer(Tf.ARRAY_BUFFER,Jf.normal),!Zf.isMeshPhongMaterial&&!Zf.isMeshStandardMaterial&&!Zf.isMeshNormalMaterial&&!0===Zf.flatShading)for(var Kf=0,$f=3*Yf.count;Kf<$f;Kf+=9){var eh=Yf.normalArray,th=(eh[Kf+0]+eh[Kf+3]+eh[Kf+6])/3,rh=(eh[Kf+1]+eh[Kf+4]+eh[Kf+7])/3,ah=(eh[Kf+2]+eh[Kf+5]+eh[Kf+8])/3;eh[Kf+0]=th,eh[Kf+1]=rh,eh[Kf+2]=ah,eh[Kf+3]=th,eh[Kf+4]=rh,eh[Kf+5]=ah,eh[Kf+6]=th,eh[Kf+7]=rh,eh[Kf+8]=ah}Tf.bufferData(Tf.ARRAY_BUFFER,Yf.normalArray,Tf.DYNAMIC_DRAW),wf.enableAttribute(Qf.normal),Tf.vertexAttribPointer(Qf.normal,3,Tf.FLOAT,!1,0,0)}Yf.hasUvs&&Zf.map&&(Tf.bindBuffer(Tf.ARRAY_BUFFER,Jf.uv),Tf.bufferData(Tf.ARRAY_BUFFER,Yf.uvArray,Tf.DYNAMIC_DRAW),wf.enableAttribute(Qf.uv),Tf.vertexAttribPointer(Qf.uv,2,Tf.FLOAT,!1,0,0)),Yf.hasColors&&Zf.vertexColors!==Hc&&(Tf.bindBuffer(Tf.ARRAY_BUFFER,Jf.color),Tf.bufferData(Tf.ARRAY_BUFFER,Yf.colorArray,Tf.DYNAMIC_DRAW),wf.enableAttribute(Qf.color),Tf.vertexAttribPointer(Qf.color,3,Tf.FLOAT,!1,0,0)),wf.disableUnusedAttributes(),Tf.drawArrays(Tf.TRIANGLES,0,Yf.count),Yf.count=0},this.renderBufferDirect=function(Yf,qf,Zf,Jf,Qf,Kf){wf.setMaterial(Jf);var $f=Ug(Yf,qf,Jf,Qf),eh=Zf.id+'_'+$f.id+'_'+(!0===Jf.wireframe),th=!1;eh!=tf&&(tf=eh,th=!0),Qf.morphTargetInfluences&&(Ff.update(Qf,Zf,Jf,$f),th=!0);var rh=Zf.index,ah=Zf.attributes.position,ih=1;!0===Jf.wireframe&&(rh=Cf.getWireframeAttribute(Zf),ih=2);var nh=zf,oh;null!==rh&&(oh=Pf.get(rh),(nh=Gf).setIndex(oh)),th&&(!function(hh,yh,xh,vh){if(xh&&xh.isInstancedBufferGeometry&&null===Mf.get('ANGLE_instanced_arrays'))console.error('THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.');else{void 0===vh&&(vh=0),wf.initAttributes();var _h=xh.attributes,Eh=yh.getAttributes(),bh=hh.defaultAttributeValues;for(var Th in Eh){var Sh=Eh[Th];if(0<=Sh){var Mh=_h[Th];if(void 0!==Mh){var Ah=Mh.normalized,wh=Mh.itemSize,Rh=Pf.get(Mh);if(void 0===Rh)continue;var Lh=Rh.buffer,Ph=Rh.type,Ch=Rh.bytesPerElement;if(Mh.isInterleavedBufferAttribute){var Ih=Mh.data,Uh=Ih.stride,Dh=Mh.offset;Ih&&Ih.isInstancedInterleavedBuffer?(wf.enableAttributeAndDivisor(Sh,Ih.meshPerAttribute),void 0===xh.maxInstancedCount&&(xh.maxInstancedCount=Ih.meshPerAttribute*Ih.count)):wf.enableAttribute(Sh),Tf.bindBuffer(Tf.ARRAY_BUFFER,Lh),Tf.vertexAttribPointer(Sh,wh,Ph,Ah,Uh*Ch,(vh*Uh+Dh)*Ch)}else Mh.isInstancedBufferAttribute?(wf.enableAttributeAndDivisor(Sh,Mh.meshPerAttribute),void 0===xh.maxInstancedCount&&(xh.maxInstancedCount=Mh.meshPerAttribute*Mh.count)):wf.enableAttribute(Sh),Tf.bindBuffer(Tf.ARRAY_BUFFER,Lh),Tf.vertexAttribPointer(Sh,wh,Ph,Ah,0,vh*wh*Ch)}else if(void 0!==bh){var Nh=bh[Th];if(void 0!==Nh)switch(Nh.length){case 2:Tf.vertexAttrib2fv(Sh,Nh);break;case 3:Tf.vertexAttrib3fv(Sh,Nh);break;case 4:Tf.vertexAttrib4fv(Sh,Nh);break;default:Tf.vertexAttrib1fv(Sh,Nh);}}}}wf.disableUnusedAttributes()}}(Jf,$f,Zf),null!==rh&&Tf.bindBuffer(Tf.ELEMENT_ARRAY_BUFFER,oh.buffer));var sh=0;null===rh?void 0!==ah&&(sh=ah.count):sh=rh.count;var lh=Zf.drawRange.start*ih,dh=Zf.drawRange.count*ih,ph=null===Kf?0:Kf.start*ih,ch=null===Kf?1/0:Kf.count*ih,mh=Math.max(lh,ph),uh=Math.min(sh,lh+dh,ph+ch)-1,gh=Math.max(0,uh-mh+1);if(0!==gh){if(Qf.isMesh){if(!0===Jf.wireframe)wf.setLineWidth(Jf.wireframeLinewidth*bg()),nh.setMode(Tf.LINES);else switch(Qf.drawMode){case _u:nh.setMode(Tf.TRIANGLES);break;case Eu:nh.setMode(Tf.TRIANGLE_STRIP);break;case bu:nh.setMode(Tf.TRIANGLE_FAN);}}else if(Qf.isLine){var fh=Jf.linewidth;void 0===fh&&(fh=1),wf.setLineWidth(fh*bg()),Qf.isLineSegments?nh.setMode(Tf.LINES):Qf.isLineLoop?nh.setMode(Tf.LINE_LOOP):nh.setMode(Tf.LINE_STRIP)}else Qf.isPoints&&nh.setMode(Tf.POINTS);Zf&&Zf.isInstancedBufferGeometry?0<Zf.maxInstancedCount&&nh.renderInstances(Zf,mh,gh):nh.render(mh,gh)}},this.compile=function(Yf,qf){Xg.length=0,jg.length=0,Yf.traverse(function(Zf){Zf.isLight&&(Xg.push(Zf),Zf.castShadow&&jg.push(Zf))}),Uf.setup(Xg,jg,qf),Yf.traverse(function(Zf){if(Zf.material)if(Array.isArray(Zf.material))for(var Jf=0;Jf<Zf.material.length;Jf++)Ig(Zf.material[Jf],Yf.fog,Zf);else Ig(Zf.material,Yf.fog,Zf)})};var Xf=!1,jf=null;this.animate=function(Yf){jf=Yf,Xf||((Wf.getDevice()||window).requestAnimationFrame(Rg),Xf=!0)},this.render=function(Yf,qf,Zf,Jf){if(!(qf&&qf.isCamera))console.error('THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.');else if(!Qg){tf='',ef=-1,rf=null,!0===Yf.autoUpdate&&Yf.updateMatrixWorld(),null===qf.parent&&qf.updateMatrixWorld(),Wf.enabled&&(qf=Wf.getCamera(qf)),vf.multiplyMatrices(qf.projectionMatrix,qf.matrixWorldInverse),ff.setFromMatrix(vf),Xg.length=0,jg.length=0,qg.length=0,Zg.length=0,xf=this.localClippingEnabled,yf=hf.init(this.clippingPlanes,xf,qf),(Yg=Nf.get(Yf,qf)).init(),Lg(Yf,qf,Jg.sortObjects),!0===Jg.sortObjects&&Yg.sort(),yf&&hf.beginShadows(),kf.render(jg,Yf,qf),Uf.setup(Xg,jg,qf),yf&&hf.endShadows(),bf.frame++,bf.calls=0,bf.vertices=0,bf.faces=0,bf.points=0,void 0===Zf&&(Zf=null),this.setRenderTarget(Zf),Bf.render(Yg,Yf,qf,Jf);var Qf=Yg.opaque,Kf=Yg.transparent;if(Yf.overrideMaterial){var $f=Yf.overrideMaterial;Qf.length&&Pg(Qf,Yf,qf,$f),Kf.length&&Pg(Kf,Yf,qf,$f)}else Qf.length&&Pg(Qf,Yf,qf),Kf.length&&Pg(Kf,Yf,qf);Of.render(qg,Yf,qf),Hf.render(Zg,Yf,qf,of),Zf&&Lf.updateRenderTargetMipmap(Zf),wf.buffers.depth.setTest(!0),wf.buffers.depth.setMask(!0),wf.buffers.color.setMask(!0),wf.setPolygonOffset(!1),Wf.enabled&&Wf.submitFrame()}},this.setFaceCulling=function(Yf,qf){wf.setCullFace(Yf),wf.setFlipSided(qf===Dc)},this.allocTextureUnit=function(){var Yf=lf;return Yf>=Af.maxTextures&&console.warn('THREE.WebGLRenderer: Trying to use '+Yf+' texture units while this GPU supports only '+Af.maxTextures),lf+=1,Yf},this.setTexture2D=function(){var Yf=!1;return function(qf,Zf){qf&&qf.isWebGLRenderTarget&&(Yf||(console.warn('THREE.WebGLRenderer.setTexture2D: don\'t use render targets as textures. Use their .texture property instead.'),Yf=!0),qf=qf.texture),Lf.setTexture2D(qf,Zf)}}(),this.setTexture=function(){var Yf=!1;return function(qf,Zf){Yf||(console.warn('THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead.'),Yf=!0),Lf.setTexture2D(qf,Zf)}}(),this.setTextureCube=function(){var Yf=!1;return function(qf,Zf){qf&&qf.isWebGLRenderTargetCube&&(Yf||(console.warn('THREE.WebGLRenderer.setTextureCube: don\'t use cube render targets as textures. Use their .texture property instead.'),Yf=!0),qf=qf.texture),qf&&qf.isCubeTexture||Array.isArray(qf.image)&&6===qf.image.length?Lf.setTextureCube(qf,Zf):Lf.setTextureCubeDynamic(qf,Zf)}}(),this.getRenderTarget=function(){return Kg},this.setRenderTarget=function(Yf){Kg=Yf,Yf&&void 0===Rf.get(Yf).__webglFramebuffer&&Lf.setupRenderTarget(Yf);var qf=null,Zf=!1;if(Yf){var Jf=Rf.get(Yf).__webglFramebuffer;Yf.isWebGLRenderTargetCube?(qf=Jf[Yf.activeCubeFace],Zf=!0):qf=Jf,of.copy(Yf.viewport),nf.copy(Yf.scissor),sf=Yf.scissorTest}else of.copy(mf).multiplyScalar(cf),nf.copy(uf).multiplyScalar(cf),sf=gf;if($g!==qf&&(Tf.bindFramebuffer(Tf.FRAMEBUFFER,qf),$g=qf),wf.viewport(of),wf.scissor(nf),wf.setScissorTest(sf),Zf){var Qf=Rf.get(Yf.texture);Tf.framebufferTexture2D(Tf.FRAMEBUFFER,Tf.COLOR_ATTACHMENT0,Tf.TEXTURE_CUBE_MAP_POSITIVE_X+Yf.activeCubeFace,Qf.__webglTexture,Yf.activeMipMapLevel)}},this.readRenderTargetPixels=function(Yf,qf,Zf,Jf,Qf,Kf){if(Yf&&Yf.isWebGLRenderTarget){var $f=Rf.get(Yf).__webglFramebuffer;if($f){var eh=!1;$f!==$g&&(Tf.bindFramebuffer(Tf.FRAMEBUFFER,$f),eh=!0);try{var th=Yf.texture,rh=th.format,ah=th.type;if(rh!==au&&Vf.convert(rh)!==Tf.getParameter(Tf.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error('THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.');if(!(ah===Wm||Vf.convert(ah)===Tf.getParameter(Tf.IMPLEMENTATION_COLOR_READ_TYPE)||ah===Zm&&(Mf.get('OES_texture_float')||Mf.get('WEBGL_color_buffer_float'))||ah===Jm&&Mf.get('EXT_color_buffer_half_float')))return void console.error('THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.');Tf.checkFramebufferStatus(Tf.FRAMEBUFFER)===Tf.FRAMEBUFFER_COMPLETE?0<=qf&&qf<=Yf.width-Jf&&0<=Zf&&Zf<=Yf.height-Qf&&Tf.readPixels(qf,Zf,Jf,Qf,Vf.convert(rh),Vf.convert(ah),Kf):console.error('THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.')}finally{eh&&Tf.bindFramebuffer(Tf.FRAMEBUFFER,$g)}}}else console.error('THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.')}}function Ol(Eg,bg){this.name='',this.color=new Ps(Eg),this.density=void 0===bg?25e-5:bg}function Vl(Eg,bg,Tg){this.name='',this.color=new Ps(Eg),this.near=void 0===bg?1:bg,this.far=void 0===Tg?1e3:Tg}function Wl(){js.call(this),this.type='Scene',this.background=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0}function kl(Eg,bg,Tg,Sg,Mg){js.call(this),this.lensFlares=[],this.positionScreen=new Wo,this.customUpdateCallback=void 0,void 0!==Eg&&this.add(Eg,bg,Tg,Sg,Mg)}function Xl(Eg){Ns.call(this),this.type='SpriteMaterial',this.color=new Ps(16777215),this.map=null,this.rotation=0,this.fog=!1,this.lights=!1,this.setValues(Eg)}function jl(Eg){js.call(this),this.type='Sprite',this.material=void 0===Eg?new Xl:Eg}function Yl(){js.call(this),this.type='LOD',Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}function ql(Eg,bg){if(Eg=Eg||[],this.bones=Eg.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),void 0===bg)this.calculateInverses();else if(this.bones.length===bg.length)this.boneInverses=bg.slice(0);else{console.warn('THREE.Skeleton boneInverses is the wrong length.'),this.boneInverses=[];for(var Tg=0,Sg=this.bones.length;Tg<Sg;Tg++)this.boneInverses.push(new Ho)}}function Zl(){js.call(this),this.type='Bone'}function Jl(Eg,bg){El.call(this,Eg,bg),this.type='SkinnedMesh',this.bindMode='attached',this.bindMatrix=new Ho,this.bindMatrixInverse=new Ho;var Tg=new ql(this.initBones());this.bind(Tg,this.matrixWorld),this.normalizeSkinWeights()}function Ql(Eg){Ns.call(this),this.type='LineBasicMaterial',this.color=new Ps(16777215),this.linewidth=1,this.linecap='round',this.linejoin='round',this.lights=!1,this.setValues(Eg)}function Kl(Eg,bg,Tg){return 1===Tg?(console.warn('THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead.'),new $l(Eg,bg)):void(js.call(this),this.type='Line',this.geometry=void 0===Eg?new dl:Eg,this.material=void 0===bg?new Ql({color:16777215*Math.random()}):bg)}function $l(Eg,bg){Kl.call(this,Eg,bg),this.type='LineSegments'}function ed(Eg,bg){Kl.call(this,Eg,bg),this.type='LineLoop'}function td(Eg){Ns.call(this),this.type='PointsMaterial',this.color=new Ps(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.lights=!1,this.setValues(Eg)}function rd(Eg,bg){js.call(this),this.type='Points',this.geometry=void 0===Eg?new dl:Eg,this.material=void 0===bg?new td({color:16777215*Math.random()}):bg}function ad(){js.call(this),this.type='Group'}function id(Eg,bg,Tg,Sg,Mg,Ag,wg,Rg,Lg){function Pg(){Eg.readyState>=Eg.HAVE_CURRENT_DATA&&(Cg.needsUpdate=!0),requestAnimationFrame(Pg)}jo.call(this,Eg,bg,Tg,Sg,Mg,Ag,wg,Rg,Lg),this.generateMipmaps=!1;var Cg=this;requestAnimationFrame(Pg)}function od(Eg,bg,Tg,Sg,Mg,Ag,wg,Rg,Lg,Pg,Cg,Ig){jo.call(this,null,Ag,wg,Rg,Lg,Pg,Sg,Mg,Cg,Ig),this.image={width:bg,height:Tg},this.mipmaps=Eg,this.flipY=!1,this.generateMipmaps=!1}function nd(Eg,bg,Tg,Sg,Mg,Ag,wg,Rg,Lg,Pg){if((Pg=void 0===Pg?su:Pg)!==su&&Pg!==lu)throw new Error('DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat');void 0===Tg&&Pg===su&&(Tg=jm),void 0===Tg&&Pg===lu&&(Tg=eu),jo.call(this,null,Sg,Mg,Ag,wg,Rg,Pg,Tg,Lg),this.image={width:Eg,height:bg},this.magFilter=void 0===wg?Fm:wg,this.minFilter=void 0===Rg?Fm:Rg,this.flipY=!1,this.generateMipmaps=!1}function sd(Eg,bg,Tg){Js.call(this),this.type='ParametricGeometry',this.parameters={func:Eg,slices:bg,stacks:Tg},this.fromBufferGeometry(new ld(Eg,bg,Tg)),this.mergeVertices()}function ld(Eg,bg,Tg){dl.call(this),this.type='ParametricBufferGeometry',this.parameters={func:Eg,slices:bg,stacks:Tg};var Ag=[],wg=[],Rg=[],Lg=[],Pg=new Wo,Cg=new Wo,Ig=new Wo,Ug=new Wo,Dg=new Wo,Ng=bg+1,Sg,Mg;for(Sg=0;Sg<=Tg;Sg++){var Bg=Sg/Tg;for(Mg=0;Mg<=bg;Mg++){var Fg=Mg/bg;Cg=Eg(Fg,Bg,Cg),wg.push(Cg.x,Cg.y,Cg.z),0<=Fg-1e-5?(Ig=Eg(Fg-1e-5,Bg,Ig),Ug.subVectors(Cg,Ig)):(Ig=Eg(Fg+1e-5,Bg,Ig),Ug.subVectors(Ig,Cg)),0<=Bg-1e-5?(Ig=Eg(Fg,Bg-1e-5,Ig),Dg.subVectors(Cg,Ig)):(Ig=Eg(Fg,Bg+1e-5,Ig),Dg.subVectors(Ig,Cg)),Pg.crossVectors(Ug,Dg).normalize(),Rg.push(Pg.x,Pg.y,Pg.z),Lg.push(Fg,Bg)}}for(Sg=0;Sg<Tg;Sg++)for(Mg=0;Mg<bg;Mg++){var zg=Sg*Ng+Mg,Gg=Sg*Ng+Mg+1,Hg=(Sg+1)*Ng+Mg+1,Og=(Sg+1)*Ng+Mg;Ag.push(zg,Gg,Og),Ag.push(Gg,Hg,Og)}this.setIndex(Ag),this.addAttribute('position',new ol(wg,3)),this.addAttribute('normal',new ol(Rg,3)),this.addAttribute('uv',new ol(Lg,2))}function dd(Eg,bg,Tg,Sg){Js.call(this),this.type='PolyhedronGeometry',this.parameters={vertices:Eg,indices:bg,radius:Tg,detail:Sg},this.fromBufferGeometry(new pd(Eg,bg,Tg,Sg)),this.mergeVertices()}function pd(Eg,bg,Tg,Sg){function wg(Ug){Cg.push(Ug.x,Ug.y,Ug.z)}function Rg(Ug,Dg){var Ng=3*Ug;Dg.x=Eg[Ng+0],Dg.y=Eg[Ng+1],Dg.z=Eg[Ng+2]}function Lg(Ug,Dg,Ng,Bg){0>Bg&&1===Ug.x&&(Ig[Dg]=Ug.x-1),0===Ng.x&&0===Ng.z&&(Ig[Dg]=Bg/2/Math.PI+.5)}function Pg(Ug){return Math.atan2(Ug.z,-Ug.x)}dl.call(this),this.type='PolyhedronBufferGeometry',this.parameters={vertices:Eg,indices:bg,radius:Tg,detail:Sg},Tg=Tg||1;var Cg=[],Ig=[];(function(Ug){for(var Dg=new Wo,Ng=new Wo,Bg=new Wo,Fg=0;Fg<bg.length;Fg+=3)Rg(bg[Fg+0],Dg),Rg(bg[Fg+1],Ng),Rg(bg[Fg+2],Bg),function(zg,Gg,Hg,Og){var kg=Math.pow(2,Og),Xg=[],Vg,Wg;for(Vg=0;Vg<=kg;Vg++){Xg[Vg]=[];var jg=zg.clone().lerp(Hg,Vg/kg),Yg=Gg.clone().lerp(Hg,Vg/kg),qg=kg-Vg;for(Wg=0;Wg<=qg;Wg++)Xg[Vg][Wg]=0===Wg&&Vg===kg?jg:jg.clone().lerp(Yg,Wg/qg)}for(Vg=0;Vg<kg;Vg++)for(Wg=0;Wg<2*(kg-Vg)-1;Wg++){var Zg=Math.floor(Wg/2);0==Wg%2?(wg(Xg[Vg][Zg+1]),wg(Xg[Vg+1][Zg]),wg(Xg[Vg][Zg])):(wg(Xg[Vg][Zg+1]),wg(Xg[Vg+1][Zg+1]),wg(Xg[Vg+1][Zg]))}}(Dg,Ng,Bg,Ug)})(Sg=Sg||0),function(Ug){for(var Dg=new Wo,Ng=0;Ng<Cg.length;Ng+=3)Dg.x=Cg[Ng+0],Dg.y=Cg[Ng+1],Dg.z=Cg[Ng+2],Dg.normalize().multiplyScalar(Ug),Cg[Ng+0]=Dg.x,Cg[Ng+1]=Dg.y,Cg[Ng+2]=Dg.z}(Tg),function(){for(var Ug=new Wo,Dg=0;Dg<Cg.length;Dg+=3){Ug.x=Cg[Dg+0],Ug.y=Cg[Dg+1],Ug.z=Cg[Dg+2];var Ng=Pg(Ug)/2/Math.PI+.5,Bg=function(Fg){return Math.atan2(-Fg.y,Math.sqrt(Fg.x*Fg.x+Fg.z*Fg.z))}(Ug)/Math.PI+.5;Ig.push(Ng,1-Bg)}!function(){for(var Fg=new Wo,zg=new Wo,Gg=new Wo,Hg=new Wo,Og=new Go,Vg=new Go,Wg=new Go,kg=0,Xg=0;kg<Cg.length;kg+=9,Xg+=6){Fg.set(Cg[kg+0],Cg[kg+1],Cg[kg+2]),zg.set(Cg[kg+3],Cg[kg+4],Cg[kg+5]),Gg.set(Cg[kg+6],Cg[kg+7],Cg[kg+8]),Og.set(Ig[Xg+0],Ig[Xg+1]),Vg.set(Ig[Xg+2],Ig[Xg+3]),Wg.set(Ig[Xg+4],Ig[Xg+5]),Hg.copy(Fg).add(zg).add(Gg).divideScalar(3);var jg=Pg(Hg);Lg(Og,Xg+0,Fg,jg),Lg(Vg,Xg+2,zg,jg),Lg(Wg,Xg+4,Gg,jg)}}(),function(){for(var Fg=0;Fg<Ig.length;Fg+=6){var zg=Ig[Fg+0],Gg=Ig[Fg+2],Hg=Ig[Fg+4],Og=Math.max(zg,Gg,Hg),Vg=Math.min(zg,Gg,Hg);.9<Og&&.1>Vg&&(.2>zg&&(Ig[Fg+0]+=1),.2>Gg&&(Ig[Fg+2]+=1),.2>Hg&&(Ig[Fg+4]+=1))}}()}(),this.addAttribute('position',new ol(Cg,3)),this.addAttribute('normal',new ol(Cg.slice(),3)),this.addAttribute('uv',new ol(Ig,2)),0===Sg?this.computeVertexNormals():this.normalizeNormals()}function cd(Eg,bg){Js.call(this),this.type='TetrahedronGeometry',this.parameters={radius:Eg,detail:bg},this.fromBufferGeometry(new md(Eg,bg)),this.mergeVertices()}function md(Eg,bg){pd.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],Eg,bg),this.type='TetrahedronBufferGeometry',this.parameters={radius:Eg,detail:bg}}function ud(Eg,bg){Js.call(this),this.type='OctahedronGeometry',this.parameters={radius:Eg,detail:bg},this.fromBufferGeometry(new gd(Eg,bg)),this.mergeVertices()}function gd(Eg,bg){pd.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],Eg,bg),this.type='OctahedronBufferGeometry',this.parameters={radius:Eg,detail:bg}}function fd(Eg,bg){Js.call(this),this.type='IcosahedronGeometry',this.parameters={radius:Eg,detail:bg},this.fromBufferGeometry(new hd(Eg,bg)),this.mergeVertices()}function hd(Eg,bg){var Tg=(1+Math.sqrt(5))/2;pd.call(this,[-1,Tg,0,1,Tg,0,-1,-Tg,0,1,-Tg,0,0,-1,Tg,0,1,Tg,0,-1,-Tg,0,1,-Tg,Tg,0,-1,Tg,0,1,-Tg,0,-1,-Tg,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],Eg,bg),this.type='IcosahedronBufferGeometry',this.parameters={radius:Eg,detail:bg}}function yd(Eg,bg){Js.call(this),this.type='ExtrudeGeometry',this.parameters={shapes:Eg,options:bg},this.fromBufferGeometry(new xd(Eg,bg)),this.mergeVertices()}function xd(Eg,bg){void 0!==Eg&&(dl.call(this),this.type='ExtrudeBufferGeometry',Eg=Array.isArray(Eg)?Eg:[Eg],this.addShapeList(Eg,bg),this.computeVertexNormals())}function vd(Eg,bg){Js.call(this),this.type='TextGeometry',this.parameters={text:Eg,parameters:bg},this.fromBufferGeometry(new _d(Eg,bg)),this.mergeVertices()}function _d(Eg,bg){var Tg=(bg=bg||{}).font;if(!Tg||!Tg.isFont)return console.error('THREE.TextGeometry: font parameter is not an instance of THREE.Font.'),new Js;var Sg=Tg.generateShapes(Eg,bg.size,bg.curveSegments);bg.amount=void 0===bg.height?50:bg.height,void 0===bg.bevelThickness&&(bg.bevelThickness=10),void 0===bg.bevelSize&&(bg.bevelSize=8),void 0===bg.bevelEnabled&&(bg.bevelEnabled=!1),xd.call(this,Sg,bg),this.type='TextBufferGeometry'}function Ed(Eg,bg,Tg,Sg,Mg,Ag,wg){Js.call(this),this.type='SphereGeometry',this.parameters={radius:Eg,widthSegments:bg,heightSegments:Tg,phiStart:Sg,phiLength:Mg,thetaStart:Ag,thetaLength:wg},this.fromBufferGeometry(new bd(Eg,bg,Tg,Sg,Mg,Ag,wg)),this.mergeVertices()}function bd(Eg,bg,Tg,Sg,Mg,Ag,wg){dl.call(this),this.type='SphereBufferGeometry',this.parameters={radius:Eg,widthSegments:bg,heightSegments:Tg,phiStart:Sg,phiLength:Mg,thetaStart:Ag,thetaLength:wg},Eg=Eg||1,bg=Math.max(3,Math.floor(bg)||8),Tg=Math.max(2,Math.floor(Tg)||6),Sg=void 0===Sg?0:Sg,Mg=void 0===Mg?2*Math.PI:Mg;var Pg=(Ag=void 0===Ag?0:Ag)+(wg=void 0===wg?Math.PI:wg),Cg=0,Ig=[],Ug=new Wo,Dg=new Wo,Ng=[],Bg=[],Fg=[],zg=[],Rg,Lg;for(Lg=0;Lg<=Tg;Lg++){var Gg=[],Hg=Lg/Tg;for(Rg=0;Rg<=bg;Rg++){var Og=Rg/bg;Ug.x=-Eg*Math.cos(Sg+Og*Mg)*Math.sin(Ag+Hg*wg),Ug.y=Eg*Math.cos(Ag+Hg*wg),Ug.z=Eg*Math.sin(Sg+Og*Mg)*Math.sin(Ag+Hg*wg),Bg.push(Ug.x,Ug.y,Ug.z),Dg.set(Ug.x,Ug.y,Ug.z).normalize(),Fg.push(Dg.x,Dg.y,Dg.z),zg.push(Og,1-Hg),Gg.push(Cg++)}Ig.push(Gg)}for(Lg=0;Lg<Tg;Lg++)for(Rg=0;Rg<bg;Rg++){var Vg=Ig[Lg][Rg+1],Wg=Ig[Lg][Rg],kg=Ig[Lg+1][Rg],Xg=Ig[Lg+1][Rg+1];(0!==Lg||0<Ag)&&Ng.push(Vg,Wg,Xg),(Lg!==Tg-1||Pg<Math.PI)&&Ng.push(Wg,kg,Xg)}this.setIndex(Ng),this.addAttribute('position',new ol(Bg,3)),this.addAttribute('normal',new ol(Fg,3)),this.addAttribute('uv',new ol(zg,2))}function Td(Eg,bg,Tg,Sg,Mg,Ag){Js.call(this),this.type='RingGeometry',this.parameters={innerRadius:Eg,outerRadius:bg,thetaSegments:Tg,phiSegments:Sg,thetaStart:Mg,thetaLength:Ag},this.fromBufferGeometry(new Sd(Eg,bg,Tg,Sg,Mg,Ag)),this.mergeVertices()}function Sd(Eg,bg,Tg,Sg,Mg,Ag){dl.call(this),this.type='RingBufferGeometry',this.parameters={innerRadius:Eg,outerRadius:bg,thetaSegments:Tg,phiSegments:Sg,thetaStart:Mg,thetaLength:Ag},Eg=Eg||.5,bg=bg||1,Mg=void 0===Mg?0:Mg,Ag=void 0===Ag?2*Math.PI:Ag,Tg=void 0===Tg?8:Math.max(3,Tg);var Pg=[],Cg=[],Ig=[],Ug=[],Dg=Eg,Ng=(bg-Eg)/(Sg=void 0===Sg?1:Math.max(1,Sg)),Bg=new Wo,Fg=new Go,wg,Rg,Lg;for(Rg=0;Rg<=Sg;Rg++){for(Lg=0;Lg<=Tg;Lg++)wg=Mg+Lg/Tg*Ag,Bg.x=Dg*Math.cos(wg),Bg.y=Dg*Math.sin(wg),Cg.push(Bg.x,Bg.y,Bg.z),Ig.push(0,0,1),Fg.x=(Bg.x/bg+1)/2,Fg.y=(Bg.y/bg+1)/2,Ug.push(Fg.x,Fg.y);Dg+=Ng}for(Rg=0;Rg<Sg;Rg++){var zg=Rg*(Tg+1);for(Lg=0;Lg<Tg;Lg++){var Gg=wg=Lg+zg,Hg=wg+Tg+1,Og=wg+Tg+2,Vg=wg+1;Pg.push(Gg,Hg,Vg),Pg.push(Hg,Og,Vg)}}this.setIndex(Pg),this.addAttribute('position',new ol(Cg,3)),this.addAttribute('normal',new ol(Ig,3)),this.addAttribute('uv',new ol(Ug,2))}function Md(Eg,bg,Tg,Sg,Mg,Ag,wg,Rg){Js.call(this),this.type='CylinderGeometry',this.parameters={radiusTop:Eg,radiusBottom:bg,height:Tg,radialSegments:Sg,heightSegments:Mg,openEnded:Ag,thetaStart:wg,thetaLength:Rg},this.fromBufferGeometry(new Ad(Eg,bg,Tg,Sg,Mg,Ag,wg,Rg)),this.mergeVertices()}function Ad(Eg,bg,Tg,Sg,Mg,Ag,wg,Rg){function Lg(Gg){var Wg=new Go,kg=new Wo,Xg=0,jg=!0===Gg?Eg:bg,Yg=!0===Gg?1:-1,Hg,Og,Vg;for(Og=Ng,Hg=1;Hg<=Sg;Hg++)Ig.push(0,Fg*Yg,0),Ug.push(0,Yg,0),Dg.push(.5,.5),Ng++;for(Vg=Ng,Hg=0;Hg<=Sg;Hg++){var qg=Hg/Sg*Rg+wg,Zg=Math.cos(qg),Jg=Math.sin(qg);kg.x=jg*Jg,kg.y=Fg*Yg,kg.z=jg*Zg,Ig.push(kg.x,kg.y,kg.z),Ug.push(0,Yg,0),Wg.x=.5*Zg+.5,Wg.y=.5*Jg*Yg+.5,Dg.push(Wg.x,Wg.y),Ng++}for(Hg=0;Hg<Sg;Hg++){var Qg=Og+Hg,Kg=Vg+Hg;!0===Gg?Cg.push(Kg,Kg+1,Qg):Cg.push(Kg+1,Kg,Qg),Xg+=3}Pg.addGroup(zg,Xg,!0===Gg?1:2),zg+=Xg}dl.call(this),this.type='CylinderBufferGeometry',this.parameters={radiusTop:Eg,radiusBottom:bg,height:Tg,radialSegments:Sg,heightSegments:Mg,openEnded:Ag,thetaStart:wg,thetaLength:Rg};var Pg=this;Eg=void 0===Eg?1:Eg,bg=void 0===bg?1:bg,Tg=Tg||1,Sg=Math.floor(Sg)||8,Mg=Math.floor(Mg)||1,Ag=void 0!==Ag&&Ag,wg=void 0===wg?0:wg,Rg=void 0===Rg?2*Math.PI:Rg;var Cg=[],Ig=[],Ug=[],Dg=[],Ng=0,Bg=[],Fg=Tg/2,zg=0;!function(){var Og=new Wo,Vg=new Wo,Wg=0,kg=(bg-Eg)/Tg,Gg,Hg;for(Hg=0;Hg<=Mg;Hg++){var Xg=[],jg=Hg/Mg,Yg=jg*(bg-Eg)+Eg;for(Gg=0;Gg<=Sg;Gg++){var qg=Gg/Sg,Zg=qg*Rg+wg,Jg=Math.sin(Zg),Qg=Math.cos(Zg);Vg.x=Yg*Jg,Vg.y=-jg*Tg+Fg,Vg.z=Yg*Qg,Ig.push(Vg.x,Vg.y,Vg.z),Og.set(Jg,kg,Qg).normalize(),Ug.push(Og.x,Og.y,Og.z),Dg.push(qg,1-jg),Xg.push(Ng++)}Bg.push(Xg)}for(Gg=0;Gg<Sg;Gg++)for(Hg=0;Hg<Mg;Hg++){var Kg=Bg[Hg][Gg],$g=Bg[Hg+1][Gg],ef=Bg[Hg+1][Gg+1],tf=Bg[Hg][Gg+1];Cg.push(Kg,$g,tf),Cg.push($g,ef,tf),Wg+=6}Pg.addGroup(zg,Wg,0),zg+=Wg}(),!1===Ag&&(0<Eg&&Lg(!0),0<bg&&Lg(!1)),this.setIndex(Cg),this.addAttribute('position',new ol(Ig,3)),this.addAttribute('normal',new ol(Ug,3)),this.addAttribute('uv',new ol(Dg,2))}function wd(Eg,bg,Tg,Sg,Mg,Ag,wg){Md.call(this,0,Eg,bg,Tg,Sg,Mg,Ag,wg),this.type='ConeGeometry',this.parameters={radius:Eg,height:bg,radialSegments:Tg,heightSegments:Sg,openEnded:Mg,thetaStart:Ag,thetaLength:wg}}function Rd(Eg,bg,Tg,Sg,Mg,Ag,wg){Ad.call(this,0,Eg,bg,Tg,Sg,Mg,Ag,wg),this.type='ConeBufferGeometry',this.parameters={radius:Eg,height:bg,radialSegments:Tg,heightSegments:Sg,openEnded:Mg,thetaStart:Ag,thetaLength:wg}}function Ld(Eg,bg,Tg,Sg){Js.call(this),this.type='CircleGeometry',this.parameters={radius:Eg,segments:bg,thetaStart:Tg,thetaLength:Sg},this.fromBufferGeometry(new Pd(Eg,bg,Tg,Sg)),this.mergeVertices()}function Pd(Eg,bg,Tg,Sg){dl.call(this),this.type='CircleBufferGeometry',this.parameters={radius:Eg,segments:bg,thetaStart:Tg,thetaLength:Sg},Eg=Eg||1,bg=void 0===bg?8:Math.max(3,bg),Tg=void 0===Tg?0:Tg,Sg=void 0===Sg?2*Math.PI:Sg;var wg=[],Rg=[],Lg=[],Pg=[],Cg=new Wo,Ig=new Go,Mg,Ag;for(Rg.push(0,0,0),Lg.push(0,0,1),Pg.push(.5,.5),Ag=0,Mg=3;Ag<=bg;Ag++,Mg+=3){var Ug=Tg+Ag/bg*Sg;Cg.x=Eg*Math.cos(Ug),Cg.y=Eg*Math.sin(Ug),Rg.push(Cg.x,Cg.y,Cg.z),Lg.push(0,0,1),Ig.x=(Rg[Mg]/Eg+1)/2,Ig.y=(Rg[Mg+1]/Eg+1)/2,Pg.push(Ig.x,Ig.y)}for(Mg=1;Mg<=bg;Mg++)wg.push(Mg,Mg+1,0);this.setIndex(wg),this.addAttribute('position',new ol(Rg,3)),this.addAttribute('normal',new ol(Lg,3)),this.addAttribute('uv',new ol(Pg,2))}function Cd(Eg){Ns.call(this),this.type='ShadowMaterial',this.color=new Ps(0),this.opacity=1,this.lights=!0,this.transparent=!0,this.setValues(Eg)}function Id(Eg){yl.call(this,Eg),this.type='RawShaderMaterial'}function Ud(Eg){Ns.call(this),this.type='MeshPhongMaterial',this.color=new Ps(16777215),this.specular=new Ps(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ps(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new Go(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=vm,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap='round',this.wireframeLinejoin='round',this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(Eg)}function Dd(Eg){Ns.call(this),this.type='MeshLambertMaterial',this.color=new Ps(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ps(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=vm,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap='round',this.wireframeLinejoin='round',this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(Eg)}function Nd(Eg){Ql.call(this),this.type='LineDashedMaterial',this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(Eg)}function Bd(Eg,bg,Tg){var Sg=this,Mg=!1,Ag=0,wg=0;this.onStart=void 0,this.onLoad=Eg,this.onProgress=bg,this.onError=Tg,this.itemStart=function(Rg){wg++,!1==Mg&&void 0!==Sg.onStart&&Sg.onStart(Rg,Ag,wg),Mg=!0},this.itemEnd=function(Rg){Ag++,void 0!==Sg.onProgress&&Sg.onProgress(Rg,Ag,wg),Ag==wg&&(Mg=!1,void 0!==Sg.onLoad&&Sg.onLoad())},this.itemError=function(Rg){void 0!==Sg.onError&&Sg.onError(Rg)}}function Fd(Eg){this.manager=void 0===Eg?tg:Eg}function zd(Eg){this.manager=void 0===Eg?tg:Eg,this._parser=null}function Gd(Eg){this.manager=void 0===Eg?tg:Eg,this._parser=null}function Hd(Eg){this.manager=void 0===Eg?tg:Eg}function Od(Eg){this.manager=void 0===Eg?tg:Eg}function Vd(Eg){this.manager=void 0===Eg?tg:Eg}function Wd(Eg,bg){js.call(this),this.type='Light',this.color=new Ps(Eg),this.intensity=void 0===bg?1:bg,this.receiveShadow=void 0}function kd(Eg,bg,Tg){Wd.call(this,Eg,Tg),this.type='HemisphereLight',this.castShadow=void 0,this.position.copy(js.DefaultUp),this.updateMatrix(),this.groundColor=new Ps(bg)}function Xd(Eg){this.camera=Eg,this.bias=0,this.radius=1,this.mapSize=new Go(512,512),this.map=null,this.matrix=new Ho}function jd(){Xd.call(this,new Fl(50,1,.5,500))}function Yd(Eg,bg,Tg,Sg,Mg,Ag){Wd.call(this,Eg,bg),this.type='SpotLight',this.position.copy(js.DefaultUp),this.updateMatrix(),this.target=new js,Object.defineProperty(this,'power',{get:function get(){return this.intensity*Math.PI},set:function set(wg){this.intensity=wg/Math.PI}}),this.distance=void 0===Tg?0:Tg,this.angle=void 0===Sg?Math.PI/3:Sg,this.penumbra=void 0===Mg?0:Mg,this.decay=void 0===Ag?1:Ag,this.shadow=new jd}function qd(Eg,bg,Tg,Sg){Wd.call(this,Eg,bg),this.type='PointLight',Object.defineProperty(this,'power',{get:function get(){return 4*this.intensity*Math.PI},set:function set(Mg){this.intensity=Mg/(4*Math.PI)}}),this.distance=void 0===Tg?0:Tg,this.decay=void 0===Sg?1:Sg,this.shadow=new Xd(new Fl(90,1,.5,500))}function Zd(){Xd.call(this,new qs(-5,5,5,-5,.5,500))}function Jd(Eg,bg){Wd.call(this,Eg,bg),this.type='DirectionalLight',this.position.copy(js.DefaultUp),this.updateMatrix(),this.target=new js,this.shadow=new Zd}function Qd(Eg,bg){Wd.call(this,Eg,bg),this.type='AmbientLight',this.castShadow=void 0}function Kd(Eg,bg,Tg,Sg){Wd.call(this,Eg,bg),this.type='RectAreaLight',this.position.set(0,1,0),this.updateMatrix(),this.width=void 0===Tg?10:Tg,this.height=void 0===Sg?10:Sg}function $d(Eg,bg,Tg,Sg){this.parameterPositions=Eg,this._cachedIndex=0,this.resultBuffer=void 0===Sg?new bg.constructor(Tg):Sg,this.sampleValues=bg,this.valueSize=Tg}function ep(Eg,bg,Tg,Sg){$d.call(this,Eg,bg,Tg,Sg),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function tp(Eg,bg,Tg,Sg){$d.call(this,Eg,bg,Tg,Sg)}function rp(Eg,bg,Tg,Sg){$d.call(this,Eg,bg,Tg,Sg)}function ap(Eg,bg,Tg,Sg){if(void 0===Eg)throw new Error('track name is undefined');if(void 0===bg||0===bg.length)throw new Error('no keyframes in track named '+Eg);this.name=Eg,this.times=ag.convertArray(bg,this.TimeBufferType),this.values=ag.convertArray(Tg,this.ValueBufferType),this.setInterpolation(Sg||this.DefaultInterpolation),this.validate(),this.optimize()}function ip(Eg,bg,Tg,Sg){ap.call(this,Eg,bg,Tg,Sg)}function op(Eg,bg,Tg,Sg){$d.call(this,Eg,bg,Tg,Sg)}function np(Eg,bg,Tg,Sg){ap.call(this,Eg,bg,Tg,Sg)}function sp(Eg,bg,Tg,Sg){ap.call(this,Eg,bg,Tg,Sg)}function lp(Eg,bg,Tg,Sg){ap.call(this,Eg,bg,Tg,Sg)}function dp(Eg,bg,Tg){ap.call(this,Eg,bg,Tg)}function pp(Eg,bg,Tg,Sg){ap.call(this,Eg,bg,Tg,Sg)}function cp(Eg,bg,Tg,Sg){ap.apply(this,Eg,bg,Tg,Sg)}function mp(Eg,bg,Tg){this.name=Eg,this.tracks=Tg,this.duration=void 0===bg?-1:bg,this.uuid=Iu.generateUUID(),0>this.duration&&this.resetDuration(),this.optimize()}function up(Eg){this.manager=void 0===Eg?tg:Eg,this.textures={}}function gp(Eg){this.manager=void 0===Eg?tg:Eg}function fp(){this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){}}function hp(Eg){'boolean'==typeof Eg&&(console.warn('THREE.JSONLoader: showStatus parameter has been removed from constructor.'),Eg=void 0),this.manager=void 0===Eg?tg:Eg,this.withCredentials=!1}function yp(Eg){this.manager=void 0===Eg?tg:Eg,this.texturePath=''}function xp(Eg,bg,Tg,Sg,Mg){var Ag=.5*(Sg-bg),wg=.5*(Mg-Tg),Rg=Eg*Eg;return(2*Tg-2*Sg+Ag+wg)*(Eg*Rg)+(-3*Tg+3*Sg-2*Ag-wg)*Rg+Ag*Eg+Tg}function vp(Eg,bg,Tg,Sg){return function(Mg,Ag){var wg=1-Mg;return wg*wg*Ag}(Eg,bg)+function(Mg,Ag){return 2*(1-Mg)*Mg*Ag}(Eg,Tg)+function(Mg,Ag){return Mg*Mg*Ag}(Eg,Sg)}function _p(Eg,bg,Tg,Sg,Mg){return function(Ag,wg){var Rg=1-Ag;return Rg*Rg*Rg*wg}(Eg,bg)+function(Ag,wg){var Rg=1-Ag;return 3*Rg*Rg*Ag*wg}(Eg,Tg)+function(Ag,wg){return 3*(1-Ag)*Ag*Ag*wg}(Eg,Sg)+function(Ag,wg){return Ag*Ag*Ag*wg}(Eg,Mg)}function Ep(){this.arcLengthDivisions=200}function bp(Eg,bg){Ep.call(this),this.v1=Eg,this.v2=bg}function Tp(){Ep.call(this),this.curves=[],this.autoClose=!1}function Sp(Eg,bg,Tg,Sg,Mg,Ag,wg,Rg){Ep.call(this),this.aX=Eg,this.aY=bg,this.xRadius=Tg,this.yRadius=Sg,this.aStartAngle=Mg,this.aEndAngle=Ag,this.aClockwise=wg,this.aRotation=Rg||0}function Mp(Eg){Ep.call(this),this.points=void 0===Eg?[]:Eg}function Ap(Eg,bg,Tg,Sg){Ep.call(this),this.v0=Eg,this.v1=bg,this.v2=Tg,this.v3=Sg}function wp(Eg,bg,Tg){Ep.call(this),this.v0=Eg,this.v1=bg,this.v2=Tg}function Rp(Eg){Tp.call(this),this.currentPoint=new Go,Eg&&this.fromPoints(Eg)}function Lp(){Rp.apply(this,arguments),this.holes=[]}function Pp(){this.subPaths=[],this.currentPath=null}function Cp(Eg){this.data=Eg}function Ip(Eg){this.manager=void 0===Eg?tg:Eg}function Up(Eg){this.manager=void 0===Eg?tg:Eg}function Dp(){this.type='StereoCamera',this.aspect=1,this.eyeSep=.064,this.cameraL=new Fl,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Fl,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1}function Np(){js.call(this),this.type='AudioListener',this.context=cg.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null}function Bp(Eg){js.call(this),this.type='Audio',this.context=Eg.context,this.gain=this.context.createGain(),this.gain.connect(Eg.getInput()),this.autoplay=!1,this.buffer=null,this.loop=!1,this.startTime=0,this.offset=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType='empty',this.filters=[]}function Fp(Eg){Bp.call(this,Eg),this.panner=this.context.createPanner(),this.panner.connect(this.gain)}function zp(Eg,bg){this.analyser=Eg.context.createAnalyser(),this.analyser.fftSize=void 0===bg?2048:bg,this.data=new Uint8Array(this.analyser.frequencyBinCount),Eg.getOutput().connect(this.analyser)}function Gp(Eg,bg,Tg){this.binding=Eg,this.valueSize=Tg;var Mg=Float64Array,Sg;'quaternion'===bg?Sg=this._slerp:'string'===bg||'bool'===bg?(Mg=Array,Sg=this._select):Sg=this._lerp;this.buffer=new Mg(4*Tg),this._mixBufferRegion=Sg,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}function Hp(Eg,bg,Tg){var Sg=Tg||Op.parseTrackName(bg);this._targetGroup=Eg,this._bindings=Eg.subscribe_(bg,Sg)}function Op(Eg,bg,Tg){this.path=bg,this.parsedPath=Tg||Op.parseTrackName(bg),this.node=Op.findNode(Eg,this.parsedPath.nodeName)||Eg,this.rootNode=Eg}function Vp(){this.uuid=Iu.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var Eg={};this._indicesByUUID=Eg;for(var bg=0,Tg=arguments.length;bg!==Tg;++bg)Eg[arguments[bg].uuid]=bg;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var Sg=this;this.stats={objects:{get total(){return Sg._objects.length},get inUse(){return this.total-Sg.nCachedObjects_}},get bindingsPerObject(){return Sg._bindings.length}}}function Wp(Eg,bg,Tg){this._mixer=Eg,this._clip=bg,this._localRoot=Tg||null;for(var Sg=bg.tracks,Mg=Sg.length,Ag=Array(Mg),wg={endingStart:vu,endingEnd:vu},Rg=0,Lg;Rg!==Mg;++Rg)Lg=Sg[Rg].createInterpolant(null),Ag[Rg]=Lg,Lg.settings=wg;this._interpolantSettings=wg,this._interpolants=Ag,this._propertyBindings=Array(Mg),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=xu,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function kp(Eg){this._root=Eg,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function Xp(Eg){'string'==typeof Eg&&(console.warn('THREE.Uniform: Type parameter is no longer needed.'),Eg=arguments[1]),this.value=Eg}function jp(){dl.call(this),this.type='InstancedBufferGeometry',this.maxInstancedCount=void 0}function Yp(Eg,bg,Tg,Sg){this.uuid=Iu.generateUUID(),this.data=Eg,this.itemSize=bg,this.offset=Tg,this.normalized=!0===Sg}function qp(Eg,bg){this.uuid=Iu.generateUUID(),this.array=Eg,this.stride=bg,this.count=void 0===Eg?0:Eg.length/bg,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.onUploadCallback=function(){},this.version=0}function Zp(Eg,bg,Tg){qp.call(this,Eg,bg),this.meshPerAttribute=Tg||1}function Jp(Eg,bg,Tg){Qs.call(this,Eg,bg),this.meshPerAttribute=Tg||1}function Qp(Eg,bg,Tg,Sg){this.ray=new xl(Eg,bg),this.near=Tg||0,this.far=Sg||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function get(){return console.warn('THREE.Raycaster: params.PointCloud has been renamed to params.Points.'),this.Points}}})}function Kp(Eg,bg){return Eg.distance-bg.distance}function $p(Eg,bg,Tg,Sg){if(!1!==Eg.visible&&(Eg.raycast(bg,Tg),!0===Sg))for(var Mg=Eg.children,Ag=0,wg=Mg.length;Ag<wg;Ag++)$p(Mg[Ag],bg,Tg,!0)}function ec(Eg){this.autoStart=void 0===Eg||Eg,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}function tc(Eg,bg,Tg){return this.radius=void 0===Eg?1:Eg,this.phi=void 0===bg?0:bg,this.theta=void 0===Tg?0:Tg,this}function rc(Eg,bg,Tg){return this.radius=void 0===Eg?1:Eg,this.theta=void 0===bg?0:bg,this.y=void 0===Tg?0:Tg,this}function ac(Eg){js.call(this),this.material=Eg,this.render=function(){}}function ic(Eg,bg,Tg,Sg){this.object=Eg,this.size=void 0===bg?1:bg;var Mg=void 0===Tg?16711680:Tg,Ag=void 0===Sg?1:Sg,wg=0,Rg=this.object.geometry;Rg&&Rg.isGeometry?wg=3*Rg.faces.length:Rg&&Rg.isBufferGeometry&&(wg=Rg.attributes.normal.count);var Lg=new dl,Pg=new ol(3*(2*wg),3);Lg.addAttribute('position',Pg),$l.call(this,Lg,new Ql({color:Mg,linewidth:Ag})),this.matrixAutoUpdate=!1,this.update()}function oc(Eg,bg){js.call(this),this.light=Eg,this.light.updateMatrixWorld(),this.matrix=Eg.matrixWorld,this.matrixAutoUpdate=!1,this.color=bg;for(var Tg=new dl,Sg=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],Mg=0,Ag=1;32>Mg;Mg++,Ag++){var wg=2*(Mg/32*Math.PI),Rg=2*(Ag/32*Math.PI);Sg.push(Math.cos(wg),Math.sin(wg),1,Math.cos(Rg),Math.sin(Rg),1)}Tg.addAttribute('position',new ol(Sg,3));var Lg=new Ql({fog:!1});this.cone=new $l(Tg,Lg),this.add(this.cone),this.update()}function nc(Eg){var bg=[];Eg&&Eg.isBone&&bg.push(Eg);for(var Tg=0;Tg<Eg.children.length;Tg++)bg.push.apply(bg,nc(Eg.children[Tg]));return bg}function sc(Eg){for(var bg=nc(Eg),Tg=new dl,Sg=[],Mg=[],Ag=new Ps(0,0,1),wg=new Ps(0,1,0),Rg=0,Lg;Rg<bg.length;Rg++)Lg=bg[Rg],Lg.parent&&Lg.parent.isBone&&(Sg.push(0,0,0),Sg.push(0,0,0),Mg.push(Ag.r,Ag.g,Ag.b),Mg.push(wg.r,wg.g,wg.b));Tg.addAttribute('position',new ol(Sg,3)),Tg.addAttribute('color',new ol(Mg,3));var Pg=new Ql({vertexColors:Vc,depthTest:!1,depthWrite:!1,transparent:!0});$l.call(this,Tg,Pg),this.root=Eg,this.bones=bg,this.matrix=Eg.matrixWorld,this.matrixAutoUpdate=!1}function lc(Eg,bg,Tg){this.light=Eg,this.light.updateMatrixWorld(),this.color=Tg;var Sg=new bd(bg,4,2),Mg=new hl({wireframe:!0,fog:!1});El.call(this,Sg,Mg),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function dc(Eg,bg){js.call(this),this.light=Eg,this.light.updateMatrixWorld(),this.matrix=Eg.matrixWorld,this.matrixAutoUpdate=!1,this.color=bg;var Tg=new Ql({fog:!1}),Sg=new dl;Sg.addAttribute('position',new Qs(new Float32Array(15),3)),this.line=new Kl(Sg,Tg),this.add(this.line),this.update()}function pc(Eg,bg,Tg){js.call(this),this.light=Eg,this.light.updateMatrixWorld(),this.matrix=Eg.matrixWorld,this.matrixAutoUpdate=!1,this.color=Tg;var Sg=new gd(bg);Sg.rotateY(.5*Math.PI),this.material=new hl({wireframe:!0,fog:!1}),void 0===this.color&&(this.material.vertexColors=Vc);var Mg=Sg.getAttribute('position'),Ag=new Float32Array(3*Mg.count);Sg.addAttribute('color',new Qs(Ag,3)),this.add(new El(Sg,this.material)),this.update()}function cc(Eg,bg,Tg,Sg){Eg=Eg||10,bg=bg||10,Tg=new Ps(void 0===Tg?4473924:Tg),Sg=new Ps(void 0===Sg?8947848:Sg);for(var Mg=bg/2,Ag=Eg/bg,wg=Eg/2,Rg=[],Lg=[],Pg=0,Cg=0,Ig=-wg;Pg<=bg;Pg++,Ig+=Ag){Rg.push(-wg,0,Ig,wg,0,Ig),Rg.push(Ig,0,-wg,Ig,0,wg);var Ug=Pg===Mg?Tg:Sg;Ug.toArray(Lg,Cg),Cg+=3,Ug.toArray(Lg,Cg),Cg+=3,Ug.toArray(Lg,Cg),Cg+=3,Ug.toArray(Lg,Cg),Cg+=3}var Dg=new dl;Dg.addAttribute('position',new ol(Rg,3)),Dg.addAttribute('color',new ol(Lg,3));var Ng=new Ql({vertexColors:Vc});$l.call(this,Dg,Ng)}function mc(Eg,bg,Tg,Sg,Mg,Ag){Eg=Eg||10,bg=bg||16,Tg=Tg||8,Sg=Sg||64,Mg=new Ps(void 0===Mg?4473924:Mg),Ag=new Ps(void 0===Ag?8947848:Ag);var Dg=[],Ng=[],wg,Rg,Lg,Pg,Cg,Ig,Ug;for(Pg=0;Pg<=bg;Pg++)Lg=Pg/bg*(2*Math.PI),wg=Math.sin(Lg)*Eg,Rg=Math.cos(Lg)*Eg,Dg.push(0,0,0),Dg.push(wg,0,Rg),Ug=1&Pg?Mg:Ag,Ng.push(Ug.r,Ug.g,Ug.b),Ng.push(Ug.r,Ug.g,Ug.b);for(Pg=0;Pg<=Tg;Pg++)for(Ug=1&Pg?Mg:Ag,Ig=Eg-Eg/Tg*Pg,Cg=0;Cg<Sg;Cg++)Lg=Cg/Sg*(2*Math.PI),wg=Math.sin(Lg)*Ig,Rg=Math.cos(Lg)*Ig,Dg.push(wg,0,Rg),Ng.push(Ug.r,Ug.g,Ug.b),Lg=(Cg+1)/Sg*(2*Math.PI),wg=Math.sin(Lg)*Ig,Rg=Math.cos(Lg)*Ig,Dg.push(wg,0,Rg),Ng.push(Ug.r,Ug.g,Ug.b);var Bg=new dl;Bg.addAttribute('position',new ol(Dg,3)),Bg.addAttribute('color',new ol(Ng,3));var Fg=new Ql({vertexColors:Vc});$l.call(this,Bg,Fg)}function uc(Eg,bg,Tg,Sg){this.object=Eg,this.size=void 0===bg?1:bg;var Mg=void 0===Tg?16776960:Tg,Ag=void 0===Sg?1:Sg,wg=0,Rg=this.object.geometry;Rg&&Rg.isGeometry?wg=Rg.faces.length:console.warn('THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.');var Lg=new dl,Pg=new ol(3*(2*wg),3);Lg.addAttribute('position',Pg),$l.call(this,Lg,new Ql({color:Mg,linewidth:Ag})),this.matrixAutoUpdate=!1,this.update()}function gc(Eg,bg,Tg){js.call(this),this.light=Eg,this.light.updateMatrixWorld(),this.matrix=Eg.matrixWorld,this.matrixAutoUpdate=!1,this.color=Tg,void 0===bg&&(bg=1);var Sg=new dl;Sg.addAttribute('position',new ol([-bg,bg,0,bg,bg,0,bg,-bg,0,-bg,-bg,0,-bg,bg,0],3));var Mg=new Ql({fog:!1});this.lightPlane=new Kl(Sg,Mg),this.add(this.lightPlane),(Sg=new dl).addAttribute('position',new ol([0,0,0,0,0,1],3)),this.targetLine=new Kl(Sg,Mg),this.add(this.targetLine),this.update()}function fc(Eg){function bg(Dg,Ng,Bg){Tg(Dg,Bg),Tg(Ng,Bg)}function Tg(Dg,Ng){Ag.push(0,0,0),wg.push(Ng.r,Ng.g,Ng.b),void 0===Rg[Dg]&&(Rg[Dg]=[]),Rg[Dg].push(Ag.length/3-1)}var Sg=new dl,Mg=new Ql({color:16777215,vertexColors:Oc}),Ag=[],wg=[],Rg={},Lg=new Ps(16755200),Pg=new Ps(16711680),Cg=new Ps(43775),Ig=new Ps(16777215),Ug=new Ps(3355443);bg('n1','n2',Lg),bg('n2','n4',Lg),bg('n4','n3',Lg),bg('n3','n1',Lg),bg('f1','f2',Lg),bg('f2','f4',Lg),bg('f4','f3',Lg),bg('f3','f1',Lg),bg('n1','f1',Lg),bg('n2','f2',Lg),bg('n3','f3',Lg),bg('n4','f4',Lg),bg('p','n1',Pg),bg('p','n2',Pg),bg('p','n3',Pg),bg('p','n4',Pg),bg('u1','u2',Cg),bg('u2','u3',Cg),bg('u3','u1',Cg),bg('c','t',Ig),bg('p','c',Ug),bg('cn1','cn2',Ug),bg('cn3','cn4',Ug),bg('cf1','cf2',Ug),bg('cf3','cf4',Ug),Sg.addAttribute('position',new ol(Ag,3)),Sg.addAttribute('color',new ol(wg,3)),$l.call(this,Sg,Mg),this.camera=Eg,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=Eg.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=Rg,this.update()}function hc(Eg,bg){this.object=Eg,void 0===bg&&(bg=16776960);var Tg=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),Sg=new Float32Array(24),Mg=new dl;Mg.setIndex(new Qs(Tg,1)),Mg.addAttribute('position',new Qs(Sg,3)),$l.call(this,Mg,new Ql({color:bg})),this.matrixAutoUpdate=!1,this.update()}function yc(Eg,bg){this.type='Box3Helper',this.box=Eg;var Tg=void 0===bg?16776960:bg,Sg=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),Mg=new dl;Mg.setIndex(new Qs(Sg,1)),Mg.addAttribute('position',new ol([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),$l.call(this,Mg,new Ql({color:Tg})),this.geometry.computeBoundingSphere()}function xc(Eg,bg,Tg){this.type='PlaneHelper',this.plane=Eg,this.size=void 0===bg?1:bg;var Sg=void 0===Tg?16776960:Tg,Mg=new dl;Mg.addAttribute('position',new ol([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),Mg.computeBoundingSphere(),Kl.call(this,Mg,new Ql({color:Sg}));var Ag=new dl;Ag.addAttribute('position',new ol([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),Ag.computeBoundingSphere(),this.add(new El(Ag,new hl({color:Sg,opacity:.2,transparent:!0,depthWrite:!1})))}function vc(Eg,bg,Tg,Sg,Mg,Ag){js.call(this),void 0===Sg&&(Sg=16776960),void 0===Tg&&(Tg=1),void 0===Mg&&(Mg=.2*Tg),void 0===Ag&&(Ag=.2*Mg),void 0===mg&&((mg=new dl).addAttribute('position',new ol([0,0,0,0,1,0],3)),(ug=new Ad(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(bg),this.line=new Kl(mg,new Ql({color:Sg})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new El(ug,new hl({color:Sg})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(Eg),this.setLength(Tg,Mg,Ag)}function _c(Eg){var bg=[0,0,0,Eg=Eg||1,0,0,0,0,0,0,Eg,0,0,0,0,0,0,Eg],Tg=new dl;Tg.addAttribute('position',new ol(bg,3)),Tg.addAttribute('color',new ol([1,0,0,1,0.6,0,0,1,0,0.6,1,0,0,0,1,0,0.6,1],3));var Sg=new Ql({vertexColors:Vc});$l.call(this,Tg,Sg)}function Ec(){function Eg(Ag,wg,Rg,Lg){bg=Ag,Tg=Rg,Sg=-3*Ag+3*wg-2*Rg-Lg,Mg=2*Ag-2*wg+Rg+Lg}var bg=0,Tg=0,Sg=0,Mg=0;return{initCatmullRom:function initCatmullRom(Ag,wg,Rg,Lg,Pg){Eg(wg,Rg,Pg*(Rg-Ag),Pg*(Lg-wg))},initNonuniformCatmullRom:function initNonuniformCatmullRom(Ag,wg,Rg,Lg,Pg,Cg,Ig){var Ug=(wg-Ag)/Pg-(Rg-Ag)/(Pg+Cg)+(Rg-wg)/Cg,Dg=(Rg-wg)/Cg-(Lg-wg)/(Cg+Ig)+(Lg-Rg)/Ig;Eg(wg,Rg,Ug*=Cg,Dg*=Cg)},calc:function calc(Ag){var wg=Ag*Ag;return bg+Tg*Ag+Sg*wg+Mg*(wg*Ag)}}}function bc(Eg){Ep.call(this),2>Eg.length&&console.warn('THREE.CatmullRomCurve3: Points array needs at least two entries.'),this.points=Eg||[],this.closed=!1}function Tc(Eg,bg,Tg,Sg){Ep.call(this),this.v0=Eg,this.v1=bg,this.v2=Tg,this.v3=Sg}function Sc(Eg,bg,Tg){Ep.call(this),this.v0=Eg,this.v1=bg,this.v2=Tg}function Mc(Eg,bg){Ep.call(this),this.v1=Eg,this.v2=bg}function Ac(Eg,bg,Tg,Sg,Mg,Ag){Sp.call(this,Eg,bg,Tg,Tg,Sg,Mg,Ag)}function wc(Eg){console.warn('THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead.'),bc.call(this,Eg),this.type='catmullrom',this.closed=!0}function Rc(Eg){console.warn('THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead.'),bc.call(this,Eg),this.type='catmullrom'}function Lc(Eg){console.warn('THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead.'),bc.call(this,Eg),this.type='catmullrom'}console.log('------',No),void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(Eg){return'number'==typeof Eg&&isFinite(Eg)&&Math.floor(Eg)===Eg}),void 0===Math.sign&&(Math.sign=function(Eg){return 0>Eg?-1:0<Eg?1:+Eg}),!1=='name'in Function.prototype&&Object.defineProperty(Function.prototype,'name',{get:function get(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(Eg){if(void 0===Eg||null===Eg)throw new TypeError('Cannot convert undefined or null to object');for(var bg=Object(Eg),Tg=1,Sg;Tg<arguments.length;Tg++)if(Sg=arguments[Tg],void 0!==Sg&&null!==Sg)for(var Mg in Sg)Object.prototype.hasOwnProperty.call(Sg,Mg)&&(bg[Mg]=Sg[Mg]);return bg}),Object.assign(Fo.prototype,{addEventListener:function addEventListener(Eg,bg){void 0===this._listeners&&(this._listeners={});var Tg=this._listeners;void 0===Tg[Eg]&&(Tg[Eg]=[]),-1===Tg[Eg].indexOf(bg)&&Tg[Eg].push(bg)},hasEventListener:function hasEventListener(Eg,bg){if(void 0===this._listeners)return!1;var Tg=this._listeners;return void 0!==Tg[Eg]&&-1!==Tg[Eg].indexOf(bg)},removeEventListener:function removeEventListener(Eg,bg){if(void 0!==this._listeners){var Tg=this._listeners[Eg];if(void 0!==Tg){var Sg=Tg.indexOf(bg);-1!==Sg&&Tg.splice(Sg,1)}}},dispatchEvent:function dispatchEvent(Eg){if(void 0!==this._listeners){var bg=this._listeners[Eg.type];if(void 0!==bg){Eg.target=this;for(var Tg=bg.slice(0),Sg=0,Mg=Tg.length;Sg<Mg;Sg++)Tg[Sg].call(this,Eg)}}}});var Pc='88dev',Cc=0,Ic=1,Uc=2,Dc=0,Nc=1,Bc=2,Fc=0,zc=1,Gc=2,Hc=0,Oc=1,Vc=2,Wc=0,kc=1,Xc=2,jc=3,Yc=4,qc=5,Zc=100,Jc=101,Qc=102,Kc=103,$c=104,em=200,tm=201,rm=202,am=203,im=204,om=205,nm=206,sm=207,lm=208,dm=209,pm=210,cm=0,mm=1,um=2,gm=3,fm=4,hm=5,ym=6,xm=7,vm=0,_m=1,Em=2,bm=0,Tm=1,Sm=2,Mm=3,Am=4,wm=301,Rm=302,Lm=303,Pm=304,Cm=305,Im=306,Um=307,Dm=1e3,Nm=1001,Bm=1002,Fm=1003,zm=1004,Gm=1005,Hm=1006,Om=1007,Vm=1008,Wm=1009,km=1010,Xm=1011,jm=1012,Ym=1013,qm=1014,Zm=1015,Jm=1016,Qm=1017,Km=1018,$m=1019,eu=1020,tu=1021,ru=1022,au=1023,iu=1024,ou=1025,su=1026,lu=1027,du=2001,pu=2002,cu=2003,mu=2004,uu=2100,gu=2101,fu=2102,hu=2103,yu=2151,xu=2201,vu=2400,_u=0,Eu=1,bu=2,Tu=3e3,Su=3001,Mu=3007,Au=3002,wu=3004,Ru=3005,Lu=3006,Pu=3200,Cu=3201,Iu={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var bg='0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'.split(''),Tg=Array(36),Sg=0,Eg;return function(){for(var Mg=0;36>Mg;Mg++)8===Mg||13===Mg||18===Mg||23===Mg?Tg[Mg]='-':14===Mg?Tg[Mg]='4':(2>=Sg&&(Sg=0|33554432+16777216*Math.random()),Eg=15&Sg,Sg>>=4,Tg[Mg]=bg[19===Mg?8|3&Eg:Eg]);return Tg.join('')}}(),clamp:function clamp(Eg,bg,Tg){return Math.max(bg,Math.min(Tg,Eg))},euclideanModulo:function euclideanModulo(Eg,bg){return(Eg%bg+bg)%bg},mapLinear:function mapLinear(Eg,bg,Tg,Sg,Mg){return Sg+(Eg-bg)*(Mg-Sg)/(Tg-bg)},lerp:function lerp(Eg,bg,Tg){return(1-Tg)*Eg+Tg*bg},smoothstep:function smoothstep(Eg,bg,Tg){return Eg<=bg?0:Eg>=Tg?1:(Eg=(Eg-bg)/(Tg-bg))*Eg*(3-2*Eg)},smootherstep:function smootherstep(Eg,bg,Tg){return Eg<=bg?0:Eg>=Tg?1:(Eg=(Eg-bg)/(Tg-bg))*Eg*Eg*(Eg*(6*Eg-15)+10)},randInt:function randInt(Eg,bg){return Eg+Math.floor(Math.random()*(bg-Eg+1))},randFloat:function randFloat(Eg,bg){return Eg+Math.random()*(bg-Eg)},randFloatSpread:function randFloatSpread(Eg){return Eg*(.5-Math.random())},degToRad:function degToRad(Eg){return Eg*Iu.DEG2RAD},radToDeg:function radToDeg(Eg){return Eg*Iu.RAD2DEG},isPowerOfTwo:function isPowerOfTwo(Eg){return 0==(Eg&Eg-1)&&0!==Eg},ceilPowerOfTwo:function ceilPowerOfTwo(Eg){return Math.pow(2,Math.ceil(Math.log(Eg)/Math.LN2))},floorPowerOfTwo:function floorPowerOfTwo(Eg){return Math.pow(2,Math.floor(Math.log(Eg)/Math.LN2))}};Object.defineProperties(Go.prototype,{width:{get:function get(){return this.x},set:function set(Eg){this.x=Eg}},height:{get:function get(){return this.y},set:function set(Eg){this.y=Eg}}}),Object.assign(Go.prototype,{isVector2:!0,set:function set(Eg,bg){return this.x=Eg,this.y=bg,this},setScalar:function setScalar(Eg){return this.x=Eg,this.y=Eg,this},setX:function setX(Eg){return this.x=Eg,this},setY:function setY(Eg){return this.y=Eg,this},setComponent:function setComponent(Eg,bg){switch(Eg){case 0:this.x=bg;break;case 1:this.y=bg;break;default:throw new Error('index is out of range: '+Eg);}return this},getComponent:function getComponent(Eg){switch(Eg){case 0:return this.x;case 1:return this.y;default:throw new Error('index is out of range: '+Eg);}},clone:function clone(){return new this.constructor(this.x,this.y)},copy:function copy(Eg){return this.x=Eg.x,this.y=Eg.y,this},add:function add(Eg,bg){return void 0===bg?(this.x+=Eg.x,this.y+=Eg.y,this):(console.warn('THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead.'),this.addVectors(Eg,bg))},addScalar:function addScalar(Eg){return this.x+=Eg,this.y+=Eg,this},addVectors:function addVectors(Eg,bg){return this.x=Eg.x+bg.x,this.y=Eg.y+bg.y,this},addScaledVector:function addScaledVector(Eg,bg){return this.x+=Eg.x*bg,this.y+=Eg.y*bg,this},sub:function sub(Eg,bg){return void 0===bg?(this.x-=Eg.x,this.y-=Eg.y,this):(console.warn('THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.'),this.subVectors(Eg,bg))},subScalar:function subScalar(Eg){return this.x-=Eg,this.y-=Eg,this},subVectors:function subVectors(Eg,bg){return this.x=Eg.x-bg.x,this.y=Eg.y-bg.y,this},multiply:function multiply(Eg){return this.x*=Eg.x,this.y*=Eg.y,this},multiplyScalar:function multiplyScalar(Eg){return this.x*=Eg,this.y*=Eg,this},divide:function divide(Eg){return this.x/=Eg.x,this.y/=Eg.y,this},divideScalar:function divideScalar(Eg){return this.multiplyScalar(1/Eg)},applyMatrix3:function applyMatrix3(Eg){var bg=this.x,Tg=this.y,Sg=Eg.elements;return this.x=Sg[0]*bg+Sg[3]*Tg+Sg[6],this.y=Sg[1]*bg+Sg[4]*Tg+Sg[7],this},min:function min(Eg){return this.x=Math.min(this.x,Eg.x),this.y=Math.min(this.y,Eg.y),this},max:function max(Eg){return this.x=Math.max(this.x,Eg.x),this.y=Math.max(this.y,Eg.y),this},clamp:function clamp(Eg,bg){return this.x=Math.max(Eg.x,Math.min(bg.x,this.x)),this.y=Math.max(Eg.y,Math.min(bg.y,this.y)),this},clampScalar:function(){var Eg=new Go,bg=new Go;return function(Tg,Sg){return Eg.set(Tg,Tg),bg.set(Sg,Sg),this.clamp(Eg,bg)}}(),clampLength:function clampLength(Eg,bg){var Tg=this.length();return this.divideScalar(Tg||1).multiplyScalar(Math.max(Eg,Math.min(bg,Tg)))},floor:function floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function roundToZero(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this},negate:function negate(){return this.x=-this.x,this.y=-this.y,this},dot:function dot(Eg){return this.x*Eg.x+this.y*Eg.y},lengthSq:function lengthSq(){return this.x*this.x+this.y*this.y},length:function length(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function normalize(){return this.divideScalar(this.length()||1)},angle:function angle(){var Eg=Math.atan2(this.y,this.x);return 0>Eg&&(Eg+=2*Math.PI),Eg},distanceTo:function distanceTo(Eg){return Math.sqrt(this.distanceToSquared(Eg))},distanceToSquared:function distanceToSquared(Eg){var bg=this.x-Eg.x,Tg=this.y-Eg.y;return bg*bg+Tg*Tg},manhattanDistanceTo:function manhattanDistanceTo(Eg){return Math.abs(this.x-Eg.x)+Math.abs(this.y-Eg.y)},setLength:function setLength(Eg){return this.normalize().multiplyScalar(Eg)},lerp:function lerp(Eg,bg){return this.x+=(Eg.x-this.x)*bg,this.y+=(Eg.y-this.y)*bg,this},lerpVectors:function lerpVectors(Eg,bg,Tg){return this.subVectors(bg,Eg).multiplyScalar(Tg).add(Eg)},equals:function equals(Eg){return Eg.x===this.x&&Eg.y===this.y},fromArray:function fromArray(Eg,bg){return void 0===bg&&(bg=0),this.x=Eg[bg],this.y=Eg[bg+1],this},toArray:function toArray(Eg,bg){return void 0===Eg&&(Eg=[]),void 0===bg&&(bg=0),Eg[bg]=this.x,Eg[bg+1]=this.y,Eg},fromBufferAttribute:function fromBufferAttribute(Eg,bg,Tg){return void 0!==Tg&&console.warn('THREE.Vector2: offset has been removed from .fromBufferAttribute().'),this.x=Eg.getX(bg),this.y=Eg.getY(bg),this},rotateAround:function rotateAround(Eg,bg){var Tg=Math.cos(bg),Sg=Math.sin(bg),Mg=this.x-Eg.x,Ag=this.y-Eg.y;return this.x=Mg*Tg-Ag*Sg+Eg.x,this.y=Mg*Sg+Ag*Tg+Eg.y,this}}),Object.assign(Ho.prototype,{isMatrix4:!0,set:function set(Eg,bg,Tg,Sg,Mg,Ag,wg,Rg,Lg,Pg,Cg,Ig,Ug,Dg,Ng,Bg){var Fg=this.elements;return Fg[0]=Eg,Fg[4]=bg,Fg[8]=Tg,Fg[12]=Sg,Fg[1]=Mg,Fg[5]=Ag,Fg[9]=wg,Fg[13]=Rg,Fg[2]=Lg,Fg[6]=Pg,Fg[10]=Cg,Fg[14]=Ig,Fg[3]=Ug,Fg[7]=Dg,Fg[11]=Ng,Fg[15]=Bg,this},identity:function identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function clone(){return new Ho().fromArray(this.elements)},copy:function copy(Eg){var bg=this.elements,Tg=Eg.elements;return bg[0]=Tg[0],bg[1]=Tg[1],bg[2]=Tg[2],bg[3]=Tg[3],bg[4]=Tg[4],bg[5]=Tg[5],bg[6]=Tg[6],bg[7]=Tg[7],bg[8]=Tg[8],bg[9]=Tg[9],bg[10]=Tg[10],bg[11]=Tg[11],bg[12]=Tg[12],bg[13]=Tg[13],bg[14]=Tg[14],bg[15]=Tg[15],this},copyPosition:function copyPosition(Eg){var bg=this.elements,Tg=Eg.elements;return bg[12]=Tg[12],bg[13]=Tg[13],bg[14]=Tg[14],this},extractBasis:function extractBasis(Eg,bg,Tg){return Eg.setFromMatrixColumn(this,0),bg.setFromMatrixColumn(this,1),Tg.setFromMatrixColumn(this,2),this},makeBasis:function makeBasis(Eg,bg,Tg){return this.set(Eg.x,bg.x,Tg.x,0,Eg.y,bg.y,Tg.y,0,Eg.z,bg.z,Tg.z,0,0,0,0,1),this},extractRotation:function(){var Eg=new Wo;return function(bg){var Tg=this.elements,Sg=bg.elements,Mg=1/Eg.setFromMatrixColumn(bg,0).length(),Ag=1/Eg.setFromMatrixColumn(bg,1).length(),wg=1/Eg.setFromMatrixColumn(bg,2).length();return Tg[0]=Sg[0]*Mg,Tg[1]=Sg[1]*Mg,Tg[2]=Sg[2]*Mg,Tg[4]=Sg[4]*Ag,Tg[5]=Sg[5]*Ag,Tg[6]=Sg[6]*Ag,Tg[8]=Sg[8]*wg,Tg[9]=Sg[9]*wg,Tg[10]=Sg[10]*wg,this}}(),makeRotationFromEuler:function makeRotationFromEuler(Eg){Eg&&Eg.isEuler||console.error('THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.');var bg=this.elements,Tg=Eg.x,Sg=Eg.y,Mg=Eg.z,Ag=Math.cos(Tg),wg=Math.sin(Tg),Rg=Math.cos(Sg),Lg=Math.sin(Sg),Pg=Math.cos(Mg),Cg=Math.sin(Mg);if('XYZ'===Eg.order){var Ig=Ag*Pg,Ug=Ag*Cg,Dg=wg*Pg,Ng=wg*Cg;bg[0]=Rg*Pg,bg[4]=-Rg*Cg,bg[8]=Lg,bg[1]=Ug+Dg*Lg,bg[5]=Ig-Ng*Lg,bg[9]=-wg*Rg,bg[2]=Ng-Ig*Lg,bg[6]=Dg+Ug*Lg,bg[10]=Ag*Rg}else if('YXZ'===Eg.order){var Bg=Rg*Pg,Fg=Rg*Cg,zg=Lg*Pg,Gg=Lg*Cg;bg[0]=Bg+Gg*wg,bg[4]=zg*wg-Fg,bg[8]=Ag*Lg,bg[1]=Ag*Cg,bg[5]=Ag*Pg,bg[9]=-wg,bg[2]=Fg*wg-zg,bg[6]=Gg+Bg*wg,bg[10]=Ag*Rg}else if('ZXY'===Eg.order){var Bg=Rg*Pg,Fg=Rg*Cg,zg=Lg*Pg,Gg=Lg*Cg;bg[0]=Bg-Gg*wg,bg[4]=-Ag*Cg,bg[8]=zg+Fg*wg,bg[1]=Fg+zg*wg,bg[5]=Ag*Pg,bg[9]=Gg-Bg*wg,bg[2]=-Ag*Lg,bg[6]=wg,bg[10]=Ag*Rg}else if('ZYX'===Eg.order){var Ig=Ag*Pg,Ug=Ag*Cg,Dg=wg*Pg,Ng=wg*Cg;bg[0]=Rg*Pg,bg[4]=Dg*Lg-Ug,bg[8]=Ig*Lg+Ng,bg[1]=Rg*Cg,bg[5]=Ng*Lg+Ig,bg[9]=Ug*Lg-Dg,bg[2]=-Lg,bg[6]=wg*Rg,bg[10]=Ag*Rg}else if('YZX'===Eg.order){var Hg=Ag*Rg,Og=Ag*Lg,Vg=wg*Rg,Wg=wg*Lg;bg[0]=Rg*Pg,bg[4]=Wg-Hg*Cg,bg[8]=Vg*Cg+Og,bg[1]=Cg,bg[5]=Ag*Pg,bg[9]=-wg*Pg,bg[2]=-Lg*Pg,bg[6]=Og*Cg+Vg,bg[10]=Hg-Wg*Cg}else if('XZY'===Eg.order){var Hg=Ag*Rg,Og=Ag*Lg,Vg=wg*Rg,Wg=wg*Lg;bg[0]=Rg*Pg,bg[4]=-Cg,bg[8]=Lg*Pg,bg[1]=Hg*Cg+Wg,bg[5]=Ag*Pg,bg[9]=Og*Cg-Vg,bg[2]=Vg*Cg-Og,bg[6]=wg*Pg,bg[10]=Wg*Cg+Hg}return bg[3]=0,bg[7]=0,bg[11]=0,bg[12]=0,bg[13]=0,bg[14]=0,bg[15]=1,this},makeRotationFromQuaternion:function makeRotationFromQuaternion(Eg){var bg=this.elements,Tg=Eg._x,Sg=Eg._y,Mg=Eg._z,Ag=Eg._w,wg=Tg+Tg,Rg=Sg+Sg,Lg=Mg+Mg,Pg=Tg*wg,Cg=Tg*Rg,Ig=Tg*Lg,Ug=Sg*Rg,Dg=Sg*Lg,Ng=Mg*Lg,Bg=Ag*wg,Fg=Ag*Rg,zg=Ag*Lg;return bg[0]=1-(Ug+Ng),bg[4]=Cg-zg,bg[8]=Ig+Fg,bg[1]=Cg+zg,bg[5]=1-(Pg+Ng),bg[9]=Dg-Bg,bg[2]=Ig-Fg,bg[6]=Dg+Bg,bg[10]=1-(Pg+Ug),bg[3]=0,bg[7]=0,bg[11]=0,bg[12]=0,bg[13]=0,bg[14]=0,bg[15]=1,this},lookAt:function(){var Eg=new Wo,bg=new Wo,Tg=new Wo;return function(Sg,Mg,Ag){var wg=this.elements;return Tg.subVectors(Sg,Mg),0===Tg.lengthSq()&&(Tg.z=1),Tg.normalize(),Eg.crossVectors(Ag,Tg),0===Eg.lengthSq()&&(1===Math.abs(Ag.z)?Tg.x+=1e-4:Tg.z+=1e-4,Tg.normalize(),Eg.crossVectors(Ag,Tg)),Eg.normalize(),bg.crossVectors(Tg,Eg),wg[0]=Eg.x,wg[4]=bg.x,wg[8]=Tg.x,wg[1]=Eg.y,wg[5]=bg.y,wg[9]=Tg.y,wg[2]=Eg.z,wg[6]=bg.z,wg[10]=Tg.z,this}}(),multiply:function multiply(Eg,bg){return void 0===bg?this.multiplyMatrices(this,Eg):(console.warn('THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead.'),this.multiplyMatrices(Eg,bg))},premultiply:function premultiply(Eg){return this.multiplyMatrices(Eg,this)},multiplyMatrices:function multiplyMatrices(Eg,bg){var Tg=Eg.elements,Sg=bg.elements,Mg=this.elements,Ag=Tg[0],wg=Tg[4],Rg=Tg[8],Lg=Tg[12],Pg=Tg[1],Cg=Tg[5],Ig=Tg[9],Ug=Tg[13],Dg=Tg[2],Ng=Tg[6],Bg=Tg[10],Fg=Tg[14],zg=Tg[3],Gg=Tg[7],Hg=Tg[11],Og=Tg[15],Vg=Sg[0],Wg=Sg[4],kg=Sg[8],Xg=Sg[12],jg=Sg[1],Yg=Sg[5],qg=Sg[9],Zg=Sg[13],Jg=Sg[2],Qg=Sg[6],Kg=Sg[10],$g=Sg[14],ef=Sg[3],tf=Sg[7],rf=Sg[11],af=Sg[15];return Mg[0]=Ag*Vg+wg*jg+Rg*Jg+Lg*ef,Mg[4]=Ag*Wg+wg*Yg+Rg*Qg+Lg*tf,Mg[8]=Ag*kg+wg*qg+Rg*Kg+Lg*rf,Mg[12]=Ag*Xg+wg*Zg+Rg*$g+Lg*af,Mg[1]=Pg*Vg+Cg*jg+Ig*Jg+Ug*ef,Mg[5]=Pg*Wg+Cg*Yg+Ig*Qg+Ug*tf,Mg[9]=Pg*kg+Cg*qg+Ig*Kg+Ug*rf,Mg[13]=Pg*Xg+Cg*Zg+Ig*$g+Ug*af,Mg[2]=Dg*Vg+Ng*jg+Bg*Jg+Fg*ef,Mg[6]=Dg*Wg+Ng*Yg+Bg*Qg+Fg*tf,Mg[10]=Dg*kg+Ng*qg+Bg*Kg+Fg*rf,Mg[14]=Dg*Xg+Ng*Zg+Bg*$g+Fg*af,Mg[3]=zg*Vg+Gg*jg+Hg*Jg+Og*ef,Mg[7]=zg*Wg+Gg*Yg+Hg*Qg+Og*tf,Mg[11]=zg*kg+Gg*qg+Hg*Kg+Og*rf,Mg[15]=zg*Xg+Gg*Zg+Hg*$g+Og*af,this},multiplyScalar:function multiplyScalar(Eg){var bg=this.elements;return bg[0]*=Eg,bg[4]*=Eg,bg[8]*=Eg,bg[12]*=Eg,bg[1]*=Eg,bg[5]*=Eg,bg[9]*=Eg,bg[13]*=Eg,bg[2]*=Eg,bg[6]*=Eg,bg[10]*=Eg,bg[14]*=Eg,bg[3]*=Eg,bg[7]*=Eg,bg[11]*=Eg,bg[15]*=Eg,this},applyToBufferAttribute:function(){var Eg=new Wo;return function(bg){for(var Tg=0,Sg=bg.count;Tg<Sg;Tg++)Eg.x=bg.getX(Tg),Eg.y=bg.getY(Tg),Eg.z=bg.getZ(Tg),Eg.applyMatrix4(this),bg.setXYZ(Tg,Eg.x,Eg.y,Eg.z);return bg}}(),determinant:function determinant(){var Eg=this.elements,bg=Eg[0],Tg=Eg[4],Sg=Eg[8],Mg=Eg[12],Ag=Eg[1],wg=Eg[5],Rg=Eg[9],Lg=Eg[13],Pg=Eg[2],Cg=Eg[6],Ig=Eg[10],Ug=Eg[14];return Eg[3]*(+Mg*Rg*Cg-Sg*Lg*Cg-Mg*wg*Ig+Tg*Lg*Ig+Sg*wg*Ug-Tg*Rg*Ug)+Eg[7]*(+bg*Rg*Ug-bg*Lg*Ig+Mg*Ag*Ig-Sg*Ag*Ug+Sg*Lg*Pg-Mg*Rg*Pg)+Eg[11]*(+bg*Lg*Cg-bg*wg*Ug-Mg*Ag*Cg+Tg*Ag*Ug+Mg*wg*Pg-Tg*Lg*Pg)+Eg[15]*(-Sg*wg*Pg-bg*Rg*Cg+bg*wg*Ig+Sg*Ag*Cg-Tg*Ag*Ig+Tg*Rg*Pg)},transpose:function transpose(){var bg=this.elements,Eg;return Eg=bg[1],bg[1]=bg[4],bg[4]=Eg,Eg=bg[2],bg[2]=bg[8],bg[8]=Eg,Eg=bg[6],bg[6]=bg[9],bg[9]=Eg,Eg=bg[3],bg[3]=bg[12],bg[12]=Eg,Eg=bg[7],bg[7]=bg[13],bg[13]=Eg,Eg=bg[11],bg[11]=bg[14],bg[14]=Eg,this},setPosition:function setPosition(Eg){var bg=this.elements;return bg[12]=Eg.x,bg[13]=Eg.y,bg[14]=Eg.z,this},getInverse:function getInverse(Eg,bg){var Tg=this.elements,Sg=Eg.elements,Mg=Sg[0],Ag=Sg[1],wg=Sg[2],Rg=Sg[3],Lg=Sg[4],Pg=Sg[5],Cg=Sg[6],Ig=Sg[7],Ug=Sg[8],Dg=Sg[9],Ng=Sg[10],Bg=Sg[11],Fg=Sg[12],zg=Sg[13],Gg=Sg[14],Hg=Sg[15],Og=Dg*Gg*Ig-zg*Ng*Ig+zg*Cg*Bg-Pg*Gg*Bg-Dg*Cg*Hg+Pg*Ng*Hg,Vg=Fg*Ng*Ig-Ug*Gg*Ig-Fg*Cg*Bg+Lg*Gg*Bg+Ug*Cg*Hg-Lg*Ng*Hg,Wg=Ug*zg*Ig-Fg*Dg*Ig+Fg*Pg*Bg-Lg*zg*Bg-Ug*Pg*Hg+Lg*Dg*Hg,kg=Fg*Dg*Cg-Ug*zg*Cg-Fg*Pg*Ng+Lg*zg*Ng+Ug*Pg*Gg-Lg*Dg*Gg,Xg=Mg*Og+Ag*Vg+wg*Wg+Rg*kg;if(0==Xg){var jg='THREE.Matrix4: .getInverse() can\'t invert matrix, determinant is 0';if(!0===bg)throw new Error(jg);return console.warn(jg),this.identity()}var Yg=1/Xg;return Tg[0]=Og*Yg,Tg[1]=(zg*Ng*Rg-Dg*Gg*Rg-zg*wg*Bg+Ag*Gg*Bg+Dg*wg*Hg-Ag*Ng*Hg)*Yg,Tg[2]=(Pg*Gg*Rg-zg*Cg*Rg+zg*wg*Ig-Ag*Gg*Ig-Pg*wg*Hg+Ag*Cg*Hg)*Yg,Tg[3]=(Dg*Cg*Rg-Pg*Ng*Rg-Dg*wg*Ig+Ag*Ng*Ig+Pg*wg*Bg-Ag*Cg*Bg)*Yg,Tg[4]=Vg*Yg,Tg[5]=(Ug*Gg*Rg-Fg*Ng*Rg+Fg*wg*Bg-Mg*Gg*Bg-Ug*wg*Hg+Mg*Ng*Hg)*Yg,Tg[6]=(Fg*Cg*Rg-Lg*Gg*Rg-Fg*wg*Ig+Mg*Gg*Ig+Lg*wg*Hg-Mg*Cg*Hg)*Yg,Tg[7]=(Lg*Ng*Rg-Ug*Cg*Rg+Ug*wg*Ig-Mg*Ng*Ig-Lg*wg*Bg+Mg*Cg*Bg)*Yg,Tg[8]=Wg*Yg,Tg[9]=(Fg*Dg*Rg-Ug*zg*Rg-Fg*Ag*Bg+Mg*zg*Bg+Ug*Ag*Hg-Mg*Dg*Hg)*Yg,Tg[10]=(Lg*zg*Rg-Fg*Pg*Rg+Fg*Ag*Ig-Mg*zg*Ig-Lg*Ag*Hg+Mg*Pg*Hg)*Yg,Tg[11]=(Ug*Pg*Rg-Lg*Dg*Rg-Ug*Ag*Ig+Mg*Dg*Ig+Lg*Ag*Bg-Mg*Pg*Bg)*Yg,Tg[12]=kg*Yg,Tg[13]=(Ug*zg*wg-Fg*Dg*wg+Fg*Ag*Ng-Mg*zg*Ng-Ug*Ag*Gg+Mg*Dg*Gg)*Yg,Tg[14]=(Fg*Pg*wg-Lg*zg*wg-Fg*Ag*Cg+Mg*zg*Cg+Lg*Ag*Gg-Mg*Pg*Gg)*Yg,Tg[15]=(Lg*Dg*wg-Ug*Pg*wg+Ug*Ag*Cg-Mg*Dg*Cg-Lg*Ag*Ng+Mg*Pg*Ng)*Yg,this},scale:function scale(Eg){var bg=this.elements,Tg=Eg.x,Sg=Eg.y,Mg=Eg.z;return bg[0]*=Tg,bg[4]*=Sg,bg[8]*=Mg,bg[1]*=Tg,bg[5]*=Sg,bg[9]*=Mg,bg[2]*=Tg,bg[6]*=Sg,bg[10]*=Mg,bg[3]*=Tg,bg[7]*=Sg,bg[11]*=Mg,this},getMaxScaleOnAxis:function getMaxScaleOnAxis(){var Eg=this.elements,bg=Eg[0]*Eg[0]+Eg[1]*Eg[1]+Eg[2]*Eg[2],Tg=Eg[4]*Eg[4]+Eg[5]*Eg[5]+Eg[6]*Eg[6],Sg=Eg[8]*Eg[8]+Eg[9]*Eg[9]+Eg[10]*Eg[10];return Math.sqrt(Math.max(bg,Tg,Sg))},makeTranslation:function makeTranslation(Eg,bg,Tg){return this.set(1,0,0,Eg,0,1,0,bg,0,0,1,Tg,0,0,0,1),this},makeRotationX:function makeRotationX(Eg){var bg=Math.cos(Eg),Tg=Math.sin(Eg);return this.set(1,0,0,0,0,bg,-Tg,0,0,Tg,bg,0,0,0,0,1),this},makeRotationY:function makeRotationY(Eg){var bg=Math.cos(Eg),Tg=Math.sin(Eg);return this.set(bg,0,Tg,0,0,1,0,0,-Tg,0,bg,0,0,0,0,1),this},makeRotationZ:function makeRotationZ(Eg){var bg=Math.cos(Eg),Tg=Math.sin(Eg);return this.set(bg,-Tg,0,0,Tg,bg,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function makeRotationAxis(Eg,bg){var Tg=Math.cos(bg),Sg=Math.sin(bg),Mg=1-Tg,Ag=Eg.x,wg=Eg.y,Rg=Eg.z,Lg=Mg*Ag,Pg=Mg*wg;return this.set(Lg*Ag+Tg,Lg*wg-Sg*Rg,Lg*Rg+Sg*wg,0,Lg*wg+Sg*Rg,Pg*wg+Tg,Pg*Rg-Sg*Ag,0,Lg*Rg-Sg*wg,Pg*Rg+Sg*Ag,Mg*Rg*Rg+Tg,0,0,0,0,1),this},makeScale:function makeScale(Eg,bg,Tg){return this.set(Eg,0,0,0,0,bg,0,0,0,0,Tg,0,0,0,0,1),this},makeShear:function makeShear(Eg,bg,Tg){return this.set(1,bg,Tg,0,Eg,1,Tg,0,Eg,bg,1,0,0,0,0,1),this},compose:function compose(Eg,bg,Tg){return this.makeRotationFromQuaternion(bg),this.scale(Tg),this.setPosition(Eg),this},decompose:function(){var Eg=new Wo,bg=new Ho;return function(Tg,Sg,Mg){var Ag=this.elements,wg=Eg.set(Ag[0],Ag[1],Ag[2]).length(),Rg=Eg.set(Ag[4],Ag[5],Ag[6]).length(),Lg=Eg.set(Ag[8],Ag[9],Ag[10]).length();0>this.determinant()&&(wg=-wg),Tg.x=Ag[12],Tg.y=Ag[13],Tg.z=Ag[14],bg.copy(this);var Pg=1/wg,Cg=1/Rg,Ig=1/Lg;return bg.elements[0]*=Pg,bg.elements[1]*=Pg,bg.elements[2]*=Pg,bg.elements[4]*=Cg,bg.elements[5]*=Cg,bg.elements[6]*=Cg,bg.elements[8]*=Ig,bg.elements[9]*=Ig,bg.elements[10]*=Ig,Sg.setFromRotationMatrix(bg),Mg.x=wg,Mg.y=Rg,Mg.z=Lg,this}}(),makePerspective:function makePerspective(Eg,bg,Tg,Sg,Mg,Ag){void 0===Ag&&console.warn('THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.');var wg=this.elements;return wg[0]=2*Mg/(bg-Eg),wg[4]=0,wg[8]=(bg+Eg)/(bg-Eg),wg[12]=0,wg[1]=0,wg[5]=2*Mg/(Tg-Sg),wg[9]=(Tg+Sg)/(Tg-Sg),wg[13]=0,wg[2]=0,wg[6]=0,wg[10]=-(Ag+Mg)/(Ag-Mg),wg[14]=-2*Ag*Mg/(Ag-Mg),wg[3]=0,wg[7]=0,wg[11]=-1,wg[15]=0,this},makeOrthographic:function makeOrthographic(Eg,bg,Tg,Sg,Mg,Ag){var wg=this.elements,Rg=1/(bg-Eg),Lg=1/(Tg-Sg),Pg=1/(Ag-Mg);return wg[0]=2*Rg,wg[4]=0,wg[8]=0,wg[12]=-((bg+Eg)*Rg),wg[1]=0,wg[5]=2*Lg,wg[9]=0,wg[13]=-((Tg+Sg)*Lg),wg[2]=0,wg[6]=0,wg[10]=-2*Pg,wg[14]=-((Ag+Mg)*Pg),wg[3]=0,wg[7]=0,wg[11]=0,wg[15]=1,this},equals:function equals(Eg){for(var bg=this.elements,Tg=Eg.elements,Sg=0;16>Sg;Sg++)if(bg[Sg]!==Tg[Sg])return!1;return!0},fromArray:function fromArray(Eg,bg){void 0===bg&&(bg=0);for(var Tg=0;16>Tg;Tg++)this.elements[Tg]=Eg[Tg+bg];return this},toArray:function toArray(Eg,bg){void 0===Eg&&(Eg=[]),void 0===bg&&(bg=0);var Tg=this.elements;return Eg[bg]=Tg[0],Eg[bg+1]=Tg[1],Eg[bg+2]=Tg[2],Eg[bg+3]=Tg[3],Eg[bg+4]=Tg[4],Eg[bg+5]=Tg[5],Eg[bg+6]=Tg[6],Eg[bg+7]=Tg[7],Eg[bg+8]=Tg[8],Eg[bg+9]=Tg[9],Eg[bg+10]=Tg[10],Eg[bg+11]=Tg[11],Eg[bg+12]=Tg[12],Eg[bg+13]=Tg[13],Eg[bg+14]=Tg[14],Eg[bg+15]=Tg[15],Eg}}),Object.assign(Vo,{slerp:function slerp(Eg,bg,Tg,Sg){return Tg.copy(Eg).slerp(bg,Sg)},slerpFlat:function slerpFlat(Eg,bg,Tg,Sg,Mg,Ag,wg){var Rg=Tg[Sg+0],Lg=Tg[Sg+1],Pg=Tg[Sg+2],Cg=Tg[Sg+3],Ig=Mg[Ag+0],Ug=Mg[Ag+1],Dg=Mg[Ag+2],Ng=Mg[Ag+3];if(Cg!==Ng||Rg!==Ig||Lg!==Ug||Pg!==Dg){var Bg=1-wg,Fg=Rg*Ig+Lg*Ug+Pg*Dg+Cg*Ng,zg=0<=Fg?1:-1,Gg=1-Fg*Fg;if(Gg>Number.EPSILON){var Hg=Math.sqrt(Gg),Og=Math.atan2(Hg,Fg*zg);Bg=Math.sin(Bg*Og)/Hg,wg=Math.sin(wg*Og)/Hg}var Vg=wg*zg;if(Rg=Rg*Bg+Ig*Vg,Lg=Lg*Bg+Ug*Vg,Pg=Pg*Bg+Dg*Vg,Cg=Cg*Bg+Ng*Vg,Bg==1-wg){var Wg=1/Math.sqrt(Rg*Rg+Lg*Lg+Pg*Pg+Cg*Cg);Rg*=Wg,Lg*=Wg,Pg*=Wg,Cg*=Wg}}Eg[bg]=Rg,Eg[bg+1]=Lg,Eg[bg+2]=Pg,Eg[bg+3]=Cg}}),Object.defineProperties(Vo.prototype,{x:{get:function get(){return this._x},set:function set(Eg){this._x=Eg,this.onChangeCallback()}},y:{get:function get(){return this._y},set:function set(Eg){this._y=Eg,this.onChangeCallback()}},z:{get:function get(){return this._z},set:function set(Eg){this._z=Eg,this.onChangeCallback()}},w:{get:function get(){return this._w},set:function set(Eg){this._w=Eg,this.onChangeCallback()}}}),Object.assign(Vo.prototype,{set:function set(Eg,bg,Tg,Sg){return this._x=Eg,this._y=bg,this._z=Tg,this._w=Sg,this.onChangeCallback(),this},clone:function clone(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function copy(Eg){return this._x=Eg.x,this._y=Eg.y,this._z=Eg.z,this._w=Eg.w,this.onChangeCallback(),this},setFromEuler:function setFromEuler(Eg,bg){if(!Eg||!Eg.isEuler)throw new Error('THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.');var Tg=Eg._x,Sg=Eg._y,Mg=Eg._z,Ag=Eg.order,wg=Math.cos,Rg=Math.sin,Lg=wg(Tg/2),Pg=wg(Sg/2),Cg=wg(Mg/2),Ig=Rg(Tg/2),Ug=Rg(Sg/2),Dg=Rg(Mg/2);return'XYZ'===Ag?(this._x=Ig*Pg*Cg+Lg*Ug*Dg,this._y=Lg*Ug*Cg-Ig*Pg*Dg,this._z=Lg*Pg*Dg+Ig*Ug*Cg,this._w=Lg*Pg*Cg-Ig*Ug*Dg):'YXZ'===Ag?(this._x=Ig*Pg*Cg+Lg*Ug*Dg,this._y=Lg*Ug*Cg-Ig*Pg*Dg,this._z=Lg*Pg*Dg-Ig*Ug*Cg,this._w=Lg*Pg*Cg+Ig*Ug*Dg):'ZXY'===Ag?(this._x=Ig*Pg*Cg-Lg*Ug*Dg,this._y=Lg*Ug*Cg+Ig*Pg*Dg,this._z=Lg*Pg*Dg+Ig*Ug*Cg,this._w=Lg*Pg*Cg-Ig*Ug*Dg):'ZYX'===Ag?(this._x=Ig*Pg*Cg-Lg*Ug*Dg,this._y=Lg*Ug*Cg+Ig*Pg*Dg,this._z=Lg*Pg*Dg-Ig*Ug*Cg,this._w=Lg*Pg*Cg+Ig*Ug*Dg):'YZX'===Ag?(this._x=Ig*Pg*Cg+Lg*Ug*Dg,this._y=Lg*Ug*Cg+Ig*Pg*Dg,this._z=Lg*Pg*Dg-Ig*Ug*Cg,this._w=Lg*Pg*Cg-Ig*Ug*Dg):'XZY'===Ag&&(this._x=Ig*Pg*Cg-Lg*Ug*Dg,this._y=Lg*Ug*Cg-Ig*Pg*Dg,this._z=Lg*Pg*Dg+Ig*Ug*Cg,this._w=Lg*Pg*Cg+Ig*Ug*Dg),!1!==bg&&this.onChangeCallback(),this},setFromAxisAngle:function setFromAxisAngle(Eg,bg){var Tg=bg/2,Sg=Math.sin(Tg);return this._x=Eg.x*Sg,this._y=Eg.y*Sg,this._z=Eg.z*Sg,this._w=Math.cos(Tg),this.onChangeCallback(),this},setFromRotationMatrix:function setFromRotationMatrix(Eg){var Tg=Eg.elements,Sg=Tg[0],Mg=Tg[4],Ag=Tg[8],wg=Tg[1],Rg=Tg[5],Lg=Tg[9],Pg=Tg[2],Cg=Tg[6],Ig=Tg[10],Ug=Sg+Rg+Ig,bg;return 0<Ug?(bg=.5/Math.sqrt(Ug+1),this._w=.25/bg,this._x=(Cg-Lg)*bg,this._y=(Ag-Pg)*bg,this._z=(wg-Mg)*bg):Sg>Rg&&Sg>Ig?(bg=2*Math.sqrt(1+Sg-Rg-Ig),this._w=(Cg-Lg)/bg,this._x=.25*bg,this._y=(Mg+wg)/bg,this._z=(Ag+Pg)/bg):Rg>Ig?(bg=2*Math.sqrt(1+Rg-Sg-Ig),this._w=(Ag-Pg)/bg,this._x=(Mg+wg)/bg,this._y=.25*bg,this._z=(Lg+Cg)/bg):(bg=2*Math.sqrt(1+Ig-Sg-Rg),this._w=(wg-Mg)/bg,this._x=(Ag+Pg)/bg,this._y=(Lg+Cg)/bg,this._z=.25*bg),this.onChangeCallback(),this},setFromUnitVectors:function(){var bg=new Wo,Eg;return function(Tg,Sg){return void 0===bg&&(bg=new Wo),1e-6>(Eg=Tg.dot(Sg)+1)?(Eg=0,Math.abs(Tg.x)>Math.abs(Tg.z)?bg.set(-Tg.y,Tg.x,0):bg.set(0,-Tg.z,Tg.y)):bg.crossVectors(Tg,Sg),this._x=bg.x,this._y=bg.y,this._z=bg.z,this._w=Eg,this.normalize()}}(),inverse:function inverse(){return this.conjugate().normalize()},conjugate:function conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function dot(Eg){return this._x*Eg._x+this._y*Eg._y+this._z*Eg._z+this._w*Eg._w},lengthSq:function lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function normalize(){var Eg=this.length();return 0===Eg?(this._x=0,this._y=0,this._z=0,this._w=1):(Eg=1/Eg,this._x*=Eg,this._y*=Eg,this._z*=Eg,this._w*=Eg),this.onChangeCallback(),this},multiply:function multiply(Eg,bg){return void 0===bg?this.multiplyQuaternions(this,Eg):(console.warn('THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead.'),this.multiplyQuaternions(Eg,bg))},premultiply:function premultiply(Eg){return this.multiplyQuaternions(Eg,this)},multiplyQuaternions:function multiplyQuaternions(Eg,bg){var Tg=Eg._x,Sg=Eg._y,Mg=Eg._z,Ag=Eg._w,wg=bg._x,Rg=bg._y,Lg=bg._z,Pg=bg._w;return this._x=Tg*Pg+Ag*wg+Sg*Lg-Mg*Rg,this._y=Sg*Pg+Ag*Rg+Mg*wg-Tg*Lg,this._z=Mg*Pg+Ag*Lg+Tg*Rg-Sg*wg,this._w=Ag*Pg-Tg*wg-Sg*Rg-Mg*Lg,this.onChangeCallback(),this},slerp:function slerp(Eg,bg){if(0===bg)return this;if(1===bg)return this.copy(Eg);var Tg=this._x,Sg=this._y,Mg=this._z,Ag=this._w,wg=Ag*Eg._w+Tg*Eg._x+Sg*Eg._y+Mg*Eg._z;if(0>wg?(this._w=-Eg._w,this._x=-Eg._x,this._y=-Eg._y,this._z=-Eg._z,wg=-wg):this.copy(Eg),1<=wg)return this._w=Ag,this._x=Tg,this._y=Sg,this._z=Mg,this;var Rg=Math.sqrt(1-wg*wg);if(.001>Math.abs(Rg))return this._w=.5*(Ag+this._w),this._x=.5*(Tg+this._x),this._y=.5*(Sg+this._y),this._z=.5*(Mg+this._z),this;var Lg=Math.atan2(Rg,wg),Pg=Math.sin((1-bg)*Lg)/Rg,Cg=Math.sin(bg*Lg)/Rg;return this._w=Ag*Pg+this._w*Cg,this._x=Tg*Pg+this._x*Cg,this._y=Sg*Pg+this._y*Cg,this._z=Mg*Pg+this._z*Cg,this.onChangeCallback(),this},equals:function equals(Eg){return Eg._x===this._x&&Eg._y===this._y&&Eg._z===this._z&&Eg._w===this._w},fromArray:function fromArray(Eg,bg){return void 0===bg&&(bg=0),this._x=Eg[bg],this._y=Eg[bg+1],this._z=Eg[bg+2],this._w=Eg[bg+3],this.onChangeCallback(),this},toArray:function toArray(Eg,bg){return void 0===Eg&&(Eg=[]),void 0===bg&&(bg=0),Eg[bg]=this._x,Eg[bg+1]=this._y,Eg[bg+2]=this._z,Eg[bg+3]=this._w,Eg},onChange:function onChange(Eg){return this.onChangeCallback=Eg,this},onChangeCallback:function onChangeCallback(){}}),Object.assign(Wo.prototype,{isVector3:!0,set:function set(Eg,bg,Tg){return this.x=Eg,this.y=bg,this.z=Tg,this},setScalar:function setScalar(Eg){return this.x=Eg,this.y=Eg,this.z=Eg,this},setX:function setX(Eg){return this.x=Eg,this},setY:function setY(Eg){return this.y=Eg,this},setZ:function setZ(Eg){return this.z=Eg,this},setComponent:function setComponent(Eg,bg){switch(Eg){case 0:this.x=bg;break;case 1:this.y=bg;break;case 2:this.z=bg;break;default:throw new Error('index is out of range: '+Eg);}return this},getComponent:function getComponent(Eg){switch(Eg){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error('index is out of range: '+Eg);}},clone:function clone(){return new this.constructor(this.x,this.y,this.z)},copy:function copy(Eg){return this.x=Eg.x,this.y=Eg.y,this.z=Eg.z,this},add:function add(Eg,bg){return void 0===bg?(this.x+=Eg.x,this.y+=Eg.y,this.z+=Eg.z,this):(console.warn('THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead.'),this.addVectors(Eg,bg))},addScalar:function addScalar(Eg){return this.x+=Eg,this.y+=Eg,this.z+=Eg,this},addVectors:function addVectors(Eg,bg){return this.x=Eg.x+bg.x,this.y=Eg.y+bg.y,this.z=Eg.z+bg.z,this},addScaledVector:function addScaledVector(Eg,bg){return this.x+=Eg.x*bg,this.y+=Eg.y*bg,this.z+=Eg.z*bg,this},sub:function sub(Eg,bg){return void 0===bg?(this.x-=Eg.x,this.y-=Eg.y,this.z-=Eg.z,this):(console.warn('THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.'),this.subVectors(Eg,bg))},subScalar:function subScalar(Eg){return this.x-=Eg,this.y-=Eg,this.z-=Eg,this},subVectors:function subVectors(Eg,bg){return this.x=Eg.x-bg.x,this.y=Eg.y-bg.y,this.z=Eg.z-bg.z,this},multiply:function multiply(Eg,bg){return void 0===bg?(this.x*=Eg.x,this.y*=Eg.y,this.z*=Eg.z,this):(console.warn('THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead.'),this.multiplyVectors(Eg,bg))},multiplyScalar:function multiplyScalar(Eg){return this.x*=Eg,this.y*=Eg,this.z*=Eg,this},multiplyVectors:function multiplyVectors(Eg,bg){return this.x=Eg.x*bg.x,this.y=Eg.y*bg.y,this.z=Eg.z*bg.z,this},applyEuler:function(){var Eg=new Vo;return function(bg){return bg&&bg.isEuler||console.error('THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order.'),this.applyQuaternion(Eg.setFromEuler(bg))}}(),applyAxisAngle:function(){var Eg=new Vo;return function(bg,Tg){return this.applyQuaternion(Eg.setFromAxisAngle(bg,Tg))}}(),applyMatrix3:function applyMatrix3(Eg){var bg=this.x,Tg=this.y,Sg=this.z,Mg=Eg.elements;return this.x=Mg[0]*bg+Mg[3]*Tg+Mg[6]*Sg,this.y=Mg[1]*bg+Mg[4]*Tg+Mg[7]*Sg,this.z=Mg[2]*bg+Mg[5]*Tg+Mg[8]*Sg,this},applyMatrix4:function applyMatrix4(Eg){var bg=this.x,Tg=this.y,Sg=this.z,Mg=Eg.elements,Ag=1/(Mg[3]*bg+Mg[7]*Tg+Mg[11]*Sg+Mg[15]);return this.x=(Mg[0]*bg+Mg[4]*Tg+Mg[8]*Sg+Mg[12])*Ag,this.y=(Mg[1]*bg+Mg[5]*Tg+Mg[9]*Sg+Mg[13])*Ag,this.z=(Mg[2]*bg+Mg[6]*Tg+Mg[10]*Sg+Mg[14])*Ag,this},applyQuaternion:function applyQuaternion(Eg){var bg=this.x,Tg=this.y,Sg=this.z,Mg=Eg.x,Ag=Eg.y,wg=Eg.z,Rg=Eg.w,Lg=Rg*bg+Ag*Sg-wg*Tg,Pg=Rg*Tg+wg*bg-Mg*Sg,Cg=Rg*Sg+Mg*Tg-Ag*bg,Ig=-Mg*bg-Ag*Tg-wg*Sg;return this.x=Lg*Rg+Ig*-Mg+Pg*-wg-Cg*-Ag,this.y=Pg*Rg+Ig*-Ag+Cg*-Mg-Lg*-wg,this.z=Cg*Rg+Ig*-wg+Lg*-Ag-Pg*-Mg,this},project:function(){var Eg=new Ho;return function(bg){return Eg.multiplyMatrices(bg.projectionMatrix,Eg.getInverse(bg.matrixWorld)),this.applyMatrix4(Eg)}}(),unproject:function(){var Eg=new Ho;return function(bg){return Eg.multiplyMatrices(bg.matrixWorld,Eg.getInverse(bg.projectionMatrix)),this.applyMatrix4(Eg)}}(),transformDirection:function transformDirection(Eg){var bg=this.x,Tg=this.y,Sg=this.z,Mg=Eg.elements;return this.x=Mg[0]*bg+Mg[4]*Tg+Mg[8]*Sg,this.y=Mg[1]*bg+Mg[5]*Tg+Mg[9]*Sg,this.z=Mg[2]*bg+Mg[6]*Tg+Mg[10]*Sg,this.normalize()},divide:function divide(Eg){return this.x/=Eg.x,this.y/=Eg.y,this.z/=Eg.z,this},divideScalar:function divideScalar(Eg){return this.multiplyScalar(1/Eg)},min:function min(Eg){return this.x=Math.min(this.x,Eg.x),this.y=Math.min(this.y,Eg.y),this.z=Math.min(this.z,Eg.z),this},max:function max(Eg){return this.x=Math.max(this.x,Eg.x),this.y=Math.max(this.y,Eg.y),this.z=Math.max(this.z,Eg.z),this},clamp:function clamp(Eg,bg){return this.x=Math.max(Eg.x,Math.min(bg.x,this.x)),this.y=Math.max(Eg.y,Math.min(bg.y,this.y)),this.z=Math.max(Eg.z,Math.min(bg.z,this.z)),this},clampScalar:function(){var Eg=new Wo,bg=new Wo;return function(Tg,Sg){return Eg.set(Tg,Tg,Tg),bg.set(Sg,Sg,Sg),this.clamp(Eg,bg)}}(),clampLength:function clampLength(Eg,bg){var Tg=this.length();return this.divideScalar(Tg||1).multiplyScalar(Math.max(Eg,Math.min(bg,Tg)))},floor:function floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function roundToZero(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this},negate:function negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function dot(Eg){return this.x*Eg.x+this.y*Eg.y+this.z*Eg.z},lengthSq:function lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function normalize(){return this.divideScalar(this.length()||1)},setLength:function setLength(Eg){return this.normalize().multiplyScalar(Eg)},lerp:function lerp(Eg,bg){return this.x+=(Eg.x-this.x)*bg,this.y+=(Eg.y-this.y)*bg,this.z+=(Eg.z-this.z)*bg,this},lerpVectors:function lerpVectors(Eg,bg,Tg){return this.subVectors(bg,Eg).multiplyScalar(Tg).add(Eg)},cross:function cross(Eg,bg){if(void 0!==bg)return console.warn('THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead.'),this.crossVectors(Eg,bg);var Tg=this.x,Sg=this.y,Mg=this.z;return this.x=Sg*Eg.z-Mg*Eg.y,this.y=Mg*Eg.x-Tg*Eg.z,this.z=Tg*Eg.y-Sg*Eg.x,this},crossVectors:function crossVectors(Eg,bg){var Tg=Eg.x,Sg=Eg.y,Mg=Eg.z,Ag=bg.x,wg=bg.y,Rg=bg.z;return this.x=Sg*Rg-Mg*wg,this.y=Mg*Ag-Tg*Rg,this.z=Tg*wg-Sg*Ag,this},projectOnVector:function projectOnVector(Eg){var bg=Eg.dot(this)/Eg.lengthSq();return this.copy(Eg).multiplyScalar(bg)},projectOnPlane:function(){var Eg=new Wo;return function(bg){return Eg.copy(this).projectOnVector(bg),this.sub(Eg)}}(),reflect:function(){var Eg=new Wo;return function(bg){return this.sub(Eg.copy(bg).multiplyScalar(2*this.dot(bg)))}}(),angleTo:function angleTo(Eg){var bg=this.dot(Eg)/Math.sqrt(this.lengthSq()*Eg.lengthSq());return Math.acos(Iu.clamp(bg,-1,1))},distanceTo:function distanceTo(Eg){return Math.sqrt(this.distanceToSquared(Eg))},distanceToSquared:function distanceToSquared(Eg){var bg=this.x-Eg.x,Tg=this.y-Eg.y,Sg=this.z-Eg.z;return bg*bg+Tg*Tg+Sg*Sg},manhattanDistanceTo:function manhattanDistanceTo(Eg){return Math.abs(this.x-Eg.x)+Math.abs(this.y-Eg.y)+Math.abs(this.z-Eg.z)},setFromSpherical:function setFromSpherical(Eg){var bg=Math.sin(Eg.phi)*Eg.radius;return this.x=bg*Math.sin(Eg.theta),this.y=Math.cos(Eg.phi)*Eg.radius,this.z=bg*Math.cos(Eg.theta),this},setFromCylindrical:function setFromCylindrical(Eg){return this.x=Eg.radius*Math.sin(Eg.theta),this.y=Eg.y,this.z=Eg.radius*Math.cos(Eg.theta),this},setFromMatrixPosition:function setFromMatrixPosition(Eg){var bg=Eg.elements;return this.x=bg[12],this.y=bg[13],this.z=bg[14],this},setFromMatrixScale:function setFromMatrixScale(Eg){var bg=this.setFromMatrixColumn(Eg,0).length(),Tg=this.setFromMatrixColumn(Eg,1).length(),Sg=this.setFromMatrixColumn(Eg,2).length();return this.x=bg,this.y=Tg,this.z=Sg,this},setFromMatrixColumn:function setFromMatrixColumn(Eg,bg){return this.fromArray(Eg.elements,4*bg)},equals:function equals(Eg){return Eg.x===this.x&&Eg.y===this.y&&Eg.z===this.z},fromArray:function fromArray(Eg,bg){return void 0===bg&&(bg=0),this.x=Eg[bg],this.y=Eg[bg+1],this.z=Eg[bg+2],this},toArray:function toArray(Eg,bg){return void 0===Eg&&(Eg=[]),void 0===bg&&(bg=0),Eg[bg]=this.x,Eg[bg+1]=this.y,Eg[bg+2]=this.z,Eg},fromBufferAttribute:function fromBufferAttribute(Eg,bg,Tg){return void 0!==Tg&&console.warn('THREE.Vector3: offset has been removed from .fromBufferAttribute().'),this.x=Eg.getX(bg),this.y=Eg.getY(bg),this.z=Eg.getZ(bg),this}}),Object.assign(Xo.prototype,{isMatrix3:!0,set:function set(Eg,bg,Tg,Sg,Mg,Ag,wg,Rg,Lg){var Pg=this.elements;return Pg[0]=Eg,Pg[1]=Sg,Pg[2]=wg,Pg[3]=bg,Pg[4]=Mg,Pg[5]=Rg,Pg[6]=Tg,Pg[7]=Ag,Pg[8]=Lg,this},identity:function identity(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function clone(){return new this.constructor().fromArray(this.elements)},copy:function copy(Eg){var bg=this.elements,Tg=Eg.elements;return bg[0]=Tg[0],bg[1]=Tg[1],bg[2]=Tg[2],bg[3]=Tg[3],bg[4]=Tg[4],bg[5]=Tg[5],bg[6]=Tg[6],bg[7]=Tg[7],bg[8]=Tg[8],this},setFromMatrix4:function setFromMatrix4(Eg){var bg=Eg.elements;return this.set(bg[0],bg[4],bg[8],bg[1],bg[5],bg[9],bg[2],bg[6],bg[10]),this},applyToBufferAttribute:function(){var Eg=new Wo;return function(bg){for(var Tg=0,Sg=bg.count;Tg<Sg;Tg++)Eg.x=bg.getX(Tg),Eg.y=bg.getY(Tg),Eg.z=bg.getZ(Tg),Eg.applyMatrix3(this),bg.setXYZ(Tg,Eg.x,Eg.y,Eg.z);return bg}}(),multiply:function multiply(Eg){return this.multiplyMatrices(this,Eg)},premultiply:function premultiply(Eg){return this.multiplyMatrices(Eg,this)},multiplyMatrices:function multiplyMatrices(Eg,bg){var Tg=Eg.elements,Sg=bg.elements,Mg=this.elements,Ag=Tg[0],wg=Tg[3],Rg=Tg[6],Lg=Tg[1],Pg=Tg[4],Cg=Tg[7],Ig=Tg[2],Ug=Tg[5],Dg=Tg[8],Ng=Sg[0],Bg=Sg[3],Fg=Sg[6],zg=Sg[1],Gg=Sg[4],Hg=Sg[7],Og=Sg[2],Vg=Sg[5],Wg=Sg[8];return Mg[0]=Ag*Ng+wg*zg+Rg*Og,Mg[3]=Ag*Bg+wg*Gg+Rg*Vg,Mg[6]=Ag*Fg+wg*Hg+Rg*Wg,Mg[1]=Lg*Ng+Pg*zg+Cg*Og,Mg[4]=Lg*Bg+Pg*Gg+Cg*Vg,Mg[7]=Lg*Fg+Pg*Hg+Cg*Wg,Mg[2]=Ig*Ng+Ug*zg+Dg*Og,Mg[5]=Ig*Bg+Ug*Gg+Dg*Vg,Mg[8]=Ig*Fg+Ug*Hg+Dg*Wg,this},multiplyScalar:function multiplyScalar(Eg){var bg=this.elements;return bg[0]*=Eg,bg[3]*=Eg,bg[6]*=Eg,bg[1]*=Eg,bg[4]*=Eg,bg[7]*=Eg,bg[2]*=Eg,bg[5]*=Eg,bg[8]*=Eg,this},determinant:function determinant(){var Eg=this.elements,bg=Eg[0],Tg=Eg[1],Sg=Eg[2],Mg=Eg[3],Ag=Eg[4],wg=Eg[5],Rg=Eg[6],Lg=Eg[7],Pg=Eg[8];return bg*Ag*Pg-bg*wg*Lg-Tg*Mg*Pg+Tg*wg*Rg+Sg*Mg*Lg-Sg*Ag*Rg},getInverse:function getInverse(Eg,bg){Eg&&Eg.isMatrix4&&console.error('THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.');var Tg=Eg.elements,Sg=this.elements,Mg=Tg[0],Ag=Tg[1],wg=Tg[2],Rg=Tg[3],Lg=Tg[4],Pg=Tg[5],Cg=Tg[6],Ig=Tg[7],Ug=Tg[8],Dg=Ug*Lg-Pg*Ig,Ng=Pg*Cg-Ug*Rg,Bg=Ig*Rg-Lg*Cg,Fg=Mg*Dg+Ag*Ng+wg*Bg;if(0==Fg){var zg='THREE.Matrix3: .getInverse() can\'t invert matrix, determinant is 0';if(!0===bg)throw new Error(zg);return console.warn(zg),this.identity()}var Gg=1/Fg;return Sg[0]=Dg*Gg,Sg[1]=(wg*Ig-Ug*Ag)*Gg,Sg[2]=(Pg*Ag-wg*Lg)*Gg,Sg[3]=Ng*Gg,Sg[4]=(Ug*Mg-wg*Cg)*Gg,Sg[5]=(wg*Rg-Pg*Mg)*Gg,Sg[6]=Bg*Gg,Sg[7]=(Ag*Cg-Ig*Mg)*Gg,Sg[8]=(Lg*Mg-Ag*Rg)*Gg,this},transpose:function transpose(){var bg=this.elements,Eg;return Eg=bg[1],bg[1]=bg[3],bg[3]=Eg,Eg=bg[2],bg[2]=bg[6],bg[6]=Eg,Eg=bg[5],bg[5]=bg[7],bg[7]=Eg,this},getNormalMatrix:function getNormalMatrix(Eg){return this.setFromMatrix4(Eg).getInverse(this).transpose()},transposeIntoArray:function transposeIntoArray(Eg){var bg=this.elements;return Eg[0]=bg[0],Eg[1]=bg[3],Eg[2]=bg[6],Eg[3]=bg[1],Eg[4]=bg[4],Eg[5]=bg[7],Eg[6]=bg[2],Eg[7]=bg[5],Eg[8]=bg[8],this},setUvTransform:function setUvTransform(Eg,bg,Tg,Sg,Mg,Ag,wg){var Rg=Math.cos(Mg),Lg=Math.sin(Mg);this.set(Tg*Rg,Tg*Lg,-Tg*(Rg*Ag+Lg*wg)+Ag+Eg,-Sg*Lg,Sg*Rg,-Sg*(-Lg*Ag+Rg*wg)+wg+bg,0,0,1)},scale:function scale(Eg,bg){var Tg=this.elements;return Tg[0]*=Eg,Tg[3]*=Eg,Tg[6]*=Eg,Tg[1]*=bg,Tg[4]*=bg,Tg[7]*=bg,this},rotate:function rotate(Eg){var bg=Math.cos(Eg),Tg=Math.sin(Eg),Sg=this.elements,Mg=Sg[0],Ag=Sg[3],wg=Sg[6],Rg=Sg[1],Lg=Sg[4],Pg=Sg[7];return Sg[0]=bg*Mg+Tg*Rg,Sg[3]=bg*Ag+Tg*Lg,Sg[6]=bg*wg+Tg*Pg,Sg[1]=-Tg*Mg+bg*Rg,Sg[4]=-Tg*Ag+bg*Lg,Sg[7]=-Tg*wg+bg*Pg,this},translate:function translate(Eg,bg){var Tg=this.elements;return Tg[0]+=Eg*Tg[2],Tg[3]+=Eg*Tg[5],Tg[6]+=Eg*Tg[8],Tg[1]+=bg*Tg[2],Tg[4]+=bg*Tg[5],Tg[7]+=bg*Tg[8],this},equals:function equals(Eg){for(var bg=this.elements,Tg=Eg.elements,Sg=0;9>Sg;Sg++)if(bg[Sg]!==Tg[Sg])return!1;return!0},fromArray:function fromArray(Eg,bg){void 0===bg&&(bg=0);for(var Tg=0;9>Tg;Tg++)this.elements[Tg]=Eg[Tg+bg];return this},toArray:function toArray(Eg,bg){void 0===Eg&&(Eg=[]),void 0===bg&&(bg=0);var Tg=this.elements;return Eg[bg]=Tg[0],Eg[bg+1]=Tg[1],Eg[bg+2]=Tg[2],Eg[bg+3]=Tg[3],Eg[bg+4]=Tg[4],Eg[bg+5]=Tg[5],Eg[bg+6]=Tg[6],Eg[bg+7]=Tg[7],Eg[bg+8]=Tg[8],Eg}});var Uu=0;jo.DEFAULT_IMAGE=void 0,jo.DEFAULT_MAPPING=300,Object.defineProperty(jo.prototype,'needsUpdate',{set:function set(Eg){!0===Eg&&this.version++}}),Object.assign(jo.prototype,Fo.prototype,{constructor:jo,isTexture:!0,clone:function clone(){return new this.constructor().copy(this)},copy:function copy(Eg){return this.name=Eg.name,this.image=Eg.image,this.mipmaps=Eg.mipmaps.slice(0),this.mapping=Eg.mapping,this.wrapS=Eg.wrapS,this.wrapT=Eg.wrapT,this.magFilter=Eg.magFilter,this.minFilter=Eg.minFilter,this.anisotropy=Eg.anisotropy,this.format=Eg.format,this.type=Eg.type,this.offset.copy(Eg.offset),this.repeat.copy(Eg.repeat),this.center.copy(Eg.center),this.rotation=Eg.rotation,this.matrixAutoUpdate=Eg.matrixAutoUpdate,this.matrix.copy(Eg.matrix),this.generateMipmaps=Eg.generateMipmaps,this.premultiplyAlpha=Eg.premultiplyAlpha,this.flipY=Eg.flipY,this.unpackAlignment=Eg.unpackAlignment,this.encoding=Eg.encoding,this},toJSON:function toJSON(Eg){var bg=void 0===Eg||'string'==typeof Eg;if(!bg&&void 0!==Eg.textures[this.uuid])return Eg.textures[this.uuid];var Tg={metadata:{version:4.5,type:'Texture',generator:'Texture.toJSON'},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY};if(void 0!==this.image){var Sg=this.image;void 0===Sg.uuid&&(Sg.uuid=Iu.generateUUID()),bg||void 0!==Eg.images[Sg.uuid]||(Eg.images[Sg.uuid]={uuid:Sg.uuid,url:function(Mg){var Ag;if(Mg instanceof HTMLCanvasElement)Ag=Mg;else{(Ag=document.createElement('canvas')).width=Mg.width,Ag.height=Mg.height;var wg=Ag.getContext('2d');Mg instanceof ImageData?wg.putImageData(Mg,0,0):wg.drawImage(Mg,0,0,Mg.width,Mg.height)}return 2048<Ag.width||2048<Ag.height?Ag.toDataURL('image/jpeg',.6):Ag.toDataURL('image/png')}(Sg)}),Tg.image=Sg.uuid}return bg||(Eg.textures[this.uuid]=Tg),Tg},dispose:function dispose(){this.dispatchEvent({type:'dispose'})},transformUv:function transformUv(Eg){if(300===this.mapping){if(Eg.applyMatrix3(this.matrix),0>Eg.x||1<Eg.x)switch(this.wrapS){case Dm:Eg.x-=Math.floor(Eg.x);break;case Nm:Eg.x=0>Eg.x?0:1;break;case Bm:1===Math.abs(Math.floor(Eg.x)%2)?Eg.x=Math.ceil(Eg.x)-Eg.x:Eg.x-=Math.floor(Eg.x);}if(0>Eg.y||1<Eg.y)switch(this.wrapT){case Dm:Eg.y-=Math.floor(Eg.y);break;case Nm:Eg.y=0>Eg.y?0:1;break;case Bm:1===Math.abs(Math.floor(Eg.y)%2)?Eg.y=Math.ceil(Eg.y)-Eg.y:Eg.y-=Math.floor(Eg.y);}this.flipY&&(Eg.y=1-Eg.y)}}}),Object.assign(Yo.prototype,{isVector4:!0,set:function set(Eg,bg,Tg,Sg){return this.x=Eg,this.y=bg,this.z=Tg,this.w=Sg,this},setScalar:function setScalar(Eg){return this.x=Eg,this.y=Eg,this.z=Eg,this.w=Eg,this},setX:function setX(Eg){return this.x=Eg,this},setY:function setY(Eg){return this.y=Eg,this},setZ:function setZ(Eg){return this.z=Eg,this},setW:function setW(Eg){return this.w=Eg,this},setComponent:function setComponent(Eg,bg){switch(Eg){case 0:this.x=bg;break;case 1:this.y=bg;break;case 2:this.z=bg;break;case 3:this.w=bg;break;default:throw new Error('index is out of range: '+Eg);}return this},getComponent:function getComponent(Eg){switch(Eg){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error('index is out of range: '+Eg);}},clone:function clone(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function copy(Eg){return this.x=Eg.x,this.y=Eg.y,this.z=Eg.z,this.w=void 0===Eg.w?1:Eg.w,this},add:function add(Eg,bg){return void 0===bg?(this.x+=Eg.x,this.y+=Eg.y,this.z+=Eg.z,this.w+=Eg.w,this):(console.warn('THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead.'),this.addVectors(Eg,bg))},addScalar:function addScalar(Eg){return this.x+=Eg,this.y+=Eg,this.z+=Eg,this.w+=Eg,this},addVectors:function addVectors(Eg,bg){return this.x=Eg.x+bg.x,this.y=Eg.y+bg.y,this.z=Eg.z+bg.z,this.w=Eg.w+bg.w,this},addScaledVector:function addScaledVector(Eg,bg){return this.x+=Eg.x*bg,this.y+=Eg.y*bg,this.z+=Eg.z*bg,this.w+=Eg.w*bg,this},sub:function sub(Eg,bg){return void 0===bg?(this.x-=Eg.x,this.y-=Eg.y,this.z-=Eg.z,this.w-=Eg.w,this):(console.warn('THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.'),this.subVectors(Eg,bg))},subScalar:function subScalar(Eg){return this.x-=Eg,this.y-=Eg,this.z-=Eg,this.w-=Eg,this},subVectors:function subVectors(Eg,bg){return this.x=Eg.x-bg.x,this.y=Eg.y-bg.y,this.z=Eg.z-bg.z,this.w=Eg.w-bg.w,this},multiplyScalar:function multiplyScalar(Eg){return this.x*=Eg,this.y*=Eg,this.z*=Eg,this.w*=Eg,this},applyMatrix4:function applyMatrix4(Eg){var bg=this.x,Tg=this.y,Sg=this.z,Mg=this.w,Ag=Eg.elements;return this.x=Ag[0]*bg+Ag[4]*Tg+Ag[8]*Sg+Ag[12]*Mg,this.y=Ag[1]*bg+Ag[5]*Tg+Ag[9]*Sg+Ag[13]*Mg,this.z=Ag[2]*bg+Ag[6]*Tg+Ag[10]*Sg+Ag[14]*Mg,this.w=Ag[3]*bg+Ag[7]*Tg+Ag[11]*Sg+Ag[15]*Mg,this},divideScalar:function divideScalar(Eg){return this.multiplyScalar(1/Eg)},setAxisAngleFromQuaternion:function setAxisAngleFromQuaternion(Eg){this.w=2*Math.acos(Eg.w);var bg=Math.sqrt(1-Eg.w*Eg.w);return 1e-4>bg?(this.x=1,this.y=0,this.z=0):(this.x=Eg.x/bg,this.y=Eg.y/bg,this.z=Eg.z/bg),this},setAxisAngleFromRotationMatrix:function setAxisAngleFromRotationMatrix(Eg){var Ag=Eg.elements,wg=Ag[0],Rg=Ag[4],Lg=Ag[8],Pg=Ag[1],Cg=Ag[5],Ig=Ag[9],Ug=Ag[2],Dg=Ag[6],Ng=Ag[10],bg,Tg,Sg,Mg;if(.01>Math.abs(Rg-Pg)&&.01>Math.abs(Lg-Ug)&&.01>Math.abs(Ig-Dg)){if(.1>Math.abs(Rg+Pg)&&.1>Math.abs(Lg+Ug)&&.1>Math.abs(Ig+Dg)&&.1>Math.abs(wg+Cg+Ng-3))return this.set(1,0,0,0),this;bg=Math.PI;var Bg=(wg+1)/2,Fg=(Cg+1)/2,zg=(Ng+1)/2,Gg=(Rg+Pg)/4,Hg=(Lg+Ug)/4,Og=(Ig+Dg)/4;return Bg>Fg&&Bg>zg?.01>Bg?(Tg=0,Sg=.707106781,Mg=.707106781):(Sg=Gg/(Tg=Math.sqrt(Bg)),Mg=Hg/Tg):Fg>zg?.01>Fg?(Tg=.707106781,Sg=0,Mg=.707106781):(Tg=Gg/(Sg=Math.sqrt(Fg)),Mg=Og/Sg):.01>zg?(Tg=.707106781,Sg=.707106781,Mg=0):(Tg=Hg/(Mg=Math.sqrt(zg)),Sg=Og/Mg),this.set(Tg,Sg,Mg,bg),this}var Vg=Math.sqrt((Dg-Ig)*(Dg-Ig)+(Lg-Ug)*(Lg-Ug)+(Pg-Rg)*(Pg-Rg));return .001>Math.abs(Vg)&&(Vg=1),this.x=(Dg-Ig)/Vg,this.y=(Lg-Ug)/Vg,this.z=(Pg-Rg)/Vg,this.w=Math.acos((wg+Cg+Ng-1)/2),this},min:function min(Eg){return this.x=Math.min(this.x,Eg.x),this.y=Math.min(this.y,Eg.y),this.z=Math.min(this.z,Eg.z),this.w=Math.min(this.w,Eg.w),this},max:function max(Eg){return this.x=Math.max(this.x,Eg.x),this.y=Math.max(this.y,Eg.y),this.z=Math.max(this.z,Eg.z),this.w=Math.max(this.w,Eg.w),this},clamp:function clamp(Eg,bg){return this.x=Math.max(Eg.x,Math.min(bg.x,this.x)),this.y=Math.max(Eg.y,Math.min(bg.y,this.y)),this.z=Math.max(Eg.z,Math.min(bg.z,this.z)),this.w=Math.max(Eg.w,Math.min(bg.w,this.w)),this},clampScalar:function(){var Eg,bg;return function(Tg,Sg){return void 0===Eg&&(Eg=new Yo,bg=new Yo),Eg.set(Tg,Tg,Tg,Tg),bg.set(Sg,Sg,Sg,Sg),this.clamp(Eg,bg)}}(),clampLength:function clampLength(Eg,bg){var Tg=this.length();return this.divideScalar(Tg||1).multiplyScalar(Math.max(Eg,Math.min(bg,Tg)))},floor:function floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function roundToZero(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this.w=0>this.w?Math.ceil(this.w):Math.floor(this.w),this},negate:function negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function dot(Eg){return this.x*Eg.x+this.y*Eg.y+this.z*Eg.z+this.w*Eg.w},lengthSq:function lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function normalize(){return this.divideScalar(this.length()||1)},setLength:function setLength(Eg){return this.normalize().multiplyScalar(Eg)},lerp:function lerp(Eg,bg){return this.x+=(Eg.x-this.x)*bg,this.y+=(Eg.y-this.y)*bg,this.z+=(Eg.z-this.z)*bg,this.w+=(Eg.w-this.w)*bg,this},lerpVectors:function lerpVectors(Eg,bg,Tg){return this.subVectors(bg,Eg).multiplyScalar(Tg).add(Eg)},equals:function equals(Eg){return Eg.x===this.x&&Eg.y===this.y&&Eg.z===this.z&&Eg.w===this.w},fromArray:function fromArray(Eg,bg){return void 0===bg&&(bg=0),this.x=Eg[bg],this.y=Eg[bg+1],this.z=Eg[bg+2],this.w=Eg[bg+3],this},toArray:function toArray(Eg,bg){return void 0===Eg&&(Eg=[]),void 0===bg&&(bg=0),Eg[bg]=this.x,Eg[bg+1]=this.y,Eg[bg+2]=this.z,Eg[bg+3]=this.w,Eg},fromBufferAttribute:function fromBufferAttribute(Eg,bg,Tg){return void 0!==Tg&&console.warn('THREE.Vector4: offset has been removed from .fromBufferAttribute().'),this.x=Eg.getX(bg),this.y=Eg.getY(bg),this.z=Eg.getZ(bg),this.w=Eg.getW(bg),this}}),Object.assign(qo.prototype,Fo.prototype,{isWebGLRenderTarget:!0,setSize:function setSize(Eg,bg){this.width===Eg&&this.height===bg||(this.width=Eg,this.height=bg,this.dispose()),this.viewport.set(0,0,Eg,bg),this.scissor.set(0,0,Eg,bg)},clone:function clone(){return new this.constructor().copy(this)},copy:function copy(Eg){return this.width=Eg.width,this.height=Eg.height,this.viewport.copy(Eg.viewport),this.texture=Eg.texture.clone(),this.depthBuffer=Eg.depthBuffer,this.stencilBuffer=Eg.stencilBuffer,this.depthTexture=Eg.depthTexture,this},dispose:function dispose(){this.dispatchEvent({type:'dispose'})}}),(Zo.prototype=Object.create(qo.prototype)).constructor=Zo,Zo.prototype.isWebGLRenderTargetCube=!0,(Jo.prototype=Object.create(jo.prototype)).constructor=Jo,Jo.prototype.isDataTexture=!0,(Qo.prototype=Object.create(jo.prototype)).constructor=Qo,Qo.prototype.isCubeTexture=!0,Object.defineProperty(Qo.prototype,'images',{get:function get(){return this.image},set:function set(Eg){this.image=Eg}});var Du=new jo,Nu=new Qo,Bu=[],Fu=[],zu=new Float32Array(16),Gu=new Float32Array(9);As.prototype.setValue=function(Eg,bg){for(var Tg=this.seq,Sg=0,Mg=Tg.length,Ag;Sg!==Mg;++Sg)Ag=Tg[Sg],Ag.setValue(Eg,bg[Ag.id])};var Hu=/([\w\d_]+)(\])?(\[|\.)?/g;Ls.prototype.setValue=function(Eg,bg,Tg){var Sg=this.map[bg];void 0!==Sg&&Sg.setValue(Eg,Tg,this.renderer)},Ls.prototype.setOptional=function(Eg,bg,Tg){var Sg=bg[Tg];void 0!==Sg&&this.setValue(Eg,Tg,Sg)},Ls.upload=function(Eg,bg,Tg,Sg){for(var Mg=0,Ag=bg.length;Mg!==Ag;++Mg){var wg=bg[Mg],Rg=Tg[wg.id];!1!==Rg.needsUpdate&&wg.setValue(Eg,Rg.value,Sg)}},Ls.seqWithValue=function(Eg,bg){for(var Tg=[],Sg=0,Mg=Eg.length,Ag;Sg!==Mg;++Sg)Ag=Eg[Sg],Ag.id in bg&&Tg.push(Ag);return Tg};var Ou={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Object.assign(Ps.prototype,{isColor:!0,r:1,g:1,b:1,set:function set(Eg){return Eg&&Eg.isColor?this.copy(Eg):'number'==typeof Eg?this.setHex(Eg):'string'==typeof Eg&&this.setStyle(Eg),this},setScalar:function setScalar(Eg){return this.r=Eg,this.g=Eg,this.b=Eg,this},setHex:function setHex(Eg){return Eg=Math.floor(Eg),this.r=(255&Eg>>16)/255,this.g=(255&Eg>>8)/255,this.b=(255&Eg)/255,this},setRGB:function setRGB(Eg,bg,Tg){return this.r=Eg,this.g=bg,this.b=Tg,this},setHSL:function(){function Eg(bg,Tg,Sg){return 0>Sg&&(Sg+=1),1<Sg&&(Sg-=1),Sg<1/6?bg+6*(Tg-bg)*Sg:.5>Sg?Tg:Sg<2/3?bg+6*(Tg-bg)*(2/3-Sg):bg}return function(bg,Tg,Sg){if(bg=Iu.euclideanModulo(bg,1),Tg=Iu.clamp(Tg,0,1),Sg=Iu.clamp(Sg,0,1),0===Tg)this.r=this.g=this.b=Sg;else{var Mg=.5>=Sg?Sg*(1+Tg):Sg+Tg-Sg*Tg,Ag=2*Sg-Mg;this.r=Eg(Ag,Mg,bg+1/3),this.g=Eg(Ag,Mg,bg),this.b=Eg(Ag,Mg,bg-1/3)}return this}}(),setStyle:function setStyle(Eg){function bg(Ig){void 0!==Ig&&1>parseFloat(Ig)&&console.warn('THREE.Color: Alpha component of '+Eg+' will be ignored.')}var Tg;if(Tg=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(Eg)){var Mg=Tg[1],Ag=Tg[2],Sg;switch(Mg){case'rgb':case'rgba':if(Sg=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(Ag))return this.r=Math.min(255,parseInt(Sg[1],10))/255,this.g=Math.min(255,parseInt(Sg[2],10))/255,this.b=Math.min(255,parseInt(Sg[3],10))/255,bg(Sg[5]),this;if(Sg=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(Ag))return this.r=Math.min(100,parseInt(Sg[1],10))/100,this.g=Math.min(100,parseInt(Sg[2],10))/100,this.b=Math.min(100,parseInt(Sg[3],10))/100,bg(Sg[5]),this;break;case'hsl':case'hsla':if(Sg=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(Ag)){var wg=parseFloat(Sg[1])/360,Rg=parseInt(Sg[2],10)/100,Lg=parseInt(Sg[3],10)/100;return bg(Sg[5]),this.setHSL(wg,Rg,Lg)}}}else if(Tg=/^\#([A-Fa-f0-9]+)$/.exec(Eg)){var Pg=(Cg=Tg[1]).length;if(3===Pg)return this.r=parseInt(Cg.charAt(0)+Cg.charAt(0),16)/255,this.g=parseInt(Cg.charAt(1)+Cg.charAt(1),16)/255,this.b=parseInt(Cg.charAt(2)+Cg.charAt(2),16)/255,this;if(6===Pg)return this.r=parseInt(Cg.charAt(0)+Cg.charAt(1),16)/255,this.g=parseInt(Cg.charAt(2)+Cg.charAt(3),16)/255,this.b=parseInt(Cg.charAt(4)+Cg.charAt(5),16)/255,this}if(Eg&&0<Eg.length){var Cg=Ou[Eg];void 0===Cg?console.warn('THREE.Color: Unknown color '+Eg):this.setHex(Cg)}return this},clone:function clone(){return new this.constructor(this.r,this.g,this.b)},copy:function copy(Eg){return this.r=Eg.r,this.g=Eg.g,this.b=Eg.b,this},copyGammaToLinear:function copyGammaToLinear(Eg,bg){return void 0===bg&&(bg=2),this.r=Math.pow(Eg.r,bg),this.g=Math.pow(Eg.g,bg),this.b=Math.pow(Eg.b,bg),this},copyLinearToGamma:function copyLinearToGamma(Eg,bg){void 0===bg&&(bg=2);var Tg=0<bg?1/bg:1;return this.r=Math.pow(Eg.r,Tg),this.g=Math.pow(Eg.g,Tg),this.b=Math.pow(Eg.b,Tg),this},convertGammaToLinear:function convertGammaToLinear(){var Eg=this.r,bg=this.g,Tg=this.b;return this.r=Eg*Eg,this.g=bg*bg,this.b=Tg*Tg,this},convertLinearToGamma:function convertLinearToGamma(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function getHex(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function getHexString(){return('000000'+this.getHex().toString(16)).slice(-6)},getHSL:function getHSL(Eg){var Sg=Eg||{h:0,s:0,l:0},Mg=this.r,Ag=this.g,wg=this.b,Rg=Math.max(Mg,Ag,wg),Lg=Math.min(Mg,Ag,wg),Pg=(Lg+Rg)/2,bg,Tg;if(Lg===Rg)bg=0,Tg=0;else{var Cg=Rg-Lg;switch(Tg=.5>=Pg?Cg/(Rg+Lg):Cg/(2-Rg-Lg),Rg){case Mg:bg=(Ag-wg)/Cg+(Ag<wg?6:0);break;case Ag:bg=(wg-Mg)/Cg+2;break;case wg:bg=(Mg-Ag)/Cg+4;}bg/=6}return Sg.h=bg,Sg.s=Tg,Sg.l=Pg,Sg},getStyle:function getStyle(){return'rgb('+(0|255*this.r)+','+(0|255*this.g)+','+(0|255*this.b)+')'},offsetHSL:function offsetHSL(Eg,bg,Tg){var Sg=this.getHSL();return Sg.h+=Eg,Sg.s+=bg,Sg.l+=Tg,this.setHSL(Sg.h,Sg.s,Sg.l),this},add:function add(Eg){return this.r+=Eg.r,this.g+=Eg.g,this.b+=Eg.b,this},addColors:function addColors(Eg,bg){return this.r=Eg.r+bg.r,this.g=Eg.g+bg.g,this.b=Eg.b+bg.b,this},addScalar:function addScalar(Eg){return this.r+=Eg,this.g+=Eg,this.b+=Eg,this},sub:function sub(Eg){return this.r=Math.max(0,this.r-Eg.r),this.g=Math.max(0,this.g-Eg.g),this.b=Math.max(0,this.b-Eg.b),this},multiply:function multiply(Eg){return this.r*=Eg.r,this.g*=Eg.g,this.b*=Eg.b,this},multiplyScalar:function multiplyScalar(Eg){return this.r*=Eg,this.g*=Eg,this.b*=Eg,this},lerp:function lerp(Eg,bg){return this.r+=(Eg.r-this.r)*bg,this.g+=(Eg.g-this.g)*bg,this.b+=(Eg.b-this.b)*bg,this},equals:function equals(Eg){return Eg.r===this.r&&Eg.g===this.g&&Eg.b===this.b},fromArray:function fromArray(Eg,bg){return void 0===bg&&(bg=0),this.r=Eg[bg],this.g=Eg[bg+1],this.b=Eg[bg+2],this},toArray:function toArray(Eg,bg){return void 0===Eg&&(Eg=[]),void 0===bg&&(bg=0),Eg[bg]=this.r,Eg[bg+1]=this.g,Eg[bg+2]=this.b,Eg},toJSON:function toJSON(){return this.getHex()}});var Vu={common:{diffuse:{value:new Ps(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new Xo},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Go(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Ps(16777215)}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new Ps(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},uvTransform:{value:new Xo}}},Wu={merge:function merge(Eg){for(var bg={},Tg=0,Sg;Tg<Eg.length;Tg++)for(var Mg in Sg=this.clone(Eg[Tg]),Sg)bg[Mg]=Sg[Mg];return bg},clone:function clone(Eg){var bg={};for(var Tg in Eg)for(var Sg in bg[Tg]={},Eg[Tg]){var Mg=Eg[Tg][Sg];bg[Tg][Sg]=Mg&&(Mg.isColor||Mg.isMatrix3||Mg.isMatrix4||Mg.isVector2||Mg.isVector3||Mg.isVector4||Mg.isTexture)?Mg.clone():Array.isArray(Mg)?Mg.slice():Mg}return bg}},ku={alphamap_fragment:'#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n',alphamap_pars_fragment:'#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif\n',alphatest_fragment:'#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n',aomap_fragment:'#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif\n',aomap_pars_fragment:'#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif',begin_vertex:'\nvec3 transformed = vec3( position );\n',beginnormal_vertex:'\nvec3 objectNormal = vec3( normal );\n',bsdfs:'float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tif( decayExponent > 0.0 ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tfloat maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\treturn distanceFalloff * maxDistanceCutoffFactor;\n#else\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n#endif\n\t}\n\treturn 1.0;\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat theta = acos( dot( N, V ) );\n\tvec2 uv = vec2(\n\t\tsqrt( saturate( roughness ) ),\n\t\tsaturate( theta / ( 0.5 * PI ) ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.86267 + (0.49788 + 0.01436 * y ) * y;\n\tfloat b = 3.45068 + (4.18814 + y) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = (x > 0.0) ? v : 0.5 * inversesqrt( 1.0 - x * x ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tvec3 result = vec3( LTC_ClippedSphereFormFactor( vectorFormFactor ) );\n\treturn result;\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n',bumpmap_pars_fragment:'#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif\n',clipping_planes_fragment:'#if NUM_CLIPPING_PLANES > 0\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; ++ i ) {\n\t\tvec4 plane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t\t\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; ++ i ) {\n\t\t\tvec4 plane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t\n\t#endif\n#endif\n',clipping_planes_pars_fragment:'#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif\n',clipping_planes_pars_vertex:'#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvarying vec3 vViewPosition;\n#endif\n',clipping_planes_vertex:'#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n',color_fragment:'#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif',color_pars_fragment:'#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif\n',color_pars_vertex:'#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif',color_vertex:'#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif',common:'#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\n',cube_uv_reflection_fragment:'#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV(vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif\n',defaultnormal_vertex:'vec3 transformedNormal = normalMatrix * objectNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n',displacementmap_pars_vertex:'#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif\n',displacementmap_vertex:'#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n',emissivemap_fragment:'#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif\n',emissivemap_pars_fragment:'#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif\n',encodings_fragment:'  gl_FragColor = linearToOutputTexel( gl_FragColor );\n',encodings_pars_fragment:'\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.xyz * value.w * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM            = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat D      = max( maxRange / maxRGB, 1.0 );\n\tD            = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n\tXp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract(Le);\n\tvResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n\treturn vec4( max(vRGB, 0.0), 1.0 );\n}\n',envmap_fragment:'#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif\n',envmap_pars_fragment:'#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif\n',envmap_pars_vertex:'#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif\n',envmap_vertex:'#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif\n',fog_vertex:'\n#ifdef USE_FOG\nfogDepth = -mvPosition.z;\n#endif',fog_pars_vertex:'#ifdef USE_FOG\n  varying float fogDepth;\n#endif\n',fog_fragment:'#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif\n',fog_pars_fragment:'#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif\n',gradientmap_pars_fragment:'#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif\n',lightmap_fragment:'#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n',lightmap_pars_fragment:'#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif',lights_lambert_vertex:'vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif\n',lights_pars:'uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowCameraNear;\n\t\tfloat shadowCameraFar;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltcMat;\tuniform sampler2D ltcMag;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif\n#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV(queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n',lights_phong_fragment:'BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n',lights_phong_pars_fragment:'varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)\n',lights_physical_fragment:'PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif\n',lights_physical_pars_fragment:'struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos - halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos + halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos + halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos - halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tfloat norm = texture2D( ltcMag, uv ).a;\n\t\tvec4 t = texture2D( ltcMat, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3(   1,   0, t.y ),\n\t\t\tvec3(   0, t.z,   0 ),\n\t\t\tvec3( t.w,   0, t.x )\n\t\t);\n\t\treflectedLight.directSpecular += lightColor * material.specularColor * norm * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.indirectSpecular += ( 1.0 - clearCoatDHR ) * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}\n',lights_template:'\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tirradiance += getLightProbeIndirectIrradiance( geometry, 8 );\n\t#endif\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tvec3 radiance = getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), 8 );\n\t#ifndef STANDARD\n\t\tvec3 clearCoatRadiance = getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), 8 );\n\t#else\n\t\tvec3 clearCoatRadiance = vec3( 0.0 );\n\t#endif\n\tRE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif\n',logdepthbuf_fragment:'#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif',logdepthbuf_pars_fragment:'#ifdef USE_LOGDEPTHBUF\n\tuniform float logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n#endif\n',logdepthbuf_pars_vertex:'#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n\tuniform float logDepthBufFC;\n#endif',logdepthbuf_vertex:'#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\tgl_Position.z *= gl_Position.w;\n\t#endif\n#endif\n',map_fragment:'#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif\n',map_pars_fragment:'#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n',map_particle_fragment:'#ifdef USE_MAP\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n',map_particle_pars_fragment:'#ifdef USE_MAP\n\tuniform mat3 uvTransform;\n\tuniform sampler2D map;\n#endif\n',metalnessmap_fragment:'float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif\n',metalnessmap_pars_fragment:'#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif',morphnormal_vertex:'#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n',morphtarget_pars_vertex:'#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif',morphtarget_vertex:'#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif\n',normal_fragment:'#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n#endif\n#ifdef USE_NORMALMAP\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n',normalmap_pars_fragment:'#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n\t\tvec3 N = normalize( surf_norm );\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy = normalScale * mapN.xy;\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif\n',packing:'vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n',premultiplied_alpha_fragment:'#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif\n',project_vertex:'vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\n',dithering_fragment:'#if defined( DITHERING )\n  gl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif\n',dithering_pars_fragment:'#if defined( DITHERING )\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif\n',roughnessmap_fragment:'float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif\n',roughnessmap_pars_fragment:'#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif',shadowmap_pars_fragment:'#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif\n',shadowmap_pars_vertex:'#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif\n',shadowmap_vertex:'#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif\n',shadowmask_pars_fragment:'float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}\n',skinbase_vertex:'#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif',skinning_pars_vertex:'#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif\n',skinning_vertex:'#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif\n',skinnormal_vertex:'#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n',specularmap_fragment:'float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif',specularmap_pars_fragment:'#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif',tonemapping_fragment:'#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif\n',tonemapping_pars_fragment:'#define saturate(a) clamp( a, 0.0, 1.0 )\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\n',uv_pars_fragment:'#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif',uv_pars_vertex:'#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\n',uv_vertex:'#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif',uv2_pars_fragment:'#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif',uv2_pars_vertex:'#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif',uv2_vertex:'#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif',worldpos_vertex:'#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n#endif\n',cube_frag:'uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldPosition;\nvoid main() {\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n\tgl_FragColor.a *= opacity;\n}\n',cube_vert:'varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}\n',depth_frag:'#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}\n',depth_vert:'#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n',distanceRGBA_frag:'#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}\n',distanceRGBA_vert:'#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}\n',equirect_frag:'uniform sampler2D tEquirect;\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldPosition );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n}\n',equirect_vert:'varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n',linedashed_frag:'uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n',linedashed_vert:'uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}\n',meshbasic_frag:'uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n',meshbasic_vert:'#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}\n',meshlambert_frag:'uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n',meshlambert_vert:'#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n',meshphong_frag:'#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n',meshphong_vert:'#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n',meshphysical_frag:'#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <lights_pars>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n',meshphysical_vert:'#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n',normal_frag:'#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}\n',normal_vert:'#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}\n',points_frag:'uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n',points_vert:'uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#ifdef USE_SIZEATTENUATION\n\t\tgl_PointSize = size * ( scale / - mvPosition.z );\n\t#else\n\t\tgl_PointSize = size;\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n',shadow_frag:'uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <fog_fragment>\n}\n',shadow_vert:'#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n'},Xu={basic:{uniforms:Wu.merge([Vu.common,Vu.specularmap,Vu.envmap,Vu.aomap,Vu.lightmap,Vu.fog]),vertexShader:ku.meshbasic_vert,fragmentShader:ku.meshbasic_frag},lambert:{uniforms:Wu.merge([Vu.common,Vu.specularmap,Vu.envmap,Vu.aomap,Vu.lightmap,Vu.emissivemap,Vu.fog,Vu.lights,{emissive:{value:new Ps(0)}}]),vertexShader:ku.meshlambert_vert,fragmentShader:ku.meshlambert_frag},phong:{uniforms:Wu.merge([Vu.common,Vu.specularmap,Vu.envmap,Vu.aomap,Vu.lightmap,Vu.emissivemap,Vu.bumpmap,Vu.normalmap,Vu.displacementmap,Vu.gradientmap,Vu.fog,Vu.lights,{emissive:{value:new Ps(0)},specular:{value:new Ps(1118481)},shininess:{value:30}}]),vertexShader:ku.meshphong_vert,fragmentShader:ku.meshphong_frag},standard:{uniforms:Wu.merge([Vu.common,Vu.envmap,Vu.aomap,Vu.lightmap,Vu.emissivemap,Vu.bumpmap,Vu.normalmap,Vu.displacementmap,Vu.roughnessmap,Vu.metalnessmap,Vu.fog,Vu.lights,{emissive:{value:new Ps(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:ku.meshphysical_vert,fragmentShader:ku.meshphysical_frag},points:{uniforms:Wu.merge([Vu.points,Vu.fog]),vertexShader:ku.points_vert,fragmentShader:ku.points_frag},dashed:{uniforms:Wu.merge([Vu.common,Vu.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ku.linedashed_vert,fragmentShader:ku.linedashed_frag},depth:{uniforms:Wu.merge([Vu.common,Vu.displacementmap]),vertexShader:ku.depth_vert,fragmentShader:ku.depth_frag},normal:{uniforms:Wu.merge([Vu.common,Vu.bumpmap,Vu.normalmap,Vu.displacementmap,{opacity:{value:1}}]),vertexShader:ku.normal_vert,fragmentShader:ku.normal_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:ku.cube_vert,fragmentShader:ku.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ku.equirect_vert,fragmentShader:ku.equirect_frag},distanceRGBA:{uniforms:Wu.merge([Vu.common,Vu.displacementmap,{referencePosition:{value:new Wo},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ku.distanceRGBA_vert,fragmentShader:ku.distanceRGBA_frag},shadow:{uniforms:Wu.merge([Vu.lights,Vu.fog,{color:{value:new Ps(0)},opacity:{value:1}}]),vertexShader:ku.shadow_vert,fragmentShader:ku.shadow_frag}};Xu.physical={uniforms:Wu.merge([Xu.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:ku.meshphysical_vert,fragmentShader:ku.meshphysical_frag},Object.assign(Cs.prototype,{set:function set(Eg,bg){return this.min.copy(Eg),this.max.copy(bg),this},setFromPoints:function setFromPoints(Eg){this.makeEmpty();for(var bg=0,Tg=Eg.length;bg<Tg;bg++)this.expandByPoint(Eg[bg]);return this},setFromCenterAndSize:function(){var Eg=new Go;return function(bg,Tg){var Sg=Eg.copy(Tg).multiplyScalar(.5);return this.min.copy(bg).sub(Sg),this.max.copy(bg).add(Sg),this}}(),clone:function clone(){return new this.constructor().copy(this)},copy:function copy(Eg){return this.min.copy(Eg.min),this.max.copy(Eg.max),this},makeEmpty:function makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function getCenter(Eg){var bg=Eg||new Go;return this.isEmpty()?bg.set(0,0):bg.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function getSize(Eg){var bg=Eg||new Go;return this.isEmpty()?bg.set(0,0):bg.subVectors(this.max,this.min)},expandByPoint:function expandByPoint(Eg){return this.min.min(Eg),this.max.max(Eg),this},expandByVector:function expandByVector(Eg){return this.min.sub(Eg),this.max.add(Eg),this},expandByScalar:function expandByScalar(Eg){return this.min.addScalar(-Eg),this.max.addScalar(Eg),this},containsPoint:function containsPoint(Eg){return!(Eg.x<this.min.x||Eg.x>this.max.x||Eg.y<this.min.y||Eg.y>this.max.y)},containsBox:function containsBox(Eg){return this.min.x<=Eg.min.x&&Eg.max.x<=this.max.x&&this.min.y<=Eg.min.y&&Eg.max.y<=this.max.y},getParameter:function getParameter(Eg,bg){return(bg||new Go).set((Eg.x-this.min.x)/(this.max.x-this.min.x),(Eg.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function intersectsBox(Eg){return!(Eg.max.x<this.min.x||Eg.min.x>this.max.x||Eg.max.y<this.min.y||Eg.min.y>this.max.y)},clampPoint:function clampPoint(Eg,bg){return(bg||new Go).copy(Eg).clamp(this.min,this.max)},distanceToPoint:function(){var Eg=new Go;return function(bg){return Eg.copy(bg).clamp(this.min,this.max).sub(bg).length()}}(),intersect:function intersect(Eg){return this.min.max(Eg.min),this.max.min(Eg.max),this},union:function union(Eg){return this.min.min(Eg.min),this.max.max(Eg.max),this},translate:function translate(Eg){return this.min.add(Eg),this.max.add(Eg),this},equals:function equals(Eg){return Eg.min.equals(this.min)&&Eg.max.equals(this.max)}}),(Us.prototype=Object.create(jo.prototype)).constructor=Us;var ju=0;Object.assign(Ns.prototype,Fo.prototype,{isMaterial:!0,onBeforeCompile:function onBeforeCompile(){},setValues:function setValues(Eg){if(void 0!==Eg)for(var bg in Eg){var Tg=Eg[bg];if(!(void 0!==Tg))console.warn('THREE.Material: \''+bg+'\' parameter is undefined.');else if('shading'!=bg){var Sg=this[bg];void 0===Sg?console.warn('THREE.'+this.type+': \''+bg+'\' is not a property of this material.'):Sg&&Sg.isColor?Sg.set(Tg):Sg&&Sg.isVector3&&Tg&&Tg.isVector3?Sg.copy(Tg):this[bg]='overdraw'==bg?+Tg:Tg}else console.warn('THREE.'+this.type+': .shading has been removed. Use the boolean .flatShading instead.'),this.flatShading=1===Tg}},toJSON:function toJSON(Eg){function bg(wg){var Rg=[];for(var Lg in wg){var Pg=wg[Lg];delete Pg.metadata,Rg.push(Pg)}return Rg}var Tg=void 0===Eg||'string'==typeof Eg;Tg&&(Eg={textures:{},images:{}});var Sg={metadata:{version:4.5,type:'Material',generator:'Material.toJSON'}};if(Sg.uuid=this.uuid,Sg.type=this.type,''!==this.name&&(Sg.name=this.name),this.color&&this.color.isColor&&(Sg.color=this.color.getHex()),void 0!==this.roughness&&(Sg.roughness=this.roughness),void 0!==this.metalness&&(Sg.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(Sg.emissive=this.emissive.getHex()),1!==this.emissiveIntensity&&(Sg.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(Sg.specular=this.specular.getHex()),void 0!==this.shininess&&(Sg.shininess=this.shininess),void 0!==this.clearCoat&&(Sg.clearCoat=this.clearCoat),void 0!==this.clearCoatRoughness&&(Sg.clearCoatRoughness=this.clearCoatRoughness),this.map&&this.map.isTexture&&(Sg.map=this.map.toJSON(Eg).uuid),this.alphaMap&&this.alphaMap.isTexture&&(Sg.alphaMap=this.alphaMap.toJSON(Eg).uuid),this.lightMap&&this.lightMap.isTexture&&(Sg.lightMap=this.lightMap.toJSON(Eg).uuid),this.bumpMap&&this.bumpMap.isTexture&&(Sg.bumpMap=this.bumpMap.toJSON(Eg).uuid,Sg.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(Sg.normalMap=this.normalMap.toJSON(Eg).uuid,Sg.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(Sg.displacementMap=this.displacementMap.toJSON(Eg).uuid,Sg.displacementScale=this.displacementScale,Sg.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(Sg.roughnessMap=this.roughnessMap.toJSON(Eg).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(Sg.metalnessMap=this.metalnessMap.toJSON(Eg).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(Sg.emissiveMap=this.emissiveMap.toJSON(Eg).uuid),this.specularMap&&this.specularMap.isTexture&&(Sg.specularMap=this.specularMap.toJSON(Eg).uuid),this.envMap&&this.envMap.isTexture&&(Sg.envMap=this.envMap.toJSON(Eg).uuid,Sg.reflectivity=this.reflectivity),this.gradientMap&&this.gradientMap.isTexture&&(Sg.gradientMap=this.gradientMap.toJSON(Eg).uuid),void 0!==this.size&&(Sg.size=this.size),void 0!==this.sizeAttenuation&&(Sg.sizeAttenuation=this.sizeAttenuation),this.blending!==kc&&(Sg.blending=this.blending),!0===this.flatShading&&(Sg.flatShading=this.flatShading),this.side!==Fc&&(Sg.side=this.side),this.vertexColors!==Hc&&(Sg.vertexColors=this.vertexColors),1>this.opacity&&(Sg.opacity=this.opacity),!0===this.transparent&&(Sg.transparent=this.transparent),Sg.depthFunc=this.depthFunc,Sg.depthTest=this.depthTest,Sg.depthWrite=this.depthWrite,0!==this.rotation&&(Sg.rotation=this.rotation),1!==this.linewidth&&(Sg.linewidth=this.linewidth),void 0!==this.dashSize&&(Sg.dashSize=this.dashSize),void 0!==this.gapSize&&(Sg.gapSize=this.gapSize),void 0!==this.scale&&(Sg.scale=this.scale),!0===this.dithering&&(Sg.dithering=!0),0<this.alphaTest&&(Sg.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(Sg.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(Sg.wireframe=this.wireframe),1<this.wireframeLinewidth&&(Sg.wireframeLinewidth=this.wireframeLinewidth),'round'!==this.wireframeLinecap&&(Sg.wireframeLinecap=this.wireframeLinecap),'round'!==this.wireframeLinejoin&&(Sg.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(Sg.morphTargets=!0),!0===this.skinning&&(Sg.skinning=!0),!1===this.visible&&(Sg.visible=!1),'{}'!==JSON.stringify(this.userData)&&(Sg.userData=this.userData),Tg){var Mg=bg(Eg.textures),Ag=bg(Eg.images);0<Mg.length&&(Sg.textures=Mg),0<Ag.length&&(Sg.images=Ag)}return Sg},clone:function clone(){return new this.constructor().copy(this)},copy:function copy(Eg){this.name=Eg.name,this.fog=Eg.fog,this.lights=Eg.lights,this.blending=Eg.blending,this.side=Eg.side,this.flatShading=Eg.flatShading,this.vertexColors=Eg.vertexColors,this.opacity=Eg.opacity,this.transparent=Eg.transparent,this.blendSrc=Eg.blendSrc,this.blendDst=Eg.blendDst,this.blendEquation=Eg.blendEquation,this.blendSrcAlpha=Eg.blendSrcAlpha,this.blendDstAlpha=Eg.blendDstAlpha,this.blendEquationAlpha=Eg.blendEquationAlpha,this.depthFunc=Eg.depthFunc,this.depthTest=Eg.depthTest,this.depthWrite=Eg.depthWrite,this.colorWrite=Eg.colorWrite,this.precision=Eg.precision,this.polygonOffset=Eg.polygonOffset,this.polygonOffsetFactor=Eg.polygonOffsetFactor,this.polygonOffsetUnits=Eg.polygonOffsetUnits,this.dithering=Eg.dithering,this.alphaTest=Eg.alphaTest,this.premultipliedAlpha=Eg.premultipliedAlpha,this.overdraw=Eg.overdraw,this.visible=Eg.visible,this.userData=JSON.parse(JSON.stringify(Eg.userData)),this.clipShadows=Eg.clipShadows,this.clipIntersection=Eg.clipIntersection;var bg=Eg.clippingPlanes,Tg=null;if(null!==bg){var Sg=bg.length;Tg=Array(Sg);for(var Mg=0;Mg!==Sg;++Mg)Tg[Mg]=bg[Mg].clone()}return this.clippingPlanes=Tg,this},dispose:function dispose(){this.dispatchEvent({type:'dispose'})}}),(Bs.prototype=Object.create(Ns.prototype)).constructor=Bs,Bs.prototype.isMeshDepthMaterial=!0,Bs.prototype.copy=function(Eg){return Ns.prototype.copy.call(this,Eg),this.depthPacking=Eg.depthPacking,this.skinning=Eg.skinning,this.morphTargets=Eg.morphTargets,this.map=Eg.map,this.alphaMap=Eg.alphaMap,this.displacementMap=Eg.displacementMap,this.displacementScale=Eg.displacementScale,this.displacementBias=Eg.displacementBias,this.wireframe=Eg.wireframe,this.wireframeLinewidth=Eg.wireframeLinewidth,this},(Fs.prototype=Object.create(Ns.prototype)).constructor=Fs,Fs.prototype.isMeshDistanceMaterial=!0,Fs.prototype.copy=function(Eg){return Ns.prototype.copy.call(this,Eg),this.referencePosition.copy(Eg.referencePosition),this.nearDistance=Eg.nearDistance,this.farDistance=Eg.farDistance,this.skinning=Eg.skinning,this.morphTargets=Eg.morphTargets,this.map=Eg.map,this.alphaMap=Eg.alphaMap,this.displacementMap=Eg.displacementMap,this.displacementScale=Eg.displacementScale,this.displacementBias=Eg.displacementBias,this},Object.assign(zs.prototype,{isBox3:!0,set:function set(Eg,bg){return this.min.copy(Eg),this.max.copy(bg),this},setFromArray:function setFromArray(Eg){for(var bg=1/0,Tg=1/0,Sg=1/0,Mg=-1/0,Ag=-1/0,wg=-1/0,Rg=0,Lg=Eg.length;Rg<Lg;Rg+=3){var Pg=Eg[Rg],Cg=Eg[Rg+1],Ig=Eg[Rg+2];Pg<bg&&(bg=Pg),Cg<Tg&&(Tg=Cg),Ig<Sg&&(Sg=Ig),Pg>Mg&&(Mg=Pg),Cg>Ag&&(Ag=Cg),Ig>wg&&(wg=Ig)}return this.min.set(bg,Tg,Sg),this.max.set(Mg,Ag,wg),this},setFromBufferAttribute:function setFromBufferAttribute(Eg){for(var bg=1/0,Tg=1/0,Sg=1/0,Mg=-1/0,Ag=-1/0,wg=-1/0,Rg=0,Lg=Eg.count;Rg<Lg;Rg++){var Pg=Eg.getX(Rg),Cg=Eg.getY(Rg),Ig=Eg.getZ(Rg);Pg<bg&&(bg=Pg),Cg<Tg&&(Tg=Cg),Ig<Sg&&(Sg=Ig),Pg>Mg&&(Mg=Pg),Cg>Ag&&(Ag=Cg),Ig>wg&&(wg=Ig)}return this.min.set(bg,Tg,Sg),this.max.set(Mg,Ag,wg),this},setFromPoints:function setFromPoints(Eg){this.makeEmpty();for(var bg=0,Tg=Eg.length;bg<Tg;bg++)this.expandByPoint(Eg[bg]);return this},setFromCenterAndSize:function(){var Eg=new Wo;return function(bg,Tg){var Sg=Eg.copy(Tg).multiplyScalar(.5);return this.min.copy(bg).sub(Sg),this.max.copy(bg).add(Sg),this}}(),setFromObject:function setFromObject(Eg){return this.makeEmpty(),this.expandByObject(Eg)},clone:function clone(){return new this.constructor().copy(this)},copy:function copy(Eg){return this.min.copy(Eg.min),this.max.copy(Eg.max),this},makeEmpty:function makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function getCenter(Eg){var bg=Eg||new Wo;return this.isEmpty()?bg.set(0,0,0):bg.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function getSize(Eg){var bg=Eg||new Wo;return this.isEmpty()?bg.set(0,0,0):bg.subVectors(this.max,this.min)},expandByPoint:function expandByPoint(Eg){return this.min.min(Eg),this.max.max(Eg),this},expandByVector:function expandByVector(Eg){return this.min.sub(Eg),this.max.add(Eg),this},expandByScalar:function expandByScalar(Eg){return this.min.addScalar(-Eg),this.max.addScalar(Eg),this},expandByObject:function(){function Eg(Ag){var wg=Ag.geometry;if(void 0!==wg)if(wg.isGeometry){var Rg=wg.vertices;for(Tg=0,Sg=Rg.length;Tg<Sg;Tg++)Mg.copy(Rg[Tg]),Mg.applyMatrix4(Ag.matrixWorld),bg.expandByPoint(Mg)}else if(wg.isBufferGeometry){var Lg=wg.attributes.position;if(void 0!==Lg)for(Tg=0,Sg=Lg.count;Tg<Sg;Tg++)Mg.fromBufferAttribute(Lg,Tg).applyMatrix4(Ag.matrixWorld),bg.expandByPoint(Mg)}}var Mg=new Wo,bg,Tg,Sg;return function(Ag){return bg=this,Ag.updateMatrixWorld(!0),Ag.traverse(Eg),this}}(),containsPoint:function containsPoint(Eg){return!(Eg.x<this.min.x||Eg.x>this.max.x||Eg.y<this.min.y||Eg.y>this.max.y||Eg.z<this.min.z||Eg.z>this.max.z)},containsBox:function containsBox(Eg){return this.min.x<=Eg.min.x&&Eg.max.x<=this.max.x&&this.min.y<=Eg.min.y&&Eg.max.y<=this.max.y&&this.min.z<=Eg.min.z&&Eg.max.z<=this.max.z},getParameter:function getParameter(Eg,bg){return(bg||new Wo).set((Eg.x-this.min.x)/(this.max.x-this.min.x),(Eg.y-this.min.y)/(this.max.y-this.min.y),(Eg.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function intersectsBox(Eg){return!(Eg.max.x<this.min.x||Eg.min.x>this.max.x||Eg.max.y<this.min.y||Eg.min.y>this.max.y||Eg.max.z<this.min.z||Eg.min.z>this.max.z)},intersectsSphere:function(){var Eg=new Wo;return function(bg){return this.clampPoint(bg.center,Eg),Eg.distanceToSquared(bg.center)<=bg.radius*bg.radius}}(),intersectsPlane:function intersectsPlane(Eg){var bg,Tg;return 0<Eg.normal.x?(bg=Eg.normal.x*this.min.x,Tg=Eg.normal.x*this.max.x):(bg=Eg.normal.x*this.max.x,Tg=Eg.normal.x*this.min.x),0<Eg.normal.y?(bg+=Eg.normal.y*this.min.y,Tg+=Eg.normal.y*this.max.y):(bg+=Eg.normal.y*this.max.y,Tg+=Eg.normal.y*this.min.y),0<Eg.normal.z?(bg+=Eg.normal.z*this.min.z,Tg+=Eg.normal.z*this.max.z):(bg+=Eg.normal.z*this.max.z,Tg+=Eg.normal.z*this.min.z),bg<=Eg.constant&&Tg>=Eg.constant},clampPoint:function clampPoint(Eg,bg){return(bg||new Wo).copy(Eg).clamp(this.min,this.max)},distanceToPoint:function(){var Eg=new Wo;return function(bg){return Eg.copy(bg).clamp(this.min,this.max).sub(bg).length()}}(),getBoundingSphere:function(){var Eg=new Wo;return function(bg){var Tg=bg||new Gs;return this.getCenter(Tg.center),Tg.radius=.5*this.getSize(Eg).length(),Tg}}(),intersect:function intersect(Eg){return this.min.max(Eg.min),this.max.min(Eg.max),this.isEmpty()&&this.makeEmpty(),this},union:function union(Eg){return this.min.min(Eg.min),this.max.max(Eg.max),this},applyMatrix4:function(){var Eg=[new Wo,new Wo,new Wo,new Wo,new Wo,new Wo,new Wo,new Wo];return function(bg){return this.isEmpty()?this:(Eg[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(bg),Eg[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(bg),Eg[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(bg),Eg[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(bg),Eg[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(bg),Eg[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(bg),Eg[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(bg),Eg[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(bg),this.setFromPoints(Eg),this)}}(),translate:function translate(Eg){return this.min.add(Eg),this.max.add(Eg),this},equals:function equals(Eg){return Eg.min.equals(this.min)&&Eg.max.equals(this.max)}}),Object.assign(Gs.prototype,{set:function set(Eg,bg){return this.center.copy(Eg),this.radius=bg,this},setFromPoints:function(){var Eg=new zs;return function(bg,Tg){var Sg=this.center;void 0===Tg?Eg.setFromPoints(bg).getCenter(Sg):Sg.copy(Tg);for(var Mg=0,Ag=0,wg=bg.length;Ag<wg;Ag++)Mg=Math.max(Mg,Sg.distanceToSquared(bg[Ag]));return this.radius=Math.sqrt(Mg),this}}(),clone:function clone(){return new this.constructor().copy(this)},copy:function copy(Eg){return this.center.copy(Eg.center),this.radius=Eg.radius,this},empty:function empty(){return 0>=this.radius},containsPoint:function containsPoint(Eg){return Eg.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function distanceToPoint(Eg){return Eg.distanceTo(this.center)-this.radius},intersectsSphere:function intersectsSphere(Eg){var bg=this.radius+Eg.radius;return Eg.center.distanceToSquared(this.center)<=bg*bg},intersectsBox:function intersectsBox(Eg){return Eg.intersectsSphere(this)},intersectsPlane:function intersectsPlane(Eg){return Math.abs(Eg.distanceToPoint(this.center))<=this.radius},clampPoint:function clampPoint(Eg,bg){var Tg=this.center.distanceToSquared(Eg),Sg=bg||new Wo;return Sg.copy(Eg),Tg>this.radius*this.radius&&(Sg.sub(this.center).normalize(),Sg.multiplyScalar(this.radius).add(this.center)),Sg},getBoundingBox:function getBoundingBox(Eg){var bg=Eg||new zs;return bg.set(this.center,this.center),bg.expandByScalar(this.radius),bg},applyMatrix4:function applyMatrix4(Eg){return this.center.applyMatrix4(Eg),this.radius*=Eg.getMaxScaleOnAxis(),this},translate:function translate(Eg){return this.center.add(Eg),this},equals:function equals(Eg){return Eg.center.equals(this.center)&&Eg.radius===this.radius}}),Object.assign(Hs.prototype,{set:function set(Eg,bg){return this.normal.copy(Eg),this.constant=bg,this},setComponents:function setComponents(Eg,bg,Tg,Sg){return this.normal.set(Eg,bg,Tg),this.constant=Sg,this},setFromNormalAndCoplanarPoint:function setFromNormalAndCoplanarPoint(Eg,bg){return this.normal.copy(Eg),this.constant=-bg.dot(this.normal),this},setFromCoplanarPoints:function(){var Eg=new Wo,bg=new Wo;return function(Tg,Sg,Mg){var Ag=Eg.subVectors(Mg,Sg).cross(bg.subVectors(Tg,Sg)).normalize();return this.setFromNormalAndCoplanarPoint(Ag,Tg),this}}(),clone:function clone(){return new this.constructor().copy(this)},copy:function copy(Eg){return this.normal.copy(Eg.normal),this.constant=Eg.constant,this},normalize:function normalize(){var Eg=1/this.normal.length();return this.normal.multiplyScalar(Eg),this.constant*=Eg,this},negate:function negate(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function distanceToPoint(Eg){return this.normal.dot(Eg)+this.constant},distanceToSphere:function distanceToSphere(Eg){return this.distanceToPoint(Eg.center)-Eg.radius},projectPoint:function projectPoint(Eg,bg){return(bg||new Wo).copy(this.normal).multiplyScalar(-this.distanceToPoint(Eg)).add(Eg)},intersectLine:function(){var Eg=new Wo;return function(bg,Tg){var Sg=Tg||new Wo,Mg=bg.delta(Eg),Ag=this.normal.dot(Mg);if(0!==Ag){var wg=-(bg.start.dot(this.normal)+this.constant)/Ag;if(!(0>wg||1<wg))return Sg.copy(Mg).multiplyScalar(wg).add(bg.start)}else if(0===this.distanceToPoint(bg.start))return Sg.copy(bg.start)}}(),intersectsLine:function intersectsLine(Eg){var bg=this.distanceToPoint(Eg.start),Tg=this.distanceToPoint(Eg.end);return 0>bg&&0<Tg||0>Tg&&0<bg},intersectsBox:function intersectsBox(Eg){return Eg.intersectsPlane(this)},intersectsSphere:function intersectsSphere(Eg){return Eg.intersectsPlane(this)},coplanarPoint:function coplanarPoint(Eg){return(Eg||new Wo).copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var Eg=new Wo,bg=new Xo;return function(Tg,Sg){var Mg=Sg||bg.getNormalMatrix(Tg),Ag=this.coplanarPoint(Eg).applyMatrix4(Tg),wg=this.normal.applyMatrix3(Mg).normalize();return this.constant=-Ag.dot(wg),this}}(),translate:function translate(Eg){return this.constant-=Eg.dot(this.normal),this},equals:function equals(Eg){return Eg.normal.equals(this.normal)&&Eg.constant===this.constant}}),Object.assign(Os.prototype,{set:function set(Eg,bg,Tg,Sg,Mg,Ag){var wg=this.planes;return wg[0].copy(Eg),wg[1].copy(bg),wg[2].copy(Tg),wg[3].copy(Sg),wg[4].copy(Mg),wg[5].copy(Ag),this},clone:function clone(){return new this.constructor().copy(this)},copy:function copy(Eg){for(var bg=this.planes,Tg=0;6>Tg;Tg++)bg[Tg].copy(Eg.planes[Tg]);return this},setFromMatrix:function setFromMatrix(Eg){var bg=this.planes,Tg=Eg.elements,Sg=Tg[0],Mg=Tg[1],Ag=Tg[2],wg=Tg[3],Rg=Tg[4],Lg=Tg[5],Pg=Tg[6],Cg=Tg[7],Ig=Tg[8],Ug=Tg[9],Dg=Tg[10],Ng=Tg[11],Bg=Tg[12],Fg=Tg[13],zg=Tg[14],Gg=Tg[15];return bg[0].setComponents(wg-Sg,Cg-Rg,Ng-Ig,Gg-Bg).normalize(),bg[1].setComponents(wg+Sg,Cg+Rg,Ng+Ig,Gg+Bg).normalize(),bg[2].setComponents(wg+Mg,Cg+Lg,Ng+Ug,Gg+Fg).normalize(),bg[3].setComponents(wg-Mg,Cg-Lg,Ng-Ug,Gg-Fg).normalize(),bg[4].setComponents(wg-Ag,Cg-Pg,Ng-Dg,Gg-zg).normalize(),bg[5].setComponents(wg+Ag,Cg+Pg,Ng+Dg,Gg+zg).normalize(),this},intersectsObject:function(){var Eg=new Gs;return function(bg){var Tg=bg.geometry;return null===Tg.boundingSphere&&Tg.computeBoundingSphere(),Eg.copy(Tg.boundingSphere).applyMatrix4(bg.matrixWorld),this.intersectsSphere(Eg)}}(),intersectsSprite:function(){var Eg=new Gs;return function(bg){return Eg.center.set(0,0,0),Eg.radius=.7071067811865476,Eg.applyMatrix4(bg.matrixWorld),this.intersectsSphere(Eg)}}(),intersectsSphere:function intersectsSphere(Eg){for(var bg=this.planes,Tg=Eg.center,Sg=-Eg.radius,Mg=0;6>Mg;Mg++)if(bg[Mg].distanceToPoint(Tg)<Sg)return!1;return!0},intersectsBox:function(){var Eg=new Wo,bg=new Wo;return function(Tg){for(var Sg=this.planes,Mg=0,Ag;6>Mg;Mg++){Ag=Sg[Mg],Eg.x=0<Ag.normal.x?Tg.min.x:Tg.max.x,bg.x=0<Ag.normal.x?Tg.max.x:Tg.min.x,Eg.y=0<Ag.normal.y?Tg.min.y:Tg.max.y,bg.y=0<Ag.normal.y?Tg.max.y:Tg.min.y,Eg.z=0<Ag.normal.z?Tg.min.z:Tg.max.z,bg.z=0<Ag.normal.z?Tg.max.z:Tg.min.z;var wg=Ag.distanceToPoint(Eg),Rg=Ag.distanceToPoint(bg);if(0>wg&&0>Rg)return!1}return!0}}(),containsPoint:function containsPoint(Eg){for(var bg=this.planes,Tg=0;6>Tg;Tg++)if(0>bg[Tg].distanceToPoint(Eg))return!1;return!0}}),ks.RotationOrders=['XYZ','YZX','ZXY','XZY','YXZ','ZYX'],ks.DefaultOrder='XYZ',Object.defineProperties(ks.prototype,{x:{get:function get(){return this._x},set:function set(Eg){this._x=Eg,this.onChangeCallback()}},y:{get:function get(){return this._y},set:function set(Eg){this._y=Eg,this.onChangeCallback()}},z:{get:function get(){return this._z},set:function set(Eg){this._z=Eg,this.onChangeCallback()}},order:{get:function get(){return this._order},set:function set(Eg){this._order=Eg,this.onChangeCallback()}}}),Object.assign(ks.prototype,{isEuler:!0,set:function set(Eg,bg,Tg,Sg){return this._x=Eg,this._y=bg,this._z=Tg,this._order=Sg||this._order,this.onChangeCallback(),this},clone:function clone(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function copy(Eg){return this._x=Eg._x,this._y=Eg._y,this._z=Eg._z,this._order=Eg._order,this.onChangeCallback(),this},setFromRotationMatrix:function setFromRotationMatrix(Eg,bg,Tg){var Sg=Iu.clamp,Mg=Eg.elements,Ag=Mg[0],wg=Mg[4],Rg=Mg[8],Lg=Mg[1],Pg=Mg[5],Cg=Mg[9],Ig=Mg[2],Ug=Mg[6],Dg=Mg[10];return'XYZ'===(bg=bg||this._order)?(this._y=Math.asin(Sg(Rg,-1,1)),.99999>Math.abs(Rg)?(this._x=Math.atan2(-Cg,Dg),this._z=Math.atan2(-wg,Ag)):(this._x=Math.atan2(Ug,Pg),this._z=0)):'YXZ'===bg?(this._x=Math.asin(-Sg(Cg,-1,1)),.99999>Math.abs(Cg)?(this._y=Math.atan2(Rg,Dg),this._z=Math.atan2(Lg,Pg)):(this._y=Math.atan2(-Ig,Ag),this._z=0)):'ZXY'===bg?(this._x=Math.asin(Sg(Ug,-1,1)),.99999>Math.abs(Ug)?(this._y=Math.atan2(-Ig,Dg),this._z=Math.atan2(-wg,Pg)):(this._y=0,this._z=Math.atan2(Lg,Ag))):'ZYX'===bg?(this._y=Math.asin(-Sg(Ig,-1,1)),.99999>Math.abs(Ig)?(this._x=Math.atan2(Ug,Dg),this._z=Math.atan2(Lg,Ag)):(this._x=0,this._z=Math.atan2(-wg,Pg))):'YZX'===bg?(this._z=Math.asin(Sg(Lg,-1,1)),.99999>Math.abs(Lg)?(this._x=Math.atan2(-Cg,Pg),this._y=Math.atan2(-Ig,Ag)):(this._x=0,this._y=Math.atan2(Rg,Dg))):'XZY'===bg?(this._z=Math.asin(-Sg(wg,-1,1)),.99999>Math.abs(wg)?(this._x=Math.atan2(Ug,Pg),this._y=Math.atan2(Rg,Ag)):(this._x=Math.atan2(-Cg,Dg),this._y=0)):console.warn('THREE.Euler: .setFromRotationMatrix() given unsupported order: '+bg),this._order=bg,!1!==Tg&&this.onChangeCallback(),this},setFromQuaternion:function(){var Eg=new Ho;return function(bg,Tg,Sg){return Eg.makeRotationFromQuaternion(bg),this.setFromRotationMatrix(Eg,Tg,Sg)}}(),setFromVector3:function setFromVector3(Eg,bg){return this.set(Eg.x,Eg.y,Eg.z,bg||this._order)},reorder:function(){var Eg=new Vo;return function(bg){return Eg.setFromEuler(this),this.setFromQuaternion(Eg,bg)}}(),equals:function equals(Eg){return Eg._x===this._x&&Eg._y===this._y&&Eg._z===this._z&&Eg._order===this._order},fromArray:function fromArray(Eg){return this._x=Eg[0],this._y=Eg[1],this._z=Eg[2],void 0!==Eg[3]&&(this._order=Eg[3]),this.onChangeCallback(),this},toArray:function toArray(Eg,bg){return void 0===Eg&&(Eg=[]),void 0===bg&&(bg=0),Eg[bg]=this._x,Eg[bg+1]=this._y,Eg[bg+2]=this._z,Eg[bg+3]=this._order,Eg},toVector3:function toVector3(Eg){return Eg?Eg.set(this._x,this._y,this._z):new Wo(this._x,this._y,this._z)},onChange:function onChange(Eg){return this.onChangeCallback=Eg,this},onChangeCallback:function onChangeCallback(){}}),Object.assign(Xs.prototype,{set:function set(Eg){this.mask=0|1<<Eg},enable:function enable(Eg){this.mask|=0|1<<Eg},toggle:function toggle(Eg){this.mask^=0|1<<Eg},disable:function disable(Eg){this.mask&=~(0|1<<Eg)},test:function test(Eg){return 0!=(this.mask&Eg.mask)}});var Yu=0;js.DefaultUp=new Wo(0,1,0),js.DefaultMatrixAutoUpdate=!0,Object.assign(js.prototype,Fo.prototype,{isObject3D:!0,onBeforeRender:function onBeforeRender(){},onAfterRender:function onAfterRender(){},applyMatrix:function applyMatrix(Eg){this.matrix.multiplyMatrices(Eg,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function applyQuaternion(Eg){return this.quaternion.premultiply(Eg),this},setRotationFromAxisAngle:function setRotationFromAxisAngle(Eg,bg){this.quaternion.setFromAxisAngle(Eg,bg)},setRotationFromEuler:function setRotationFromEuler(Eg){this.quaternion.setFromEuler(Eg,!0)},setRotationFromMatrix:function setRotationFromMatrix(Eg){this.quaternion.setFromRotationMatrix(Eg)},setRotationFromQuaternion:function setRotationFromQuaternion(Eg){this.quaternion.copy(Eg)},rotateOnAxis:function(){var Eg=new Vo;return function(bg,Tg){return Eg.setFromAxisAngle(bg,Tg),this.quaternion.multiply(Eg),this}}(),rotateOnWorldAxis:function(){var Eg=new Vo;return function(bg,Tg){return Eg.setFromAxisAngle(bg,Tg),this.quaternion.premultiply(Eg),this}}(),rotateX:function(){var Eg=new Wo(1,0,0);return function(bg){return this.rotateOnAxis(Eg,bg)}}(),rotateY:function(){var Eg=new Wo(0,1,0);return function(bg){return this.rotateOnAxis(Eg,bg)}}(),rotateZ:function(){var Eg=new Wo(0,0,1);return function(bg){return this.rotateOnAxis(Eg,bg)}}(),translateOnAxis:function(){var Eg=new Wo;return function(bg,Tg){return Eg.copy(bg).applyQuaternion(this.quaternion),this.position.add(Eg.multiplyScalar(Tg)),this}}(),translateX:function(){var Eg=new Wo(1,0,0);return function(bg){return this.translateOnAxis(Eg,bg)}}(),translateY:function(){var Eg=new Wo(0,1,0);return function(bg){return this.translateOnAxis(Eg,bg)}}(),translateZ:function(){var Eg=new Wo(0,0,1);return function(bg){return this.translateOnAxis(Eg,bg)}}(),localToWorld:function localToWorld(Eg){return Eg.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var Eg=new Ho;return function(bg){return bg.applyMatrix4(Eg.getInverse(this.matrixWorld))}}(),lookAt:function(){var Eg=new Ho,bg=new Wo;return function(Tg,Sg,Mg){Tg.isVector3?bg.copy(Tg):bg.set(Tg,Sg,Mg),this.isCamera?Eg.lookAt(this.position,bg,this.up):Eg.lookAt(bg,this.position,this.up),this.quaternion.setFromRotationMatrix(Eg)}}(),add:function add(Eg){if(Eg&&Eg.parent==this)return this;if(1<arguments.length){for(var bg=0;bg<arguments.length;bg++)this.add(arguments[bg]);return this}return Eg===this?(console.error('THREE.Object3D.add: object can\'t be added as a child of itself.',Eg),this):(Eg&&Eg.isObject3D?(null!==Eg.parent&&Eg.parent.remove(Eg),Eg.parent=this,Eg.dispatchEvent({type:'added'}),this.children.push(Eg)):console.error('THREE.Object3D.add: object not an instance of THREE.Object3D.',Eg),this)},remove:function remove(Eg){if(1<arguments.length){for(var bg=0;bg<arguments.length;bg++)this.remove(arguments[bg]);return this}var Tg=this.children.indexOf(Eg);return-1!==Tg&&(Eg.parent=null,Eg.dispatchEvent({type:'removed'}),this.children.splice(Tg,1)),this},getObjectById:function getObjectById(Eg){return this.getObjectByProperty('id',Eg)},getObjectByName:function getObjectByName(Eg){return this.getObjectByProperty('name',Eg)},getObjectByProperty:function getObjectByProperty(Eg,bg){if(this[Eg]===bg)return this;for(var Tg=0,Sg=this.children.length,Mg;Tg<Sg;Tg++)if(Mg=this.children[Tg].getObjectByProperty(Eg,bg),void 0!==Mg)return Mg},getWorldPosition:function getWorldPosition(Eg){var bg=Eg||new Wo;return this.updateMatrixWorld(!0),bg.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var Eg=new Wo,bg=new Wo;return function(Tg){var Sg=Tg||new Vo;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(Eg,Sg,bg),Sg}}(),getWorldRotation:function(){var Eg=new Vo;return function(bg){var Tg=bg||new ks;return this.getWorldQuaternion(Eg),Tg.setFromQuaternion(Eg,this.rotation.order,!1)}}(),getWorldScale:function(){var Eg=new Wo,bg=new Vo;return function(Tg){var Sg=Tg||new Wo;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(Eg,bg,Sg),Sg}}(),getWorldDirection:function(){var Eg=new Vo;return function(bg){var Tg=bg||new Wo;return this.getWorldQuaternion(Eg),Tg.set(0,0,1).applyQuaternion(Eg)}}(),raycast:function raycast(){},traverse:function traverse(Eg){Eg(this);for(var bg=this.children,Tg=0,Sg=bg.length;Tg<Sg;Tg++)bg[Tg].traverse(Eg)},traverseVisible:function traverseVisible(Eg){if(!1!==this.visible){Eg(this);for(var bg=this.children,Tg=0,Sg=bg.length;Tg<Sg;Tg++)bg[Tg].traverseVisible(Eg)}},traverseAncestors:function traverseAncestors(Eg){var bg=this.parent;null!==bg&&(Eg(bg),bg.traverseAncestors(Eg))},updateMatrix:function updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function updateMatrixWorld(Eg){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||Eg)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,Eg=!0);for(var bg=this.children,Tg=0,Sg=bg.length;Tg<Sg;Tg++)bg[Tg].updateMatrixWorld(Eg)},toJSON:function toJSON(Eg){function bg(Dg,Ng){return void 0===Dg[Ng.uuid]&&(Dg[Ng.uuid]=Ng.toJSON(Eg)),Ng.uuid}function Tg(Dg){var Ng=[];for(var Bg in Dg){var Fg=Dg[Bg];delete Fg.metadata,Ng.push(Fg)}return Ng}var Sg=void 0===Eg||'string'==typeof Eg,Mg={};Sg&&(Eg={geometries:{},materials:{},textures:{},images:{}},Mg.metadata={version:4.5,type:'Object',generator:'Object3D.toJSON'});var Ag={};if(Ag.uuid=this.uuid,Ag.type=this.type,''!==this.name&&(Ag.name=this.name),!0===this.castShadow&&(Ag.castShadow=!0),!0===this.receiveShadow&&(Ag.receiveShadow=!0),!1===this.visible&&(Ag.visible=!1),'{}'!==JSON.stringify(this.userData)&&(Ag.userData=this.userData),Ag.matrix=this.matrix.toArray(),void 0!==this.geometry&&(Ag.geometry=bg(Eg.geometries,this.geometry)),void 0!==this.material)if(Array.isArray(this.material)){for(var wg=[],Rg=0,Lg=this.material.length;Rg<Lg;Rg++)wg.push(bg(Eg.materials,this.material[Rg]));Ag.material=wg}else Ag.material=bg(Eg.materials,this.material);if(0<this.children.length)for(Ag.children=[],Rg=0;Rg<this.children.length;Rg++)Ag.children.push(this.children[Rg].toJSON(Eg).object);if(Sg){var Pg=Tg(Eg.geometries),Cg=Tg(Eg.materials),Ig=Tg(Eg.textures),Ug=Tg(Eg.images);0<Pg.length&&(Mg.geometries=Pg),0<Cg.length&&(Mg.materials=Cg),0<Ig.length&&(Mg.textures=Ig),0<Ug.length&&(Mg.images=Ug)}return Mg.object=Ag,Mg},clone:function clone(Eg){return new this.constructor().copy(this,Eg)},copy:function copy(Eg,bg){if(void 0===bg&&(bg=!0),this.name=Eg.name,this.up.copy(Eg.up),this.position.copy(Eg.position),this.quaternion.copy(Eg.quaternion),this.scale.copy(Eg.scale),this.matrix.copy(Eg.matrix),this.matrixWorld.copy(Eg.matrixWorld),this.matrixAutoUpdate=Eg.matrixAutoUpdate,this.matrixWorldNeedsUpdate=Eg.matrixWorldNeedsUpdate,this.layers.mask=Eg.layers.mask,this.visible=Eg.visible,this.castShadow=Eg.castShadow,this.receiveShadow=Eg.receiveShadow,this.frustumCulled=Eg.frustumCulled,this.renderOrder=Eg.renderOrder,this.userData=JSON.parse(JSON.stringify(Eg.userData)),!0===bg)for(var Tg=0,Sg;Tg<Eg.children.length;Tg++)Sg=Eg.children[Tg],this.add(Sg.clone());return this}}),Ys.prototype=Object.assign(Object.create(js.prototype),{constructor:Ys,isCamera:!0,copy:function copy(Eg,bg){return js.prototype.copy.call(this,Eg,bg),this.matrixWorldInverse.copy(Eg.matrixWorldInverse),this.projectionMatrix.copy(Eg.projectionMatrix),this},getWorldDirection:function(){var Eg=new Vo;return function(bg){var Tg=bg||new Wo;return this.getWorldQuaternion(Eg),Tg.set(0,0,-1).applyQuaternion(Eg)}}(),updateMatrixWorld:function updateMatrixWorld(Eg){js.prototype.updateMatrixWorld.call(this,Eg),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function clone(){return new this.constructor().copy(this)}}),qs.prototype=Object.assign(Object.create(Ys.prototype),{constructor:qs,isOrthographicCamera:!0,copy:function copy(Eg,bg){return Ys.prototype.copy.call(this,Eg,bg),this.left=Eg.left,this.right=Eg.right,this.top=Eg.top,this.bottom=Eg.bottom,this.near=Eg.near,this.far=Eg.far,this.zoom=Eg.zoom,this.view=null===Eg.view?null:Object.assign({},Eg.view),this},setViewOffset:function setViewOffset(Eg,bg,Tg,Sg,Mg,Ag){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=Eg,this.view.fullHeight=bg,this.view.offsetX=Tg,this.view.offsetY=Sg,this.view.width=Mg,this.view.height=Ag,this.updateProjectionMatrix()},clearViewOffset:function clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function updateProjectionMatrix(){var Eg=(this.right-this.left)/(2*this.zoom),bg=(this.top-this.bottom)/(2*this.zoom),Tg=(this.right+this.left)/2,Sg=(this.top+this.bottom)/2,Mg=Tg-Eg,Ag=Tg+Eg,wg=Sg+bg,Rg=Sg-bg;if(null!==this.view&&this.view.enabled){var Lg=this.zoom/(this.view.width/this.view.fullWidth),Pg=this.zoom/(this.view.height/this.view.fullHeight),Cg=(this.right-this.left)/this.view.width,Ig=(this.top-this.bottom)/this.view.height;Ag=(Mg+=Cg*(this.view.offsetX/Lg))+Cg*(this.view.width/Lg),Rg=(wg-=Ig*(this.view.offsetY/Pg))-Ig*(this.view.height/Pg)}this.projectionMatrix.makeOrthographic(Mg,Ag,wg,Rg,this.near,this.far)},toJSON:function toJSON(Eg){var bg=js.prototype.toJSON.call(this,Eg);return bg.object.zoom=this.zoom,bg.object.left=this.left,bg.object.right=this.right,bg.object.top=this.top,bg.object.bottom=this.bottom,bg.object.near=this.near,bg.object.far=this.far,null!==this.view&&(bg.object.view=Object.assign({},this.view)),bg}}),Object.assign(Zs.prototype,{clone:function clone(){return new this.constructor().copy(this)},copy:function copy(Eg){this.a=Eg.a,this.b=Eg.b,this.c=Eg.c,this.normal.copy(Eg.normal),this.color.copy(Eg.color),this.materialIndex=Eg.materialIndex;for(var bg=0,Tg=Eg.vertexNormals.length;bg<Tg;bg++)this.vertexNormals[bg]=Eg.vertexNormals[bg].clone();for(var bg=0,Tg=Eg.vertexColors.length;bg<Tg;bg++)this.vertexColors[bg]=Eg.vertexColors[bg].clone();return this}});var qu=0;Object.assign(Js.prototype,Fo.prototype,{isGeometry:!0,applyMatrix:function applyMatrix(Eg){for(var bg=new Xo().getNormalMatrix(Eg),Tg=0,Sg=this.vertices.length;Tg<Sg;Tg++)this.vertices[Tg].applyMatrix4(Eg);for(var Tg=0,Sg=this.faces.length,Mg;Tg<Sg;Tg++){Mg=this.faces[Tg],Mg.normal.applyMatrix3(bg).normalize();for(var Ag=0,wg=Mg.vertexNormals.length;Ag<wg;Ag++)Mg.vertexNormals[Ag].applyMatrix3(bg).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(){var Eg=new Ho;return function(bg){return Eg.makeRotationX(bg),this.applyMatrix(Eg),this}}(),rotateY:function(){var Eg=new Ho;return function(bg){return Eg.makeRotationY(bg),this.applyMatrix(Eg),this}}(),rotateZ:function(){var Eg=new Ho;return function(bg){return Eg.makeRotationZ(bg),this.applyMatrix(Eg),this}}(),translate:function(){var Eg=new Ho;return function(bg,Tg,Sg){return Eg.makeTranslation(bg,Tg,Sg),this.applyMatrix(Eg),this}}(),scale:function(){var Eg=new Ho;return function(bg,Tg,Sg){return Eg.makeScale(bg,Tg,Sg),this.applyMatrix(Eg),this}}(),lookAt:function(){var Eg=new js;return function(bg){Eg.lookAt(bg),Eg.updateMatrix(),this.applyMatrix(Eg.matrix)}}(),fromBufferGeometry:function fromBufferGeometry(Eg){function bg(Hg,Og,Vg,Wg){var kg=new Zs(Hg,Og,Vg,void 0===wg?[]:[Cg[Hg].clone(),Cg[Og].clone(),Cg[Vg].clone()],void 0===Rg?[]:[Tg.colors[Hg].clone(),Tg.colors[Og].clone(),Tg.colors[Vg].clone()],Wg);Tg.faces.push(kg),void 0!==Lg&&Tg.faceVertexUvs[0].push([Ig[Hg].clone(),Ig[Og].clone(),Ig[Vg].clone()]),void 0!==Pg&&Tg.faceVertexUvs[1].push([Ug[Hg].clone(),Ug[Og].clone(),Ug[Vg].clone()])}var Tg=this,Sg=null===Eg.index?void 0:Eg.index.array,Mg=Eg.attributes,Ag=Mg.position.array,wg=void 0===Mg.normal?void 0:Mg.normal.array,Rg=void 0===Mg.color?void 0:Mg.color.array,Lg=void 0===Mg.uv?void 0:Mg.uv.array,Pg=void 0===Mg.uv2?void 0:Mg.uv2.array;void 0!==Pg&&(this.faceVertexUvs[1]=[]);for(var Cg=[],Ig=[],Ug=[],Dg=0,Ng=0;Dg<Ag.length;Dg+=3,Ng+=2)Tg.vertices.push(new Wo(Ag[Dg],Ag[Dg+1],Ag[Dg+2])),void 0!==wg&&Cg.push(new Wo(wg[Dg],wg[Dg+1],wg[Dg+2])),void 0!==Rg&&Tg.colors.push(new Ps(Rg[Dg],Rg[Dg+1],Rg[Dg+2])),void 0!==Lg&&Ig.push(new Go(Lg[Ng],Lg[Ng+1])),void 0!==Pg&&Ug.push(new Go(Pg[Ng],Pg[Ng+1]));var Bg=Eg.groups;if(0<Bg.length)for(Dg=0;Dg<Bg.length;Dg++)for(var Fg=Bg[Dg],zg=Fg.start,Ng=zg,Gg=zg+Fg.count;Ng<Gg;Ng+=3)void 0===Sg?bg(Ng,Ng+1,Ng+2,Fg.materialIndex):bg(Sg[Ng],Sg[Ng+1],Sg[Ng+2],Fg.materialIndex);else if(void 0!==Sg)for(Dg=0;Dg<Sg.length;Dg+=3)bg(Sg[Dg],Sg[Dg+1],Sg[Dg+2]);else for(Dg=0;Dg<Ag.length/3;Dg+=3)bg(Dg,Dg+1,Dg+2);return this.computeFaceNormals(),null!==Eg.boundingBox&&(this.boundingBox=Eg.boundingBox.clone()),null!==Eg.boundingSphere&&(this.boundingSphere=Eg.boundingSphere.clone()),this},center:function center(){this.computeBoundingBox();var Eg=this.boundingBox.getCenter().negate();return this.translate(Eg.x,Eg.y,Eg.z),Eg},normalize:function normalize(){this.computeBoundingSphere();var Eg=this.boundingSphere.center,bg=this.boundingSphere.radius,Tg=0===bg?1:1/bg,Sg=new Ho;return Sg.set(Tg,0,0,-Tg*Eg.x,0,Tg,0,-Tg*Eg.y,0,0,Tg,-Tg*Eg.z,0,0,0,1),this.applyMatrix(Sg),this},computeFaceNormals:function computeFaceNormals(){for(var Eg=new Wo,bg=new Wo,Tg=0,Sg=this.faces.length;Tg<Sg;Tg++){var Mg=this.faces[Tg],Ag=this.vertices[Mg.a],wg=this.vertices[Mg.b],Rg=this.vertices[Mg.c];Eg.subVectors(Rg,wg),bg.subVectors(Ag,wg),Eg.cross(bg),Eg.normalize(),Mg.normal.copy(Eg)}},computeVertexNormals:function computeVertexNormals(Eg){void 0===Eg&&(Eg=!0);var bg,Tg,Sg,Mg,Ag,wg;for(wg=Array(this.vertices.length),bg=0,Tg=this.vertices.length;bg<Tg;bg++)wg[bg]=new Wo;if(Eg){var Cg=new Wo,Ig=new Wo,Rg,Lg,Pg;for(Sg=0,Mg=this.faces.length;Sg<Mg;Sg++)Ag=this.faces[Sg],Rg=this.vertices[Ag.a],Lg=this.vertices[Ag.b],Pg=this.vertices[Ag.c],Cg.subVectors(Pg,Lg),Ig.subVectors(Rg,Lg),Cg.cross(Ig),wg[Ag.a].add(Cg),wg[Ag.b].add(Cg),wg[Ag.c].add(Cg)}else for(this.computeFaceNormals(),Sg=0,Mg=this.faces.length;Sg<Mg;Sg++)wg[(Ag=this.faces[Sg]).a].add(Ag.normal),wg[Ag.b].add(Ag.normal),wg[Ag.c].add(Ag.normal);for(bg=0,Tg=this.vertices.length;bg<Tg;bg++)wg[bg].normalize();for(Sg=0,Mg=this.faces.length;Sg<Mg;Sg++){var Ug=(Ag=this.faces[Sg]).vertexNormals;3===Ug.length?(Ug[0].copy(wg[Ag.a]),Ug[1].copy(wg[Ag.b]),Ug[2].copy(wg[Ag.c])):(Ug[0]=wg[Ag.a].clone(),Ug[1]=wg[Ag.b].clone(),Ug[2]=wg[Ag.c].clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function computeFlatVertexNormals(){var Eg,bg,Tg;for(this.computeFaceNormals(),Eg=0,bg=this.faces.length;Eg<bg;Eg++){var Sg=(Tg=this.faces[Eg]).vertexNormals;3===Sg.length?(Sg[0].copy(Tg.normal),Sg[1].copy(Tg.normal),Sg[2].copy(Tg.normal)):(Sg[0]=Tg.normal.clone(),Sg[1]=Tg.normal.clone(),Sg[2]=Tg.normal.clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function computeMorphNormals(){var Eg,bg,Tg,Sg,Mg;for(Tg=0,Sg=this.faces.length;Tg<Sg;Tg++)for((Mg=this.faces[Tg]).__originalFaceNormal?Mg.__originalFaceNormal.copy(Mg.normal):Mg.__originalFaceNormal=Mg.normal.clone(),Mg.__originalVertexNormals||(Mg.__originalVertexNormals=[]),Eg=0,bg=Mg.vertexNormals.length;Eg<bg;Eg++)Mg.__originalVertexNormals[Eg]?Mg.__originalVertexNormals[Eg].copy(Mg.vertexNormals[Eg]):Mg.__originalVertexNormals[Eg]=Mg.vertexNormals[Eg].clone();var Ag=new Js;for(Ag.faces=this.faces,Eg=0,bg=this.morphTargets.length;Eg<bg;Eg++){if(!this.morphNormals[Eg]){this.morphNormals[Eg]={},this.morphNormals[Eg].faceNormals=[],this.morphNormals[Eg].vertexNormals=[];var wg=this.morphNormals[Eg].faceNormals,Rg=this.morphNormals[Eg].vertexNormals;for(Tg=0,Sg=this.faces.length;Tg<Sg;Tg++)Pg=new Wo,Cg={a:new Wo,b:new Wo,c:new Wo},wg.push(Pg),Rg.push(Cg)}var Lg=this.morphNormals[Eg];Ag.vertices=this.morphTargets[Eg].vertices,Ag.computeFaceNormals(),Ag.computeVertexNormals();var Pg,Cg;for(Tg=0,Sg=this.faces.length;Tg<Sg;Tg++)Mg=this.faces[Tg],Pg=Lg.faceNormals[Tg],Cg=Lg.vertexNormals[Tg],Pg.copy(Mg.normal),Cg.a.copy(Mg.vertexNormals[0]),Cg.b.copy(Mg.vertexNormals[1]),Cg.c.copy(Mg.vertexNormals[2])}for(Tg=0,Sg=this.faces.length;Tg<Sg;Tg++)(Mg=this.faces[Tg]).normal=Mg.__originalFaceNormal,Mg.vertexNormals=Mg.__originalVertexNormals},computeLineDistances:function computeLineDistances(){for(var Eg=0,bg=this.vertices,Tg=0,Sg=bg.length;Tg<Sg;Tg++)0<Tg&&(Eg+=bg[Tg].distanceTo(bg[Tg-1])),this.lineDistances[Tg]=Eg},computeBoundingBox:function computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new zs),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new Gs),this.boundingSphere.setFromPoints(this.vertices)},merge:function merge(Eg,bg,Tg){if(Eg&&Eg.isGeometry){var Mg=this.vertices.length,Ag=this.vertices,wg=Eg.vertices,Rg=this.faces,Lg=Eg.faces,Pg=this.faceVertexUvs[0],Cg=Eg.faceVertexUvs[0],Ig=this.colors,Ug=Eg.colors,Sg;void 0===Tg&&(Tg=0),void 0!==bg&&(Sg=new Xo().getNormalMatrix(bg));for(var Dg=0,Ng=wg.length,Bg;Dg<Ng;Dg++)Bg=wg[Dg].clone(),void 0!==bg&&Bg.applyMatrix4(bg),Ag.push(Bg);for(var Dg=0,Ng=Ug.length;Dg<Ng;Dg++)Ig.push(Ug[Dg].clone());for(Dg=0,Ng=Lg.length;Dg<Ng;Dg++){var Hg=Lg[Dg],Og=Hg.vertexNormals,Vg=Hg.vertexColors,Fg,zg,Gg;(Fg=new Zs(Hg.a+Mg,Hg.b+Mg,Hg.c+Mg)).normal.copy(Hg.normal),void 0!==Sg&&Fg.normal.applyMatrix3(Sg).normalize();for(var Wg=0,kg=Og.length;Wg<kg;Wg++)zg=Og[Wg].clone(),void 0!==Sg&&zg.applyMatrix3(Sg).normalize(),Fg.vertexNormals.push(zg);Fg.color.copy(Hg.color);for(var Wg=0,kg=Vg.length;Wg<kg;Wg++)Gg=Vg[Wg],Fg.vertexColors.push(Gg.clone());Fg.materialIndex=Hg.materialIndex+Tg,Rg.push(Fg)}for(Dg=0,Ng=Cg.length;Dg<Ng;Dg++){var Xg=Cg[Dg],jg=[];if(void 0!==Xg){for(var Wg=0,kg=Xg.length;Wg<kg;Wg++)jg.push(Xg[Wg].clone());Pg.push(jg)}}}else console.error('THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.',Eg)},mergeMesh:function mergeMesh(Eg){Eg&&Eg.isMesh?(Eg.matrixAutoUpdate&&Eg.updateMatrix(),this.merge(Eg.geometry,Eg.matrix)):console.error('THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.',Eg)},mergeVertices:function mergeVertices(){var Lg={},Pg=[],Cg=[],Ig=Math.pow(10,4),Eg,bg,Tg,Sg,Mg,Ag,wg,Rg;for(Tg=0,Sg=this.vertices.length;Tg<Sg;Tg++)Eg=this.vertices[Tg],void 0===Lg[bg=Math.round(Eg.x*Ig)+'_'+Math.round(Eg.y*Ig)+'_'+Math.round(Eg.z*Ig)]?(Lg[bg]=Tg,Pg.push(this.vertices[Tg]),Cg[Tg]=Pg.length-1):Cg[Tg]=Cg[Lg[bg]];var Ug=[];for(Tg=0,Sg=this.faces.length;Tg<Sg;Tg++){(Mg=this.faces[Tg]).a=Cg[Mg.a],Mg.b=Cg[Mg.b],Mg.c=Cg[Mg.c],Ag=[Mg.a,Mg.b,Mg.c];for(var Dg=0;3>Dg;Dg++)if(Ag[Dg]===Ag[(Dg+1)%3]){Ug.push(Tg);break}}for(Tg=Ug.length-1;0<=Tg;Tg--){var Ng=Ug[Tg];for(this.faces.splice(Ng,1),wg=0,Rg=this.faceVertexUvs.length;wg<Rg;wg++)this.faceVertexUvs[wg].splice(Ng,1)}var Bg=this.vertices.length-Pg.length;return this.vertices=Pg,Bg},setFromPoints:function setFromPoints(Eg){this.vertices=[];for(var bg=0,Tg=Eg.length,Sg;bg<Tg;bg++)Sg=Eg[bg],this.vertices.push(new Wo(Sg.x,Sg.y,Sg.z||0));return this},sortFacesByMaterialIndex:function sortFacesByMaterialIndex(){for(var Eg=this.faces,bg=Eg.length,Tg=0;Tg<bg;Tg++)Eg[Tg]._id=Tg;Eg.sort(function(Lg,Pg){return Lg.materialIndex-Pg.materialIndex});var Ag=this.faceVertexUvs[0],wg=this.faceVertexUvs[1],Sg,Mg;for(Ag&&Ag.length===bg&&(Sg=[]),wg&&wg.length===bg&&(Mg=[]),Tg=0;Tg<bg;Tg++){var Rg=Eg[Tg]._id;Sg&&Sg.push(Ag[Rg]),Mg&&Mg.push(wg[Rg])}Sg&&(this.faceVertexUvs[0]=Sg),Mg&&(this.faceVertexUvs[1]=Mg)},toJSON:function toJSON(){function Eg(qg,Zg,Jg){return Jg?qg|1<<Zg:qg&~(1<<Zg)}function bg(qg){var Zg=qg.x.toString()+qg.y.toString()+qg.z.toString();return void 0===Ug[Zg]?(Ug[Zg]=Ig.length/3,Ig.push(qg.x,qg.y,qg.z),Ug[Zg]):Ug[Zg]}function Tg(qg){var Zg=qg.r.toString()+qg.g.toString()+qg.b.toString();return void 0===Ng[Zg]?(Ng[Zg]=Dg.length,Dg.push(qg.getHex()),Ng[Zg]):Ng[Zg]}function Sg(qg){var Zg=qg.x.toString()+qg.y.toString();return void 0===Fg[Zg]?(Fg[Zg]=Bg.length/2,Bg.push(qg.x,qg.y),Fg[Zg]):Fg[Zg]}var Mg={metadata:{version:4.5,type:'Geometry',generator:'Geometry.toJSON'}};if(Mg.uuid=this.uuid,Mg.type=this.type,''!==this.name&&(Mg.name=this.name),void 0!==this.parameters){var Ag=this.parameters;for(var wg in Ag)void 0!==Ag[wg]&&(Mg[wg]=Ag[wg]);return Mg}for(var Rg=[],Lg=0,Pg;Lg<this.vertices.length;Lg++)Pg=this.vertices[Lg],Rg.push(Pg.x,Pg.y,Pg.z);for(var Cg=[],Ig=[],Ug={},Dg=[],Ng={},Bg=[],Fg={},Lg=0;Lg<this.faces.length;Lg++){var zg=this.faces[Lg],Gg=void 0!==this.faceVertexUvs[0][Lg],Hg=0<zg.normal.length(),Og=0<zg.vertexNormals.length,Vg=1!==zg.color.r||1!==zg.color.g||1!==zg.color.b,Wg=0<zg.vertexColors.length,kg=0;if(kg=Eg(kg,0,0),kg=Eg(kg,1,!0),kg=Eg(kg,2,!1),kg=Eg(kg,3,Gg),kg=Eg(kg,4,Hg),kg=Eg(kg,5,Og),kg=Eg(kg,6,Vg),kg=Eg(kg,7,Wg),Cg.push(kg),Cg.push(zg.a,zg.b,zg.c),Cg.push(zg.materialIndex),Gg){var Xg=this.faceVertexUvs[0][Lg];Cg.push(Sg(Xg[0]),Sg(Xg[1]),Sg(Xg[2]))}if(Hg&&Cg.push(bg(zg.normal)),Og){var jg=zg.vertexNormals;Cg.push(bg(jg[0]),bg(jg[1]),bg(jg[2]))}if(Vg&&Cg.push(Tg(zg.color)),Wg){var Yg=zg.vertexColors;Cg.push(Tg(Yg[0]),Tg(Yg[1]),Tg(Yg[2]))}}return Mg.data={},Mg.data.vertices=Rg,Mg.data.normals=Ig,0<Dg.length&&(Mg.data.colors=Dg),0<Bg.length&&(Mg.data.uvs=[Bg]),Mg.data.faces=Cg,Mg},clone:function clone(){return new Js().copy(this)},copy:function copy(Eg){var bg,Tg,Sg,Mg,Ag,wg;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=Eg.name;var Rg=Eg.vertices;for(bg=0,Tg=Rg.length;bg<Tg;bg++)this.vertices.push(Rg[bg].clone());var Lg=Eg.colors;for(bg=0,Tg=Lg.length;bg<Tg;bg++)this.colors.push(Lg[bg].clone());var Pg=Eg.faces;for(bg=0,Tg=Pg.length;bg<Tg;bg++)this.faces.push(Pg[bg].clone());for(bg=0,Tg=Eg.faceVertexUvs.length;bg<Tg;bg++){var Cg=Eg.faceVertexUvs[bg];for(void 0===this.faceVertexUvs[bg]&&(this.faceVertexUvs[bg]=[]),Sg=0,Mg=Cg.length;Sg<Mg;Sg++){var Ig=Cg[Sg],Ug=[];for(Ag=0,wg=Ig.length;Ag<wg;Ag++){var Dg=Ig[Ag];Ug.push(Dg.clone())}this.faceVertexUvs[bg].push(Ug)}}var Ng=Eg.morphTargets;for(bg=0,Tg=Ng.length;bg<Tg;bg++){var Bg={};if(Bg.name=Ng[bg].name,void 0!==Ng[bg].vertices)for(Bg.vertices=[],Sg=0,Mg=Ng[bg].vertices.length;Sg<Mg;Sg++)Bg.vertices.push(Ng[bg].vertices[Sg].clone());if(void 0!==Ng[bg].normals)for(Bg.normals=[],Sg=0,Mg=Ng[bg].normals.length;Sg<Mg;Sg++)Bg.normals.push(Ng[bg].normals[Sg].clone());this.morphTargets.push(Bg)}var Fg=Eg.morphNormals;for(bg=0,Tg=Fg.length;bg<Tg;bg++){var zg={};if(void 0!==Fg[bg].vertexNormals)for(zg.vertexNormals=[],Sg=0,Mg=Fg[bg].vertexNormals.length;Sg<Mg;Sg++){var Gg=Fg[bg].vertexNormals[Sg],Hg={};Hg.a=Gg.a.clone(),Hg.b=Gg.b.clone(),Hg.c=Gg.c.clone(),zg.vertexNormals.push(Hg)}if(void 0!==Fg[bg].faceNormals)for(zg.faceNormals=[],Sg=0,Mg=Fg[bg].faceNormals.length;Sg<Mg;Sg++)zg.faceNormals.push(Fg[bg].faceNormals[Sg].clone());this.morphNormals.push(zg)}var Og=Eg.skinWeights;for(bg=0,Tg=Og.length;bg<Tg;bg++)this.skinWeights.push(Og[bg].clone());var Vg=Eg.skinIndices;for(bg=0,Tg=Vg.length;bg<Tg;bg++)this.skinIndices.push(Vg[bg].clone());var Wg=Eg.lineDistances;for(bg=0,Tg=Wg.length;bg<Tg;bg++)this.lineDistances.push(Wg[bg]);var kg=Eg.boundingBox;null!==kg&&(this.boundingBox=kg.clone());var Xg=Eg.boundingSphere;return null!==Xg&&(this.boundingSphere=Xg.clone()),this.elementsNeedUpdate=Eg.elementsNeedUpdate,this.verticesNeedUpdate=Eg.verticesNeedUpdate,this.uvsNeedUpdate=Eg.uvsNeedUpdate,this.normalsNeedUpdate=Eg.normalsNeedUpdate,this.colorsNeedUpdate=Eg.colorsNeedUpdate,this.lineDistancesNeedUpdate=Eg.lineDistancesNeedUpdate,this.groupsNeedUpdate=Eg.groupsNeedUpdate,this},dispose:function dispose(){this.dispatchEvent({type:'dispose'})}}),Object.defineProperty(Qs.prototype,'needsUpdate',{set:function set(Eg){!0===Eg&&this.version++}}),Object.assign(Qs.prototype,{isBufferAttribute:!0,setArray:function setArray(Eg){if(Array.isArray(Eg))throw new TypeError('THREE.BufferAttribute: array should be a Typed Array.');this.count=void 0===Eg?0:Eg.length/this.itemSize,this.array=Eg},setDynamic:function setDynamic(Eg){return this.dynamic=Eg,this},copy:function copy(Eg){return this.array=new Eg.array.constructor(Eg.array),this.itemSize=Eg.itemSize,this.count=Eg.count,this.normalized=Eg.normalized,this.dynamic=Eg.dynamic,this},copyAt:function copyAt(Eg,bg,Tg){Eg*=this.itemSize,Tg*=bg.itemSize;for(var Sg=0,Mg=this.itemSize;Sg<Mg;Sg++)this.array[Eg+Sg]=bg.array[Tg+Sg];return this},copyArray:function copyArray(Eg){return this.array.set(Eg),this},copyColorsArray:function copyColorsArray(Eg){for(var bg=this.array,Tg=0,Sg=0,Mg=Eg.length,Ag;Sg<Mg;Sg++)Ag=Eg[Sg],void 0===Ag&&(console.warn('THREE.BufferAttribute.copyColorsArray(): color is undefined',Sg),Ag=new Ps),bg[Tg++]=Ag.r,bg[Tg++]=Ag.g,bg[Tg++]=Ag.b;return this},copyIndicesArray:function copyIndicesArray(Eg){for(var bg=this.array,Tg=0,Sg=0,Mg=Eg.length,Ag;Sg<Mg;Sg++)Ag=Eg[Sg],bg[Tg++]=Ag.a,bg[Tg++]=Ag.b,bg[Tg++]=Ag.c;return this},copyVector2sArray:function copyVector2sArray(Eg){for(var bg=this.array,Tg=0,Sg=0,Mg=Eg.length,Ag;Sg<Mg;Sg++)Ag=Eg[Sg],void 0===Ag&&(console.warn('THREE.BufferAttribute.copyVector2sArray(): vector is undefined',Sg),Ag=new Go),bg[Tg++]=Ag.x,bg[Tg++]=Ag.y;return this},copyVector3sArray:function copyVector3sArray(Eg){for(var bg=this.array,Tg=0,Sg=0,Mg=Eg.length,Ag;Sg<Mg;Sg++)Ag=Eg[Sg],void 0===Ag&&(console.warn('THREE.BufferAttribute.copyVector3sArray(): vector is undefined',Sg),Ag=new Wo),bg[Tg++]=Ag.x,bg[Tg++]=Ag.y,bg[Tg++]=Ag.z;return this},copyVector4sArray:function copyVector4sArray(Eg){for(var bg=this.array,Tg=0,Sg=0,Mg=Eg.length,Ag;Sg<Mg;Sg++)Ag=Eg[Sg],void 0===Ag&&(console.warn('THREE.BufferAttribute.copyVector4sArray(): vector is undefined',Sg),Ag=new Yo),bg[Tg++]=Ag.x,bg[Tg++]=Ag.y,bg[Tg++]=Ag.z,bg[Tg++]=Ag.w;return this},set:function set(Eg,bg){return void 0===bg&&(bg=0),this.array.set(Eg,bg),this},getX:function getX(Eg){return this.array[Eg*this.itemSize]},setX:function setX(Eg,bg){return this.array[Eg*this.itemSize]=bg,this},getY:function getY(Eg){return this.array[Eg*this.itemSize+1]},setY:function setY(Eg,bg){return this.array[Eg*this.itemSize+1]=bg,this},getZ:function getZ(Eg){return this.array[Eg*this.itemSize+2]},setZ:function setZ(Eg,bg){return this.array[Eg*this.itemSize+2]=bg,this},getW:function getW(Eg){return this.array[Eg*this.itemSize+3]},setW:function setW(Eg,bg){return this.array[Eg*this.itemSize+3]=bg,this},setXY:function setXY(Eg,bg,Tg){return Eg*=this.itemSize,this.array[Eg+0]=bg,this.array[Eg+1]=Tg,this},setXYZ:function setXYZ(Eg,bg,Tg,Sg){return Eg*=this.itemSize,this.array[Eg+0]=bg,this.array[Eg+1]=Tg,this.array[Eg+2]=Sg,this},setXYZW:function setXYZW(Eg,bg,Tg,Sg,Mg){return Eg*=this.itemSize,this.array[Eg+0]=bg,this.array[Eg+1]=Tg,this.array[Eg+2]=Sg,this.array[Eg+3]=Mg,this},onUpload:function onUpload(Eg){return this.onUploadCallback=Eg,this},clone:function clone(){return new this.constructor(this.array,this.itemSize).copy(this)}}),(Ks.prototype=Object.create(Qs.prototype)).constructor=Ks,($s.prototype=Object.create(Qs.prototype)).constructor=$s,(el.prototype=Object.create(Qs.prototype)).constructor=el,(tl.prototype=Object.create(Qs.prototype)).constructor=tl,(rl.prototype=Object.create(Qs.prototype)).constructor=rl,(al.prototype=Object.create(Qs.prototype)).constructor=al,(il.prototype=Object.create(Qs.prototype)).constructor=il,(ol.prototype=Object.create(Qs.prototype)).constructor=ol,(nl.prototype=Object.create(Qs.prototype)).constructor=nl,Object.assign(sl.prototype,{computeGroups:function computeGroups(Eg){for(var Tg=[],Sg=void 0,Mg=Eg.faces,Ag=0,bg,wg;Ag<Mg.length;Ag++)wg=Mg[Ag],wg.materialIndex!==Sg&&(Sg=wg.materialIndex,void 0!=bg&&(bg.count=3*Ag-bg.start,Tg.push(bg)),bg={start:3*Ag,materialIndex:Sg});void 0!==bg&&(bg.count=3*Ag-bg.start,Tg.push(bg)),this.groups=Tg},fromGeometry:function fromGeometry(Eg){var Tg=Eg.faces,Sg=Eg.vertices,Mg=Eg.faceVertexUvs,Ag=Mg[0]&&0<Mg[0].length,wg=Mg[1]&&0<Mg[1].length,Rg=Eg.morphTargets,Lg=Rg.length,bg;if(0<Lg){for(bg=[],Fg=0;Fg<Lg;Fg++)bg[Fg]=[];this.morphTargets.position=bg}var Cg=Eg.morphNormals,Ig=Cg.length,Pg;if(0<Ig){for(Pg=[],Fg=0;Fg<Ig;Fg++)Pg[Fg]=[];this.morphTargets.normal=Pg}for(var Ug=Eg.skinIndices,Dg=Eg.skinWeights,Ng=Ug.length===Sg.length,Bg=Dg.length===Sg.length,Fg=0,zg;Fg<Tg.length;Fg++){zg=Tg[Fg],this.vertices.push(Sg[zg.a],Sg[zg.b],Sg[zg.c]);var Gg=zg.vertexNormals;if(3===Gg.length)this.normals.push(Gg[0],Gg[1],Gg[2]);else{var Hg=zg.normal;this.normals.push(Hg,Hg,Hg)}var Og=zg.vertexColors;if(3===Og.length)this.colors.push(Og[0],Og[1],Og[2]);else{var Vg=zg.color;this.colors.push(Vg,Vg,Vg)}if(!0===Ag&&(void 0===(Wg=Mg[0][Fg])?(console.warn('THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ',Fg),this.uvs.push(new Go,new Go,new Go)):this.uvs.push(Wg[0],Wg[1],Wg[2])),!0===wg){var Wg=Mg[1][Fg];void 0===Wg?(console.warn('THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ',Fg),this.uvs2.push(new Go,new Go,new Go)):this.uvs2.push(Wg[0],Wg[1],Wg[2])}for(Xg=0;Xg<Lg;Xg++){var kg=Rg[Xg].vertices;bg[Xg].push(kg[zg.a],kg[zg.b],kg[zg.c])}for(var Xg=0,jg;Xg<Ig;Xg++)jg=Cg[Xg].vertexNormals[Fg],Pg[Xg].push(jg.a,jg.b,jg.c);Ng&&this.skinIndices.push(Ug[zg.a],Ug[zg.b],Ug[zg.c]),Bg&&this.skinWeights.push(Dg[zg.a],Dg[zg.b],Dg[zg.c])}return this.computeGroups(Eg),this.verticesNeedUpdate=Eg.verticesNeedUpdate,this.normalsNeedUpdate=Eg.normalsNeedUpdate,this.colorsNeedUpdate=Eg.colorsNeedUpdate,this.uvsNeedUpdate=Eg.uvsNeedUpdate,this.groupsNeedUpdate=Eg.groupsNeedUpdate,this}});var Zu=1;Object.assign(dl.prototype,Fo.prototype,{isBufferGeometry:!0,getIndex:function getIndex(){return this.index},setIndex:function setIndex(Eg){this.index=Array.isArray(Eg)?new(65535<ll(Eg)?il:rl)(Eg,1):Eg},addAttribute:function addAttribute(Eg,bg){return bg&&bg.isBufferAttribute||bg&&bg.isInterleavedBufferAttribute?'index'===Eg?(console.warn('THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute.'),void this.setIndex(bg)):(this.attributes[Eg]=bg,this):(console.warn('THREE.BufferGeometry: .addAttribute() now expects ( name, attribute ).'),void this.addAttribute(Eg,new Qs(arguments[1],arguments[2])))},getAttribute:function getAttribute(Eg){return this.attributes[Eg]},removeAttribute:function removeAttribute(Eg){return delete this.attributes[Eg],this},addGroup:function addGroup(Eg,bg,Tg){this.groups.push({start:Eg,count:bg,materialIndex:void 0===Tg?0:Tg})},clearGroups:function clearGroups(){this.groups=[]},setDrawRange:function setDrawRange(Eg,bg){this.drawRange.start=Eg,this.drawRange.count=bg},applyMatrix:function applyMatrix(Eg){var bg=this.attributes.position;void 0!==bg&&(Eg.applyToBufferAttribute(bg),bg.needsUpdate=!0);var Tg=this.attributes.normal;return void 0!==Tg&&(new Xo().getNormalMatrix(Eg).applyToBufferAttribute(Tg),Tg.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(){var Eg=new Ho;return function(bg){return Eg.makeRotationX(bg),this.applyMatrix(Eg),this}}(),rotateY:function(){var Eg=new Ho;return function(bg){return Eg.makeRotationY(bg),this.applyMatrix(Eg),this}}(),rotateZ:function(){var Eg=new Ho;return function(bg){return Eg.makeRotationZ(bg),this.applyMatrix(Eg),this}}(),translate:function(){var Eg=new Ho;return function(bg,Tg,Sg){return Eg.makeTranslation(bg,Tg,Sg),this.applyMatrix(Eg),this}}(),scale:function(){var Eg=new Ho;return function(bg,Tg,Sg){return Eg.makeScale(bg,Tg,Sg),this.applyMatrix(Eg),this}}(),lookAt:function(){var Eg=new js;return function(bg){Eg.lookAt(bg),Eg.updateMatrix(),this.applyMatrix(Eg.matrix)}}(),center:function center(){this.computeBoundingBox();var Eg=this.boundingBox.getCenter().negate();return this.translate(Eg.x,Eg.y,Eg.z),Eg},setFromObject:function setFromObject(Eg){var bg=Eg.geometry;if(Eg.isPoints||Eg.isLine){var Tg=new ol(3*bg.vertices.length,3),Sg=new ol(3*bg.colors.length,3);if(this.addAttribute('position',Tg.copyVector3sArray(bg.vertices)),this.addAttribute('color',Sg.copyColorsArray(bg.colors)),bg.lineDistances&&bg.lineDistances.length===bg.vertices.length){var Mg=new ol(bg.lineDistances.length,1);this.addAttribute('lineDistance',Mg.copyArray(bg.lineDistances))}null!==bg.boundingSphere&&(this.boundingSphere=bg.boundingSphere.clone()),null!==bg.boundingBox&&(this.boundingBox=bg.boundingBox.clone())}else Eg.isMesh&&bg&&bg.isGeometry&&this.fromGeometry(bg);return this},setFromPoints:function setFromPoints(Eg){for(var bg=[],Tg=0,Sg=Eg.length,Mg;Tg<Sg;Tg++)Mg=Eg[Tg],bg.push(Mg.x,Mg.y,Mg.z||0);return this.addAttribute('position',new ol(bg,3)),this},updateFromObject:function updateFromObject(Eg){var bg=Eg.geometry;if(Eg.isMesh){var Tg=bg.__directGeometry;if(!0===bg.elementsNeedUpdate&&(Tg=void 0,bg.elementsNeedUpdate=!1),void 0===Tg)return this.fromGeometry(bg);Tg.verticesNeedUpdate=bg.verticesNeedUpdate,Tg.normalsNeedUpdate=bg.normalsNeedUpdate,Tg.colorsNeedUpdate=bg.colorsNeedUpdate,Tg.uvsNeedUpdate=bg.uvsNeedUpdate,Tg.groupsNeedUpdate=bg.groupsNeedUpdate,bg.verticesNeedUpdate=!1,bg.normalsNeedUpdate=!1,bg.colorsNeedUpdate=!1,bg.uvsNeedUpdate=!1,bg.groupsNeedUpdate=!1,bg=Tg}var Sg;return!0===bg.verticesNeedUpdate&&(void 0!==(Sg=this.attributes.position)&&(Sg.copyVector3sArray(bg.vertices),Sg.needsUpdate=!0),bg.verticesNeedUpdate=!1),!0===bg.normalsNeedUpdate&&(void 0!==(Sg=this.attributes.normal)&&(Sg.copyVector3sArray(bg.normals),Sg.needsUpdate=!0),bg.normalsNeedUpdate=!1),!0===bg.colorsNeedUpdate&&(void 0!==(Sg=this.attributes.color)&&(Sg.copyColorsArray(bg.colors),Sg.needsUpdate=!0),bg.colorsNeedUpdate=!1),bg.uvsNeedUpdate&&(void 0!==(Sg=this.attributes.uv)&&(Sg.copyVector2sArray(bg.uvs),Sg.needsUpdate=!0),bg.uvsNeedUpdate=!1),bg.lineDistancesNeedUpdate&&(void 0!==(Sg=this.attributes.lineDistance)&&(Sg.copyArray(bg.lineDistances),Sg.needsUpdate=!0),bg.lineDistancesNeedUpdate=!1),bg.groupsNeedUpdate&&(bg.computeGroups(Eg.geometry),this.groups=bg.groups,bg.groupsNeedUpdate=!1),this},fromGeometry:function fromGeometry(Eg){return Eg.__directGeometry=new sl().fromGeometry(Eg),this.fromDirectGeometry(Eg.__directGeometry)},fromDirectGeometry:function fromDirectGeometry(Eg){var bg=new Float32Array(3*Eg.vertices.length);if(this.addAttribute('position',new Qs(bg,3).copyVector3sArray(Eg.vertices)),0<Eg.normals.length){var Tg=new Float32Array(3*Eg.normals.length);this.addAttribute('normal',new Qs(Tg,3).copyVector3sArray(Eg.normals))}if(0<Eg.colors.length){var Sg=new Float32Array(3*Eg.colors.length);this.addAttribute('color',new Qs(Sg,3).copyColorsArray(Eg.colors))}if(0<Eg.uvs.length){var Mg=new Float32Array(2*Eg.uvs.length);this.addAttribute('uv',new Qs(Mg,2).copyVector2sArray(Eg.uvs))}if(0<Eg.uvs2.length){var Ag=new Float32Array(2*Eg.uvs2.length);this.addAttribute('uv2',new Qs(Ag,2).copyVector2sArray(Eg.uvs2))}if(0<Eg.indices.length){var wg=new(65535<ll(Eg.indices)?Uint32Array:Uint16Array)(3*Eg.indices.length);this.setIndex(new Qs(wg,1).copyIndicesArray(Eg.indices))}for(var Rg in this.groups=Eg.groups,Eg.morphTargets){for(var Lg=[],Pg=Eg.morphTargets[Rg],Cg=0,Ig=Pg.length;Cg<Ig;Cg++){var Ug=Pg[Cg],Dg=new ol(3*Ug.length,3);Lg.push(Dg.copyVector3sArray(Ug))}this.morphAttributes[Rg]=Lg}if(0<Eg.skinIndices.length){var Ng=new ol(4*Eg.skinIndices.length,4);this.addAttribute('skinIndex',Ng.copyVector4sArray(Eg.skinIndices))}if(0<Eg.skinWeights.length){var Bg=new ol(4*Eg.skinWeights.length,4);this.addAttribute('skinWeight',Bg.copyVector4sArray(Eg.skinWeights))}return null!==Eg.boundingSphere&&(this.boundingSphere=Eg.boundingSphere.clone()),null!==Eg.boundingBox&&(this.boundingBox=Eg.boundingBox.clone()),this},computeBoundingBox:function computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new zs);var Eg=this.attributes.position;void 0===Eg?this.boundingBox.makeEmpty():this.boundingBox.setFromBufferAttribute(Eg),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){var Eg=new zs,bg=new Wo;return function(){null===this.boundingSphere&&(this.boundingSphere=new Gs);var Tg=this.attributes.position;if(Tg){var Sg=this.boundingSphere.center;Eg.setFromBufferAttribute(Tg),Eg.getCenter(Sg);for(var Mg=0,Ag=0,wg=Tg.count;Ag<wg;Ag++)bg.x=Tg.getX(Ag),bg.y=Tg.getY(Ag),bg.z=Tg.getZ(Ag),Mg=Math.max(Mg,Sg.distanceToSquared(bg));this.boundingSphere.radius=Math.sqrt(Mg),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function computeFaceNormals(){},computeVertexNormals:function computeVertexNormals(){var Eg=this.index,bg=this.attributes,Tg=this.groups;if(bg.position){var Sg=bg.position.array;if(void 0===bg.normal)this.addAttribute('normal',new Qs(new Float32Array(Sg.length),3));else for(var Mg=bg.normal.array,Ag=0,wg=Mg.length;o<s;Ag++)Mg[o]=0;var Cg=bg.normal.array,Ig=new Wo,Ug=new Wo,Dg=new Wo,Ng=new Wo,Bg=new Wo,Rg,Lg,Pg;if(Eg){var Fg=Eg.array;0===Tg.length&&this.addGroup(0,Fg.length);for(var zg=0,Gg=Tg.length;zg<Gg;++zg)for(var Hg=Tg[zg],Og=Hg.start,Ag=Og,wg=Og+Hg.count;Ag<wg;Ag+=3)Rg=3*Fg[Ag+0],Lg=3*Fg[Ag+1],Pg=3*Fg[Ag+2],Ig.fromArray(Sg,Rg),Ug.fromArray(Sg,Lg),Dg.fromArray(Sg,Pg),Ng.subVectors(Dg,Ug),Bg.subVectors(Ig,Ug),Ng.cross(Bg),Cg[Rg]+=Ng.x,Cg[Rg+1]+=Ng.y,Cg[Rg+2]+=Ng.z,Cg[Lg]+=Ng.x,Cg[Lg+1]+=Ng.y,Cg[Lg+2]+=Ng.z,Cg[Pg]+=Ng.x,Cg[Pg+1]+=Ng.y,Cg[Pg+2]+=Ng.z}else for(var Ag=0,wg=Sg.length;o<s;Ag+=9)Ig.fromArray(Sg,Ag),Ug.fromArray(Sg,Ag+3),Dg.fromArray(Sg,Ag+6),Ng.subVectors(Dg,Ug),Bg.subVectors(Ig,Ug),Ng.cross(Bg),Cg[Ag]=Ng.x,Cg[Ag+1]=Ng.y,Cg[Ag+2]=Ng.z,Cg[Ag+3]=Ng.x,Cg[Ag+4]=Ng.y,Cg[Ag+5]=Ng.z,Cg[Ag+6]=Ng.x,Cg[Ag+7]=Ng.y,Cg[Ag+8]=Ng.z;this.normalizeNormals(),bg.normal.needsUpdate=!0}},merge:function merge(Eg,bg){if(Eg&&Eg.isBufferGeometry){void 0===bg&&(bg=0);var Tg=this.attributes;for(var Sg in Tg)if(void 0!==Eg.attributes[Sg])for(var Mg=Tg[Sg].array,Ag=Eg.attributes[Sg],wg=Ag.array,Rg=0,Lg=Ag.itemSize*bg;Rg<wg.length;Rg++,Lg++)Mg[Lg]=wg[Rg];return this}console.error('THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.',Eg)},normalizeNormals:function(){var Eg=new Wo;return function(){for(var bg=this.attributes.normal,Tg=0,Sg=bg.count;Tg<Sg;Tg++)Eg.x=bg.getX(Tg),Eg.y=bg.getY(Tg),Eg.z=bg.getZ(Tg),Eg.normalize(),bg.setXYZ(Tg,Eg.x,Eg.y,Eg.z)}}(),toNonIndexed:function toNonIndexed(){if(null===this.index)return console.warn('THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed.'),this;var Eg=new dl,bg=this.index.array,Tg=this.attributes;for(var Sg in Tg){for(var Mg=Tg[Sg],Ag=Mg.array,wg=Mg.itemSize,Rg=new Ag.constructor(bg.length*wg),Lg=0,Pg=0,Cg=0,Ig=bg.length;Cg<Ig;Cg++){Lg=bg[Cg]*wg;for(var Ug=0;Ug<wg;Ug++)Rg[Pg++]=Ag[Lg++]}Eg.addAttribute(Sg,new Qs(Rg,wg))}return Eg},toJSON:function toJSON(){var Eg={metadata:{version:4.5,type:'BufferGeometry',generator:'BufferGeometry.toJSON'}};if(Eg.uuid=this.uuid,Eg.type=this.type,''!==this.name&&(Eg.name=this.name),void 0!==this.parameters){var bg=this.parameters;for(var Tg in bg)void 0!==bg[Tg]&&(Eg[Tg]=bg[Tg]);return Eg}Eg.data={attributes:{}};var Sg=this.index;null!==Sg&&(wg=Array.prototype.slice.call(Sg.array),Eg.data.index={type:Sg.array.constructor.name,array:wg});var Mg=this.attributes;for(var Tg in Mg){var Ag=Mg[Tg],wg=Array.prototype.slice.call(Ag.array);Eg.data.attributes[Tg]={itemSize:Ag.itemSize,type:Ag.array.constructor.name,array:wg,normalized:Ag.normalized}}var Rg=this.groups;0<Rg.length&&(Eg.data.groups=JSON.parse(JSON.stringify(Rg)));var Lg=this.boundingSphere;return null!==Lg&&(Eg.data.boundingSphere={center:Lg.center.toArray(),radius:Lg.radius}),Eg},clone:function clone(){return new dl().copy(this)},copy:function copy(Eg){var bg,Tg,Sg;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=Eg.name;var Mg=Eg.index;null!==Mg&&this.setIndex(Mg.clone());var Ag=Eg.attributes;for(bg in Ag){var wg=Ag[bg];this.addAttribute(bg,wg.clone())}var Rg=Eg.morphAttributes;for(bg in Rg){var Lg=[],Pg=Rg[bg];for(Tg=0,Sg=Pg.length;Tg<Sg;Tg++)Lg.push(Pg[Tg].clone());this.morphAttributes[bg]=Lg}var Cg=Eg.groups;for(Tg=0,Sg=Cg.length;Tg<Sg;Tg++){var Ig=Cg[Tg];this.addGroup(Ig.start,Ig.count,Ig.materialIndex)}var Ug=Eg.boundingBox;null!==Ug&&(this.boundingBox=Ug.clone());var Dg=Eg.boundingSphere;return null!==Dg&&(this.boundingSphere=Dg.clone()),this.drawRange.start=Eg.drawRange.start,this.drawRange.count=Eg.drawRange.count,this},dispose:function dispose(){this.dispatchEvent({type:'dispose'})}}),(pl.prototype=Object.create(Js.prototype)).constructor=pl,(cl.prototype=Object.create(dl.prototype)).constructor=cl,(ml.prototype=Object.create(Js.prototype)).constructor=ml,(ul.prototype=Object.create(dl.prototype)).constructor=ul,(gl.prototype=Object.create(Js.prototype)).constructor=gl,(fl.prototype=Object.create(dl.prototype)).constructor=fl,(hl.prototype=Object.create(Ns.prototype)).constructor=hl,hl.prototype.isMeshBasicMaterial=!0,hl.prototype.copy=function(Eg){return Ns.prototype.copy.call(this,Eg),this.color.copy(Eg.color),this.map=Eg.map,this.lightMap=Eg.lightMap,this.lightMapIntensity=Eg.lightMapIntensity,this.aoMap=Eg.aoMap,this.aoMapIntensity=Eg.aoMapIntensity,this.specularMap=Eg.specularMap,this.alphaMap=Eg.alphaMap,this.envMap=Eg.envMap,this.combine=Eg.combine,this.reflectivity=Eg.reflectivity,this.refractionRatio=Eg.refractionRatio,this.wireframe=Eg.wireframe,this.wireframeLinewidth=Eg.wireframeLinewidth,this.wireframeLinecap=Eg.wireframeLinecap,this.wireframeLinejoin=Eg.wireframeLinejoin,this.skinning=Eg.skinning,this.morphTargets=Eg.morphTargets,this},(yl.prototype=Object.create(Ns.prototype)).constructor=yl,yl.prototype.isShaderMaterial=!0,yl.prototype.copy=function(Eg){return Ns.prototype.copy.call(this,Eg),this.fragmentShader=Eg.fragmentShader,this.vertexShader=Eg.vertexShader,this.uniforms=Wu.clone(Eg.uniforms),this.defines=Eg.defines,this.wireframe=Eg.wireframe,this.wireframeLinewidth=Eg.wireframeLinewidth,this.lights=Eg.lights,this.clipping=Eg.clipping,this.skinning=Eg.skinning,this.morphTargets=Eg.morphTargets,this.morphNormals=Eg.morphNormals,this.extensions=Eg.extensions,this},yl.prototype.toJSON=function(Eg){var bg=Ns.prototype.toJSON.call(this,Eg);return bg.uniforms=this.uniforms,bg.vertexShader=this.vertexShader,bg.fragmentShader=this.fragmentShader,bg},Object.assign(xl.prototype,{set:function set(Eg,bg){return this.origin.copy(Eg),this.direction.copy(bg),this},clone:function clone(){return new this.constructor().copy(this)},copy:function copy(Eg){return this.origin.copy(Eg.origin),this.direction.copy(Eg.direction),this},at:function at(Eg,bg){return(bg||new Wo).copy(this.direction).multiplyScalar(Eg).add(this.origin)},lookAt:function lookAt(Eg){return this.direction.copy(Eg).sub(this.origin).normalize(),this},recast:function(){var Eg=new Wo;return function(bg){return this.origin.copy(this.at(bg,Eg)),this}}(),closestPointToPoint:function closestPointToPoint(Eg,bg){var Tg=bg||new Wo;Tg.subVectors(Eg,this.origin);var Sg=Tg.dot(this.direction);return 0>Sg?Tg.copy(this.origin):Tg.copy(this.direction).multiplyScalar(Sg).add(this.origin)},distanceToPoint:function distanceToPoint(Eg){return Math.sqrt(this.distanceSqToPoint(Eg))},distanceSqToPoint:function(){var Eg=new Wo;return function(bg){var Tg=Eg.subVectors(bg,this.origin).dot(this.direction);return 0>Tg?this.origin.distanceToSquared(bg):(Eg.copy(this.direction).multiplyScalar(Tg).add(this.origin),Eg.distanceToSquared(bg))}}(),distanceSqToSegment:function(){var Eg=new Wo,bg=new Wo,Tg=new Wo;return function(Sg,Mg,Ag,wg){Eg.copy(Sg).add(Mg).multiplyScalar(.5),bg.copy(Mg).sub(Sg).normalize(),Tg.copy(this.origin).sub(Eg);var Ig=.5*Sg.distanceTo(Mg),Ug=-this.direction.dot(bg),Dg=Tg.dot(this.direction),Ng=-Tg.dot(bg),Bg=Tg.lengthSq(),Fg=Math.abs(1-Ug*Ug),Rg,Lg,Pg,Cg;if(!(0<Fg))Lg=0<Ug?-Ig:Ig,Pg=-(Rg=Math.max(0,-(Ug*Lg+Dg)))*Rg+Lg*(Lg+2*Ng)+Bg;else if(!(Rg=Ug*Ng-Dg,Lg=Ug*Dg-Ng,Cg=Ig*Fg,0<=Rg))Lg<=-Cg?Pg=-(Rg=Math.max(0,-(-Ug*Ig+Dg)))*Rg+(Lg=0<Rg?-Ig:Math.min(Math.max(-Ig,-Ng),Ig))*(Lg+2*Ng)+Bg:Lg<=Cg?(Rg=0,Pg=(Lg=Math.min(Math.max(-Ig,-Ng),Ig))*(Lg+2*Ng)+Bg):Pg=-(Rg=Math.max(0,-(Ug*Ig+Dg)))*Rg+(Lg=0<Rg?Ig:Math.min(Math.max(-Ig,-Ng),Ig))*(Lg+2*Ng)+Bg;else if(!(Lg>=-Cg))Lg=-Ig,Pg=-(Rg=Math.max(0,-(Ug*Lg+Dg)))*Rg+Lg*(Lg+2*Ng)+Bg;else if(Lg<=Cg){var zg=1/Fg;Pg=(Rg*=zg)*(Rg+Ug*(Lg*=zg)+2*Dg)+Lg*(Ug*Rg+Lg+2*Ng)+Bg}else Lg=Ig,Pg=-(Rg=Math.max(0,-(Ug*Lg+Dg)))*Rg+Lg*(Lg+2*Ng)+Bg;return Ag&&Ag.copy(this.direction).multiplyScalar(Rg).add(this.origin),wg&&wg.copy(bg).multiplyScalar(Lg).add(Eg),Pg}}(),intersectSphere:function(){var Eg=new Wo;return function(bg,Tg){Eg.subVectors(bg.center,this.origin);var Sg=Eg.dot(this.direction),Mg=Eg.dot(Eg)-Sg*Sg,Ag=bg.radius*bg.radius;if(Mg>Ag)return null;var wg=Math.sqrt(Ag-Mg),Rg=Sg-wg,Lg=Sg+wg;return 0>Rg&&0>Lg?null:0>Rg?this.at(Lg,Tg):this.at(Rg,Tg)}}(),intersectsSphere:function intersectsSphere(Eg){return this.distanceToPoint(Eg.center)<=Eg.radius},distanceToPlane:function distanceToPlane(Eg){var bg=Eg.normal.dot(this.direction);if(0===bg)return 0===Eg.distanceToPoint(this.origin)?0:null;var Tg=-(this.origin.dot(Eg.normal)+Eg.constant)/bg;return 0<=Tg?Tg:null},intersectPlane:function intersectPlane(Eg,bg){var Tg=this.distanceToPlane(Eg);return null===Tg?null:this.at(Tg,bg)},intersectsPlane:function intersectsPlane(Eg){var bg=Eg.distanceToPoint(this.origin);return!(0!==bg)||0>Eg.normal.dot(this.direction)*bg},intersectBox:function intersectBox(Eg,bg){var Lg=1/this.direction.x,Pg=1/this.direction.y,Cg=1/this.direction.z,Ig=this.origin,Tg,Sg,Mg,Ag,wg,Rg;return 0<=Lg?(Tg=(Eg.min.x-Ig.x)*Lg,Sg=(Eg.max.x-Ig.x)*Lg):(Tg=(Eg.max.x-Ig.x)*Lg,Sg=(Eg.min.x-Ig.x)*Lg),0<=Pg?(Mg=(Eg.min.y-Ig.y)*Pg,Ag=(Eg.max.y-Ig.y)*Pg):(Mg=(Eg.max.y-Ig.y)*Pg,Ag=(Eg.min.y-Ig.y)*Pg),Tg>Ag||Mg>Sg?null:((Mg>Tg||Tg!=Tg)&&(Tg=Mg),(Ag<Sg||Sg!=Sg)&&(Sg=Ag),0<=Cg?(wg=(Eg.min.z-Ig.z)*Cg,Rg=(Eg.max.z-Ig.z)*Cg):(wg=(Eg.max.z-Ig.z)*Cg,Rg=(Eg.min.z-Ig.z)*Cg),Tg>Rg||wg>Sg?null:((wg>Tg||Tg!=Tg)&&(Tg=wg),(Rg<Sg||Sg!=Sg)&&(Sg=Rg),0>Sg?null:this.at(0<=Tg?Tg:Sg,bg)))},intersectsBox:function(){var Eg=new Wo;return function(bg){return null!==this.intersectBox(bg,Eg)}}(),intersectTriangle:function(){var Eg=new Wo,bg=new Wo,Tg=new Wo,Sg=new Wo;return function(Mg,Ag,wg,Rg,Lg){bg.subVectors(Ag,Mg),Tg.subVectors(wg,Mg),Sg.crossVectors(bg,Tg);var Cg=this.direction.dot(Sg),Pg;if(0<Cg){if(Rg)return null;Pg=1}else{if(!(0>Cg))return null;Pg=-1,Cg=-Cg}Eg.subVectors(this.origin,Mg);var Ig=Pg*this.direction.dot(Tg.crossVectors(Eg,Tg));if(0>Ig)return null;var Ug=Pg*this.direction.dot(bg.cross(Eg));if(0>Ug)return null;if(Ig+Ug>Cg)return null;var Dg=-Pg*Eg.dot(Sg);return 0>Dg?null:this.at(Dg/Cg,Lg)}}(),applyMatrix4:function applyMatrix4(Eg){return this.origin.applyMatrix4(Eg),this.direction.transformDirection(Eg),this},equals:function equals(Eg){return Eg.origin.equals(this.origin)&&Eg.direction.equals(this.direction)}}),Object.assign(vl.prototype,{set:function set(Eg,bg){return this.start.copy(Eg),this.end.copy(bg),this},clone:function clone(){return new this.constructor().copy(this)},copy:function copy(Eg){return this.start.copy(Eg.start),this.end.copy(Eg.end),this},getCenter:function getCenter(Eg){return(Eg||new Wo).addVectors(this.start,this.end).multiplyScalar(.5)},delta:function delta(Eg){return(Eg||new Wo).subVectors(this.end,this.start)},distanceSq:function distanceSq(){return this.start.distanceToSquared(this.end)},distance:function distance(){return this.start.distanceTo(this.end)},at:function at(Eg,bg){var Tg=bg||new Wo;return this.delta(Tg).multiplyScalar(Eg).add(this.start)},closestPointToPointParameter:function(){var Eg=new Wo,bg=new Wo;return function(Tg,Sg){Eg.subVectors(Tg,this.start),bg.subVectors(this.end,this.start);var Mg=bg.dot(bg),Ag=bg.dot(Eg)/Mg;return Sg&&(Ag=Iu.clamp(Ag,0,1)),Ag}}(),closestPointToPoint:function closestPointToPoint(Eg,bg,Tg){var Sg=this.closestPointToPointParameter(Eg,bg),Mg=Tg||new Wo;return this.delta(Mg).multiplyScalar(Sg).add(this.start)},applyMatrix4:function applyMatrix4(Eg){return this.start.applyMatrix4(Eg),this.end.applyMatrix4(Eg),this},equals:function equals(Eg){return Eg.start.equals(this.start)&&Eg.end.equals(this.end)}}),Object.assign(_l,{normal:function(){var Eg=new Wo;return function(bg,Tg,Sg,Mg){var Ag=Mg||new Wo;Ag.subVectors(Sg,Tg),Eg.subVectors(bg,Tg),Ag.cross(Eg);var wg=Ag.lengthSq();return 0<wg?Ag.multiplyScalar(1/Math.sqrt(wg)):Ag.set(0,0,0)}}(),barycoordFromPoint:function(){var Eg=new Wo,bg=new Wo,Tg=new Wo;return function(Sg,Mg,Ag,wg,Rg){Eg.subVectors(wg,Mg),bg.subVectors(Ag,Mg),Tg.subVectors(Sg,Mg);var Lg=Eg.dot(Eg),Pg=Eg.dot(bg),Cg=Eg.dot(Tg),Ig=bg.dot(bg),Ug=bg.dot(Tg),Dg=Lg*Ig-Pg*Pg,Ng=Rg||new Wo;if(0==Dg)return Ng.set(-2,-1,-1);var Bg=1/Dg,Fg=(Ig*Cg-Pg*Ug)*Bg,zg=(Lg*Ug-Pg*Cg)*Bg;return Ng.set(1-Fg-zg,zg,Fg)}}(),containsPoint:function(){var Eg=new Wo;return function(bg,Tg,Sg,Mg){var Ag=_l.barycoordFromPoint(bg,Tg,Sg,Mg,Eg);return 0<=Ag.x&&0<=Ag.y&&1>=Ag.x+Ag.y}}()}),Object.assign(_l.prototype,{set:function set(Eg,bg,Tg){return this.a.copy(Eg),this.b.copy(bg),this.c.copy(Tg),this},setFromPointsAndIndices:function setFromPointsAndIndices(Eg,bg,Tg,Sg){return this.a.copy(Eg[bg]),this.b.copy(Eg[Tg]),this.c.copy(Eg[Sg]),this},clone:function clone(){return new this.constructor().copy(this)},copy:function copy(Eg){return this.a.copy(Eg.a),this.b.copy(Eg.b),this.c.copy(Eg.c),this},area:function(){var Eg=new Wo,bg=new Wo;return function(){return Eg.subVectors(this.c,this.b),bg.subVectors(this.a,this.b),.5*Eg.cross(bg).length()}}(),midpoint:function midpoint(Eg){return(Eg||new Wo).addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function normal(Eg){return _l.normal(this.a,this.b,this.c,Eg)},plane:function plane(Eg){return(Eg||new Hs).setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function barycoordFromPoint(Eg,bg){return _l.barycoordFromPoint(Eg,this.a,this.b,this.c,bg)},containsPoint:function containsPoint(Eg){return _l.containsPoint(Eg,this.a,this.b,this.c)},closestPointToPoint:function(){var Eg=new Hs,bg=[new vl,new vl,new vl],Tg=new Wo,Sg=new Wo;return function(Mg,Ag){var wg=Ag||new Wo,Rg=1/0;if(Eg.setFromCoplanarPoints(this.a,this.b,this.c),Eg.projectPoint(Mg,Tg),!0===this.containsPoint(Tg))wg.copy(Tg);else{bg[0].set(this.a,this.b),bg[1].set(this.b,this.c),bg[2].set(this.c,this.a);for(var Lg=0;Lg<bg.length;Lg++){bg[Lg].closestPointToPoint(Tg,!0,Sg);var Pg=Tg.distanceToSquared(Sg);Pg<Rg&&(Rg=Pg,wg.copy(Sg))}}return wg}}(),equals:function equals(Eg){return Eg.a.equals(this.a)&&Eg.b.equals(this.b)&&Eg.c.equals(this.c)}}),El.prototype=Object.assign(Object.create(js.prototype),{constructor:El,isMesh:!0,setDrawMode:function setDrawMode(Eg){this.drawMode=Eg},copy:function copy(Eg){return js.prototype.copy.call(this,Eg),this.drawMode=Eg.drawMode,void 0!==Eg.morphTargetInfluences&&(this.morphTargetInfluences=Eg.morphTargetInfluences.slice()),void 0!==Eg.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},Eg.morphTargetDictionary)),this},updateMorphTargets:function updateMorphTargets(){var Sg=this.geometry,Eg,bg,Tg;if(Sg.isBufferGeometry){var Mg=Sg.morphAttributes,Ag=Object.keys(Mg);if(0<Ag.length){var wg=Mg[Ag[0]];if(void 0!==wg)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},Eg=0,bg=wg.length;Eg<bg;Eg++)Tg=wg[Eg].name||Eg+'',this.morphTargetInfluences.push(0),this.morphTargetDictionary[Tg]=Eg}}else{var Rg=Sg.morphTargets;if(void 0!==Rg&&0<Rg.length)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},Eg=0,bg=Rg.length;Eg<bg;Eg++)Tg=Rg[Eg].name||Eg+'',this.morphTargetInfluences.push(0),this.morphTargetDictionary[Tg]=Eg}},raycast:function(){function Eg(Gg,Hg,Og,Vg,Wg,kg,Xg){return _l.barycoordFromPoint(Gg,Hg,Og,Vg,Bg),Wg.multiplyScalar(Bg.x),kg.multiplyScalar(Bg.y),Xg.multiplyScalar(Bg.z),Wg.add(kg).add(Xg),Wg.clone()}function bg(Gg,Hg,Og,Vg,Wg,kg,Xg,jg){if(null===(Hg.side===zc?Vg.intersectTriangle(Xg,kg,Wg,!0,jg):Vg.intersectTriangle(Wg,kg,Xg,Hg.side!==Gc,jg)))return null;zg.copy(jg),zg.applyMatrix4(Gg.matrixWorld);var Yg=Og.ray.origin.distanceTo(zg);return Yg<Og.near||Yg>Og.far?null:{distance:Yg,point:zg.clone(),object:Gg}}function Tg(Gg,Hg,Og,Vg,Wg,kg,Xg,jg){wg.fromBufferAttribute(Vg,kg),Rg.fromBufferAttribute(Vg,Xg),Lg.fromBufferAttribute(Vg,jg);var Yg=bg(Gg,Gg.material,Hg,Og,wg,Rg,Lg,Fg);return Yg&&(Wg&&(Ug.fromBufferAttribute(Wg,kg),Dg.fromBufferAttribute(Wg,Xg),Ng.fromBufferAttribute(Wg,jg),Yg.uv=Eg(Fg,wg,Rg,Lg,Ug,Dg,Ng)),Yg.face=new Zs(kg,Xg,jg,_l.normal(wg,Rg,Lg)),Yg.faceIndex=kg),Yg}var Sg=new Ho,Mg=new xl,Ag=new Gs,wg=new Wo,Rg=new Wo,Lg=new Wo,Pg=new Wo,Cg=new Wo,Ig=new Wo,Ug=new Go,Dg=new Go,Ng=new Go,Bg=new Wo,Fg=new Wo,zg=new Wo;return function(Gg,Hg){var Og=this.geometry,Vg=this.material,Wg=this.matrixWorld;if(void 0!==Vg&&(null===Og.boundingSphere&&Og.computeBoundingSphere(),Ag.copy(Og.boundingSphere),Ag.applyMatrix4(Wg),!1!==Gg.ray.intersectsSphere(Ag)&&(Sg.getInverse(Wg),Mg.copy(Gg.ray).applyMatrix4(Sg),null===Og.boundingBox||!1!==Mg.intersectsBox(Og.boundingBox)))){var kg;if(Og.isBufferGeometry){var Jg=Og.index,Qg=Og.attributes.position,Kg=Og.attributes.uv,Xg,jg,Yg,qg,Zg;if(null!==Jg)for(qg=0,Zg=Jg.count;qg<Zg;qg+=3)Xg=Jg.getX(qg),jg=Jg.getX(qg+1),Yg=Jg.getX(qg+2),(kg=Tg(this,Gg,Mg,Qg,Kg,Xg,jg,Yg))&&(kg.faceIndex=Math.floor(qg/3),Hg.push(kg));else if(void 0!==Qg)for(qg=0,Zg=Qg.count;qg<Zg;qg+=3)(kg=Tg(this,Gg,Mg,Qg,Kg,Xg=qg,jg=qg+1,Yg=qg+2))&&(kg.index=Xg,Hg.push(kg))}else if(Og.isGeometry){var af=Array.isArray(Vg),of=Og.vertices,nf=Og.faces,sf=Og.faceVertexUvs[0],$g,ef,tf,rf;0<sf.length&&(rf=sf);for(var lf=0,df=nf.length;lf<df;lf++){var pf=nf[lf],cf=af?Vg[pf.materialIndex]:Vg;if(void 0!==cf){if($g=of[pf.a],ef=of[pf.b],tf=of[pf.c],!0===cf.morphTargets){var mf=Og.morphTargets,uf=this.morphTargetInfluences;wg.set(0,0,0),Rg.set(0,0,0),Lg.set(0,0,0);for(var gf=0,ff=mf.length,hf;gf<ff;gf++)if(hf=uf[gf],0!==hf){var yf=mf[gf].vertices;wg.addScaledVector(Pg.subVectors(yf[pf.a],$g),hf),Rg.addScaledVector(Cg.subVectors(yf[pf.b],ef),hf),Lg.addScaledVector(Ig.subVectors(yf[pf.c],tf),hf)}wg.add($g),Rg.add(ef),Lg.add(tf),$g=wg,ef=Rg,tf=Lg}if(kg=bg(this,cf,Gg,Mg,$g,ef,tf,Fg)){if(rf&&rf[lf]){var xf=rf[lf];Ug.copy(xf[0]),Dg.copy(xf[1]),Ng.copy(xf[2]),kg.uv=Eg(Fg,$g,ef,tf,Ug,Dg,Ng)}kg.face=pf,kg.faceIndex=lf,Hg.push(kg)}}}}}}}(),clone:function clone(){return new this.constructor(this.geometry,this.material).copy(this)}});var Ju=0;Fl.prototype=Object.assign(Object.create(Ys.prototype),{constructor:Fl,isPerspectiveCamera:!0,copy:function copy(Eg,bg){return Ys.prototype.copy.call(this,Eg,bg),this.fov=Eg.fov,this.zoom=Eg.zoom,this.near=Eg.near,this.far=Eg.far,this.focus=Eg.focus,this.aspect=Eg.aspect,this.view=null===Eg.view?null:Object.assign({},Eg.view),this.filmGauge=Eg.filmGauge,this.filmOffset=Eg.filmOffset,this},setFocalLength:function setFocalLength(Eg){var bg=.5*this.getFilmHeight()/Eg;this.fov=2*Iu.RAD2DEG*Math.atan(bg),this.updateProjectionMatrix()},getFocalLength:function getFocalLength(){var Eg=Math.tan(.5*Iu.DEG2RAD*this.fov);return .5*this.getFilmHeight()/Eg},getEffectiveFOV:function getEffectiveFOV(){return 2*Iu.RAD2DEG*Math.atan(Math.tan(.5*Iu.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function setViewOffset(Eg,bg,Tg,Sg,Mg,Ag){this.aspect=Eg/bg,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=Eg,this.view.fullHeight=bg,this.view.offsetX=Tg,this.view.offsetY=Sg,this.view.width=Mg,this.view.height=Ag,this.updateProjectionMatrix()},clearViewOffset:function clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function updateProjectionMatrix(){var Eg=this.near,bg=Eg*Math.tan(.5*Iu.DEG2RAD*this.fov)/this.zoom,Tg=2*bg,Sg=this.aspect*Tg,Mg=-.5*Sg,Ag=this.view;if(null!==this.view&&this.view.enabled){var wg=Ag.fullWidth,Rg=Ag.fullHeight;Mg+=Ag.offsetX*Sg/wg,bg-=Ag.offsetY*Tg/Rg,Sg*=Ag.width/wg,Tg*=Ag.height/Rg}var Lg=this.filmOffset;0!==Lg&&(Mg+=Eg*Lg/this.getFilmWidth()),this.projectionMatrix.makePerspective(Mg,Mg+Sg,bg,bg-Tg,Eg,this.far)},toJSON:function toJSON(Eg){var bg=js.prototype.toJSON.call(this,Eg);return bg.object.fov=this.fov,bg.object.zoom=this.zoom,bg.object.near=this.near,bg.object.far=this.far,bg.object.focus=this.focus,bg.object.aspect=this.aspect,null!==this.view&&(bg.object.view=Object.assign({},this.view)),bg.object.filmGauge=this.filmGauge,bg.object.filmOffset=this.filmOffset,bg}}),zl.prototype=Object.assign(Object.create(Fl.prototype),{constructor:zl,isArrayCamera:!0}),Ol.prototype.isFogExp2=!0,Ol.prototype.clone=function(){return new Ol(this.color.getHex(),this.density)},Ol.prototype.toJSON=function(){return{type:'FogExp2',color:this.color.getHex(),density:this.density}},Vl.prototype.isFog=!0,Vl.prototype.clone=function(){return new Vl(this.color.getHex(),this.near,this.far)},Vl.prototype.toJSON=function(){return{type:'Fog',color:this.color.getHex(),near:this.near,far:this.far}},Wl.prototype=Object.assign(Object.create(js.prototype),{constructor:Wl,copy:function copy(Eg,bg){return js.prototype.copy.call(this,Eg,bg),null!==Eg.background&&(this.background=Eg.background.clone()),null!==Eg.fog&&(this.fog=Eg.fog.clone()),null!==Eg.overrideMaterial&&(this.overrideMaterial=Eg.overrideMaterial.clone()),this.autoUpdate=Eg.autoUpdate,this.matrixAutoUpdate=Eg.matrixAutoUpdate,this},toJSON:function toJSON(Eg){var bg=js.prototype.toJSON.call(this,Eg);return null!==this.background&&(bg.object.background=this.background.toJSON(Eg)),null!==this.fog&&(bg.object.fog=this.fog.toJSON()),bg}}),kl.prototype=Object.assign(Object.create(js.prototype),{constructor:kl,isLensFlare:!0,copy:function copy(Eg){js.prototype.copy.call(this,Eg),this.positionScreen.copy(Eg.positionScreen),this.customUpdateCallback=Eg.customUpdateCallback;for(var bg=0,Tg=Eg.lensFlares.length;bg<Tg;bg++)this.lensFlares.push(Eg.lensFlares[bg]);return this},add:function add(Eg,bg,Tg,Sg,Mg,Ag){void 0===bg&&(bg=-1),void 0===Tg&&(Tg=0),void 0===Ag&&(Ag=1),void 0===Mg&&(Mg=new Ps(16777215)),void 0===Sg&&(Sg=kc),Tg=Math.min(Tg,Math.max(0,Tg)),this.lensFlares.push({texture:Eg,size:bg,distance:Tg,x:0,y:0,z:0,scale:1,rotation:0,opacity:Ag,color:Mg,blending:Sg})},updateLensFlares:function updateLensFlares(){var Tg=this.lensFlares.length,Sg=2*-this.positionScreen.x,Mg=2*-this.positionScreen.y,Eg,bg;for(Eg=0;Eg<Tg;Eg++)(bg=this.lensFlares[Eg]).x=this.positionScreen.x+Sg*bg.distance,bg.y=this.positionScreen.y+Mg*bg.distance,bg.wantedRotation=.25*(bg.x*Math.PI),bg.rotation+=.25*(bg.wantedRotation-bg.rotation)}}),(Xl.prototype=Object.create(Ns.prototype)).constructor=Xl,Xl.prototype.isSpriteMaterial=!0,Xl.prototype.copy=function(Eg){return Ns.prototype.copy.call(this,Eg),this.color.copy(Eg.color),this.map=Eg.map,this.rotation=Eg.rotation,this},jl.prototype=Object.assign(Object.create(js.prototype),{constructor:jl,isSprite:!0,raycast:function(){var Eg=new Wo,bg=new Wo,Tg=new Wo;return function(Sg,Mg){bg.setFromMatrixPosition(this.matrixWorld),Sg.ray.closestPointToPoint(bg,Eg),Tg.setFromMatrixScale(this.matrixWorld);var Ag=Tg.x*Tg.y/4;if(!(bg.distanceToSquared(Eg)>Ag)){var wg=Sg.ray.origin.distanceTo(Eg);wg<Sg.near||wg>Sg.far||Mg.push({distance:wg,point:Eg.clone(),face:null,object:this})}}}(),clone:function clone(){return new this.constructor(this.material).copy(this)}}),Yl.prototype=Object.assign(Object.create(js.prototype),{constructor:Yl,copy:function copy(Eg){js.prototype.copy.call(this,Eg,!1);for(var bg=Eg.levels,Tg=0,Sg=bg.length,Mg;Tg<Sg;Tg++)Mg=bg[Tg],this.addLevel(Mg.object.clone(),Mg.distance);return this},addLevel:function addLevel(Eg,bg){void 0===bg&&(bg=0),bg=Math.abs(bg);for(var Tg=this.levels,Sg=0;Sg<Tg.length&&!(bg<Tg[Sg].distance);Sg++);Tg.splice(Sg,0,{distance:bg,object:Eg}),this.add(Eg)},getObjectForDistance:function getObjectForDistance(Eg){for(var bg=this.levels,Tg=1,Sg=bg.length;Tg<Sg&&!(Eg<bg[Tg].distance);Tg++);return bg[Tg-1].object},raycast:function(){var Eg=new Wo;return function(bg,Tg){Eg.setFromMatrixPosition(this.matrixWorld);var Sg=bg.ray.origin.distanceTo(Eg);this.getObjectForDistance(Sg).raycast(bg,Tg)}}(),update:function(){var Eg=new Wo,bg=new Wo;return function(Tg){var Sg=this.levels;if(1<Sg.length){Eg.setFromMatrixPosition(Tg.matrixWorld),bg.setFromMatrixPosition(this.matrixWorld);var Mg=Eg.distanceTo(bg);Sg[0].object.visible=!0;for(var Ag=1,wg=Sg.length;Ag<wg&&Mg>=Sg[Ag].distance;Ag++)Sg[Ag-1].object.visible=!1,Sg[Ag].object.visible=!0;for(;Ag<wg;Ag++)Sg[Ag].object.visible=!1}}}(),toJSON:function toJSON(Eg){var bg=js.prototype.toJSON.call(this,Eg);bg.object.levels=[];for(var Tg=this.levels,Sg=0,Mg=Tg.length,Ag;Sg<Mg;Sg++)Ag=Tg[Sg],bg.object.levels.push({object:Ag.object.uuid,distance:Ag.distance});return bg}}),Object.assign(ql.prototype,{calculateInverses:function calculateInverses(){this.boneInverses=[];for(var Eg=0,bg=this.bones.length,Tg;Eg<bg;Eg++)Tg=new Ho,this.bones[Eg]&&Tg.getInverse(this.bones[Eg].matrixWorld),this.boneInverses.push(Tg)},pose:function pose(){var Eg,bg,Tg;for(bg=0,Tg=this.bones.length;bg<Tg;bg++)(Eg=this.bones[bg])&&Eg.matrixWorld.getInverse(this.boneInverses[bg]);for(bg=0,Tg=this.bones.length;bg<Tg;bg++)(Eg=this.bones[bg])&&(Eg.parent&&Eg.parent.isBone?(Eg.matrix.getInverse(Eg.parent.matrixWorld),Eg.matrix.multiply(Eg.matrixWorld)):Eg.matrix.copy(Eg.matrixWorld),Eg.matrix.decompose(Eg.position,Eg.quaternion,Eg.scale))},update:function(){var Eg=new Ho,bg=new Ho;return function(){for(var Tg=this.bones,Sg=this.boneInverses,Mg=this.boneMatrices,Ag=this.boneTexture,wg=0,Rg=Tg.length,Lg;wg<Rg;wg++)Lg=Tg[wg]?Tg[wg].matrixWorld:bg,Eg.multiplyMatrices(Lg,Sg[wg]),Eg.toArray(Mg,16*wg);void 0!==Ag&&(Ag.needsUpdate=!0)}}(),clone:function clone(){return new ql(this.bones,this.boneInverses)}}),Zl.prototype=Object.assign(Object.create(js.prototype),{constructor:Zl,isBone:!0}),Jl.prototype=Object.assign(Object.create(El.prototype),{constructor:Jl,isSkinnedMesh:!0,initBones:function initBones(){var Mg=[],Eg,bg,Tg,Sg;if(this.geometry&&void 0!==this.geometry.bones){for(Tg=0,Sg=this.geometry.bones.length;Tg<Sg;Tg++)bg=this.geometry.bones[Tg],Eg=new Zl,Mg.push(Eg),Eg.name=bg.name,Eg.position.fromArray(bg.pos),Eg.quaternion.fromArray(bg.rotq),void 0!==bg.scl&&Eg.scale.fromArray(bg.scl);for(Tg=0,Sg=this.geometry.bones.length;Tg<Sg;Tg++)-1!==(bg=this.geometry.bones[Tg]).parent&&null!==bg.parent&&void 0!==Mg[bg.parent]?Mg[bg.parent].add(Mg[Tg]):this.add(Mg[Tg])}return this.updateMatrixWorld(!0),Mg},bind:function bind(Eg,bg){this.skeleton=Eg,void 0===bg&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),bg=this.matrixWorld),this.bindMatrix.copy(bg),this.bindMatrixInverse.getInverse(bg)},pose:function pose(){this.skeleton.pose()},normalizeSkinWeights:function normalizeSkinWeights(){var Eg,bg;if(this.geometry&&this.geometry.isGeometry)for(bg=0;bg<this.geometry.skinWeights.length;bg++){var Tg=this.geometry.skinWeights[bg];(Eg=1/Tg.manhattanLength())==1/0?Tg.set(1,0,0,0):Tg.multiplyScalar(Eg)}else if(this.geometry&&this.geometry.isBufferGeometry){var Sg=new Yo,Mg=this.geometry.attributes.skinWeight;for(bg=0;bg<Mg.count;bg++)Sg.x=Mg.getX(bg),Sg.y=Mg.getY(bg),Sg.z=Mg.getZ(bg),Sg.w=Mg.getW(bg),(Eg=1/Sg.manhattanLength())==1/0?Sg.set(1,0,0,0):Sg.multiplyScalar(Eg),Mg.setXYZW(bg,Sg.x,Sg.y,Sg.z,Sg.w)}},updateMatrixWorld:function updateMatrixWorld(Eg){El.prototype.updateMatrixWorld.call(this,Eg),'attached'===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):'detached'===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn('THREE.SkinnedMesh: Unrecognized bindMode: '+this.bindMode)},clone:function clone(){return new this.constructor(this.geometry,this.material).copy(this)}}),(Ql.prototype=Object.create(Ns.prototype)).constructor=Ql,Ql.prototype.isLineBasicMaterial=!0,Ql.prototype.copy=function(Eg){return Ns.prototype.copy.call(this,Eg),this.color.copy(Eg.color),this.linewidth=Eg.linewidth,this.linecap=Eg.linecap,this.linejoin=Eg.linejoin,this},Kl.prototype=Object.assign(Object.create(js.prototype),{constructor:Kl,isLine:!0,raycast:function(){var Eg=new Ho,bg=new xl,Tg=new Gs;return function(Sg,Mg){var Ag=Sg.linePrecision,wg=Ag*Ag,Rg=this.geometry,Lg=this.matrixWorld;if(null===Rg.boundingSphere&&Rg.computeBoundingSphere(),Tg.copy(Rg.boundingSphere),Tg.applyMatrix4(Lg),!1!==Sg.ray.intersectsSphere(Tg)){Eg.getInverse(Lg),bg.copy(Sg.ray).applyMatrix4(Eg);var Pg=new Wo,Cg=new Wo,Ig=new Wo,Ug=new Wo,Dg=this&&this.isLineSegments?2:1;if(Rg.isBufferGeometry){var Ng=Rg.index,Bg=Rg.attributes.position.array;if(null!==Ng)for(var Fg=Ng.array,zg=0,Gg=Fg.length-1;zg<Gg;zg+=Dg){var Hg=Fg[zg],Og=Fg[zg+1];Pg.fromArray(Bg,3*Hg),Cg.fromArray(Bg,3*Og),(kg=bg.distanceSqToSegment(Pg,Cg,Ug,Ig))>wg||(Ug.applyMatrix4(this.matrixWorld),(Xg=Sg.ray.origin.distanceTo(Ug))<Sg.near||Xg>Sg.far||Mg.push({distance:Xg,point:Ig.clone().applyMatrix4(this.matrixWorld),index:zg,face:null,faceIndex:null,object:this}))}else for(var zg=0,Gg=Bg.length/3-1;zg<Gg;zg+=Dg)Pg.fromArray(Bg,3*zg),Cg.fromArray(Bg,3*zg+3),(kg=bg.distanceSqToSegment(Pg,Cg,Ug,Ig))>wg||(Ug.applyMatrix4(this.matrixWorld),(Xg=Sg.ray.origin.distanceTo(Ug))<Sg.near||Xg>Sg.far||Mg.push({distance:Xg,point:Ig.clone().applyMatrix4(this.matrixWorld),index:zg,face:null,faceIndex:null,object:this}))}else if(Rg.isGeometry)for(var Vg=Rg.vertices,Wg=Vg.length,zg=0,kg;zg<Wg-1;zg+=Dg)if(kg=bg.distanceSqToSegment(Vg[zg],Vg[zg+1],Ug,Ig),!(kg>wg)){Ug.applyMatrix4(this.matrixWorld);var Xg=Sg.ray.origin.distanceTo(Ug);Xg<Sg.near||Xg>Sg.far||Mg.push({distance:Xg,point:Ig.clone().applyMatrix4(this.matrixWorld),index:zg,face:null,faceIndex:null,object:this})}}}}(),clone:function clone(){return new this.constructor(this.geometry,this.material).copy(this)}}),$l.prototype=Object.assign(Object.create(Kl.prototype),{constructor:$l,isLineSegments:!0}),ed.prototype=Object.assign(Object.create(Kl.prototype),{constructor:ed,isLineLoop:!0}),(td.prototype=Object.create(Ns.prototype)).constructor=td,td.prototype.isPointsMaterial=!0,td.prototype.copy=function(Eg){return Ns.prototype.copy.call(this,Eg),this.color.copy(Eg.color),this.map=Eg.map,this.size=Eg.size,this.sizeAttenuation=Eg.sizeAttenuation,this},rd.prototype=Object.assign(Object.create(js.prototype),{constructor:rd,isPoints:!0,raycast:function(){var Eg=new Ho,bg=new xl,Tg=new Gs;return function(Sg,Mg){function Ag(Vg,Wg){var kg=bg.distanceSqToPoint(Vg);if(kg<Ig){var Xg=bg.closestPointToPoint(Vg);Xg.applyMatrix4(Lg);var jg=Sg.ray.origin.distanceTo(Xg);if(jg<Sg.near||jg>Sg.far)return;Mg.push({distance:jg,distanceToRay:Math.sqrt(kg),point:Xg.clone(),index:Wg,face:null,object:wg})}}var wg=this,Rg=this.geometry,Lg=this.matrixWorld,Pg=Sg.params.Points.threshold;if(null===Rg.boundingSphere&&Rg.computeBoundingSphere(),Tg.copy(Rg.boundingSphere),Tg.applyMatrix4(Lg),Tg.radius+=Pg,!1!==Sg.ray.intersectsSphere(Tg)){Eg.getInverse(Lg),bg.copy(Sg.ray).applyMatrix4(Eg);var Cg=Pg/((this.scale.x+this.scale.y+this.scale.z)/3),Ig=Cg*Cg,Ug=new Wo;if(Rg.isBufferGeometry){var Dg=Rg.index,Ng=Rg.attributes.position.array;if(null!==Dg)for(var Bg=Dg.array,Fg=0,zg=Bg.length,Gg;Fg<zg;Fg++)Gg=Bg[Fg],Ug.fromArray(Ng,3*Gg),Ag(Ug,Gg);else for(var Fg=0,Hg=Ng.length/3;Fg<Hg;Fg++)Ug.fromArray(Ng,3*Fg),Ag(Ug,Fg)}else for(var Og=Rg.vertices,Fg=0,Hg=Og.length;Fg<Hg;Fg++)Ag(Og[Fg],Fg)}}}(),clone:function clone(){return new this.constructor(this.geometry,this.material).copy(this)}}),ad.prototype=Object.assign(Object.create(js.prototype),{constructor:ad}),(id.prototype=Object.create(jo.prototype)).constructor=id,(od.prototype=Object.create(jo.prototype)).constructor=od,od.prototype.isCompressedTexture=!0,(nd.prototype=Object.create(jo.prototype)).constructor=nd,nd.prototype.isDepthTexture=!0,(sd.prototype=Object.create(Js.prototype)).constructor=sd,(ld.prototype=Object.create(dl.prototype)).constructor=ld,(dd.prototype=Object.create(Js.prototype)).constructor=dd,(pd.prototype=Object.create(dl.prototype)).constructor=pd,(cd.prototype=Object.create(Js.prototype)).constructor=cd,(md.prototype=Object.create(pd.prototype)).constructor=md,(ud.prototype=Object.create(Js.prototype)).constructor=ud,(gd.prototype=Object.create(pd.prototype)).constructor=gd,(fd.prototype=Object.create(Js.prototype)).constructor=fd,(hd.prototype=Object.create(pd.prototype)).constructor=hd;var Qu={area:function area(Eg){for(var bg=Eg.length,Tg=0,Sg=bg-1,Mg=0;Mg<bg;Sg=Mg++)Tg+=Eg[Sg].x*Eg[Mg].y-Eg[Mg].x*Eg[Sg].y;return .5*Tg},triangulate:function(){function Eg(bg,Tg,Sg,Mg,Ag,wg){var Rg,Lg,Pg,Cg,Ig,Ug,Dg,Ng,Bg;if(Lg=bg[wg[Tg]].x,Pg=bg[wg[Tg]].y,Cg=bg[wg[Sg]].x,Ig=bg[wg[Sg]].y,Ug=bg[wg[Mg]].x,Dg=bg[wg[Mg]].y,0>=(Cg-Lg)*(Dg-Pg)-(Ig-Pg)*(Ug-Lg))return!1;var Fg,zg,Gg,Hg,Og,Vg,Wg,kg,Xg,jg,Yg,qg,Zg,Jg,Qg;for(Fg=Ug-Cg,zg=Dg-Ig,Gg=Lg-Ug,Hg=Pg-Dg,Og=Cg-Lg,Vg=Ig-Pg,Rg=0;Rg<Ag;Rg++)if(Ng=bg[wg[Rg]].x,Bg=bg[wg[Rg]].y,(Ng!==Lg||Bg!==Pg)&&(Ng!==Cg||Bg!==Ig)&&(Ng!==Ug||Bg!==Dg)&&(Wg=Ng-Lg,kg=Bg-Pg,Xg=Ng-Cg,jg=Bg-Ig,Yg=Ng-Ug,qg=Bg-Dg,Qg=Fg*jg-zg*Xg,Zg=Og*kg-Vg*Wg,Jg=Gg*qg-Hg*Yg,Qg>=-Number.EPSILON&&Jg>=-Number.EPSILON&&Zg>=-Number.EPSILON))return!1;return!0}return function(bg,Tg){var Sg=bg.length;if(3>Sg)return null;var Rg=[],Lg=[],Pg=[],Mg,Ag,wg;if(0<Qu.area(bg))for(Ag=0;Ag<Sg;Ag++)Lg[Ag]=Ag;else for(Ag=0;Ag<Sg;Ag++)Lg[Ag]=Sg-1-Ag;var Cg=Sg,Ig=2*Cg;for(Ag=Cg-1;2<Cg;){if(0>=Ig--)return console.warn('THREE.ShapeUtils: Unable to triangulate polygon! in triangulate()'),Tg?Pg:Rg;if(Mg=Ag,Cg<=Mg&&(Mg=0),Ag=Mg+1,Cg<=Ag&&(Ag=0),wg=Ag+1,Cg<=wg&&(wg=0),Eg(bg,Mg,Ag,wg,Cg,Lg)){var Ug,Dg,Ng,Bg,Fg;for(Ug=Lg[Mg],Dg=Lg[Ag],Ng=Lg[wg],Rg.push([bg[Ug],bg[Dg],bg[Ng]]),Pg.push([Lg[Mg],Lg[Ag],Lg[wg]]),Bg=Ag,Fg=Ag+1;Fg<Cg;Bg++,Fg++)Lg[Bg]=Lg[Fg];Ig=2*--Cg}}return Tg?Pg:Rg}}(),triangulateShape:function triangulateShape(Eg,bg){function Tg(Gg){var Hg=Gg.length;2<Hg&&Gg[Hg-1].equals(Gg[0])&&Gg.pop()}function Sg(Gg,Hg,Og){return Gg.x===Hg.x?Gg.y<Hg.y?Gg.y<=Og.y&&Og.y<=Hg.y:Hg.y<=Og.y&&Og.y<=Gg.y:Gg.x<Hg.x?Gg.x<=Og.x&&Og.x<=Hg.x:Hg.x<=Og.x&&Og.x<=Gg.x}function Mg(Gg,Hg,Og,Vg,Wg){var kg=Hg.x-Gg.x,Xg=Hg.y-Gg.y,jg=Vg.x-Og.x,Yg=Vg.y-Og.y,qg=Gg.x-Og.x,Zg=Gg.y-Og.y,Jg=Xg*jg-kg*Yg,Qg=Xg*qg-kg*Zg;if(Math.abs(Jg)>Number.EPSILON){var Kg;if(0<Jg){if(0>Qg||Qg>Jg)return[];if(0>(Kg=Yg*qg-jg*Zg)||Kg>Jg)return[]}else{if(0<Qg||Qg<Jg)return[];if(0<(Kg=Yg*qg-jg*Zg)||Kg<Jg)return[]}if(0===Kg)return Wg&&(0==Qg||Qg==Jg)?[]:[Gg];if(Kg===Jg)return Wg&&(0==Qg||Qg==Jg)?[]:[Hg];if(0==Qg)return[Og];if(Qg==Jg)return[Vg];var $g=Kg/Jg;return[{x:Gg.x+$g*kg,y:Gg.y+$g*Xg}]}if(0!=Qg||Yg*qg!=jg*Zg)return[];var ef=0==kg&&0==Xg,tf=0==jg&&0==Yg;if(ef&&tf)return Gg.x!==Og.x||Gg.y!==Og.y?[]:[Gg];if(ef)return Sg(Og,Vg,Gg)?[Gg]:[];if(tf)return Sg(Gg,Hg,Og)?[Og]:[];var rf,af,of,nf,sf,lf,df,pf;return 0==kg?(Gg.y<Hg.y?(rf=Gg,of=Gg.y,af=Hg,nf=Hg.y):(rf=Hg,of=Hg.y,af=Gg,nf=Gg.y),Og.y<Vg.y?(sf=Og,df=Og.y,lf=Vg,pf=Vg.y):(sf=Vg,df=Vg.y,lf=Og,pf=Og.y)):(Gg.x<Hg.x?(rf=Gg,of=Gg.x,af=Hg,nf=Hg.x):(rf=Hg,of=Hg.x,af=Gg,nf=Gg.x),Og.x<Vg.x?(sf=Og,df=Og.x,lf=Vg,pf=Vg.x):(sf=Vg,df=Vg.x,lf=Og,pf=Og.x)),of<=df?nf<df?[]:nf===df?Wg?[]:[sf]:nf<=pf?[sf,af]:[sf,lf]:of>pf?[]:of===pf?Wg?[]:[rf]:nf<=pf?[rf,af]:[rf,lf]}function Ag(Gg,Hg,Og,Vg){var Wg=Hg.x-Gg.x,kg=Hg.y-Gg.y,Xg=Og.x-Gg.x,jg=Og.y-Gg.y,Yg=Vg.x-Gg.x,qg=Vg.y-Gg.y,Zg=Wg*jg-kg*Xg,Jg=Wg*qg-kg*Yg;if(Math.abs(Zg)>Number.EPSILON){var Qg=Yg*jg-qg*Xg;return 0<Zg?0<=Jg&&0<=Qg:0<=Jg||0<=Qg}return 0<Jg}Tg(Eg),bg.forEach(Tg);for(var Ug={},Dg=Eg.concat(),Ng=0,Bg=bg.length,wg,Rg,Lg,Pg,Cg,Ig;Ng<Bg;Ng++)Array.prototype.push.apply(Dg,bg[Ng]);for(wg=0,Rg=Dg.length;wg<Rg;wg++)void 0!==Ug[Cg=Dg[wg].x+':'+Dg[wg].y]&&console.warn('THREE.ShapeUtils: Duplicate point',Cg,wg),Ug[Cg]=wg;var Fg=function(Gg,Hg){function Og(pf,cf){var mf=tf.length-1,uf=pf-1;0>uf&&(uf=mf);var gf=pf+1;gf>mf&&(gf=0);var ff=Ag(tf[pf],tf[uf],tf[gf],kg[cf]);if(!ff)return!1;var hf=kg.length-1,yf=cf-1;0>yf&&(yf=hf);var xf=cf+1;return xf>hf&&(xf=0),!!(ff=Ag(kg[cf],kg[yf],kg[xf],tf[pf]))}function Vg(pf,cf){var mf,uf;for(mf=0;mf<tf.length;mf++)if(uf=mf+1,uf%=tf.length,0<Mg(pf,cf,tf[mf],tf[uf],!0).length)return!0;return!1}function Wg(pf,cf){var mf,uf,gf,ff;for(mf=0;mf<rf.length;mf++)for(uf=Hg[rf[mf]],gf=0;gf<uf.length;gf++)if(ff=gf+1,ff%=uf.length,0<Mg(pf,cf,uf[gf],uf[ff],!0).length)return!0;return!1}for(var tf=Gg.concat(),rf=[],af=[],of=0,nf=Hg.length,kg,Xg,jg,Yg,qg,Zg,Jg,Qg,Kg,$g,ef;of<nf;of++)rf.push(of);for(var sf=0,lf=2*rf.length;0<rf.length;){if(0>--lf){console.log('THREE.ShapeUtils: Infinite Loop! Holes left:" + indepHoles.length + ", Probably Hole outside Shape!');break}for(jg=sf;jg<tf.length;jg++){for(Yg=tf[jg],Xg=-1,of=0;of<rf.length;of++)if(Zg=rf[of],Jg=Yg.x+':'+Yg.y+':'+Zg,void 0===af[Jg]){kg=Hg[Zg];for(var df=0;df<kg.length;df++)if(qg=kg[df],Og(jg,df)&&!Vg(Yg,qg)&&!Wg(Yg,qg)){Xg=df,rf.splice(of,1),Qg=tf.slice(0,jg+1),Kg=tf.slice(jg),$g=kg.slice(Xg),ef=kg.slice(0,Xg+1),tf=Qg.concat($g).concat(ef).concat(Kg),sf=jg;break}if(0<=Xg)break;af[Jg]=!0}if(0<=Xg)break}}return tf}(Eg,bg),zg=Qu.triangulate(Fg,!1);for(wg=0,Rg=zg.length;wg<Rg;wg++)for(Pg=zg[wg],Lg=0;3>Lg;Lg++)void 0!==(Ig=Ug[Cg=Pg[Lg].x+':'+Pg[Lg].y])&&(Pg[Lg]=Ig);return zg.concat()},isClockWise:function isClockWise(Eg){return 0>Qu.area(Eg)}};(yd.prototype=Object.create(Js.prototype)).constructor=yd,(xd.prototype=Object.create(dl.prototype)).constructor=xd,xd.prototype.getArrays=function(){var Eg=this.getAttribute('position'),bg=Eg?Array.prototype.slice.call(Eg.array):[],Tg=this.getAttribute('uv'),Sg=Tg?Array.prototype.slice.call(Tg.array):[],Mg=this.index;return{position:bg,uv:Sg,index:Mg?Array.prototype.slice.call(Mg.array):[]}},xd.prototype.addShapeList=function(Eg,bg){var Tg=Eg.length;bg.arrays=this.getArrays();for(var Sg=0,Mg;Sg<Tg;Sg++)Mg=Eg[Sg],this.addShape(Mg,bg);this.setIndex(bg.arrays.index),this.addAttribute('position',new ol(bg.arrays.position,3)),this.addAttribute('uv',new ol(bg.arrays.uv,2))},xd.prototype.addShape=function(Eg,bg){function Tg(Tf,Sf,Mf){return Sf||console.error('THREE.ExtrudeGeometry: vec does not exist'),Sf.clone().multiplyScalar(Mf).add(Tf)}function Sg(Tf,Sf,Mf){var Lf=Tf.x-Sf.x,Pf=Tf.y-Sf.y,Cf=Mf.x-Tf.x,If=Mf.y-Tf.y,Uf=Lf*Lf+Pf*Pf,Af,wf,Rf;if(Math.abs(Lf*If-Pf*Cf)>Number.EPSILON){var Nf=Math.sqrt(Uf),Bf=Math.sqrt(Cf*Cf+If*If),Ff=Sf.x-Pf/Nf,zf=Sf.y+Lf/Nf,Gf=((Mf.x-If/Bf-Ff)*If-(Mf.y+Cf/Bf-zf)*Cf)/(Lf*If-Pf*Cf),Hf=(Af=Ff+Lf*Gf-Tf.x)*Af+(wf=zf+Pf*Gf-Tf.y)*wf;if(2>=Hf)return new Go(Af,wf);Rf=Math.sqrt(Hf/2)}else{var Of=!1;Lf>Number.EPSILON?Cf>Number.EPSILON&&(Of=!0):Lf<-Number.EPSILON?Cf<-Number.EPSILON&&(Of=!0):Math.sign(Pf)===Math.sign(If)&&(Of=!0),Of?(Af=-Pf,wf=Lf,Rf=Math.sqrt(Uf)):(Af=Lf,wf=Pf,Rf=Math.sqrt(Uf/2))}return new Go(Af/Rf,wf/Rf)}function Mg(Tf,Sf){var Mf,Af;for(ff=Tf.length;0<=--ff;){Mf=ff,0>(Af=ff-1)&&(Af=Tf.length-1);var wf=0,Rf=jg+2*Wg;for(wf=0;wf<Rf;wf++){var Lf=mf*wf,Pf=mf*(wf+1);!function(Cf,If,Uf,Df){Rg(Cf),Rg(If),Rg(Df),Rg(If),Rg(Uf),Rg(Df);var Nf=Bg.length/3,Bf=Zg.generateSideWallUV($g,Bg,Nf-6,Nf-3,Nf-2,Nf-1);Lg(Bf[0]),Lg(Bf[1]),Lg(Bf[3]),Lg(Bf[1]),Lg(Bf[2]),Lg(Bf[3])}(Sf+Mf+Lf,Sf+Af+Lf,Sf+Af+Pf,Sf+Mf+Pf)}}}function Ag(Tf,Sf,Mf){Gg.push(Tf),Gg.push(Sf),Gg.push(Mf)}function wg(Tf,Sf,Mf){Rg(Tf),Rg(Sf),Rg(Mf);var Af=Bg.length/3,wf=Zg.generateTopUV($g,Bg,Af-3,Af-2,Af-1);Lg(wf[0]),Lg(wf[1]),Lg(wf[2])}function Rg(Tf){Fg.push(Bg.length/3),Bg.push(Gg[3*Tf+0]),Bg.push(Gg[3*Tf+1]),Bg.push(Gg[3*Tf+2])}function Lg(Tf){zg.push(Tf.x),zg.push(Tf.y)}var Ng=bg.arrays?bg.arrays:this.getArrays(),Bg=Ng.position,Fg=Ng.index,zg=Ng.uv,Gg=[],Hg=void 0===bg.amount?100:bg.amount,Og=void 0===bg.bevelThickness?6:bg.bevelThickness,Vg=void 0===bg.bevelSize?Og-2:bg.bevelSize,Wg=void 0===bg.bevelSegments?3:bg.bevelSegments,kg=void 0===bg.bevelEnabled||bg.bevelEnabled,Xg=void 0===bg.curveSegments?12:bg.curveSegments,jg=void 0===bg.steps?1:bg.steps,Yg=bg.extrudePath,qg=!1,Zg=void 0===bg.UVGenerator?yd.WorldUVGenerator:bg.UVGenerator,Pg,Cg,Ig,Ug,Dg;Yg&&(Pg=Yg.getSpacedPoints(jg),qg=!0,kg=!1,Cg=void 0===bg.frames?Yg.computeFrenetFrames(jg,!1):bg.frames,Ig=new Wo,Ug=new Wo,Dg=new Wo),kg||(Wg=0,Og=0,Vg=0);var $g=this,ef=Eg.extractPoints(Xg),tf=ef.shape,rf=ef.holes,Jg,Qg,Kg;if(!Qu.isClockWise(tf))for(tf=tf.reverse(),Qg=0,Kg=rf.length;Qg<Kg;Qg++)Jg=rf[Qg],Qu.isClockWise(Jg)&&(rf[Qg]=Jg.reverse());var af=Qu.triangulateShape(tf,rf),of=tf;for(Qg=0,Kg=rf.length;Qg<Kg;Qg++)Jg=rf[Qg],tf=tf.concat(Jg);for(var mf=tf.length,uf=af.length,gf=[],ff=0,hf=of.length,yf=hf-1,xf=ff+1,nf,sf,lf,df,pf,cf;ff<hf;ff++,yf++,xf++)yf===hf&&(yf=0),xf===hf&&(xf=0),gf[ff]=Sg(of[ff],of[yf],of[xf]);var _f=[],Ef=gf.concat(),vf;for(Qg=0,Kg=rf.length;Qg<Kg;Qg++){for(Jg=rf[Qg],vf=[],ff=0,yf=(hf=Jg.length)-1,xf=ff+1;ff<hf;ff++,yf++,xf++)yf===hf&&(yf=0),xf===hf&&(xf=0),vf[ff]=Sg(Jg[ff],Jg[yf],Jg[xf]);_f.push(vf),Ef=Ef.concat(vf)}for(nf=0;nf<Wg;nf++){for(lf=nf/Wg,df=Og*Math.cos(lf*Math.PI/2),sf=Vg*Math.sin(lf*Math.PI/2),ff=0,hf=of.length;ff<hf;ff++)Ag((pf=Tg(of[ff],gf[ff],sf)).x,pf.y,-df);for(Qg=0,Kg=rf.length;Qg<Kg;Qg++)for(Jg=rf[Qg],vf=_f[Qg],ff=0,hf=Jg.length;ff<hf;ff++)Ag((pf=Tg(Jg[ff],vf[ff],sf)).x,pf.y,-df)}for(sf=Vg,ff=0;ff<mf;ff++)pf=kg?Tg(tf[ff],Ef[ff],sf):tf[ff],qg?(Ug.copy(Cg.normals[0]).multiplyScalar(pf.x),Ig.copy(Cg.binormals[0]).multiplyScalar(pf.y),Dg.copy(Pg[0]).add(Ug).add(Ig),Ag(Dg.x,Dg.y,Dg.z)):Ag(pf.x,pf.y,0);var bf;for(bf=1;bf<=jg;bf++)for(ff=0;ff<mf;ff++)pf=kg?Tg(tf[ff],Ef[ff],sf):tf[ff],qg?(Ug.copy(Cg.normals[bf]).multiplyScalar(pf.x),Ig.copy(Cg.binormals[bf]).multiplyScalar(pf.y),Dg.copy(Pg[bf]).add(Ug).add(Ig),Ag(Dg.x,Dg.y,Dg.z)):Ag(pf.x,pf.y,Hg/jg*bf);for(nf=Wg-1;0<=nf;nf--){for(lf=nf/Wg,df=Og*Math.cos(lf*Math.PI/2),sf=Vg*Math.sin(lf*Math.PI/2),ff=0,hf=of.length;ff<hf;ff++)Ag((pf=Tg(of[ff],gf[ff],sf)).x,pf.y,Hg+df);for(Qg=0,Kg=rf.length;Qg<Kg;Qg++)for(Jg=rf[Qg],vf=_f[Qg],ff=0,hf=Jg.length;ff<hf;ff++)pf=Tg(Jg[ff],vf[ff],sf),qg?Ag(pf.x,pf.y+Pg[jg-1].y,Pg[jg-1].x+df):Ag(pf.x,pf.y,Hg+df)}!function(){var Tf=Bg.length/3;if(kg){var Sf=0,Mf=mf*Sf;for(ff=0;ff<uf;ff++)wg((cf=af[ff])[2]+Mf,cf[1]+Mf,cf[0]+Mf);for(Mf=mf*(Sf=jg+2*Wg),ff=0;ff<uf;ff++)wg((cf=af[ff])[0]+Mf,cf[1]+Mf,cf[2]+Mf)}else{for(ff=0;ff<uf;ff++)wg((cf=af[ff])[2],cf[1],cf[0]);for(ff=0;ff<uf;ff++)wg((cf=af[ff])[0]+mf*jg,cf[1]+mf*jg,cf[2]+mf*jg)}$g.addGroup(Tf,Bg.length/3-Tf,void 0===bg.material?0:bg.material)}(),function(){var Tf=Bg.length/3,Sf=0;for(Mg(of,Sf),Sf+=of.length,Qg=0,Kg=rf.length;Qg<Kg;Qg++)Mg(Jg=rf[Qg],Sf),Sf+=Jg.length;$g.addGroup(Tf,Bg.length/3-Tf,void 0===bg.extrudeMaterial?1:bg.extrudeMaterial)}(),bg.arrays||(this.setIndex(Fg),this.addAttribute('position',new ol(Bg,3)),this.addAttribute('uv',new ol(bg.arrays.uv,2)))},yd.WorldUVGenerator={generateTopUV:function generateTopUV(Eg,bg,Tg,Sg,Mg){var Ag=bg[3*Tg],wg=bg[3*Tg+1],Rg=bg[3*Sg],Lg=bg[3*Sg+1],Pg=bg[3*Mg],Cg=bg[3*Mg+1];return[new Go(Ag,wg),new Go(Rg,Lg),new Go(Pg,Cg)]},generateSideWallUV:function generateSideWallUV(Eg,bg,Tg,Sg,Mg,Ag){var wg=bg[3*Tg],Rg=bg[3*Tg+1],Lg=bg[3*Tg+2],Pg=bg[3*Sg],Cg=bg[3*Sg+1],Ig=bg[3*Sg+2],Ug=bg[3*Mg],Dg=bg[3*Mg+1],Ng=bg[3*Mg+2],Bg=bg[3*Ag],Fg=bg[3*Ag+1],zg=bg[3*Ag+2];return .01>Math.abs(Rg-Cg)?[new Go(wg,1-Lg),new Go(Pg,1-Ig),new Go(Ug,1-Ng),new Go(Bg,1-zg)]:[new Go(Rg,1-Lg),new Go(Cg,1-Ig),new Go(Dg,1-Ng),new Go(Fg,1-zg)]}},(vd.prototype=Object.create(Js.prototype)).constructor=vd,(_d.prototype=Object.create(xd.prototype)).constructor=_d,(Ed.prototype=Object.create(Js.prototype)).constructor=Ed,(bd.prototype=Object.create(dl.prototype)).constructor=bd,(Td.prototype=Object.create(Js.prototype)).constructor=Td,(Sd.prototype=Object.create(dl.prototype)).constructor=Sd,(Md.prototype=Object.create(Js.prototype)).constructor=Md,(Ad.prototype=Object.create(dl.prototype)).constructor=Ad,(wd.prototype=Object.create(Md.prototype)).constructor=wd,(Rd.prototype=Object.create(Ad.prototype)).constructor=Rd,(Ld.prototype=Object.create(Js.prototype)).constructor=Ld,(Pd.prototype=Object.create(dl.prototype)).constructor=Pd;var Ku=Object.freeze({ParametricGeometry:sd,ParametricBufferGeometry:ld,TetrahedronGeometry:cd,TetrahedronBufferGeometry:md,OctahedronGeometry:ud,OctahedronBufferGeometry:gd,IcosahedronGeometry:fd,IcosahedronBufferGeometry:hd,PolyhedronGeometry:dd,PolyhedronBufferGeometry:pd,TextGeometry:vd,TextBufferGeometry:_d,SphereGeometry:Ed,SphereBufferGeometry:bd,RingGeometry:Td,RingBufferGeometry:Sd,PlaneGeometry:gl,PlaneBufferGeometry:fl,ExtrudeGeometry:yd,ExtrudeBufferGeometry:xd,ConeGeometry:wd,ConeBufferGeometry:Rd,CylinderGeometry:Md,CylinderBufferGeometry:Ad,CircleGeometry:Ld,CircleBufferGeometry:Pd,BoxGeometry:ml,BoxBufferGeometry:ul,ShapeGeometry:pl,ShapeBufferGeometry:cl});(Cd.prototype=Object.create(Ns.prototype)).constructor=Cd,Cd.prototype.isShadowMaterial=!0,(Id.prototype=Object.create(yl.prototype)).constructor=Id,Id.prototype.isRawShaderMaterial=!0,(Ud.prototype=Object.create(Ns.prototype)).constructor=Ud,Ud.prototype.isMeshPhongMaterial=!0,Ud.prototype.copy=function(Eg){return Ns.prototype.copy.call(this,Eg),this.color.copy(Eg.color),this.specular.copy(Eg.specular),this.shininess=Eg.shininess,this.map=Eg.map,this.lightMap=Eg.lightMap,this.lightMapIntensity=Eg.lightMapIntensity,this.aoMap=Eg.aoMap,this.aoMapIntensity=Eg.aoMapIntensity,this.emissive.copy(Eg.emissive),this.emissiveMap=Eg.emissiveMap,this.emissiveIntensity=Eg.emissiveIntensity,this.bumpMap=Eg.bumpMap,this.bumpScale=Eg.bumpScale,this.normalMap=Eg.normalMap,this.normalScale.copy(Eg.normalScale),this.displacementMap=Eg.displacementMap,this.displacementScale=Eg.displacementScale,this.displacementBias=Eg.displacementBias,this.specularMap=Eg.specularMap,this.alphaMap=Eg.alphaMap,this.envMap=Eg.envMap,this.combine=Eg.combine,this.reflectivity=Eg.reflectivity,this.refractionRatio=Eg.refractionRatio,this.wireframe=Eg.wireframe,this.wireframeLinewidth=Eg.wireframeLinewidth,this.wireframeLinecap=Eg.wireframeLinecap,this.wireframeLinejoin=Eg.wireframeLinejoin,this.skinning=Eg.skinning,this.morphTargets=Eg.morphTargets,this.morphNormals=Eg.morphNormals,this},(Dd.prototype=Object.create(Ns.prototype)).constructor=Dd,Dd.prototype.isMeshLambertMaterial=!0,Dd.prototype.copy=function(Eg){return Ns.prototype.copy.call(this,Eg),this.color.copy(Eg.color),this.map=Eg.map,this.lightMap=Eg.lightMap,this.lightMapIntensity=Eg.lightMapIntensity,this.aoMap=Eg.aoMap,this.aoMapIntensity=Eg.aoMapIntensity,this.emissive.copy(Eg.emissive),this.emissiveMap=Eg.emissiveMap,this.emissiveIntensity=Eg.emissiveIntensity,this.specularMap=Eg.specularMap,this.alphaMap=Eg.alphaMap,this.envMap=Eg.envMap,this.combine=Eg.combine,this.reflectivity=Eg.reflectivity,this.refractionRatio=Eg.refractionRatio,this.wireframe=Eg.wireframe,this.wireframeLinewidth=Eg.wireframeLinewidth,this.wireframeLinecap=Eg.wireframeLinecap,this.wireframeLinejoin=Eg.wireframeLinejoin,this.skinning=Eg.skinning,this.morphTargets=Eg.morphTargets,this.morphNormals=Eg.morphNormals,this},(Nd.prototype=Object.create(Ql.prototype)).constructor=Nd,Nd.prototype.isLineDashedMaterial=!0,Nd.prototype.copy=function(Eg){return Ql.prototype.copy.call(this,Eg),this.scale=Eg.scale,this.dashSize=Eg.dashSize,this.gapSize=Eg.gapSize,this};var $u=Object.freeze({ShadowMaterial:Cd,SpriteMaterial:Xl,MeshPhongMaterial:Ud,MeshLambertMaterial:Dd,MeshBasicMaterial:hl,Material:Ns}),eg={enabled:!1,files:{},add:function add(Eg,bg){!1!==this.enabled&&(this.files[Eg]=bg)},get:function get(Eg){if(!1!==this.enabled)return this.files[Eg]},remove:function remove(Eg){delete this.files[Eg]},clear:function clear(){this.files={}}},tg=new Bd,rg={};Object.assign(Fd.prototype,{load:function load(Eg,bg,Tg,Sg){void 0===Eg&&(Eg=''),void 0!==this.path&&(Eg=this.path+Eg);var Mg=this,Ag=eg.get(Eg);if(void 0!==Ag)return Mg.manager.itemStart(Eg),setTimeout(function(){bg&&bg(Ag),Mg.manager.itemEnd(Eg)},0),Ag;if(void 0===rg[Eg]){var wg=Eg.match(/^data:(.*?)(;base64)?,(.*)$/);if(wg){var Rg=wg[1],Lg=!!wg[2],Pg=wg[3];Pg=window.decodeURIComponent(Pg),Lg&&(Pg=window.atob(Pg));try{var Ig=(this.responseType||'').toLowerCase(),Cg;switch(Ig){case'arraybuffer':case'blob':for(var Ug=new Uint8Array(Pg.length),Dg=0;Dg<Pg.length;Dg++)Ug[Dg]=Pg.charCodeAt(Dg);Cg='blob'===Ig?new Blob([Ug.buffer],{type:Rg}):Ug.buffer;break;case'document':var Ng=new DOMParser;Cg=Ng.parseFromString(Pg,Rg);break;case'json':Cg=JSON.parse(Pg);break;default:Cg=Pg;}window.setTimeout(function(){bg&&bg(Cg),Mg.manager.itemEnd(Eg)},0)}catch(zg){window.setTimeout(function(){Sg&&Sg(zg),Mg.manager.itemEnd(Eg),Mg.manager.itemError(Eg)},0)}}else{rg[Eg]=[],rg[Eg].push({onLoad:bg,onProgress:Tg,onError:Sg});var Bg=new XMLHttpRequest;for(var Fg in Bg.open('GET',Eg,!0),Bg.addEventListener('load',function(zg){var Gg=zg.target.response;eg.add(Eg,Gg);var Hg=rg[Eg];if(delete rg[Eg],200===this.status){for(var Og=0,Vg=Hg.length;Og<Vg;Og++)(Wg=Hg[Og]).onLoad&&Wg.onLoad(Gg);Mg.manager.itemEnd(Eg)}else if(0===this.status){console.warn('THREE.FileLoader: HTTP Status 0 received.');for(var Og=0,Vg=Hg.length;Og<Vg;Og++)(Wg=Hg[Og]).onLoad&&Wg.onLoad(Gg);Mg.manager.itemEnd(Eg)}else{for(var Og=0,Vg=Hg.length,Wg;Og<Vg;Og++)Wg=Hg[Og],Wg.onError&&Wg.onError(zg);Mg.manager.itemEnd(Eg),Mg.manager.itemError(Eg)}},!1),Bg.addEventListener('progress',function(zg){for(var Gg=rg[Eg],Hg=0,Og=Gg.length,Vg;Hg<Og;Hg++)Vg=Gg[Hg],Vg.onProgress&&Vg.onProgress(zg)},!1),Bg.addEventListener('error',function(zg){for(var Gg=rg[Eg],Hg=0,Og=Gg.length,Vg;Hg<Og;Hg++)Vg=Gg[Hg],Vg.onError&&Vg.onError(zg);Mg.manager.itemEnd(Eg),Mg.manager.itemError(Eg)},!1),void 0!==this.responseType&&(Bg.responseType=this.responseType),void 0!==this.withCredentials&&(Bg.withCredentials=this.withCredentials),Bg.overrideMimeType&&Bg.overrideMimeType(void 0===this.mimeType?'text/plain':this.mimeType),this.requestHeader)Bg.setRequestHeader(Fg,this.requestHeader[Fg]);Bg.send(null)}return Mg.manager.itemStart(Eg),Bg}rg[Eg].push({onLoad:bg,onProgress:Tg,onError:Sg})},setPath:function setPath(Eg){return this.path=Eg,this},setResponseType:function setResponseType(Eg){return this.responseType=Eg,this},setWithCredentials:function setWithCredentials(Eg){return this.withCredentials=Eg,this},setMimeType:function setMimeType(Eg){return this.mimeType=Eg,this},setRequestHeader:function setRequestHeader(Eg){return this.requestHeader=Eg,this}}),Object.assign(zd.prototype,{load:function load(Eg,bg,Tg,Sg){function Mg(Ug){Lg.load(Eg[Ug],function(Dg){var Ng=Ag._parser(Dg,!0);wg[Ug]={width:Ng.width,height:Ng.height,format:Ng.format,mipmaps:Ng.mipmaps},6==(Pg+=1)&&(1===Ng.mipmapCount&&(Rg.minFilter=Hm),Rg.format=Ng.format,Rg.needsUpdate=!0,bg&&bg(Rg))},Tg,Sg)}var Ag=this,wg=[],Rg=new od;Rg.image=wg;var Lg=new Fd(this.manager);if(Lg.setPath(this.path),Lg.setResponseType('arraybuffer'),Array.isArray(Eg))for(var Pg=0,Cg=0,Ig=Eg.length;Cg<Ig;++Cg)Mg(Cg);else Lg.load(Eg,function(Ug){var Dg=Ag._parser(Ug,!0);if(Dg.isCubemap)for(var Ng=Dg.mipmaps.length/Dg.mipmapCount,Bg=0;Bg<Ng;Bg++){wg[Bg]={mipmaps:[]};for(var Fg=0;Fg<Dg.mipmapCount;Fg++)wg[Bg].mipmaps.push(Dg.mipmaps[Bg*Dg.mipmapCount+Fg]),wg[Bg].format=Dg.format,wg[Bg].width=Dg.width,wg[Bg].height=Dg.height}else Rg.image.width=Dg.width,Rg.image.height=Dg.height,Rg.mipmaps=Dg.mipmaps;1===Dg.mipmapCount&&(Rg.minFilter=Hm),Rg.format=Dg.format,Rg.needsUpdate=!0,bg&&bg(Rg)},Tg,Sg);return Rg},setPath:function setPath(Eg){return this.path=Eg,this}}),Object.assign(Gd.prototype,{load:function load(Eg,bg,Tg,Sg){var Mg=this,Ag=new Jo,wg=new Fd(this.manager);return wg.setResponseType('arraybuffer'),wg.load(Eg,function(Rg){var Lg=Mg._parser(Rg);Lg&&(void 0===Lg.image?void 0!==Lg.data&&(Ag.image.width=Lg.width,Ag.image.height=Lg.height,Ag.image.data=Lg.data):Ag.image=Lg.image,Ag.wrapS=void 0===Lg.wrapS?Nm:Lg.wrapS,Ag.wrapT=void 0===Lg.wrapT?Nm:Lg.wrapT,Ag.magFilter=void 0===Lg.magFilter?Hm:Lg.magFilter,Ag.minFilter=void 0===Lg.minFilter?Vm:Lg.minFilter,Ag.anisotropy=void 0===Lg.anisotropy?1:Lg.anisotropy,void 0!==Lg.format&&(Ag.format=Lg.format),void 0!==Lg.type&&(Ag.type=Lg.type),void 0!==Lg.mipmaps&&(Ag.mipmaps=Lg.mipmaps),1===Lg.mipmapCount&&(Ag.minFilter=Hm),Ag.needsUpdate=!0,bg&&bg(Ag,Lg))},Tg,Sg),Ag}}),Object.assign(Hd.prototype,{crossOrigin:'Anonymous',load:function load(Eg,bg,Tg,Sg){void 0===Eg&&(Eg=''),void 0!==this.path&&(Eg=this.path+Eg);var Mg=this,Ag=eg.get(Eg);if(void 0!==Ag)return Mg.manager.itemStart(Eg),setTimeout(function(){bg&&bg(Ag),Mg.manager.itemEnd(Eg)},0),Ag;var wg=document.createElement('img');return wg.addEventListener('load',function(){eg.add(Eg,this),bg&&bg(this),Mg.manager.itemEnd(Eg)},!1),wg.addEventListener('error',function(Rg){Sg&&Sg(Rg),Mg.manager.itemEnd(Eg),Mg.manager.itemError(Eg)},!1),'data:'!==Eg.substr(0,5)&&void 0!==this.crossOrigin&&(wg.crossOrigin=this.crossOrigin),Mg.manager.itemStart(Eg),wg.src=Eg,wg},setCrossOrigin:function setCrossOrigin(Eg){return this.crossOrigin=Eg,this},setPath:function setPath(Eg){return this.path=Eg,this}}),Object.assign(Od.prototype,{crossOrigin:'Anonymous',load:function load(Eg,bg,Tg,Sg){function Mg(Pg){wg.load(Eg[Pg],function(Cg){Ag.images[Pg]=Cg,6==++Rg&&(Ag.needsUpdate=!0,bg&&bg(Ag))},void 0,Sg)}var Ag=new Qo,wg=new Hd(this.manager);wg.setCrossOrigin(this.crossOrigin),wg.setPath(this.path);for(var Rg=0,Lg=0;Lg<Eg.length;++Lg)Mg(Lg);return Ag},setCrossOrigin:function setCrossOrigin(Eg){return this.crossOrigin=Eg,this},setPath:function setPath(Eg){return this.path=Eg,this}}),Object.assign(Vd.prototype,{crossOrigin:'Anonymous',load:function load(Eg,bg,Tg,Sg){var Mg=new Hd(this.manager);Mg.setCrossOrigin(this.crossOrigin),Mg.setPath(this.path);var Ag=new jo;return Ag.image=Mg.load(Eg,function(){var wg=0<Eg.search(/\.(jpg|jpeg)$/)||0===Eg.search(/^data\:image\/jpeg/);Ag.format=wg?ru:au,Ag.needsUpdate=!0,void 0!==bg&&bg(Ag)},Tg,Sg),Ag},setCrossOrigin:function setCrossOrigin(Eg){return this.crossOrigin=Eg,this},setPath:function setPath(Eg){return this.path=Eg,this}}),Wd.prototype=Object.assign(Object.create(js.prototype),{constructor:Wd,isLight:!0,copy:function copy(Eg){return js.prototype.copy.call(this,Eg),this.color.copy(Eg.color),this.intensity=Eg.intensity,this},toJSON:function toJSON(Eg){var bg=js.prototype.toJSON.call(this,Eg);return bg.object.color=this.color.getHex(),bg.object.intensity=this.intensity,void 0!==this.groundColor&&(bg.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(bg.object.distance=this.distance),void 0!==this.angle&&(bg.object.angle=this.angle),void 0!==this.decay&&(bg.object.decay=this.decay),void 0!==this.penumbra&&(bg.object.penumbra=this.penumbra),void 0!==this.shadow&&(bg.object.shadow=this.shadow.toJSON()),bg}}),kd.prototype=Object.assign(Object.create(Wd.prototype),{constructor:kd,isHemisphereLight:!0,copy:function copy(Eg){return Wd.prototype.copy.call(this,Eg),this.groundColor.copy(Eg.groundColor),this}}),Object.assign(Xd.prototype,{copy:function copy(Eg){return this.camera=Eg.camera.clone(),this.bias=Eg.bias,this.radius=Eg.radius,this.mapSize.copy(Eg.mapSize),this},clone:function clone(){return new this.constructor().copy(this)},toJSON:function toJSON(){var Eg={};return 0!==this.bias&&(Eg.bias=this.bias),1!==this.radius&&(Eg.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(Eg.mapSize=this.mapSize.toArray()),Eg.camera=this.camera.toJSON(!1).object,delete Eg.camera.matrix,Eg}}),jd.prototype=Object.assign(Object.create(Xd.prototype),{constructor:jd,isSpotLightShadow:!0,update:function update(Eg){var bg=this.camera,Tg=2*Iu.RAD2DEG*Eg.angle,Sg=this.mapSize.width/this.mapSize.height,Mg=Eg.distance||bg.far;Tg===bg.fov&&Sg===bg.aspect&&Mg===bg.far||(bg.fov=Tg,bg.aspect=Sg,bg.far=Mg,bg.updateProjectionMatrix())}}),Yd.prototype=Object.assign(Object.create(Wd.prototype),{constructor:Yd,isSpotLight:!0,copy:function copy(Eg){return Wd.prototype.copy.call(this,Eg),this.distance=Eg.distance,this.angle=Eg.angle,this.penumbra=Eg.penumbra,this.decay=Eg.decay,this.target=Eg.target.clone(),this.shadow=Eg.shadow.clone(),this}}),qd.prototype=Object.assign(Object.create(Wd.prototype),{constructor:qd,isPointLight:!0,copy:function copy(Eg){return Wd.prototype.copy.call(this,Eg),this.distance=Eg.distance,this.decay=Eg.decay,this.shadow=Eg.shadow.clone(),this}}),Zd.prototype=Object.assign(Object.create(Xd.prototype),{constructor:Zd}),Jd.prototype=Object.assign(Object.create(Wd.prototype),{constructor:Jd,isDirectionalLight:!0,copy:function copy(Eg){return Wd.prototype.copy.call(this,Eg),this.target=Eg.target.clone(),this.shadow=Eg.shadow.clone(),this}}),Qd.prototype=Object.assign(Object.create(Wd.prototype),{constructor:Qd,isAmbientLight:!0}),Kd.prototype=Object.assign(Object.create(Wd.prototype),{constructor:Kd,isRectAreaLight:!0,copy:function copy(Eg){return Wd.prototype.copy.call(this,Eg),this.width=Eg.width,this.height=Eg.height,this},toJSON:function toJSON(Eg){var bg=Wd.prototype.toJSON.call(this,Eg);return bg.object.width=this.width,bg.object.height=this.height,bg}});var ag={arraySlice:function arraySlice(Eg,bg,Tg){return ag.isTypedArray(Eg)?new Eg.constructor(Eg.subarray(bg,void 0===Tg?Eg.length:Tg)):Eg.slice(bg,Tg)},convertArray:function convertArray(Eg,bg,Tg){return Eg&&(Tg||Eg.constructor!==bg)?'number'==typeof bg.BYTES_PER_ELEMENT?new bg(Eg):Array.prototype.slice.call(Eg):Eg},isTypedArray:function isTypedArray(Eg){return ArrayBuffer.isView(Eg)&&!(Eg instanceof DataView)},getKeyframeOrder:function getKeyframeOrder(Eg){for(var bg=Eg.length,Tg=Array(bg),Sg=0;Sg!==bg;++Sg)Tg[Sg]=Sg;return Tg.sort(function(Mg,Ag){return Eg[Mg]-Eg[Ag]}),Tg},sortedArray:function sortedArray(Eg,bg,Tg){for(var Sg=Eg.length,Mg=new Eg.constructor(Sg),Ag=0,wg=0;wg!==Sg;++Ag)for(var Rg=Tg[Ag]*bg,Lg=0;Lg!==bg;++Lg)Mg[wg++]=Eg[Rg+Lg];return Mg},flattenJSON:function flattenJSON(Eg,bg,Tg,Sg){for(var Mg=1,Ag=Eg[0];void 0!==Ag&&void 0===Ag[Sg];)Ag=Eg[Mg++];if(void 0!==Ag){var wg=Ag[Sg];if(void 0!==wg)if(Array.isArray(wg))do void 0!==(wg=Ag[Sg])&&(bg.push(Ag.time),Tg.push.apply(Tg,wg)),Ag=Eg[Mg++];while(void 0!==Ag);else if(void 0!==wg.toArray)do void 0!==(wg=Ag[Sg])&&(bg.push(Ag.time),wg.toArray(Tg,Tg.length)),Ag=Eg[Mg++];while(void 0!==Ag);else do void 0!==(wg=Ag[Sg])&&(bg.push(Ag.time),Tg.push(wg)),Ag=Eg[Mg++];while(void 0!==Ag)}}};Object.assign($d.prototype,{evaluate:function evaluate(Eg){var bg=this.parameterPositions,Tg=this._cachedIndex,Sg=bg[Tg],Mg=bg[Tg-1];t:{e:{var Ag;i:{n:if(!(Eg<Sg)){for(Rg=Tg+2;;){if(void 0===Sg){if(Eg<Mg)break n;return Tg=bg.length,this._cachedIndex=Tg,this.afterEnd_(Tg-1,Eg,Mg)}if(Tg===Rg)break;if(Mg=Sg,Sg=bg[++Tg],Eg<Sg)break e}Ag=bg.length;break i}if(Eg>=Mg)break t;var wg=bg[1];Eg<wg&&(Tg=2,Mg=wg);for(var Rg=Tg-2;;){if(void 0===Mg)return this._cachedIndex=0,this.beforeStart_(0,Eg,Sg);if(Tg===Rg)break;if(Sg=Mg,Mg=bg[--Tg-1],Eg>=Mg)break e}Ag=Tg,Tg=0}for(;Tg<Ag;){var Lg=Tg+Ag>>>1;Eg<bg[Lg]?Ag=Lg:Tg=Lg+1}if(Sg=bg[Tg],void 0===(Mg=bg[Tg-1]))return this._cachedIndex=0,this.beforeStart_(0,Eg,Sg);if(void 0===Sg)return Tg=bg.length,this._cachedIndex=Tg,this.afterEnd_(Tg-1,Mg,Eg)}this._cachedIndex=Tg,this.intervalChanged_(Tg,Mg,Sg)}return this.interpolate_(Tg,Mg,Eg,Sg)},settings:null,DefaultSettings_:{},getSettings_:function getSettings_(){return this.settings||this.DefaultSettings_},copySampleValue_:function copySampleValue_(Eg){for(var bg=this.resultBuffer,Tg=this.sampleValues,Sg=this.valueSize,Ag=0;Ag!==Sg;++Ag)bg[Ag]=Tg[Eg*Sg+Ag];return bg},interpolate_:function interpolate_(){throw new Error('call to abstract method')},intervalChanged_:function intervalChanged_(){}}),Object.assign($d.prototype,{beforeStart_:$d.prototype.copySampleValue_,afterEnd_:$d.prototype.copySampleValue_}),ep.prototype=Object.assign(Object.create($d.prototype),{constructor:ep,DefaultSettings_:{endingStart:vu,endingEnd:vu},intervalChanged_:function intervalChanged_(Eg,bg,Tg){var Sg=this.parameterPositions,Mg=Eg-2,Ag=Eg+1,wg=Sg[Mg],Rg=Sg[Ag];if(void 0===wg)switch(this.getSettings_().endingStart){case 2401:Mg=Eg,wg=2*bg-Tg;break;case 2402:wg=bg+Sg[Mg=Sg.length-2]-Sg[Mg+1];break;default:Mg=Eg,wg=Tg;}if(void 0===Rg)switch(this.getSettings_().endingEnd){case 2401:Ag=Eg,Rg=2*Tg-bg;break;case 2402:Ag=1,Rg=Tg+Sg[1]-Sg[0];break;default:Ag=Eg-1,Rg=bg;}var Lg=.5*(Tg-bg),Pg=this.valueSize;this._weightPrev=Lg/(bg-wg),this._weightNext=Lg/(Rg-Tg),this._offsetPrev=Mg*Pg,this._offsetNext=Ag*Pg},interpolate_:function interpolate_(Eg,bg,Tg,Sg){for(var Mg=this.resultBuffer,Ag=this.sampleValues,wg=this.valueSize,Rg=Eg*wg,Pg=this._offsetPrev,Cg=this._offsetNext,Ig=this._weightPrev,Ug=this._weightNext,Dg=(Tg-bg)/(Sg-bg),Ng=Dg*Dg,Bg=Ng*Dg,Og=0;Og!==wg;++Og)Mg[Og]=(-Ig*Bg+2*Ig*Ng-Ig*Dg)*Ag[Pg+Og]+((1+Ig)*Bg+(-1.5-2*Ig)*Ng+(-.5+Ig)*Dg+1)*Ag[Rg-wg+Og]+((-1-Ug)*Bg+(1.5+Ug)*Ng+.5*Dg)*Ag[Rg+Og]+(Ug*Bg-Ug*Ng)*Ag[Cg+Og];return Mg}}),tp.prototype=Object.assign(Object.create($d.prototype),{constructor:tp,interpolate_:function interpolate_(Eg,bg,Tg,Sg){for(var Mg=this.resultBuffer,Ag=this.sampleValues,wg=this.valueSize,Rg=Eg*wg,Pg=(Tg-bg)/(Sg-bg),Ig=0;Ig!==wg;++Ig)Mg[Ig]=Ag[Rg-wg+Ig]*(1-Pg)+Ag[Rg+Ig]*Pg;return Mg}}),rp.prototype=Object.assign(Object.create($d.prototype),{constructor:rp,interpolate_:function interpolate_(Eg){return this.copySampleValue_(Eg-1)}});var ig;ig={TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:2301,InterpolantFactoryMethodDiscrete:function InterpolantFactoryMethodDiscrete(Eg){return new rp(this.times,this.values,this.getValueSize(),Eg)},InterpolantFactoryMethodLinear:function InterpolantFactoryMethodLinear(Eg){return new tp(this.times,this.values,this.getValueSize(),Eg)},InterpolantFactoryMethodSmooth:function InterpolantFactoryMethodSmooth(Eg){return new ep(this.times,this.values,this.getValueSize(),Eg)},setInterpolation:function setInterpolation(Eg){var bg;if(2300===Eg?bg=this.InterpolantFactoryMethodDiscrete:2301===Eg?bg=this.InterpolantFactoryMethodLinear:2302===Eg?bg=this.InterpolantFactoryMethodSmooth:void 0,void 0!==bg)this.createInterpolant=bg;else{var Tg='unsupported interpolation for '+this.ValueTypeName+' keyframe track named '+this.name;if(void 0===this.createInterpolant){if(Eg===this.DefaultInterpolation)throw new Error(Tg);this.setInterpolation(this.DefaultInterpolation)}console.warn('THREE.KeyframeTrackPrototype:',Tg)}},getInterpolation:function getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302;}},getValueSize:function getValueSize(){return this.values.length/this.times.length},shift:function shift(Eg){if(0!==Eg)for(var bg=this.times,Tg=0,Sg=bg.length;Tg!==Sg;++Tg)bg[Tg]+=Eg;return this},scale:function scale(Eg){if(1!==Eg)for(var bg=this.times,Tg=0,Sg=bg.length;Tg!==Sg;++Tg)bg[Tg]*=Eg;return this},trim:function trim(Eg,bg){for(var Tg=this.times,Sg=Tg.length,Mg=0,Ag=Sg-1;Mg!==Sg&&Tg[Mg]<Eg;)++Mg;for(;-1!=Ag&&Tg[Ag]>bg;)--Ag;if(++Ag,0!==Mg||Ag!==Sg){Mg>=Ag&&(Ag=Math.max(Ag,1),Mg=Ag-1);var wg=this.getValueSize();this.times=ag.arraySlice(Tg,Mg,Ag),this.values=ag.arraySlice(this.values,Mg*wg,Ag*wg)}return this},validate:function validate(){var Eg=!0,bg=this.getValueSize();0!=bg-Math.floor(bg)&&(console.error('THREE.KeyframeTrackPrototype: Invalid value size in track.',this),Eg=!1);var Tg=this.times,Sg=this.values,Mg=Tg.length;0===Mg&&(console.error('THREE.KeyframeTrackPrototype: Track is empty.',this),Eg=!1);for(var Ag=null,wg=0,Rg;wg!==Mg;wg++){if(Rg=Tg[wg],'number'==typeof Rg&&isNaN(Rg)){console.error('THREE.KeyframeTrackPrototype: Time is not a valid number.',this,wg,Rg),Eg=!1;break}if(null!=Ag&&Ag>Rg){console.error('THREE.KeyframeTrackPrototype: Out of order keys.',this,wg,Rg,Ag),Eg=!1;break}Ag=Rg}if(void 0!==Sg&&ag.isTypedArray(Sg))for(var wg=0,Lg=Sg.length,Pg;wg!==Lg;++wg)if(Pg=Sg[wg],isNaN(Pg)){console.error('THREE.KeyframeTrackPrototype: Value is not a valid number.',this,wg,Pg),Eg=!1;break}return Eg},optimize:function optimize(){for(var Eg=this.times,bg=this.values,Tg=this.getValueSize(),Sg=2302===this.getInterpolation(),Mg=1,Ag=Eg.length-1,wg=1;wg<Ag;++wg){var Rg=!1,Lg=Eg[wg];if(Lg!==Eg[wg+1]&&(1!==wg||Lg!==Lg[0]))if(Sg)Rg=!0;else for(var Pg=wg*Tg,Ug=0,Dg;Ug!==Tg;++Ug)if(Dg=bg[Pg+Ug],Dg!==bg[Pg-Tg+Ug]||Dg!==bg[Pg+Tg+Ug]){Rg=!0;break}if(Rg){if(wg!==Mg){Eg[Mg]=Eg[wg];for(var Ng=wg*Tg,Bg=Mg*Tg,Ug=0;Ug!==Tg;++Ug)bg[Bg+Ug]=bg[Ng+Ug]}++Mg}}if(0<Ag){Eg[Mg]=Eg[Ag];for(var Ng=Ag*Tg,Bg=Mg*Tg,Ug=0;Ug!==Tg;++Ug)bg[Bg+Ug]=bg[Ng+Ug];++Mg}return Mg!==Eg.length&&(this.times=ag.arraySlice(Eg,0,Mg),this.values=ag.arraySlice(bg,0,Mg*Tg)),this}},ip.prototype=Object.assign(Object.create(ig),{constructor:ip,ValueTypeName:'vector'}),op.prototype=Object.assign(Object.create($d.prototype),{constructor:op,interpolate_:function interpolate_(Eg,bg,Tg,Sg){for(var Mg=this.resultBuffer,Ag=this.sampleValues,wg=this.valueSize,Rg=Eg*wg,Pg=Rg+wg;Rg!==Pg;Rg+=4)Vo.slerpFlat(Mg,0,Ag,Rg-wg,Ag,Rg,(Tg-bg)/(Sg-bg));return Mg}}),np.prototype=Object.assign(Object.create(ig),{constructor:np,ValueTypeName:'quaternion',DefaultInterpolation:2301,InterpolantFactoryMethodLinear:function InterpolantFactoryMethodLinear(Eg){return new op(this.times,this.values,this.getValueSize(),Eg)},InterpolantFactoryMethodSmooth:void 0}),sp.prototype=Object.assign(Object.create(ig),{constructor:sp,ValueTypeName:'number'}),lp.prototype=Object.assign(Object.create(ig),{constructor:lp,ValueTypeName:'string',ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),dp.prototype=Object.assign(Object.create(ig),{constructor:dp,ValueTypeName:'bool',ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),pp.prototype=Object.assign(Object.create(ig),{constructor:pp,ValueTypeName:'color'}),cp.prototype=ig,ig.constructor=cp,Object.assign(cp,{parse:function parse(Eg){if(void 0===Eg.type)throw new Error('track type undefined, can not parse');var bg=cp._getTrackTypeForValueTypeName(Eg.type);if(void 0===Eg.times){var Tg=[],Sg=[];ag.flattenJSON(Eg.keys,Tg,Sg,'value'),Eg.times=Tg,Eg.values=Sg}return void 0===bg.parse?new bg(Eg.name,Eg.times,Eg.values,Eg.interpolation):bg.parse(Eg)},toJSON:function toJSON(Eg){var Tg=Eg.constructor,bg;if(void 0!==Tg.toJSON)bg=Tg.toJSON(Eg);else{bg={name:Eg.name,times:ag.convertArray(Eg.times,Array),values:ag.convertArray(Eg.values,Array)};var Sg=Eg.getInterpolation();Sg!==Eg.DefaultInterpolation&&(bg.interpolation=Sg)}return bg.type=Eg.ValueTypeName,bg},_getTrackTypeForValueTypeName:function _getTrackTypeForValueTypeName(Eg){switch(Eg.toLowerCase()){case'scalar':case'double':case'float':case'number':case'integer':return sp;case'vector':case'vector2':case'vector3':case'vector4':return ip;case'color':return pp;case'quaternion':return np;case'bool':case'boolean':return dp;case'string':return lp;}throw new Error('Unsupported typeName: '+Eg)}}),Object.assign(mp,{parse:function parse(Eg){for(var bg=[],Tg=Eg.tracks,Sg=1/(Eg.fps||1),Mg=0,Ag=Tg.length;Mg!==Ag;++Mg)bg.push(cp.parse(Tg[Mg]).scale(Sg));return new mp(Eg.name,Eg.duration,bg)},toJSON:function toJSON(Eg){for(var bg=[],Tg=Eg.tracks,Sg={name:Eg.name,duration:Eg.duration,tracks:bg},Mg=0,Ag=Tg.length;Mg!==Ag;++Mg)bg.push(cp.toJSON(Tg[Mg]));return Sg},CreateFromMorphTargetSequence:function CreateFromMorphTargetSequence(Eg,bg,Tg,Sg){for(var Mg=bg.length,Ag=[],wg=0;wg<Mg;wg++){var Rg=[],Lg=[];Rg.push((wg+Mg-1)%Mg,wg,(wg+1)%Mg),Lg.push(0,1,0);var Pg=ag.getKeyframeOrder(Rg);Rg=ag.sortedArray(Rg,1,Pg),Lg=ag.sortedArray(Lg,1,Pg),Sg||0!==Rg[0]||(Rg.push(Mg),Lg.push(Lg[0])),Ag.push(new sp('.morphTargetInfluences['+bg[wg].name+']',Rg,Lg).scale(1/Tg))}return new mp(Eg,-1,Ag)},findByName:function findByName(Eg,bg){var Tg=Eg;if(!Array.isArray(Eg)){var Sg=Eg;Tg=Sg.geometry&&Sg.geometry.animations||Sg.animations}for(var Mg=0;Mg<Tg.length;Mg++)if(Tg[Mg].name===bg)return Tg[Mg];return null},CreateClipsFromMorphTargetSequences:function CreateClipsFromMorphTargetSequences(Eg,bg,Tg){for(var Sg={},Mg=/^([\w-]*?)([\d]+)$/,Ag=0,wg=Eg.length;Ag<wg;Ag++){var Rg=Eg[Ag],Lg=Rg.name.match(Mg);if(Lg&&1<Lg.length){var Pg=Sg[Ig=Lg[1]];Pg||(Sg[Ig]=Pg=[]),Pg.push(Rg)}}var Cg=[];for(var Ig in Sg)Cg.push(mp.CreateFromMorphTargetSequence(Ig,Sg[Ig],bg,Tg));return Cg},parseAnimation:function parseAnimation(Eg,bg){if(!Eg)return console.error('THREE.AnimationClip: No animation in JSONLoader data.'),null;for(var Tg=function i(Gg,Hg,Xg,Og,Vg){if(0!==Xg.length){var Wg=[],kg=[];ag.flattenJSON(Xg,Wg,kg,Og),0!==Wg.length&&Vg.push(new Gg(Hg,Wg,kg))}},Sg=[],Mg=Eg.name||'default',Ag=Eg.length||-1,wg=Eg.fps||30,Rg=Eg.hierarchy||[],Lg=0,Pg;Lg<Rg.length;Lg++)if(Pg=Rg[Lg].keys,Pg&&0!==Pg.length)if(Pg[0].morphTargets){for(var Cg={},Ig=0;Ig<Pg.length;Ig++)if(Pg[Ig].morphTargets)for(Bg=0;Bg<Pg[Ig].morphTargets.length;Bg++)Cg[Pg[Ig].morphTargets[Bg]]=-1;for(var Ug in Cg){for(var Dg=[],Ng=[],Bg=0,Fg;Bg!==Pg[Ig].morphTargets.length;++Bg)Fg=Pg[Ig],Dg.push(Fg.time),Ng.push(Fg.morphTarget===Ug?1:0);Sg.push(new sp('.morphTargetInfluence['+Ug+']',Dg,Ng))}Ag=Cg.length*(wg||1)}else{var zg='.bones['+bg[Lg].name+']';Tg(ip,zg+'.position',Pg,'pos',Sg),Tg(np,zg+'.quaternion',Pg,'rot',Sg),Tg(ip,zg+'.scale',Pg,'scl',Sg)}return 0===Sg.length?null:new mp(Mg,Ag,Sg)}}),Object.assign(mp.prototype,{resetDuration:function resetDuration(){for(var Eg=0,bg=0,Tg=this.tracks.length,Sg;bg!==Tg;++bg)Sg=this.tracks[bg],Eg=Math.max(Eg,Sg.times[Sg.times.length-1]);this.duration=Eg},trim:function trim(){for(var Eg=0;Eg<this.tracks.length;Eg++)this.tracks[Eg].trim(0,this.duration);return this},optimize:function optimize(){for(var Eg=0;Eg<this.tracks.length;Eg++)this.tracks[Eg].optimize();return this}}),Object.assign(up.prototype,{load:function load(Eg,bg,Tg,Sg){var Mg=this;new Fd(Mg.manager).load(Eg,function(Ag){bg(Mg.parse(JSON.parse(Ag)))},Tg,Sg)},setTextures:function setTextures(Eg){this.textures=Eg},parse:function parse(Eg){function bg(Ag){return void 0===Tg[Ag]&&console.warn('THREE.MaterialLoader: Undefined texture',Ag),Tg[Ag]}var Tg=this.textures,Sg=new $u[Eg.type];if(void 0!==Eg.uuid&&(Sg.uuid=Eg.uuid),void 0!==Eg.name&&(Sg.name=Eg.name),void 0!==Eg.color&&Sg.color.setHex(Eg.color),void 0!==Eg.roughness&&(Sg.roughness=Eg.roughness),void 0!==Eg.metalness&&(Sg.metalness=Eg.metalness),void 0!==Eg.emissive&&Sg.emissive.setHex(Eg.emissive),void 0!==Eg.specular&&Sg.specular.setHex(Eg.specular),void 0!==Eg.shininess&&(Sg.shininess=Eg.shininess),void 0!==Eg.clearCoat&&(Sg.clearCoat=Eg.clearCoat),void 0!==Eg.clearCoatRoughness&&(Sg.clearCoatRoughness=Eg.clearCoatRoughness),void 0!==Eg.uniforms&&(Sg.uniforms=Eg.uniforms),void 0!==Eg.vertexShader&&(Sg.vertexShader=Eg.vertexShader),void 0!==Eg.fragmentShader&&(Sg.fragmentShader=Eg.fragmentShader),void 0!==Eg.vertexColors&&(Sg.vertexColors=Eg.vertexColors),void 0!==Eg.fog&&(Sg.fog=Eg.fog),void 0!==Eg.flatShading&&(Sg.flatShading=Eg.flatShading),void 0!==Eg.blending&&(Sg.blending=Eg.blending),void 0!==Eg.side&&(Sg.side=Eg.side),void 0!==Eg.opacity&&(Sg.opacity=Eg.opacity),void 0!==Eg.transparent&&(Sg.transparent=Eg.transparent),void 0!==Eg.alphaTest&&(Sg.alphaTest=Eg.alphaTest),void 0!==Eg.depthTest&&(Sg.depthTest=Eg.depthTest),void 0!==Eg.depthWrite&&(Sg.depthWrite=Eg.depthWrite),void 0!==Eg.colorWrite&&(Sg.colorWrite=Eg.colorWrite),void 0!==Eg.wireframe&&(Sg.wireframe=Eg.wireframe),void 0!==Eg.wireframeLinewidth&&(Sg.wireframeLinewidth=Eg.wireframeLinewidth),void 0!==Eg.wireframeLinecap&&(Sg.wireframeLinecap=Eg.wireframeLinecap),void 0!==Eg.wireframeLinejoin&&(Sg.wireframeLinejoin=Eg.wireframeLinejoin),void 0!==Eg.rotation&&(Sg.rotation=Eg.rotation),1!==Eg.linewidth&&(Sg.linewidth=Eg.linewidth),void 0!==Eg.dashSize&&(Sg.dashSize=Eg.dashSize),void 0!==Eg.gapSize&&(Sg.gapSize=Eg.gapSize),void 0!==Eg.scale&&(Sg.scale=Eg.scale),void 0!==Eg.skinning&&(Sg.skinning=Eg.skinning),void 0!==Eg.morphTargets&&(Sg.morphTargets=Eg.morphTargets),void 0!==Eg.dithering&&(Sg.dithering=Eg.dithering),void 0!==Eg.visible&&(Sg.visible=Eg.visible),void 0!==Eg.userData&&(Sg.userData=Eg.userData),void 0!==Eg.shading&&(Sg.flatShading=1===Eg.shading),void 0!==Eg.size&&(Sg.size=Eg.size),void 0!==Eg.sizeAttenuation&&(Sg.sizeAttenuation=Eg.sizeAttenuation),void 0!==Eg.map&&(Sg.map=bg(Eg.map)),void 0!==Eg.alphaMap&&(Sg.alphaMap=bg(Eg.alphaMap),Sg.transparent=!0),void 0!==Eg.bumpMap&&(Sg.bumpMap=bg(Eg.bumpMap)),void 0!==Eg.bumpScale&&(Sg.bumpScale=Eg.bumpScale),void 0!==Eg.normalMap&&(Sg.normalMap=bg(Eg.normalMap)),void 0!==Eg.normalScale){var Mg=Eg.normalScale;!1===Array.isArray(Mg)&&(Mg=[Mg,Mg]),Sg.normalScale=new Go().fromArray(Mg)}return void 0!==Eg.displacementMap&&(Sg.displacementMap=bg(Eg.displacementMap)),void 0!==Eg.displacementScale&&(Sg.displacementScale=Eg.displacementScale),void 0!==Eg.displacementBias&&(Sg.displacementBias=Eg.displacementBias),void 0!==Eg.roughnessMap&&(Sg.roughnessMap=bg(Eg.roughnessMap)),void 0!==Eg.metalnessMap&&(Sg.metalnessMap=bg(Eg.metalnessMap)),void 0!==Eg.emissiveMap&&(Sg.emissiveMap=bg(Eg.emissiveMap)),void 0!==Eg.emissiveIntensity&&(Sg.emissiveIntensity=Eg.emissiveIntensity),void 0!==Eg.specularMap&&(Sg.specularMap=bg(Eg.specularMap)),void 0!==Eg.envMap&&(Sg.envMap=bg(Eg.envMap)),void 0!==Eg.reflectivity&&(Sg.reflectivity=Eg.reflectivity),void 0!==Eg.lightMap&&(Sg.lightMap=bg(Eg.lightMap)),void 0!==Eg.lightMapIntensity&&(Sg.lightMapIntensity=Eg.lightMapIntensity),void 0!==Eg.aoMap&&(Sg.aoMap=bg(Eg.aoMap)),void 0!==Eg.aoMapIntensity&&(Sg.aoMapIntensity=Eg.aoMapIntensity),void 0!==Eg.gradientMap&&(Sg.gradientMap=bg(Eg.gradientMap)),Sg}}),Object.assign(gp.prototype,{load:function load(Eg,bg,Tg,Sg){var Mg=this;new Fd(Mg.manager).load(Eg,function(Ag){bg(Mg.parse(JSON.parse(Ag)))},Tg,Sg)},parse:function parse(Eg){var bg=new dl,Tg=Eg.data.index;void 0!==Tg&&(wg=new og[Tg.type](Tg.array),bg.setIndex(new Qs(wg,1)));var Sg=Eg.data.attributes;for(var Mg in Sg){var Ag=Sg[Mg],wg=new og[Ag.type](Ag.array);bg.addAttribute(Mg,new Qs(wg,Ag.itemSize,Ag.normalized))}var Rg=Eg.data.groups||Eg.data.drawcalls||Eg.data.offsets;if(void 0!==Rg)for(var Lg=0,Pg=Rg.length,Cg;Lg!==Pg;++Lg)Cg=Rg[Lg],bg.addGroup(Cg.start,Cg.count,Cg.materialIndex);var Ig=Eg.data.boundingSphere;if(void 0!==Ig){var Ug=new Wo;void 0!==Ig.center&&Ug.fromArray(Ig.center),bg.boundingSphere=new Gs(Ug,Ig.radius)}return bg}});var og={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:'undefined'==typeof Uint8ClampedArray?Uint8Array:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};fp.Handlers={handlers:[],add:function add(Eg,bg){this.handlers.push(Eg,bg)},get:function get(Eg){for(var bg=this.handlers,Tg=0,Sg=bg.length;Tg<Sg;Tg+=2){var Mg=bg[Tg],Ag=bg[Tg+1];if(Mg.test(Eg))return Ag}return null}},Object.assign(fp.prototype,{crossOrigin:void 0,extractUrlBase:function extractUrlBase(Eg){var bg=Eg.split('/');return 1===bg.length?'./':(bg.pop(),bg.join('/')+'/')},initMaterials:function initMaterials(Eg,bg,Tg){for(var Sg=[],Mg=0;Mg<Eg.length;++Mg)Sg[Mg]=this.createMaterial(Eg[Mg],bg,Tg);return Sg},createMaterial:function(){var Eg={NoBlending:Wc,NormalBlending:kc,AdditiveBlending:Xc,SubtractiveBlending:jc,MultiplyBlending:Yc,CustomBlending:qc},bg=new Ps,Tg=new Vd,Sg=new up;return function(Mg,Ag,wg){function Rg(Ug,Dg,Ng,Bg,Fg){var Gg=Ag+Ug,Hg=fp.Handlers.get(Gg),zg;null===Hg?(Tg.setCrossOrigin(wg),zg=Tg.load(Gg)):zg=Hg.load(Gg),void 0!==Dg&&(zg.repeat.fromArray(Dg),1!==Dg[0]&&(zg.wrapS=Dm),1!==Dg[1]&&(zg.wrapT=Dm)),void 0!==Ng&&zg.offset.fromArray(Ng),void 0!==Bg&&('repeat'===Bg[0]&&(zg.wrapS=Dm),'mirror'===Bg[0]&&(zg.wrapS=Bm),'repeat'===Bg[1]&&(zg.wrapT=Dm),'mirror'===Bg[1]&&(zg.wrapT=Bm)),void 0!==Fg&&(zg.anisotropy=Fg);var Og=Iu.generateUUID();return Lg[Og]=zg,Og}var Lg={},Pg={uuid:Iu.generateUUID(),type:'MeshLambertMaterial'};for(var Cg in Mg){var Ig=Mg[Cg];switch(Cg){case'DbgColor':case'DbgIndex':case'opticalDensity':case'illumination':break;case'DbgName':Pg.name=Ig;break;case'blending':Pg.blending=Eg[Ig];break;case'colorAmbient':case'mapAmbient':console.warn('THREE.Loader.createMaterial:',Cg,'is no longer supported.');break;case'colorDiffuse':Pg.color=bg.fromArray(Ig).getHex();break;case'colorSpecular':Pg.specular=bg.fromArray(Ig).getHex();break;case'colorEmissive':Pg.emissive=bg.fromArray(Ig).getHex();break;case'specularCoef':Pg.shininess=Ig;break;case'shading':'basic'===Ig.toLowerCase()&&(Pg.type='MeshBasicMaterial'),'phong'===Ig.toLowerCase()&&(Pg.type='MeshPhongMaterial'),'standard'===Ig.toLowerCase()&&(Pg.type='MeshStandardMaterial');break;case'mapDiffuse':Pg.map=Rg(Ig,Mg.mapDiffuseRepeat,Mg.mapDiffuseOffset,Mg.mapDiffuseWrap,Mg.mapDiffuseAnisotropy);break;case'mapDiffuseRepeat':case'mapDiffuseOffset':case'mapDiffuseWrap':case'mapDiffuseAnisotropy':break;case'mapEmissive':Pg.emissiveMap=Rg(Ig,Mg.mapEmissiveRepeat,Mg.mapEmissiveOffset,Mg.mapEmissiveWrap,Mg.mapEmissiveAnisotropy);break;case'mapEmissiveRepeat':case'mapEmissiveOffset':case'mapEmissiveWrap':case'mapEmissiveAnisotropy':break;case'mapLight':Pg.lightMap=Rg(Ig,Mg.mapLightRepeat,Mg.mapLightOffset,Mg.mapLightWrap,Mg.mapLightAnisotropy);break;case'mapLightRepeat':case'mapLightOffset':case'mapLightWrap':case'mapLightAnisotropy':break;case'mapAO':Pg.aoMap=Rg(Ig,Mg.mapAORepeat,Mg.mapAOOffset,Mg.mapAOWrap,Mg.mapAOAnisotropy);break;case'mapAORepeat':case'mapAOOffset':case'mapAOWrap':case'mapAOAnisotropy':break;case'mapBump':Pg.bumpMap=Rg(Ig,Mg.mapBumpRepeat,Mg.mapBumpOffset,Mg.mapBumpWrap,Mg.mapBumpAnisotropy);break;case'mapBumpScale':Pg.bumpScale=Ig;break;case'mapBumpRepeat':case'mapBumpOffset':case'mapBumpWrap':case'mapBumpAnisotropy':break;case'mapNormal':Pg.normalMap=Rg(Ig,Mg.mapNormalRepeat,Mg.mapNormalOffset,Mg.mapNormalWrap,Mg.mapNormalAnisotropy);break;case'mapNormalFactor':Pg.normalScale=[Ig,Ig];break;case'mapNormalRepeat':case'mapNormalOffset':case'mapNormalWrap':case'mapNormalAnisotropy':break;case'mapSpecular':Pg.specularMap=Rg(Ig,Mg.mapSpecularRepeat,Mg.mapSpecularOffset,Mg.mapSpecularWrap,Mg.mapSpecularAnisotropy);break;case'mapSpecularRepeat':case'mapSpecularOffset':case'mapSpecularWrap':case'mapSpecularAnisotropy':break;case'mapMetalness':Pg.metalnessMap=Rg(Ig,Mg.mapMetalnessRepeat,Mg.mapMetalnessOffset,Mg.mapMetalnessWrap,Mg.mapMetalnessAnisotropy);break;case'mapMetalnessRepeat':case'mapMetalnessOffset':case'mapMetalnessWrap':case'mapMetalnessAnisotropy':break;case'mapRoughness':Pg.roughnessMap=Rg(Ig,Mg.mapRoughnessRepeat,Mg.mapRoughnessOffset,Mg.mapRoughnessWrap,Mg.mapRoughnessAnisotropy);break;case'mapRoughnessRepeat':case'mapRoughnessOffset':case'mapRoughnessWrap':case'mapRoughnessAnisotropy':break;case'mapAlpha':Pg.alphaMap=Rg(Ig,Mg.mapAlphaRepeat,Mg.mapAlphaOffset,Mg.mapAlphaWrap,Mg.mapAlphaAnisotropy);break;case'mapAlphaRepeat':case'mapAlphaOffset':case'mapAlphaWrap':case'mapAlphaAnisotropy':break;case'flipSided':Pg.side=zc;break;case'doubleSided':Pg.side=Gc;break;case'transparency':console.warn('THREE.Loader.createMaterial: transparency has been renamed to opacity'),Pg.opacity=Ig;break;case'depthTest':case'depthWrite':case'colorWrite':case'opacity':case'reflectivity':case'transparent':case'visible':case'wireframe':Pg[Cg]=Ig;break;case'vertexColors':!0===Ig&&(Pg.vertexColors=Vc),'face'===Ig&&(Pg.vertexColors=Oc);break;default:console.error('THREE.Loader.createMaterial: Unsupported',Cg,Ig);}}return'MeshBasicMaterial'===Pg.type&&delete Pg.emissive,'MeshPhongMaterial'!==Pg.type&&delete Pg.specular,1>Pg.opacity&&(Pg.transparent=!0),Sg.setTextures(Lg),Sg.parse(Pg)}}()}),Object.assign(hp.prototype,{load:function load(Eg,bg,Tg,Sg){var Mg=this,Ag=this.texturePath&&'string'==typeof this.texturePath?this.texturePath:fp.prototype.extractUrlBase(Eg),wg=new Fd(this.manager);wg.setWithCredentials(this.withCredentials),wg.load(Eg,function(Rg){var Lg=JSON.parse(Rg),Pg=Lg.metadata;if(void 0!==Pg){var Cg=Pg.type;if(void 0!==Cg){if('object'===Cg.toLowerCase())return void console.error('THREE.JSONLoader: '+Eg+' should be loaded with THREE.ObjectLoader instead.');if('scene'===Cg.toLowerCase())return void console.error('THREE.JSONLoader: '+Eg+' should be loaded with THREE.SceneLoader instead.')}}var Ig=Mg.parse(Lg,Ag);bg(Ig.geometry,Ig.materials)},Tg,Sg)},setTexturePath:function setTexturePath(Eg){this.texturePath=Eg},parse:function(){return function(Eg,bg){void 0!==Eg.data&&(Eg=Eg.data),Eg.scale=void 0===Eg.scale?1:1/Eg.scale;var Tg=new Js;return(function(Sg,Mg){function Ag(of,nf){return of&1<<nf}var Kg=Sg.faces,$g=Sg.vertices,ef=Sg.normals,tf=Sg.colors,rf=Sg.scale,af=0,wg,Rg,Lg,Pg,Cg,Ig,Ug,Dg,Ng,Bg,Fg,zg,Gg,Hg,Og,Vg,Wg,kg,Xg,jg,Yg,qg,Zg,Jg,Qg;if(void 0!==Sg.uvs){for(wg=0;wg<Sg.uvs.length;wg++)Sg.uvs[wg].length&&af++;for(wg=0;wg<af;wg++)Mg.faceVertexUvs[wg]=[]}for(Pg=0,Cg=$g.length;Pg<Cg;)(kg=new Wo).x=$g[Pg++]*rf,kg.y=$g[Pg++]*rf,kg.z=$g[Pg++]*rf,Mg.vertices.push(kg);for(Pg=0,Cg=Kg.length;Pg<Cg;)if(Bg=Kg[Pg++],Fg=Ag(Bg,0),zg=Ag(Bg,1),Gg=Ag(Bg,3),Hg=Ag(Bg,4),Og=Ag(Bg,5),Vg=Ag(Bg,6),Wg=Ag(Bg,7),Fg){if(jg=new Zs,jg.a=Kg[Pg],jg.b=Kg[Pg+1],jg.c=Kg[Pg+3],Yg=new Zs,Yg.a=Kg[Pg+1],Yg.b=Kg[Pg+2],Yg.c=Kg[Pg+3],Pg+=4,zg&&(Ng=Kg[Pg++],jg.materialIndex=Ng,Yg.materialIndex=Ng),Lg=Mg.faces.length,Gg)for(wg=0;wg<af;wg++)for(Jg=Sg.uvs[wg],Mg.faceVertexUvs[wg][Lg]=[],Mg.faceVertexUvs[wg][Lg+1]=[],Rg=0;4>Rg;Rg++)Qg=new Go(Jg[2*(Dg=Kg[Pg++])],Jg[2*Dg+1]),2!==Rg&&Mg.faceVertexUvs[wg][Lg].push(Qg),0!==Rg&&Mg.faceVertexUvs[wg][Lg+1].push(Qg);if(Hg&&(Ug=3*Kg[Pg++],jg.normal.set(ef[Ug++],ef[Ug++],ef[Ug]),Yg.normal.copy(jg.normal)),Og)for(wg=0;4>wg;wg++)Ug=3*Kg[Pg++],Zg=new Wo(ef[Ug++],ef[Ug++],ef[Ug]),2!==wg&&jg.vertexNormals.push(Zg),0!==wg&&Yg.vertexNormals.push(Zg);if(Vg&&(qg=tf[Ig=Kg[Pg++]],jg.color.setHex(qg),Yg.color.setHex(qg)),Wg)for(wg=0;4>wg;wg++)qg=tf[Ig=Kg[Pg++]],2!==wg&&jg.vertexColors.push(new Ps(qg)),0!==wg&&Yg.vertexColors.push(new Ps(qg));Mg.faces.push(jg),Mg.faces.push(Yg)}else{if(Xg=new Zs,Xg.a=Kg[Pg++],Xg.b=Kg[Pg++],Xg.c=Kg[Pg++],zg&&(Ng=Kg[Pg++],Xg.materialIndex=Ng),Lg=Mg.faces.length,Gg)for(wg=0;wg<af;wg++)for(Jg=Sg.uvs[wg],Mg.faceVertexUvs[wg][Lg]=[],Rg=0;3>Rg;Rg++)Qg=new Go(Jg[2*(Dg=Kg[Pg++])],Jg[2*Dg+1]),Mg.faceVertexUvs[wg][Lg].push(Qg);if(Hg&&(Ug=3*Kg[Pg++],Xg.normal.set(ef[Ug++],ef[Ug++],ef[Ug])),Og)for(wg=0;3>wg;wg++)Ug=3*Kg[Pg++],Zg=new Wo(ef[Ug++],ef[Ug++],ef[Ug]),Xg.vertexNormals.push(Zg);if(Vg&&(Ig=Kg[Pg++],Xg.color.setHex(tf[Ig])),Wg)for(wg=0;3>wg;wg++)Ig=Kg[Pg++],Xg.vertexColors.push(new Ps(tf[Ig]));Mg.faces.push(Xg)}}(Eg,Tg),function(Sg,Mg){var Ag=void 0===Sg.influencesPerVertex?2:Sg.influencesPerVertex;if(Sg.skinWeights)for(var wg=0,Rg=Sg.skinWeights.length;wg<Rg;wg+=Ag){var Lg=Sg.skinWeights[wg],Pg=1<Ag?Sg.skinWeights[wg+1]:0,Cg=2<Ag?Sg.skinWeights[wg+2]:0,Ig=3<Ag?Sg.skinWeights[wg+3]:0;Mg.skinWeights.push(new Yo(Lg,Pg,Cg,Ig))}if(Sg.skinIndices)for(var wg=0,Rg=Sg.skinIndices.length;wg<Rg;wg+=Ag){var Ug=Sg.skinIndices[wg],Dg=1<Ag?Sg.skinIndices[wg+1]:0,Ng=2<Ag?Sg.skinIndices[wg+2]:0,Bg=3<Ag?Sg.skinIndices[wg+3]:0;Mg.skinIndices.push(new Yo(Ug,Dg,Ng,Bg))}Mg.bones=Sg.bones,Mg.bones&&0<Mg.bones.length&&(Mg.skinWeights.length!==Mg.skinIndices.length||Mg.skinIndices.length!==Mg.vertices.length)&&console.warn('When skinning, number of vertices ('+Mg.vertices.length+'), skinIndices ('+Mg.skinIndices.length+'), and skinWeights ('+Mg.skinWeights.length+') should match.')}(Eg,Tg),function(Sg,Mg){var Ag=Sg.scale;if(void 0!==Sg.morphTargets)for(var wg=0,Rg=Sg.morphTargets.length;wg<Rg;wg++){Mg.morphTargets[wg]={},Mg.morphTargets[wg].name=Sg.morphTargets[wg].name,Mg.morphTargets[wg].vertices=[];for(var Lg=Mg.morphTargets[wg].vertices,Pg=Sg.morphTargets[wg].vertices,Cg=0,Ig=Pg.length,Ug;Cg<Ig;Cg+=3)Ug=new Wo,Ug.x=Pg[Cg]*Ag,Ug.y=Pg[Cg+1]*Ag,Ug.z=Pg[Cg+2]*Ag,Lg.push(Ug)}if(void 0!==Sg.morphColors&&0<Sg.morphColors.length){console.warn('THREE.JSONLoader: "morphColors" no longer supported. Using them as face colors.');for(var Dg=Mg.faces,Ng=Sg.morphColors[0].colors,wg=0,Rg=Dg.length;wg<Rg;wg++)Dg[wg].color.fromArray(Ng,3*wg)}}(Eg,Tg),function(Sg,Mg){var Ag=[],wg=[];void 0!==Sg.animation&&wg.push(Sg.animation),void 0!==Sg.animations&&(Sg.animations.length?wg=wg.concat(Sg.animations):wg.push(Sg.animations));for(var Rg=0,Lg;Rg<wg.length;Rg++)Lg=mp.parseAnimation(wg[Rg],Mg.bones),Lg&&Ag.push(Lg);if(Mg.morphTargets){var Pg=mp.CreateClipsFromMorphTargetSequences(Mg.morphTargets,10);Ag=Ag.concat(Pg)}0<Ag.length&&(Mg.animations=Ag)}(Eg,Tg),Tg.computeFaceNormals(),Tg.computeBoundingSphere(),void 0===Eg.materials||0===Eg.materials.length)?{geometry:Tg}:{geometry:Tg,materials:fp.prototype.initMaterials(Eg.materials,bg,this.crossOrigin)}}}()}),Object.assign(yp.prototype,{load:function load(Eg,bg,Tg,Sg){''===this.texturePath&&(this.texturePath=Eg.substring(0,Eg.lastIndexOf('/')+1));var Mg=this;new Fd(Mg.manager).load(Eg,function(Ag){var wg=null;try{wg=JSON.parse(Ag)}catch(Lg){return void 0!==Sg&&Sg(Lg),void console.error('THREE:ObjectLoader: Can\'t parse '+Eg+'.',Lg.message)}var Rg=wg.metadata;void 0!==Rg&&void 0!==Rg.type&&'geometry'!==Rg.type.toLowerCase()?Mg.parse(wg,bg):console.error('THREE.ObjectLoader: Can\'t load '+Eg+'. Use THREE.JSONLoader instead.')},Tg,Sg)},setTexturePath:function setTexturePath(Eg){this.texturePath=Eg},setCrossOrigin:function setCrossOrigin(Eg){this.crossOrigin=Eg},parse:function parse(Eg,bg){var Tg=this.parseGeometries(Eg.geometries),Sg=this.parseImages(Eg.images,function(){void 0!==bg&&bg(wg)}),Mg=this.parseTextures(Eg.textures,Sg),Ag=this.parseMaterials(Eg.materials,Mg),wg=this.parseObject(Eg.object,Tg,Ag);return Eg.animations&&(wg.animations=this.parseAnimations(Eg.animations)),void 0!==Eg.images&&0!==Eg.images.length||void 0!==bg&&bg(wg),wg},parseGeometries:function parseGeometries(Eg){var bg={};if(void 0!==Eg)for(var Tg=new hp,Sg=new gp,Mg=0,Ag=Eg.length;Mg<Ag;Mg++){var Rg=Eg[Mg],wg;switch(Rg.type){case'PlaneGeometry':case'PlaneBufferGeometry':wg=new Ku[Rg.type](Rg.width,Rg.height,Rg.widthSegments,Rg.heightSegments);break;case'BoxGeometry':case'BoxBufferGeometry':case'CubeGeometry':wg=new Ku[Rg.type](Rg.width,Rg.height,Rg.depth,Rg.widthSegments,Rg.heightSegments,Rg.depthSegments);break;case'CircleGeometry':case'CircleBufferGeometry':wg=new Ku[Rg.type](Rg.radius,Rg.segments,Rg.thetaStart,Rg.thetaLength);break;case'CylinderGeometry':case'CylinderBufferGeometry':wg=new Ku[Rg.type](Rg.radiusTop,Rg.radiusBottom,Rg.height,Rg.radialSegments,Rg.heightSegments,Rg.openEnded,Rg.thetaStart,Rg.thetaLength);break;case'ConeGeometry':case'ConeBufferGeometry':wg=new Ku[Rg.type](Rg.radius,Rg.height,Rg.radialSegments,Rg.heightSegments,Rg.openEnded,Rg.thetaStart,Rg.thetaLength);break;case'SphereGeometry':case'SphereBufferGeometry':wg=new Ku[Rg.type](Rg.radius,Rg.widthSegments,Rg.heightSegments,Rg.phiStart,Rg.phiLength,Rg.thetaStart,Rg.thetaLength);break;case'IcosahedronGeometry':case'IcosahedronBufferGeometry':case'OctahedronGeometry':case'OctahedronBufferGeometry':case'TetrahedronGeometry':case'TetrahedronBufferGeometry':wg=new Ku[Rg.type](Rg.radius,Rg.detail);break;case'RingGeometry':case'RingBufferGeometry':wg=new Ku[Rg.type](Rg.innerRadius,Rg.outerRadius,Rg.thetaSegments,Rg.phiSegments,Rg.thetaStart,Rg.thetaLength);break;case'BufferGeometry':wg=Sg.parse(Rg);break;case'Geometry':wg=Tg.parse(Rg,this.texturePath).geometry;break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+Rg.type+'"');continue;}wg.uuid=Rg.uuid,void 0!==Rg.name&&(wg.name=Rg.name),bg[Rg.uuid]=wg}return bg},parseMaterials:function parseMaterials(Eg,bg){var Tg={};if(void 0!==Eg){var Sg=new up;Sg.setTextures(bg);for(var Mg=0,Ag=Eg.length,wg;Mg<Ag;Mg++)if(wg=Eg[Mg],'MultiMaterial'===wg.type){for(var Rg=[],Lg=0;Lg<wg.materials.length;Lg++)Rg.push(Sg.parse(wg.materials[Lg]));Tg[wg.uuid]=Rg}else Tg[wg.uuid]=Sg.parse(wg)}return Tg},parseAnimations:function parseAnimations(Eg){for(var bg=[],Tg=0,Sg;Tg<Eg.length;Tg++)Sg=mp.parse(Eg[Tg]),bg.push(Sg);return bg},parseImages:function parseImages(Eg,bg){function Tg(Cg){return Sg.manager.itemStart(Cg),Ag.load(Cg,function(){Sg.manager.itemEnd(Cg)},void 0,function(){Sg.manager.itemEnd(Cg),Sg.manager.itemError(Cg)})}var Sg=this,Mg={};if(void 0!==Eg&&0<Eg.length){var Ag=new Hd(new Bd(bg));Ag.setCrossOrigin(this.crossOrigin);for(var wg=0,Rg=Eg.length;wg<Rg;wg++){var Lg=Eg[wg],Pg=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(Lg.url)?Lg.url:Sg.texturePath+Lg.url;Mg[Lg.uuid]=Tg(Pg)}}return Mg},parseTextures:function parseTextures(Eg,bg){function Tg(Lg,Pg){return'number'==typeof Lg?Lg:(console.warn('THREE.ObjectLoader.parseTexture: Constant should be in numeric form.',Lg),Pg[Lg])}var Sg={};if(void 0!==Eg)for(var Mg=0,Ag=Eg.length,wg;Mg<Ag;Mg++){wg=Eg[Mg],void 0===wg.image&&console.warn('THREE.ObjectLoader: No "image" specified for',wg.uuid),void 0===bg[wg.image]&&console.warn('THREE.ObjectLoader: Undefined image',wg.image);var Rg=new jo(bg[wg.image]);Rg.needsUpdate=!0,Rg.uuid=wg.uuid,void 0!==wg.name&&(Rg.name=wg.name),void 0!==wg.mapping&&(Rg.mapping=Tg(wg.mapping,ng)),void 0!==wg.offset&&Rg.offset.fromArray(wg.offset),void 0!==wg.repeat&&Rg.repeat.fromArray(wg.repeat),void 0!==wg.center&&Rg.center.fromArray(wg.center),void 0!==wg.rotation&&(Rg.rotation=wg.rotation),void 0!==wg.wrap&&(Rg.wrapS=Tg(wg.wrap[0],sg),Rg.wrapT=Tg(wg.wrap[1],sg)),void 0!==wg.minFilter&&(Rg.minFilter=Tg(wg.minFilter,lg)),void 0!==wg.magFilter&&(Rg.magFilter=Tg(wg.magFilter,lg)),void 0!==wg.anisotropy&&(Rg.anisotropy=wg.anisotropy),void 0!==wg.flipY&&(Rg.flipY=wg.flipY),Sg[wg.uuid]=Rg}return Sg},parseObject:function(){var Eg=new Ho;return function(bg,Tg,Sg){function Mg(Bg){return void 0===Tg[Bg]&&console.warn('THREE.ObjectLoader: Undefined geometry',Bg),Tg[Bg]}function Ag(Bg){if(void 0!==Bg){if(Array.isArray(Bg)){for(var Fg=[],zg=0,Gg=Bg.length,Hg;zg<Gg;zg++)Hg=Bg[zg],void 0===Sg[Hg]&&console.warn('THREE.ObjectLoader: Undefined material',Hg),Fg.push(Sg[Hg]);return Fg}return void 0===Sg[Bg]&&console.warn('THREE.ObjectLoader: Undefined material',Bg),Sg[Bg]}}var wg;switch(bg.type){case'Scene':wg=new Wl,void 0!==bg.background&&Number.isInteger(bg.background)&&(wg.background=new Ps(bg.background)),void 0!==bg.fog&&('Fog'===bg.fog.type?wg.fog=new Vl(bg.fog.color,bg.fog.near,bg.fog.far):'FogExp2'===bg.fog.type&&(wg.fog=new Ol(bg.fog.color,bg.fog.density)));break;case'PerspectiveCamera':wg=new Fl(bg.fov,bg.aspect,bg.near,bg.far),void 0!==bg.focus&&(wg.focus=bg.focus),void 0!==bg.zoom&&(wg.zoom=bg.zoom),void 0!==bg.filmGauge&&(wg.filmGauge=bg.filmGauge),void 0!==bg.filmOffset&&(wg.filmOffset=bg.filmOffset),void 0!==bg.view&&(wg.view=Object.assign({},bg.view));break;case'OrthographicCamera':wg=new qs(bg.left,bg.right,bg.top,bg.bottom,bg.near,bg.far);break;case'AmbientLight':wg=new Qd(bg.color,bg.intensity);break;case'DirectionalLight':wg=new Jd(bg.color,bg.intensity);break;case'PointLight':wg=new qd(bg.color,bg.intensity,bg.distance,bg.decay);break;case'RectAreaLight':wg=new Kd(bg.color,bg.intensity,bg.width,bg.height);break;case'SpotLight':wg=new Yd(bg.color,bg.intensity,bg.distance,bg.angle,bg.penumbra,bg.decay);break;case'HemisphereLight':wg=new kd(bg.color,bg.groundColor,bg.intensity);break;case'SkinnedMesh':console.warn('THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.');case'Mesh':var Rg=Mg(bg.geometry),Lg=Ag(bg.material);wg=Rg.bones&&0<Rg.bones.length?new Jl(Rg,Lg):new El(Rg,Lg);break;case'LOD':wg=new Yl;break;case'Line':wg=new Kl(Mg(bg.geometry),Ag(bg.material),bg.mode);break;case'LineLoop':wg=new ed(Mg(bg.geometry),Ag(bg.material));break;case'LineSegments':wg=new $l(Mg(bg.geometry),Ag(bg.material));break;case'PointCloud':case'Points':wg=new rd(Mg(bg.geometry),Ag(bg.material));break;case'Sprite':wg=new jl(Ag(bg.material));break;case'Group':wg=new ad;break;default:wg=new js;}if(wg.uuid=bg.uuid,void 0!==bg.name&&(wg.name=bg.name),void 0===bg.matrix?(void 0!==bg.position&&wg.position.fromArray(bg.position),void 0!==bg.rotation&&wg.rotation.fromArray(bg.rotation),void 0!==bg.quaternion&&wg.quaternion.fromArray(bg.quaternion),void 0!==bg.scale&&wg.scale.fromArray(bg.scale)):(Eg.fromArray(bg.matrix),Eg.decompose(wg.position,wg.quaternion,wg.scale)),void 0!==bg.castShadow&&(wg.castShadow=bg.castShadow),void 0!==bg.receiveShadow&&(wg.receiveShadow=bg.receiveShadow),bg.shadow&&(void 0!==bg.shadow.bias&&(wg.shadow.bias=bg.shadow.bias),void 0!==bg.shadow.radius&&(wg.shadow.radius=bg.shadow.radius),void 0!==bg.shadow.mapSize&&wg.shadow.mapSize.fromArray(bg.shadow.mapSize),void 0!==bg.shadow.camera&&(wg.shadow.camera=this.parseObject(bg.shadow.camera))),void 0!==bg.visible&&(wg.visible=bg.visible),void 0!==bg.userData&&(wg.userData=bg.userData),void 0!==bg.children)for(var Pg=bg.children,Cg=0;Cg<Pg.length;Cg++)wg.add(this.parseObject(Pg[Cg],Tg,Sg));if('LOD'===bg.type)for(var Ig=bg.levels,Ug=0;Ug<Ig.length;Ug++){var Dg=Ig[Ug],Ng=wg.getObjectByProperty('uuid',Dg.object);void 0!==Ng&&wg.addLevel(Ng,Dg.distance)}return wg}}()});var ng={UVMapping:300,CubeReflectionMapping:wm,CubeRefractionMapping:Rm,EquirectangularReflectionMapping:Lm,EquirectangularRefractionMapping:Pm,SphericalReflectionMapping:Cm,CubeUVReflectionMapping:Im,CubeUVRefractionMapping:Um},sg={RepeatWrapping:Dm,ClampToEdgeWrapping:Nm,MirroredRepeatWrapping:Bm},lg={NearestFilter:Fm,NearestMipMapNearestFilter:zm,NearestMipMapLinearFilter:Gm,LinearFilter:Hm,LinearMipMapNearestFilter:Om,LinearMipMapLinearFilter:Vm};Object.assign(Ep.prototype,{getPoint:function getPoint(){return console.warn('THREE.Curve: .getPoint() not implemented.'),null},getPointAt:function getPointAt(Eg,bg){var Tg=this.getUtoTmapping(Eg);return this.getPoint(Tg,bg)},getPoints:function getPoints(Eg){void 0===Eg&&(Eg=5);for(var bg=[],Tg=0;Tg<=Eg;Tg++)bg.push(this.getPoint(Tg/Eg));return bg},getSpacedPoints:function getSpacedPoints(Eg){void 0===Eg&&(Eg=5);for(var bg=[],Tg=0;Tg<=Eg;Tg++)bg.push(this.getPointAt(Tg/Eg));return bg},getLength:function getLength(){var Eg=this.getLengths();return Eg[Eg.length-1]},getLengths:function getLengths(Eg){if(void 0===Eg&&(Eg=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===Eg+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var Sg=[],Mg=this.getPoint(0),Ag=0,bg,Tg;for(Sg.push(0),Tg=1;Tg<=Eg;Tg++)Ag+=(bg=this.getPoint(Tg/Eg)).distanceTo(Mg),Sg.push(Ag),Mg=bg;return this.cacheArcLengths=Sg,Sg},updateArcLengths:function updateArcLengths(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function getUtoTmapping(Eg,bg){var Sg=this.getLengths(),Mg=0,Ag=Sg.length,Tg;Tg=bg||Eg*Sg[Ag-1];for(var Rg=0,Lg=Ag-1,wg;Rg<=Lg;)if(Mg=Math.floor(Rg+(Lg-Rg)/2),0>(wg=Sg[Mg]-Tg))Rg=Mg+1;else{if(!(0<wg)){Lg=Mg;break}Lg=Mg-1}if(Mg=Lg,Sg[Mg]===Tg)return Mg/(Ag-1);var Pg=Sg[Mg];return(Mg+(Tg-Pg)/(Sg[Mg+1]-Pg))/(Ag-1)},getTangent:function getTangent(Eg){var bg=Eg-1e-4,Tg=Eg+1e-4;0>bg&&(bg=0),1<Tg&&(Tg=1);var Sg=this.getPoint(bg);return this.getPoint(Tg).clone().sub(Sg).normalize()},getTangentAt:function getTangentAt(Eg){var bg=this.getUtoTmapping(Eg);return this.getTangent(bg)},computeFrenetFrames:function computeFrenetFrames(Eg,bg){var Ag=new Wo,wg=[],Rg=[],Lg=[],Pg=new Wo,Cg=new Ho,Tg,Sg,Mg;for(Tg=0;Tg<=Eg;Tg++)Sg=Tg/Eg,wg[Tg]=this.getTangentAt(Sg),wg[Tg].normalize();Rg[0]=new Wo,Lg[0]=new Wo;var Ig=Number.MAX_VALUE,Ug=Math.abs(wg[0].x),Dg=Math.abs(wg[0].y),Ng=Math.abs(wg[0].z);for(Ug<=Ig&&(Ig=Ug,Ag.set(1,0,0)),Dg<=Ig&&(Ig=Dg,Ag.set(0,1,0)),Ng<=Ig&&Ag.set(0,0,1),Pg.crossVectors(wg[0],Ag).normalize(),Rg[0].crossVectors(wg[0],Pg),Lg[0].crossVectors(wg[0],Rg[0]),Tg=1;Tg<=Eg;Tg++)Rg[Tg]=Rg[Tg-1].clone(),Lg[Tg]=Lg[Tg-1].clone(),Pg.crossVectors(wg[Tg-1],wg[Tg]),Pg.length()>Number.EPSILON&&(Pg.normalize(),Mg=Math.acos(Iu.clamp(wg[Tg-1].dot(wg[Tg]),-1,1)),Rg[Tg].applyMatrix4(Cg.makeRotationAxis(Pg,Mg))),Lg[Tg].crossVectors(wg[Tg],Rg[Tg]);if(!0===bg)for(Mg=Math.acos(Iu.clamp(Rg[0].dot(Rg[Eg]),-1,1)),Mg/=Eg,0<wg[0].dot(Pg.crossVectors(Rg[0],Rg[Eg]))&&(Mg=-Mg),Tg=1;Tg<=Eg;Tg++)Rg[Tg].applyMatrix4(Cg.makeRotationAxis(wg[Tg],Mg*Tg)),Lg[Tg].crossVectors(wg[Tg],Rg[Tg]);return{tangents:wg,normals:Rg,binormals:Lg}}}),(bp.prototype=Object.create(Ep.prototype)).constructor=bp,bp.prototype.isLineCurve=!0,bp.prototype.getPoint=function(Eg,bg){var Tg=bg||new Go;return 1===Eg?Tg.copy(this.v2):(Tg.copy(this.v2).sub(this.v1),Tg.multiplyScalar(Eg).add(this.v1)),Tg},bp.prototype.getPointAt=function(Eg,bg){return this.getPoint(Eg,bg)},bp.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()},Tp.prototype=Object.assign(Object.create(Ep.prototype),{constructor:Tp,add:function add(Eg){this.curves.push(Eg)},closePath:function closePath(){var Eg=this.curves[0].getPoint(0),bg=this.curves[this.curves.length-1].getPoint(1);Eg.equals(bg)||this.curves.push(new bp(bg,Eg))},getPoint:function getPoint(Eg){for(var bg=Eg*this.getLength(),Tg=this.getCurveLengths(),Sg=0;Sg<Tg.length;){if(Tg[Sg]>=bg){var Mg=Tg[Sg]-bg,Ag=this.curves[Sg],wg=Ag.getLength(),Rg=0===wg?0:1-Mg/wg;return Ag.getPointAt(Rg)}Sg++}return null},getLength:function getLength(){var Eg=this.getCurveLengths();return Eg[Eg.length-1]},updateArcLengths:function updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var Eg=[],bg=0,Tg=0,Sg=this.curves.length;Tg<Sg;Tg++)bg+=this.curves[Tg].getLength(),Eg.push(bg);return this.cacheLengths=Eg,Eg},getSpacedPoints:function getSpacedPoints(Eg){void 0===Eg&&(Eg=40);for(var bg=[],Tg=0;Tg<=Eg;Tg++)bg.push(this.getPoint(Tg/Eg));return this.autoClose&&bg.push(bg[0]),bg},getPoints:function getPoints(Eg){Eg=Eg||12;for(var Tg=[],Sg=0,Mg=this.curves,bg;Sg<Mg.length;Sg++)for(var Ag=Mg[Sg],wg=Ag&&Ag.isEllipseCurve?2*Eg:Ag&&Ag.isLineCurve?1:Ag&&Ag.isSplineCurve?Eg*Ag.points.length:Eg,Rg=Ag.getPoints(wg),Lg=0,Pg;Lg<Rg.length;Lg++)Pg=Rg[Lg],bg&&bg.equals(Pg)||(Tg.push(Pg),bg=Pg);return this.autoClose&&1<Tg.length&&!Tg[Tg.length-1].equals(Tg[0])&&Tg.push(Tg[0]),Tg}}),(Sp.prototype=Object.create(Ep.prototype)).constructor=Sp,Sp.prototype.isEllipseCurve=!0,Sp.prototype.getPoint=function(Eg,bg){for(var Tg=bg||new Go,Sg=2*Math.PI,Mg=this.aEndAngle-this.aStartAngle,Ag=Math.abs(Mg)<Number.EPSILON;0>Mg;)Mg+=Sg;for(;Mg>Sg;)Mg-=Sg;Mg<Number.EPSILON&&(Mg=Ag?0:Sg),!0!==this.aClockwise||Ag||(Mg===Sg?Mg=-Sg:Mg-=Sg);var wg=this.aStartAngle+Eg*Mg,Rg=this.aX+this.xRadius*Math.cos(wg),Lg=this.aY+this.yRadius*Math.sin(wg);if(0!==this.aRotation){var Pg=Math.cos(this.aRotation),Cg=Math.sin(this.aRotation),Ig=Rg-this.aX,Ug=Lg-this.aY;Rg=Ig*Pg-Ug*Cg+this.aX,Lg=Ig*Cg+Ug*Pg+this.aY}return Tg.set(Rg,Lg)},(Mp.prototype=Object.create(Ep.prototype)).constructor=Mp,Mp.prototype.isSplineCurve=!0,Mp.prototype.getPoint=function(Eg,bg){var Tg=bg||new Go,Sg=this.points,Mg=(Sg.length-1)*Eg,Ag=Math.floor(Mg),wg=Mg-Ag,Rg=Sg[0===Ag?Ag:Ag-1],Lg=Sg[Ag],Pg=Sg[Ag>Sg.length-2?Sg.length-1:Ag+1],Cg=Sg[Ag>Sg.length-3?Sg.length-1:Ag+2];return Tg.set(xp(wg,Rg.x,Lg.x,Pg.x,Cg.x),xp(wg,Rg.y,Lg.y,Pg.y,Cg.y)),Tg},(Ap.prototype=Object.create(Ep.prototype)).constructor=Ap,Ap.prototype.isCubicBezierCurve=!0,Ap.prototype.getPoint=function(Eg,bg){var Tg=bg||new Go,Sg=this.v0,Mg=this.v1,Ag=this.v2,wg=this.v3;return Tg.set(_p(Eg,Sg.x,Mg.x,Ag.x,wg.x),_p(Eg,Sg.y,Mg.y,Ag.y,wg.y)),Tg},(wp.prototype=Object.create(Ep.prototype)).constructor=wp,wp.prototype.isQuadraticBezierCurve=!0,wp.prototype.getPoint=function(Eg,bg){var Tg=bg||new Go,Sg=this.v0,Mg=this.v1,Ag=this.v2;return Tg.set(vp(Eg,Sg.x,Mg.x,Ag.x),vp(Eg,Sg.y,Mg.y,Ag.y)),Tg};var dg=Object.assign(Object.create(Tp.prototype),{fromPoints:function fromPoints(Eg){this.moveTo(Eg[0].x,Eg[0].y);for(var bg=1,Tg=Eg.length;bg<Tg;bg++)this.lineTo(Eg[bg].x,Eg[bg].y)},moveTo:function moveTo(Eg,bg){this.currentPoint.set(Eg,bg)},lineTo:function lineTo(Eg,bg){var Tg=new bp(this.currentPoint.clone(),new Go(Eg,bg));this.curves.push(Tg),this.currentPoint.set(Eg,bg)},quadraticCurveTo:function quadraticCurveTo(Eg,bg,Tg,Sg){var Mg=new wp(this.currentPoint.clone(),new Go(Eg,bg),new Go(Tg,Sg));this.curves.push(Mg),this.currentPoint.set(Tg,Sg)},bezierCurveTo:function bezierCurveTo(Eg,bg,Tg,Sg,Mg,Ag){var wg=new Ap(this.currentPoint.clone(),new Go(Eg,bg),new Go(Tg,Sg),new Go(Mg,Ag));this.curves.push(wg),this.currentPoint.set(Mg,Ag)},splineThru:function splineThru(Eg){var bg=new Mp([this.currentPoint.clone()].concat(Eg));this.curves.push(bg),this.currentPoint.copy(Eg[Eg.length-1])},arc:function arc(Eg,bg,Tg,Sg,Mg,Ag){var wg=this.currentPoint.x,Rg=this.currentPoint.y;this.absarc(Eg+wg,bg+Rg,Tg,Sg,Mg,Ag)},absarc:function absarc(Eg,bg,Tg,Sg,Mg,Ag){this.absellipse(Eg,bg,Tg,Tg,Sg,Mg,Ag)},ellipse:function ellipse(Eg,bg,Tg,Sg,Mg,Ag,wg,Rg){var Lg=this.currentPoint.x,Pg=this.currentPoint.y;this.absellipse(Eg+Lg,bg+Pg,Tg,Sg,Mg,Ag,wg,Rg)},absellipse:function absellipse(Eg,bg,Tg,Sg,Mg,Ag,wg,Rg){var Lg=new Sp(Eg,bg,Tg,Sg,Mg,Ag,wg,Rg);if(0<this.curves.length){var Pg=Lg.getPoint(0);Pg.equals(this.currentPoint)||this.lineTo(Pg.x,Pg.y)}this.curves.push(Lg);var Cg=Lg.getPoint(1);this.currentPoint.copy(Cg)}});Rp.prototype=dg,dg.constructor=Rp,Lp.prototype=Object.assign(Object.create(dg),{constructor:Lp,getPointsHoles:function getPointsHoles(Eg){for(var bg=[],Tg=0,Sg=this.holes.length;Tg<Sg;Tg++)bg[Tg]=this.holes[Tg].getPoints(Eg);return bg},extractAllPoints:function extractAllPoints(Eg){return{shape:this.getPoints(Eg),holes:this.getPointsHoles(Eg)}},extractPoints:function extractPoints(Eg){return this.extractAllPoints(Eg)}}),Object.assign(Pp.prototype,{moveTo:function moveTo(Eg,bg){this.currentPath=new Rp,this.subPaths.push(this.currentPath),this.currentPath.moveTo(Eg,bg)},lineTo:function lineTo(Eg,bg){this.currentPath.lineTo(Eg,bg)},quadraticCurveTo:function quadraticCurveTo(Eg,bg,Tg,Sg){this.currentPath.quadraticCurveTo(Eg,bg,Tg,Sg)},bezierCurveTo:function bezierCurveTo(Eg,bg,Tg,Sg,Mg,Ag){this.currentPath.bezierCurveTo(Eg,bg,Tg,Sg,Mg,Ag)},splineThru:function splineThru(Eg){this.currentPath.splineThru(Eg)},toShapes:function toShapes(Eg,bg){function Tg(Kg){for(var $g=[],ef=0,tf=Kg.length;ef<tf;ef++){var rf=Kg[ef],af=new Lp;af.curves=rf.curves,$g.push(af)}return $g}function Sg(Kg,$g){for(var ef=$g.length,tf=!1,rf=ef-1,af=0;af<ef;rf=af++){var of=$g[rf],nf=$g[af],sf=nf.x-of.x,lf=nf.y-of.y;if(Math.abs(lf)>Number.EPSILON){if(0>lf&&(of=$g[af],sf=-sf,nf=$g[rf],lf=-lf),Kg.y<of.y||Kg.y>nf.y)continue;if(Kg.y!==of.y){var df=lf*(Kg.x-of.x)-sf*(Kg.y-of.y);if(0==df)return!0;if(0>df)continue;tf=!tf}else if(Kg.x===of.x)return!0}else{if(Kg.y!==of.y)continue;if(nf.x<=Kg.x&&Kg.x<=of.x||of.x<=Kg.x&&Kg.x<=nf.x)return!0}}return tf}var Mg=Qu.isClockWise,Ag=this.subPaths;if(0===Ag.length)return[];if(!0===bg)return Tg(Ag);var Pg=[],wg,Rg,Lg;if(1===Ag.length)return Rg=Ag[0],Lg=new Lp,Lg.curves=Rg.curves,Pg.push(Lg),Pg;var Cg=!Mg(Ag[0].getPoints());Cg=Eg?!Cg:Cg;var Ug=[],Dg=[],Ng=[],Bg=0,Ig;Dg[Bg]=void 0,Ng[Bg]=[];for(var Fg=0,zg=Ag.length;Fg<zg;Fg++)wg=Mg(Ig=(Rg=Ag[Fg]).getPoints()),(wg=Eg?!wg:wg)?(!Cg&&Dg[Bg]&&Bg++,Dg[Bg]={s:new Lp,p:Ig},Dg[Bg].s.curves=Rg.curves,Cg&&Bg++,Ng[Bg]=[]):Ng[Bg].push({h:Rg,p:Ig[0]});if(!Dg[0])return Tg(Ag);if(1<Dg.length){for(var Gg=!1,Hg=[],Og=0,Vg=Dg.length;Og<Vg;Og++)Ug[Og]=[];for(var Og=0,Vg=Dg.length;Og<Vg;Og++)for(var Wg=Ng[Og],kg=0;kg<Wg.length;kg++){for(var Xg=Wg[kg],jg=!0,Yg=0;Yg<Dg.length;Yg++)Sg(Xg.p,Dg[Yg].p)&&(Og!==Yg&&Hg.push({froms:Og,tos:Yg,hole:kg}),jg?(jg=!1,Ug[Yg].push(Xg)):Gg=!0);jg&&Ug[Og].push(Xg)}0<Hg.length&&(Gg||(Ng=Ug))}for(var Fg=0,Zg=Dg.length,qg;Fg<Zg;Fg++){Lg=Dg[Fg].s,Pg.push(Lg);for(var Jg=0,Qg=(qg=Ng[Fg]).length;Jg<Qg;Jg++)Lg.holes.push(qg[Jg].h)}return Pg}}),Object.assign(Cp.prototype,{isFont:!0,generateShapes:function generateShapes(Eg,bg,Tg){function Sg(Pg){for(var Cg=(Pg+'').split(''),Ig=bg/Mg.resolution,Ug=(Mg.boundingBox.yMax-Mg.boundingBox.yMin+Mg.underlineThickness)*Ig,Dg=0,Ng=0,Bg=[],Fg=0,zg;Fg<Cg.length;Fg++)if(zg=Cg[Fg],'\n'===zg)Dg=0,Ng-=Ug;else{var Gg=function(Hg,Og,Vg,Wg){var kg=Mg.glyphs[Hg]||Mg.glyphs['?'];if(kg){var rf=new Pp,af=[],Xg,jg,Yg,qg,Zg,Jg,Qg,Kg,$g,ef,tf;if(kg.o)for(var of=kg._cachedOutline||(kg._cachedOutline=kg.o.split(' ')),nf=0,sf=of.length;nf<sf;)switch(of[nf++]){case'm':Xg=of[nf++]*Og+Vg,jg=of[nf++]*Og+Wg,rf.moveTo(Xg,jg);break;case'l':Xg=of[nf++]*Og+Vg,jg=of[nf++]*Og+Wg,rf.lineTo(Xg,jg);break;case'q':if(Yg=of[nf++]*Og+Vg,qg=of[nf++]*Og+Wg,Qg=of[nf++]*Og+Vg,Kg=of[nf++]*Og+Wg,rf.quadraticCurveTo(Qg,Kg,Yg,qg),tf=af[af.length-1])for(Zg=tf.x,Jg=tf.y,lf=1;lf<=Tg;lf++)vp(df=lf/Tg,Zg,Qg,Yg),vp(df,Jg,Kg,qg);break;case'b':if(Yg=of[nf++]*Og+Vg,qg=of[nf++]*Og+Wg,Qg=of[nf++]*Og+Vg,Kg=of[nf++]*Og+Wg,$g=of[nf++]*Og+Vg,ef=of[nf++]*Og+Wg,rf.bezierCurveTo(Qg,Kg,$g,ef,Yg,qg),tf=af[af.length-1]){Zg=tf.x,Jg=tf.y;for(var lf=1,df;lf<=Tg;lf++)df=lf/Tg,_p(df,Zg,Qg,$g,Yg),_p(df,Jg,Kg,ef,qg)}}return{offsetX:kg.ha*Og,path:rf}}}(zg,Ig,Dg,Ng);Dg+=Gg.offsetX,Bg.push(Gg.path)}return Bg}void 0===bg&&(bg=100),void 0===Tg&&(Tg=4);for(var Mg=this.data,Ag=Sg(Eg),wg=[],Rg=0,Lg=Ag.length;Rg<Lg;Rg++)Array.prototype.push.apply(wg,Ag[Rg].toShapes());return wg}}),Object.assign(Ip.prototype,{load:function load(Eg,bg){var Mg;new Fd(this.manager);try{Mg=JSON.parse(Eg)}catch(wg){console.warn('THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead.'),Mg=JSON.parse(Eg.substring(65,Eg.length-2))}var Ag=this.parse(Mg);bg&&bg(Ag)},parse:function parse(Eg){return new Cp(Eg)},setPath:function setPath(Eg){return this.path=Eg,this}});var cg={getContext:function getContext(){return void 0===pg&&(pg=new(window.AudioContext||window.webkitAudioContext)),pg},setContext:function setContext(Eg){pg=Eg}},pg;Object.assign(Up.prototype,{load:function load(Eg,bg,Tg,Sg){var Mg=new Fd(this.manager);Mg.setResponseType('arraybuffer'),Mg.load(Eg,function(Ag){cg.getContext().decodeAudioData(Ag,function(wg){bg(wg)})},Tg,Sg)}}),Object.assign(Dp.prototype,{update:function(){var Lg=new Ho,Pg=new Ho,Eg,bg,Tg,Sg,Mg,Ag,wg,Rg;return function(Cg){if(Eg!==this||bg!==Cg.focus||Tg!==Cg.fov||Sg!==Cg.aspect*this.aspect||Mg!==Cg.near||Ag!==Cg.far||wg!==Cg.zoom||Rg!==this.eyeSep){Eg=this,bg=Cg.focus,Tg=Cg.fov,Sg=Cg.aspect*this.aspect,Mg=Cg.near,Ag=Cg.far,wg=Cg.zoom;var Dg=Cg.projectionMatrix.clone(),Ng=(Rg=this.eyeSep/2)*Mg/bg,Bg=Mg*Math.tan(.5*(Iu.DEG2RAD*Tg))/wg,Ig,Ug;Pg.elements[12]=-Rg,Lg.elements[12]=Rg,Ig=-Bg*Sg+Ng,Ug=Bg*Sg+Ng,Dg.elements[0]=2*Mg/(Ug-Ig),Dg.elements[8]=(Ug+Ig)/(Ug-Ig),this.cameraL.projectionMatrix.copy(Dg),Ig=-Bg*Sg-Ng,Ug=Bg*Sg-Ng,Dg.elements[0]=2*Mg/(Ug-Ig),Dg.elements[8]=(Ug+Ig)/(Ug-Ig),this.cameraR.projectionMatrix.copy(Dg)}this.cameraL.matrixWorld.copy(Cg.matrixWorld).multiply(Pg),this.cameraR.matrixWorld.copy(Cg.matrixWorld).multiply(Lg)}}()}),Np.prototype=Object.assign(Object.create(js.prototype),{constructor:Np,getInput:function getInput(){return this.gain},removeFilter:function removeFilter(){null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null)},getFilter:function getFilter(){return this.filter},setFilter:function setFilter(Eg){null===this.filter?this.gain.disconnect(this.context.destination):(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)),this.filter=Eg,this.gain.connect(this.filter),this.filter.connect(this.context.destination)},getMasterVolume:function getMasterVolume(){return this.gain.gain.value},setMasterVolume:function setMasterVolume(Eg){this.gain.gain.value=Eg},updateMatrixWorld:function(){var Eg=new Wo,bg=new Vo,Tg=new Wo,Sg=new Wo;return function(Mg){js.prototype.updateMatrixWorld.call(this,Mg);var Ag=this.context.listener,wg=this.up;this.matrixWorld.decompose(Eg,bg,Tg),Sg.set(0,0,-1).applyQuaternion(bg),Ag.positionX?(Ag.positionX.setValueAtTime(Eg.x,this.context.currentTime),Ag.positionY.setValueAtTime(Eg.y,this.context.currentTime),Ag.positionZ.setValueAtTime(Eg.z,this.context.currentTime),Ag.forwardX.setValueAtTime(Sg.x,this.context.currentTime),Ag.forwardY.setValueAtTime(Sg.y,this.context.currentTime),Ag.forwardZ.setValueAtTime(Sg.z,this.context.currentTime),Ag.upX.setValueAtTime(wg.x,this.context.currentTime),Ag.upY.setValueAtTime(wg.y,this.context.currentTime),Ag.upZ.setValueAtTime(wg.z,this.context.currentTime)):(Ag.setPosition(Eg.x,Eg.y,Eg.z),Ag.setOrientation(Sg.x,Sg.y,Sg.z,wg.x,wg.y,wg.z))}}()}),Bp.prototype=Object.assign(Object.create(js.prototype),{constructor:Bp,getOutput:function getOutput(){return this.gain},setNodeSource:function setNodeSource(Eg){return this.hasPlaybackControl=!1,this.sourceType='audioNode',this.source=Eg,this.connect(),this},setBuffer:function setBuffer(Eg){return this.buffer=Eg,this.sourceType='buffer',this.autoplay&&this.play(),this},play:function play(){if(!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){var Eg=this.context.createBufferSource();return Eg.buffer=this.buffer,Eg.loop=this.loop,Eg.onended=this.onEnded.bind(this),Eg.playbackRate.setValueAtTime(this.playbackRate,this.startTime),this.startTime=this.context.currentTime,Eg.start(this.startTime,this.offset),this.isPlaying=!0,this.source=Eg,this.connect()}console.warn('THREE.Audio: this Audio has no playback control.')}else console.warn('THREE.Audio: Audio is already playing.')},pause:function pause(){return!1===this.hasPlaybackControl?void console.warn('THREE.Audio: this Audio has no playback control.'):(!0===this.isPlaying&&(this.source.stop(),this.offset+=(this.context.currentTime-this.startTime)*this.playbackRate,this.isPlaying=!1),this)},stop:function stop(){return!1===this.hasPlaybackControl?void console.warn('THREE.Audio: this Audio has no playback control.'):(this.source.stop(),this.offset=0,this.isPlaying=!1,this)},connect:function connect(){if(0<this.filters.length){this.source.connect(this.filters[0]);for(var Eg=1,bg=this.filters.length;Eg<bg;Eg++)this.filters[Eg-1].connect(this.filters[Eg]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function disconnect(){if(0<this.filters.length){this.source.disconnect(this.filters[0]);for(var Eg=1,bg=this.filters.length;Eg<bg;Eg++)this.filters[Eg-1].disconnect(this.filters[Eg]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function getFilters(){return this.filters},setFilters:function setFilters(Eg){return Eg||(Eg=[]),!0===this.isPlaying?(this.disconnect(),this.filters=Eg,this.connect()):this.filters=Eg,this},getFilter:function getFilter(){return this.getFilters()[0]},setFilter:function setFilter(Eg){return this.setFilters(Eg?[Eg]:[])},setPlaybackRate:function setPlaybackRate(Eg){return!1===this.hasPlaybackControl?void console.warn('THREE.Audio: this Audio has no playback control.'):(this.playbackRate=Eg,!0===this.isPlaying&&this.source.playbackRate.setValueAtTime(this.playbackRate,this.context.currentTime),this)},getPlaybackRate:function getPlaybackRate(){return this.playbackRate},onEnded:function onEnded(){this.isPlaying=!1},getLoop:function getLoop(){return!1===this.hasPlaybackControl?(console.warn('THREE.Audio: this Audio has no playback control.'),!1):this.loop},setLoop:function setLoop(Eg){return!1===this.hasPlaybackControl?void console.warn('THREE.Audio: this Audio has no playback control.'):(this.loop=Eg,!0===this.isPlaying&&(this.source.loop=this.loop),this)},getVolume:function getVolume(){return this.gain.gain.value},setVolume:function setVolume(Eg){return this.gain.gain.value=Eg,this}}),Fp.prototype=Object.assign(Object.create(Bp.prototype),{constructor:Fp,getOutput:function getOutput(){return this.panner},getRefDistance:function getRefDistance(){return this.panner.refDistance},setRefDistance:function setRefDistance(Eg){this.panner.refDistance=Eg},getRolloffFactor:function getRolloffFactor(){return this.panner.rolloffFactor},setRolloffFactor:function setRolloffFactor(Eg){this.panner.rolloffFactor=Eg},getDistanceModel:function getDistanceModel(){return this.panner.distanceModel},setDistanceModel:function setDistanceModel(Eg){this.panner.distanceModel=Eg},getMaxDistance:function getMaxDistance(){return this.panner.maxDistance},setMaxDistance:function setMaxDistance(Eg){this.panner.maxDistance=Eg},updateMatrixWorld:function(){var Eg=new Wo;return function(bg){js.prototype.updateMatrixWorld.call(this,bg),Eg.setFromMatrixPosition(this.matrixWorld),this.panner.setPosition(Eg.x,Eg.y,Eg.z)}}()}),Object.assign(zp.prototype,{getFrequencyData:function getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function getAverageFrequency(){for(var Eg=0,bg=this.getFrequencyData(),Tg=0;Tg<bg.length;Tg++)Eg+=bg[Tg];return Eg/bg.length}}),Object.assign(Gp.prototype,{accumulate:function accumulate(Eg,bg){var Tg=this.buffer,Sg=this.valueSize,Mg=Eg*Sg+Sg,Ag=this.cumulativeWeight;if(0===Ag){for(var wg=0;wg!==Sg;++wg)Tg[Mg+wg]=Tg[wg];Ag=bg}else{var Rg=bg/(Ag+=bg);this._mixBufferRegion(Tg,Mg,0,Rg,Sg)}this.cumulativeWeight=Ag},apply:function apply(Eg){var bg=this.valueSize,Tg=this.buffer,Sg=Eg*bg+bg,Mg=this.cumulativeWeight,Ag=this.binding;if(this.cumulativeWeight=0,1>Mg){this._mixBufferRegion(Tg,Sg,3*bg,1-Mg,bg)}for(var Rg=bg;Rg!==bg+bg;++Rg)if(Tg[Rg]!==Tg[Rg+bg]){Ag.setValue(Tg,Sg);break}},saveOriginalState:function saveOriginalState(){var Eg=this.binding,bg=this.buffer,Tg=this.valueSize,Sg=3*Tg;Eg.getValue(bg,Sg);for(var Mg=Tg;Mg!==Sg;++Mg)bg[Mg]=bg[Sg+Mg%Tg];this.cumulativeWeight=0},restoreOriginalState:function restoreOriginalState(){var Eg=3*this.valueSize;this.binding.setValue(this.buffer,Eg)},_select:function _select(Eg,bg,Tg,Sg,Mg){if(.5<=Sg)for(var Ag=0;Ag!==Mg;++Ag)Eg[bg+Ag]=Eg[Tg+Ag]},_slerp:function _slerp(Eg,bg,Tg,Sg){Vo.slerpFlat(Eg,bg,Eg,bg,Eg,Tg,Sg)},_lerp:function _lerp(Eg,bg,Tg,Sg,Mg){for(var wg=0,Rg;wg!==Mg;++wg)Rg=bg+wg,Eg[Rg]=Eg[Rg]*(1-Sg)+Eg[Tg+wg]*Sg}}),Object.assign(Hp.prototype,{getValue:function getValue(Eg,bg){this.bind();var Tg=this._targetGroup.nCachedObjects_,Sg=this._bindings[Tg];void 0!==Sg&&Sg.getValue(Eg,bg)},setValue:function setValue(Eg,bg){for(var Tg=this._bindings,Sg=this._targetGroup.nCachedObjects_,Mg=Tg.length;Sg!==Mg;++Sg)Tg[Sg].setValue(Eg,bg)},bind:function bind(){for(var Eg=this._bindings,bg=this._targetGroup.nCachedObjects_,Tg=Eg.length;bg!==Tg;++bg)Eg[bg].bind()},unbind:function unbind(){for(var Eg=this._bindings,bg=this._targetGroup.nCachedObjects_,Tg=Eg.length;bg!==Tg;++bg)Eg[bg].unbind()}}),Object.assign(Op,{Composite:Hp,create:function create(Eg,bg,Tg){return Eg&&Eg.isAnimationObjectGroup?new Op.Composite(Eg,bg,Tg):new Op(Eg,bg,Tg)},sanitizeNodeName:function sanitizeNodeName(Eg){return Eg.replace(/\s/g,'_').replace(/[^\w-]/g,'')},parseTrackName:function(){var Eg=new RegExp('^'+/((?:[\w-]+[\/:])*)/.source+/([\w-\.]+)?/.source+/(?:\.([\w-]+)(?:\[(.+)\])?)?/.source+/\.([\w-]+)(?:\[(.+)\])?/.source+'$'),bg=['material','materials','bones'];return function(Tg){var Sg=Eg.exec(Tg);if(!Sg)throw new Error('PropertyBinding: Cannot parse trackName: '+Tg);var Mg={nodeName:Sg[2],objectName:Sg[3],objectIndex:Sg[4],propertyName:Sg[5],propertyIndex:Sg[6]},Ag=Mg.nodeName&&Mg.nodeName.lastIndexOf('.');if(void 0!==Ag&&-1!==Ag){var wg=Mg.nodeName.substring(Ag+1);-1!==bg.indexOf(wg)&&(Mg.nodeName=Mg.nodeName.substring(0,Ag),Mg.objectName=wg)}if(null===Mg.propertyName||0===Mg.propertyName.length)throw new Error('PropertyBinding: can not parse propertyName from trackName: '+Tg);return Mg}}(),findNode:function findNode(Eg,bg){if(!bg||''===bg||'root'===bg||'.'===bg||-1===bg||bg===Eg.name||bg===Eg.uuid)return Eg;if(Eg.skeleton){var Tg=function(Mg){for(var Ag=0,wg;Ag<Mg.bones.length;Ag++)if(wg=Mg.bones[Ag],wg.name===bg)return wg;return null}(Eg.skeleton);if(Tg)return Tg}if(Eg.children){var Sg=function Mg(Ag){for(var wg=0,Rg;wg<Ag.length;wg++){if(Rg=Ag[wg],Rg.name===bg||Rg.uuid===bg)return Rg;var Lg=Mg(Rg.children);if(Lg)return Lg}return null}(Eg.children);if(Sg)return Sg}return null}}),Object.assign(Op.prototype,{_getValue_unavailable:function _getValue_unavailable(){},_setValue_unavailable:function _setValue_unavailable(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(Eg,bg){Eg[bg]=this.node[this.propertyName]},function(Eg,bg){for(var Tg=this.resolvedProperty,Sg=0,Mg=Tg.length;Sg!==Mg;++Sg)Eg[bg++]=Tg[Sg]},function(Eg,bg){Eg[bg]=this.resolvedProperty[this.propertyIndex]},function(Eg,bg){this.resolvedProperty.toArray(Eg,bg)}],SetterByBindingTypeAndVersioning:[[function(Eg,bg){this.targetObject[this.propertyName]=Eg[bg]},function(Eg,bg){this.targetObject[this.propertyName]=Eg[bg],this.targetObject.needsUpdate=!0},function(Eg,bg){this.targetObject[this.propertyName]=Eg[bg],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(Eg,bg){for(var Tg=this.resolvedProperty,Sg=0,Mg=Tg.length;Sg!==Mg;++Sg)Tg[Sg]=Eg[bg++]},function(Eg,bg){for(var Tg=this.resolvedProperty,Sg=0,Mg=Tg.length;Sg!==Mg;++Sg)Tg[Sg]=Eg[bg++];this.targetObject.needsUpdate=!0},function(Eg,bg){for(var Tg=this.resolvedProperty,Sg=0,Mg=Tg.length;Sg!==Mg;++Sg)Tg[Sg]=Eg[bg++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(Eg,bg){this.resolvedProperty[this.propertyIndex]=Eg[bg]},function(Eg,bg){this.resolvedProperty[this.propertyIndex]=Eg[bg],this.targetObject.needsUpdate=!0},function(Eg,bg){this.resolvedProperty[this.propertyIndex]=Eg[bg],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(Eg,bg){this.resolvedProperty.fromArray(Eg,bg)},function(Eg,bg){this.resolvedProperty.fromArray(Eg,bg),this.targetObject.needsUpdate=!0},function(Eg,bg){this.resolvedProperty.fromArray(Eg,bg),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function getValue(Eg,bg){this.bind(),this.getValue(Eg,bg)},setValue:function setValue(Eg,bg){this.bind(),this.setValue(Eg,bg)},bind:function bind(){var Eg=this.node,bg=this.parsedPath,Tg=bg.objectName,Sg=bg.propertyName,Mg=bg.propertyIndex;if(Eg||(Eg=Op.findNode(this.rootNode,bg.nodeName)||this.rootNode,this.node=Eg),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,Eg){if(Tg){var Ag=bg.objectIndex;switch(Tg){case'materials':if(!Eg.material)return void console.error('THREE.PropertyBinding: Can not bind to material as node does not have a material.',this);if(!Eg.material.materials)return void console.error('THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.',this);Eg=Eg.material.materials;break;case'bones':if(!Eg.skeleton)return void console.error('THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.',this);for(Eg=Eg.skeleton.bones,Pg=0;Pg<Eg.length;Pg++)if(Eg[Pg].name===Ag){Ag=Pg;break}break;default:if(void 0===Eg[Tg])return void console.error('THREE.PropertyBinding: Can not bind to objectName of node undefined.',this);Eg=Eg[Tg];}if(void 0!==Ag){if(void 0===Eg[Ag])return void console.error('THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.',this,Eg);Eg=Eg[Ag]}}var wg=Eg[Sg];if(void 0!==wg){var Rg=this.Versioning.None;void 0===Eg.needsUpdate?void 0!==Eg.matrixWorldNeedsUpdate&&(Rg=this.Versioning.MatrixWorldNeedsUpdate,this.targetObject=Eg):(Rg=this.Versioning.NeedsUpdate,this.targetObject=Eg);var Lg=this.BindingType.Direct;if(void 0!==Mg){if('morphTargetInfluences'===Sg){if(!Eg.geometry)return void console.error('THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.',this);if(Eg.geometry.isBufferGeometry){if(!Eg.geometry.morphAttributes)return void console.error('THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.',this);for(Pg=0;Pg<this.node.geometry.morphAttributes.position.length;Pg++)if(Eg.geometry.morphAttributes.position[Pg].name===Mg){Mg=Pg;break}}else{if(!Eg.geometry.morphTargets)return void console.error('THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.',this);for(var Pg=0;Pg<this.node.geometry.morphTargets.length;Pg++)if(Eg.geometry.morphTargets[Pg].name===Mg){Mg=Pg;break}}}Lg=this.BindingType.ArrayElement,this.resolvedProperty=wg,this.propertyIndex=Mg}else void 0!==wg.fromArray&&void 0!==wg.toArray?(Lg=this.BindingType.HasFromToArray,this.resolvedProperty=wg):Array.isArray(wg)?(Lg=this.BindingType.EntireArray,this.resolvedProperty=wg):this.propertyName=Sg;this.getValue=this.GetterByBindingType[Lg],this.setValue=this.SetterByBindingTypeAndVersioning[Lg][Rg]}else{var Cg=bg.nodeName;console.error('THREE.PropertyBinding: Trying to update property for track: '+Cg+'.'+Sg+' but it wasn\'t found.',Eg)}}else console.error('THREE.PropertyBinding: Trying to update node for track: '+this.path+' but it wasn\'t found.')},unbind:function unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(Op.prototype,{_getValue_unbound:Op.prototype.getValue,_setValue_unbound:Op.prototype.setValue}),Object.assign(Vp.prototype,{isAnimationObjectGroup:!0,add:function add(){for(var Eg=this._objects,bg=Eg.length,Tg=this.nCachedObjects_,Sg=this._indicesByUUID,Mg=this._paths,Ag=this._parsedPaths,wg=this._bindings,Rg=wg.length,Lg=0,Pg=arguments.length;Lg!==Pg;++Lg){var Cg=arguments[Lg],Ig=Cg.uuid,Ug=Sg[Ig],Dg=void 0;if(void 0===Ug){Ug=bg++,Sg[Ig]=Ug,Eg.push(Cg);for(var Ng=0,Bg=Rg;Ng!==Bg;++Ng)wg[Ng].push(new Op(Cg,Mg[Ng],Ag[Ng]))}else if(Ug<Tg){Dg=Eg[Ug];var Fg=--Tg,zg=Eg[Fg];Sg[zg.uuid]=Ug,Eg[Ug]=zg,Sg[Ig]=Fg,Eg[Fg]=Cg;for(var Ng=0,Bg=Rg;Ng!==Bg;++Ng){var Gg=wg[Ng],Hg=Gg[Fg],Og=Gg[Ug];Gg[Ug]=Hg,void 0===Og&&(Og=new Op(Cg,Mg[Ng],Ag[Ng])),Gg[Fg]=Og}}else Eg[Ug]!==Dg&&console.error('THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.')}this.nCachedObjects_=Tg},remove:function remove(){for(var Eg=this._objects,bg=this.nCachedObjects_,Tg=this._indicesByUUID,Sg=this._bindings,Mg=Sg.length,Ag=0,wg=arguments.length;Ag!==wg;++Ag){var Rg=arguments[Ag],Lg=Rg.uuid,Pg=Tg[Lg];if(void 0!==Pg&&Pg>=bg){var Cg=bg++,Ig=Eg[Cg];Tg[Ig.uuid]=Pg,Eg[Pg]=Ig,Tg[Lg]=Cg,Eg[Cg]=Rg;for(var Ug=0;Ug!==Mg;++Ug){var Ng=Sg[Ug],Bg=Ng[Cg],Fg=Ng[Pg];Ng[Pg]=Bg,Ng[Cg]=Fg}}}this.nCachedObjects_=bg},uncache:function uncache(){for(var Eg=this._objects,bg=Eg.length,Tg=this.nCachedObjects_,Sg=this._indicesByUUID,Mg=this._bindings,Ag=Mg.length,wg=0,Rg=arguments.length;wg!==Rg;++wg){var Lg=arguments[wg].uuid,Pg=Sg[Lg];if(void 0!==Pg)if(delete Sg[Lg],Pg<Tg){var Cg=--Tg,Ig=Eg[Cg],Ug=Eg[zg=--bg];Sg[Ig.uuid]=Pg,Eg[Pg]=Ig,Sg[Ug.uuid]=Cg,Eg[Cg]=Ug,Eg.pop();for(var Dg=0,Ng=Ag;Dg!==Ng;++Dg){var Bg=(Gg=Mg[Dg])[Cg],Fg=Gg[zg];Gg[Pg]=Bg,Gg[Cg]=Fg,Gg.pop()}}else{var zg=--bg;Sg[(Ug=Eg[zg]).uuid]=Pg,Eg[Pg]=Ug,Eg.pop();for(var Dg=0,Ng=Ag,Gg;Dg!==Ng;++Dg)Gg=Mg[Dg],Gg[Pg]=Gg[zg],Gg.pop()}}this.nCachedObjects_=Tg},subscribe_:function subscribe_(Eg,bg){var Tg=this._bindingsIndicesByPath,Sg=Tg[Eg],Mg=this._bindings;if(void 0!==Sg)return Mg[Sg];var Ag=this._paths,wg=this._parsedPaths,Rg=this._objects,Lg=Rg.length,Pg=this.nCachedObjects_,Cg=Array(Lg);Sg=Mg.length,Tg[Eg]=Sg,Ag.push(Eg),wg.push(bg),Mg.push(Cg);for(var Ig=Pg,Ug=Rg.length,Dg;Ig!==Ug;++Ig)Dg=Rg[Ig],Cg[Ig]=new Op(Dg,Eg,bg);return Cg},unsubscribe_:function unsubscribe_(Eg){var bg=this._bindingsIndicesByPath,Tg=bg[Eg];if(void 0!==Tg){var Sg=this._paths,Mg=this._parsedPaths,Ag=this._bindings,wg=Ag.length-1,Rg=Ag[wg];bg[Eg[wg]]=Tg,Ag[Tg]=Rg,Ag.pop(),Mg[Tg]=Mg[wg],Mg.pop(),Sg[Tg]=Sg[wg],Sg.pop()}}}),Object.assign(Wp.prototype,{play:function play(){return this._mixer._activateAction(this),this},stop:function stop(){return this._mixer._deactivateAction(this),this.reset()},reset:function reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function isScheduled(){return this._mixer._isActiveAction(this)},startAt:function startAt(Eg){return this._startTime=Eg,this},setLoop:function setLoop(Eg,bg){return this.loop=Eg,this.repetitions=bg,this},setEffectiveWeight:function setEffectiveWeight(Eg){return this.weight=Eg,this._effectiveWeight=this.enabled?Eg:0,this.stopFading()},getEffectiveWeight:function getEffectiveWeight(){return this._effectiveWeight},fadeIn:function fadeIn(Eg){return this._scheduleFading(Eg,0,1)},fadeOut:function fadeOut(Eg){return this._scheduleFading(Eg,1,0)},crossFadeFrom:function crossFadeFrom(Eg,bg,Tg){if(Eg.fadeOut(bg),this.fadeIn(bg),Tg){var Sg=this._clip.duration,Mg=Eg._clip.duration;Eg.warp(1,Mg/Sg,bg),this.warp(Sg/Mg,1,bg)}return this},crossFadeTo:function crossFadeTo(Eg,bg,Tg){return Eg.crossFadeFrom(this,bg,Tg)},stopFading:function stopFading(){var Eg=this._weightInterpolant;return null!==Eg&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(Eg)),this},setEffectiveTimeScale:function setEffectiveTimeScale(Eg){return this.timeScale=Eg,this._effectiveTimeScale=this.paused?0:Eg,this.stopWarping()},getEffectiveTimeScale:function getEffectiveTimeScale(){return this._effectiveTimeScale},setDuration:function setDuration(Eg){return this.timeScale=this._clip.duration/Eg,this.stopWarping()},syncWith:function syncWith(Eg){return this.time=Eg.time,this.timeScale=Eg.timeScale,this.stopWarping()},halt:function halt(Eg){return this.warp(this._effectiveTimeScale,0,Eg)},warp:function warp(Eg,bg,Tg){var Sg=this._mixer,Mg=Sg.time,Ag=this._timeScaleInterpolant,wg=this.timeScale;null===Ag&&(Ag=Sg._lendControlInterpolant(),this._timeScaleInterpolant=Ag);var Rg=Ag.parameterPositions,Lg=Ag.sampleValues;return Rg[0]=Mg,Rg[1]=Mg+Tg,Lg[0]=Eg/wg,Lg[1]=bg/wg,this},stopWarping:function stopWarping(){var Eg=this._timeScaleInterpolant;return null!==Eg&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(Eg)),this},getMixer:function getMixer(){return this._mixer},getClip:function getClip(){return this._clip},getRoot:function getRoot(){return this._localRoot||this._mixer._root},_update:function _update(Eg,bg,Tg,Sg){if(this.enabled){var Mg=this._startTime;if(null!==Mg){var Ag=(Eg-Mg)*Tg;if(0>Ag||0===Tg)return;this._startTime=null,bg=Tg*Ag}bg*=this._updateTimeScale(Eg);var wg=this._updateTime(bg),Rg=this._updateWeight(Eg);if(0<Rg)for(var Lg=this._interpolants,Pg=this._propertyBindings,Cg=0,Ig=Lg.length;Cg!==Ig;++Cg)Lg[Cg].evaluate(wg),Pg[Cg].accumulate(Sg,Rg)}else this._updateWeight(Eg)},_updateWeight:function _updateWeight(Eg){var bg=0;if(this.enabled){bg=this.weight;var Tg=this._weightInterpolant;if(null!==Tg){var Sg=Tg.evaluate(Eg)[0];bg*=Sg,Eg>Tg.parameterPositions[1]&&(this.stopFading(),0===Sg&&(this.enabled=!1))}}return this._effectiveWeight=bg,bg},_updateTimeScale:function _updateTimeScale(Eg){var bg=0;if(!this.paused){bg=this.timeScale;var Tg=this._timeScaleInterpolant;null!==Tg&&(bg*=Tg.evaluate(Eg)[0],Eg>Tg.parameterPositions[1]&&(this.stopWarping(),0===bg?this.paused=!0:this.timeScale=bg))}return this._effectiveTimeScale=bg,bg},_updateTime:function _updateTime(Eg){var bg=this.time+Eg;if(0===Eg)return bg;var Tg=this._clip.duration,Sg=this.loop,Mg=this._loopCount;if(2200===Sg){-1===Mg&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(bg>=Tg)bg=Tg;else{if(!(0>bg))break t;bg=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this._mixer.dispatchEvent({type:'finished',action:this,direction:0>Eg?-1:1})}}else{var Ag=2202===Sg;if(-1===Mg&&(0<=Eg?(Mg=0,this._setEndings(!0,0===this.repetitions,Ag)):this._setEndings(0===this.repetitions,!0,Ag)),bg>=Tg||0>bg){var wg=Math.floor(bg/Tg);bg-=Tg*wg,Mg+=Math.abs(wg);var Rg=this.repetitions-Mg;if(0>Rg)this.clampWhenFinished?this.paused=!0:this.enabled=!1,bg=0<Eg?Tg:0,this._mixer.dispatchEvent({type:'finished',action:this,direction:0<Eg?1:-1});else{if(0==Rg){var Lg=0>Eg;this._setEndings(Lg,!Lg,Ag)}else this._setEndings(!1,!1,Ag);this._loopCount=Mg,this._mixer.dispatchEvent({type:'loop',action:this,loopDelta:wg})}}if(Ag&&1==(1&Mg))return this.time=bg,Tg-bg}return this.time=bg,bg},_setEndings:function _setEndings(Eg,bg,Tg){var Sg=this._interpolantSettings;Tg?(Sg.endingStart=2401,Sg.endingEnd=2401):(Sg.endingStart=Eg?this.zeroSlopeAtStart?2401:vu:2402,Sg.endingEnd=bg?this.zeroSlopeAtEnd?2401:vu:2402)},_scheduleFading:function _scheduleFading(Eg,bg,Tg){var Sg=this._mixer,Mg=Sg.time,Ag=this._weightInterpolant;null===Ag&&(Ag=Sg._lendControlInterpolant(),this._weightInterpolant=Ag);var wg=Ag.parameterPositions,Rg=Ag.sampleValues;return wg[0]=Mg,Rg[0]=bg,wg[1]=Mg+Eg,Rg[1]=Tg,this}}),Object.assign(kp.prototype,Fo.prototype,{_bindAction:function _bindAction(Eg,bg){var Tg=Eg._localRoot||this._root,Sg=Eg._clip.tracks,Mg=Sg.length,Ag=Eg._propertyBindings,wg=Eg._interpolants,Rg=Tg.uuid,Lg=this._bindingsByRootAndName,Pg=Lg[Rg];void 0===Pg&&(Pg={},Lg[Rg]=Pg);for(var Cg=0;Cg!==Mg;++Cg){var Ig=Sg[Cg],Ug=Ig.name,Dg=Pg[Ug];if(void 0!==Dg)Ag[Cg]=Dg;else{if(void 0!==(Dg=Ag[Cg])){null===Dg._cacheIndex&&(++Dg.referenceCount,this._addInactiveBinding(Dg,Rg,Ug));continue}var Ng=bg&&bg._propertyBindings[Cg].binding.parsedPath;++(Dg=new Gp(Op.create(Tg,Ug,Ng),Ig.ValueTypeName,Ig.getValueSize())).referenceCount,this._addInactiveBinding(Dg,Rg,Ug),Ag[Cg]=Dg}wg[Cg].resultBuffer=Dg.buffer}},_activateAction:function _activateAction(Eg){if(!this._isActiveAction(Eg)){if(null===Eg._cacheIndex){var bg=(Eg._localRoot||this._root).uuid,Tg=Eg._clip.uuid,Sg=this._actionsByClip[Tg];this._bindAction(Eg,Sg&&Sg.knownActions[0]),this._addInactiveAction(Eg,Tg,bg)}for(var Mg=Eg._propertyBindings,Ag=0,wg=Mg.length,Rg;Ag!==wg;++Ag)Rg=Mg[Ag],0==Rg.useCount++&&(this._lendBinding(Rg),Rg.saveOriginalState());this._lendAction(Eg)}},_deactivateAction:function _deactivateAction(Eg){if(this._isActiveAction(Eg)){for(var bg=Eg._propertyBindings,Tg=0,Sg=bg.length,Mg;Tg!==Sg;++Tg)Mg=bg[Tg],0==--Mg.useCount&&(Mg.restoreOriginalState(),this._takeBackBinding(Mg));this._takeBackAction(Eg)}},_initMemoryManager:function _initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var Eg=this;this.stats={actions:{get total(){return Eg._actions.length},get inUse(){return Eg._nActiveActions}},bindings:{get total(){return Eg._bindings.length},get inUse(){return Eg._nActiveBindings}},controlInterpolants:{get total(){return Eg._controlInterpolants.length},get inUse(){return Eg._nActiveControlInterpolants}}}},_isActiveAction:function _isActiveAction(Eg){var bg=Eg._cacheIndex;return null!==bg&&bg<this._nActiveActions},_addInactiveAction:function _addInactiveAction(Eg,bg,Tg){var Sg=this._actions,Mg=this._actionsByClip,Ag=Mg[bg];if(void 0===Ag)Ag={knownActions:[Eg],actionByRoot:{}},Eg._byClipCacheIndex=0,Mg[bg]=Ag;else{var wg=Ag.knownActions;Eg._byClipCacheIndex=wg.length,wg.push(Eg)}Eg._cacheIndex=Sg.length,Sg.push(Eg),Ag.actionByRoot[Tg]=Eg},_removeInactiveAction:function _removeInactiveAction(Eg){var bg=this._actions,Tg=bg[bg.length-1],Sg=Eg._cacheIndex;Tg._cacheIndex=Sg,bg[Sg]=Tg,bg.pop(),Eg._cacheIndex=null;var Mg=Eg._clip.uuid,Ag=this._actionsByClip,wg=Ag[Mg],Rg=wg.knownActions,Lg=Rg[Rg.length-1],Pg=Eg._byClipCacheIndex;Lg._byClipCacheIndex=Pg,Rg[Pg]=Lg,Rg.pop(),Eg._byClipCacheIndex=null,delete wg.actionByRoot[(Eg._localRoot||this._root).uuid],0===Rg.length&&delete Ag[Mg],this._removeInactiveBindingsForAction(Eg)},_removeInactiveBindingsForAction:function _removeInactiveBindingsForAction(Eg){for(var bg=Eg._propertyBindings,Tg=0,Sg=bg.length,Mg;Tg!==Sg;++Tg)Mg=bg[Tg],0==--Mg.referenceCount&&this._removeInactiveBinding(Mg)},_lendAction:function _lendAction(Eg){var bg=this._actions,Tg=Eg._cacheIndex,Sg=this._nActiveActions++,Mg=bg[Sg];Eg._cacheIndex=Sg,bg[Sg]=Eg,Mg._cacheIndex=Tg,bg[Tg]=Mg},_takeBackAction:function _takeBackAction(Eg){var bg=this._actions,Tg=Eg._cacheIndex,Sg=--this._nActiveActions,Mg=bg[Sg];Eg._cacheIndex=Sg,bg[Sg]=Eg,Mg._cacheIndex=Tg,bg[Tg]=Mg},_addInactiveBinding:function _addInactiveBinding(Eg,bg,Tg){var Sg=this._bindingsByRootAndName,Mg=Sg[bg],Ag=this._bindings;void 0===Mg&&(Mg={},Sg[bg]=Mg),Mg[Tg]=Eg,Eg._cacheIndex=Ag.length,Ag.push(Eg)},_removeInactiveBinding:function _removeInactiveBinding(Eg){var bg=this._bindings,Tg=Eg.binding,Sg=Tg.rootNode.uuid,Mg=Tg.path,Ag=this._bindingsByRootAndName,wg=Ag[Sg],Rg=bg[bg.length-1],Lg=Eg._cacheIndex;Rg._cacheIndex=Lg,bg[Lg]=Rg,bg.pop(),delete wg[Mg];t:{for(var Pg in wg)break t;delete Ag[Sg]}},_lendBinding:function _lendBinding(Eg){var bg=this._bindings,Tg=Eg._cacheIndex,Sg=this._nActiveBindings++,Mg=bg[Sg];Eg._cacheIndex=Sg,bg[Sg]=Eg,Mg._cacheIndex=Tg,bg[Tg]=Mg},_takeBackBinding:function _takeBackBinding(Eg){var bg=this._bindings,Tg=Eg._cacheIndex,Sg=--this._nActiveBindings,Mg=bg[Sg];Eg._cacheIndex=Sg,bg[Sg]=Eg,Mg._cacheIndex=Tg,bg[Tg]=Mg},_lendControlInterpolant:function _lendControlInterpolant(){var Eg=this._controlInterpolants,bg=this._nActiveControlInterpolants++,Tg=Eg[bg];return void 0===Tg&&((Tg=new tp(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=bg,Eg[bg]=Tg),Tg},_takeBackControlInterpolant:function _takeBackControlInterpolant(Eg){var bg=this._controlInterpolants,Tg=Eg.__cacheIndex,Sg=--this._nActiveControlInterpolants,Mg=bg[Sg];Eg.__cacheIndex=Sg,bg[Sg]=Eg,Mg.__cacheIndex=Tg,bg[Tg]=Mg},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function clipAction(Eg,bg){var Tg=bg||this._root,Sg=Tg.uuid,Mg='string'==typeof Eg?mp.findByName(Tg,Eg):Eg,Ag=null===Mg?Eg:Mg.uuid,wg=this._actionsByClip[Ag],Rg=null;if(void 0!==wg){var Lg=wg.actionByRoot[Sg];if(void 0!==Lg)return Lg;Rg=wg.knownActions[0],null===Mg&&(Mg=Rg._clip)}if(null===Mg)return null;var Pg=new Wp(this,Mg,bg);return this._bindAction(Pg,Rg),this._addInactiveAction(Pg,Ag,Sg),Pg},existingAction:function existingAction(Eg,bg){var Tg=bg||this._root,Sg=Tg.uuid,Mg='string'==typeof Eg?mp.findByName(Tg,Eg):Eg,Ag=Mg?Mg.uuid:Eg,wg=this._actionsByClip[Ag];return void 0===wg?null:wg.actionByRoot[Sg]||null},stopAllAction:function stopAllAction(){var Eg=this._actions,bg=this._nActiveActions,Tg=this._bindings,Sg=this._nActiveBindings;for(this._nActiveActions=0,this._nActiveBindings=0,Mg=0;Mg!==bg;++Mg)Eg[Mg].reset();for(var Mg=0;Mg!==Sg;++Mg)Tg[Mg].useCount=0;return this},update:function update(Eg){Eg*=this.timeScale;for(var bg=this._actions,Tg=this._nActiveActions,Sg=this.time+=Eg,Mg=Math.sign(Eg),Ag=this._accuIndex^=1,wg=0;wg!==Tg;++wg)bg[wg]._update(Sg,Eg,Mg,Ag);for(var Rg=this._bindings,Lg=this._nActiveBindings,wg=0;wg!==Lg;++wg)Rg[wg].apply(Ag);return this},getRoot:function getRoot(){return this._root},uncacheClip:function uncacheClip(Eg){var bg=this._actions,Tg=Eg.uuid,Sg=this._actionsByClip,Mg=Sg[Tg];if(void 0!==Mg){for(var Ag=Mg.knownActions,wg=0,Rg=Ag.length,Lg;wg!==Rg;++wg){Lg=Ag[wg],this._deactivateAction(Lg);var Pg=Lg._cacheIndex,Cg=bg[bg.length-1];Lg._cacheIndex=null,Lg._byClipCacheIndex=null,Cg._cacheIndex=Pg,bg[Pg]=Cg,bg.pop(),this._removeInactiveBindingsForAction(Lg)}delete Sg[Tg]}},uncacheRoot:function uncacheRoot(Eg){var bg=Eg.uuid,Tg=this._actionsByClip;for(var Sg in Tg){var Mg=Tg[Sg].actionByRoot[bg];void 0!==Mg&&(this._deactivateAction(Mg),this._removeInactiveAction(Mg))}var Ag=this._bindingsByRootAndName[bg];if(void 0!==Ag)for(var wg in Ag){var Rg=Ag[wg];Rg.restoreOriginalState(),this._removeInactiveBinding(Rg)}},uncacheAction:function uncacheAction(Eg,bg){var Tg=this.existingAction(Eg,bg);null!==Tg&&(this._deactivateAction(Tg),this._removeInactiveAction(Tg))}}),Xp.prototype.clone=function(){return new Xp(void 0===this.value.clone?this.value:this.value.clone())},jp.prototype=Object.assign(Object.create(dl.prototype),{constructor:jp,isInstancedBufferGeometry:!0,copy:function copy(Eg){return dl.prototype.copy.call(this,Eg),this.maxInstancedCount=Eg.maxInstancedCount,this},clone:function clone(){return new this.constructor().copy(this)}}),Object.defineProperties(Yp.prototype,{count:{get:function get(){return this.data.count}},array:{get:function get(){return this.data.array}}}),Object.assign(Yp.prototype,{isInterleavedBufferAttribute:!0,setX:function setX(Eg,bg){return this.data.array[Eg*this.data.stride+this.offset]=bg,this},setY:function setY(Eg,bg){return this.data.array[Eg*this.data.stride+this.offset+1]=bg,this},setZ:function setZ(Eg,bg){return this.data.array[Eg*this.data.stride+this.offset+2]=bg,this},setW:function setW(Eg,bg){return this.data.array[Eg*this.data.stride+this.offset+3]=bg,this},getX:function getX(Eg){return this.data.array[Eg*this.data.stride+this.offset]},getY:function getY(Eg){return this.data.array[Eg*this.data.stride+this.offset+1]},getZ:function getZ(Eg){return this.data.array[Eg*this.data.stride+this.offset+2]},getW:function getW(Eg){return this.data.array[Eg*this.data.stride+this.offset+3]},setXY:function setXY(Eg,bg,Tg){return Eg=Eg*this.data.stride+this.offset,this.data.array[Eg+0]=bg,this.data.array[Eg+1]=Tg,this},setXYZ:function setXYZ(Eg,bg,Tg,Sg){return Eg=Eg*this.data.stride+this.offset,this.data.array[Eg+0]=bg,this.data.array[Eg+1]=Tg,this.data.array[Eg+2]=Sg,this},setXYZW:function setXYZW(Eg,bg,Tg,Sg,Mg){return Eg=Eg*this.data.stride+this.offset,this.data.array[Eg+0]=bg,this.data.array[Eg+1]=Tg,this.data.array[Eg+2]=Sg,this.data.array[Eg+3]=Mg,this}}),Object.defineProperty(qp.prototype,'needsUpdate',{set:function set(Eg){!0===Eg&&this.version++}}),Object.assign(qp.prototype,{isInterleavedBuffer:!0,setArray:function setArray(Eg){if(Array.isArray(Eg))throw new TypeError('THREE.BufferAttribute: array should be a Typed Array.');this.count=void 0===Eg?0:Eg.length/this.stride,this.array=Eg},setDynamic:function setDynamic(Eg){return this.dynamic=Eg,this},copy:function copy(Eg){return this.array=new Eg.array.constructor(Eg.array),this.count=Eg.count,this.stride=Eg.stride,this.dynamic=Eg.dynamic,this},copyAt:function copyAt(Eg,bg,Tg){Eg*=this.stride,Tg*=bg.stride;for(var Sg=0,Mg=this.stride;Sg<Mg;Sg++)this.array[Eg+Sg]=bg.array[Tg+Sg];return this},set:function set(Eg,bg){return void 0===bg&&(bg=0),this.array.set(Eg,bg),this},clone:function clone(){return new this.constructor().copy(this)},onUpload:function onUpload(Eg){return this.onUploadCallback=Eg,this}}),Zp.prototype=Object.assign(Object.create(qp.prototype),{constructor:Zp,isInstancedInterleavedBuffer:!0,copy:function copy(Eg){return qp.prototype.copy.call(this,Eg),this.meshPerAttribute=Eg.meshPerAttribute,this}}),Jp.prototype=Object.assign(Object.create(Qs.prototype),{constructor:Jp,isInstancedBufferAttribute:!0,copy:function copy(Eg){return Qs.prototype.copy.call(this,Eg),this.meshPerAttribute=Eg.meshPerAttribute,this}}),Object.assign(Qp.prototype,{linePrecision:1,set:function set(Eg,bg){this.ray.set(Eg,bg)},setFromCamera:function setFromCamera(Eg,bg){bg&&bg.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(bg.matrixWorld),this.ray.direction.set(Eg.x,Eg.y,.5).unproject(bg).sub(this.ray.origin).normalize()):bg&&bg.isOrthographicCamera?(this.ray.origin.set(Eg.x,Eg.y,(bg.near+bg.far)/(bg.near-bg.far)).unproject(bg),this.ray.direction.set(0,0,-1).transformDirection(bg.matrixWorld)):console.error('THREE.Raycaster: Unsupported camera type.')},intersectObject:function intersectObject(Eg,bg){var Tg=[];return $p(Eg,this,Tg,bg),Tg.sort(Kp),Tg},intersectObjects:function intersectObjects(Eg,bg){var Tg=[];if(!1===Array.isArray(Eg))return console.warn('THREE.Raycaster.intersectObjects: objects is not an Array.'),Tg;for(var Sg=0,Mg=Eg.length;Sg<Mg;Sg++)$p(Eg[Sg],this,Tg,bg);return Tg.sort(Kp),Tg}}),Object.assign(ec.prototype,{start:function start(){this.startTime=('undefined'==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function getElapsedTime(){return this.getDelta(),this.elapsedTime},getDelta:function getDelta(){var Eg=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var bg=('undefined'==typeof performance?Date:performance).now();Eg=(bg-this.oldTime)/1e3,this.oldTime=bg,this.elapsedTime+=Eg}return Eg}}),Object.assign(tc.prototype,{set:function set(Eg,bg,Tg){return this.radius=Eg,this.phi=bg,this.theta=Tg,this},clone:function clone(){return new this.constructor().copy(this)},copy:function copy(Eg){return this.radius=Eg.radius,this.phi=Eg.phi,this.theta=Eg.theta,this},makeSafe:function makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function setFromVector3(Eg){return this.radius=Eg.length(),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(Eg.x,Eg.z),this.phi=Math.acos(Iu.clamp(Eg.y/this.radius,-1,1))),this}}),Object.assign(rc.prototype,{set:function set(Eg,bg,Tg){return this.radius=Eg,this.theta=bg,this.y=Tg,this},clone:function clone(){return new this.constructor().copy(this)},copy:function copy(Eg){return this.radius=Eg.radius,this.theta=Eg.theta,this.y=Eg.y,this},setFromVector3:function setFromVector3(Eg){return this.radius=Math.sqrt(Eg.x*Eg.x+Eg.z*Eg.z),this.theta=Math.atan2(Eg.x,Eg.z),this.y=Eg.y,this}}),(ac.prototype=Object.create(js.prototype)).constructor=ac,ac.prototype.isImmediateRenderObject=!0,(ic.prototype=Object.create($l.prototype)).constructor=ic,ic.prototype.update=function(){var Eg=new Wo,bg=new Wo,Tg=new Xo;return function(){var Sg=['a','b','c'];this.object.updateMatrixWorld(!0),Tg.getNormalMatrix(this.object.matrixWorld);var Mg=this.object.matrixWorld,Ag=this.geometry.attributes.position,wg=this.object.geometry;if(wg&&wg.isGeometry)for(var Rg=wg.vertices,Lg=wg.faces,Pg=0,Cg=0,Ig=Lg.length;Cg<Ig;Cg++)for(var Ug=Lg[Cg],Dg=0,Ng=Ug.vertexNormals.length;Dg<Ng;Dg++){var Bg=Rg[Ug[Sg[Dg]]],Fg=Ug.vertexNormals[Dg];Eg.copy(Bg).applyMatrix4(Mg),bg.copy(Fg).applyMatrix3(Tg).normalize().multiplyScalar(this.size).add(Eg),Ag.setXYZ(Pg,Eg.x,Eg.y,Eg.z),Pg+=1,Ag.setXYZ(Pg,bg.x,bg.y,bg.z),Pg+=1}else if(wg&&wg.isBufferGeometry)for(var zg=wg.attributes.position,Gg=wg.attributes.normal,Pg=0,Dg=0,Ng=zg.count;f<p;Dg++)Eg.set(zg.getX(Dg),zg.getY(Dg),zg.getZ(Dg)).applyMatrix4(Mg),bg.set(Gg.getX(Dg),Gg.getY(Dg),Gg.getZ(Dg)),bg.applyMatrix3(Tg).normalize().multiplyScalar(this.size).add(Eg),Ag.setXYZ(Pg,Eg.x,Eg.y,Eg.z),Pg+=1,Ag.setXYZ(Pg,bg.x,bg.y,bg.z),Pg+=1;Ag.needsUpdate=!0}}(),(oc.prototype=Object.create(js.prototype)).constructor=oc,oc.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},oc.prototype.update=function(){var Eg=new Wo,bg=new Wo;return function(){this.light.updateMatrixWorld();var Tg=this.light.distance?this.light.distance:1e3,Sg=Tg*Math.tan(this.light.angle);this.cone.scale.set(Sg,Sg,Tg),Eg.setFromMatrixPosition(this.light.matrixWorld),bg.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(bg.sub(Eg)),void 0===this.color?this.cone.material.color.copy(this.light.color):this.cone.material.color.set(this.color)}}(),(sc.prototype=Object.create($l.prototype)).constructor=sc,sc.prototype.updateMatrixWorld=function(){var Eg=new Wo,bg=new Ho,Tg=new Ho;return function(Sg){var Mg=this.bones,Ag=this.geometry,wg=Ag.getAttribute('position');Tg.getInverse(this.root.matrixWorld);for(var Rg=0,Lg=0,Pg;Rg<Mg.length;Rg++)Pg=Mg[Rg],Pg.parent&&Pg.parent.isBone&&(bg.multiplyMatrices(Tg,Pg.matrixWorld),Eg.setFromMatrixPosition(bg),wg.setXYZ(Lg,Eg.x,Eg.y,Eg.z),bg.multiplyMatrices(Tg,Pg.parent.matrixWorld),Eg.setFromMatrixPosition(bg),wg.setXYZ(Lg+1,Eg.x,Eg.y,Eg.z),Lg+=2);Ag.getAttribute('position').needsUpdate=!0,js.prototype.updateMatrixWorld.call(this,Sg)}}(),(lc.prototype=Object.create(El.prototype)).constructor=lc,lc.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},lc.prototype.update=function(){void 0===this.color?this.material.color.copy(this.light.color):this.material.color.set(this.color)},(dc.prototype=Object.create(js.prototype)).constructor=dc,dc.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},dc.prototype.update=function(){var Eg=.5*this.light.width,bg=.5*this.light.height,Tg=this.line.geometry.attributes.position,Sg=Tg.array;Sg[0]=Eg,Sg[1]=-bg,Sg[2]=0,Sg[3]=Eg,Sg[4]=bg,Sg[5]=0,Sg[6]=-Eg,Sg[7]=bg,Sg[8]=0,Sg[9]=-Eg,Sg[10]=-bg,Sg[11]=0,Sg[12]=Eg,Sg[13]=-bg,Sg[14]=0,Tg.needsUpdate=!0,void 0===this.color?this.line.material.color.copy(this.light.color):this.line.material.color.set(this.color)},(pc.prototype=Object.create(js.prototype)).constructor=pc,pc.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},pc.prototype.update=function(){var Eg=new Wo,bg=new Ps,Tg=new Ps;return function(){var Sg=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var Mg=Sg.geometry.getAttribute('color');bg.copy(this.light.color),Tg.copy(this.light.groundColor);for(var Ag=0,wg=Mg.count,Rg;Ag<wg;Ag++)Rg=Ag<wg/2?bg:Tg,Mg.setXYZ(Ag,Rg.r,Rg.g,Rg.b);Mg.needsUpdate=!0}Sg.lookAt(Eg.setFromMatrixPosition(this.light.matrixWorld).negate())}}(),(cc.prototype=Object.create($l.prototype)).constructor=cc,(mc.prototype=Object.create($l.prototype)).constructor=mc,(uc.prototype=Object.create($l.prototype)).constructor=uc,uc.prototype.update=function(){var Eg=new Wo,bg=new Wo,Tg=new Xo;return function(){this.object.updateMatrixWorld(!0),Tg.getNormalMatrix(this.object.matrixWorld);for(var Sg=this.object.matrixWorld,Mg=this.geometry.attributes.position,Ag=this.object.geometry,wg=Ag.vertices,Rg=Ag.faces,Lg=0,Pg=0,Cg=Rg.length;Pg<Cg;Pg++){var Ig=Rg[Pg],Ug=Ig.normal;Eg.copy(wg[Ig.a]).add(wg[Ig.b]).add(wg[Ig.c]).divideScalar(3).applyMatrix4(Sg),bg.copy(Ug).applyMatrix3(Tg).normalize().multiplyScalar(this.size).add(Eg),Mg.setXYZ(Lg,Eg.x,Eg.y,Eg.z),Lg+=1,Mg.setXYZ(Lg,bg.x,bg.y,bg.z),Lg+=1}Mg.needsUpdate=!0}}(),(gc.prototype=Object.create(js.prototype)).constructor=gc,gc.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},gc.prototype.update=function(){var Eg=new Wo,bg=new Wo,Tg=new Wo;return function(){Eg.setFromMatrixPosition(this.light.matrixWorld),bg.setFromMatrixPosition(this.light.target.matrixWorld),Tg.subVectors(bg,Eg),this.lightPlane.lookAt(Tg),void 0===this.color?(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)):(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)),this.targetLine.lookAt(Tg),this.targetLine.scale.z=Tg.length()}}(),(fc.prototype=Object.create($l.prototype)).constructor=fc,fc.prototype.update=function(){function Eg(Ag,wg,Rg,Lg){Sg.set(wg,Rg,Lg).unproject(Mg);var Pg=Tg[Ag];if(void 0!==Pg)for(var Cg=bg.getAttribute('position'),Ig=0,Ug=Pg.length;Ig<Ug;Ig++)Cg.setXYZ(Pg[Ig],Sg.x,Sg.y,Sg.z)}var Sg=new Wo,Mg=new Ys,bg,Tg;return function(){bg=this.geometry,Tg=this.pointMap,Mg.projectionMatrix.copy(this.camera.projectionMatrix),Eg('c',0,0,-1),Eg('t',0,0,1),Eg('n1',-1,-1,-1),Eg('n2',1,-1,-1),Eg('n3',-1,1,-1),Eg('n4',1,1,-1),Eg('f1',-1,-1,1),Eg('f2',1,-1,1),Eg('f3',-1,1,1),Eg('f4',1,1,1),Eg('u1',.7,1.1,-1),Eg('u2',-.7,1.1,-1),Eg('u3',0,2,-1),Eg('cf1',-1,0,1),Eg('cf2',1,0,1),Eg('cf3',0,-1,1),Eg('cf4',0,1,1),Eg('cn1',-1,0,-1),Eg('cn2',1,0,-1),Eg('cn3',0,-1,-1),Eg('cn4',0,1,-1),bg.getAttribute('position').needsUpdate=!0}}(),(hc.prototype=Object.create($l.prototype)).constructor=hc,hc.prototype.update=function(){var Eg=new zs;return function(bg){if(void 0!==bg&&console.warn('THREE.BoxHelper: .update() has no longer arguments.'),void 0!==this.object&&Eg.setFromObject(this.object),!Eg.isEmpty()){var Tg=Eg.min,Sg=Eg.max,Mg=this.geometry.attributes.position,Ag=Mg.array;Ag[0]=Sg.x,Ag[1]=Sg.y,Ag[2]=Sg.z,Ag[3]=Tg.x,Ag[4]=Sg.y,Ag[5]=Sg.z,Ag[6]=Tg.x,Ag[7]=Tg.y,Ag[8]=Sg.z,Ag[9]=Sg.x,Ag[10]=Tg.y,Ag[11]=Sg.z,Ag[12]=Sg.x,Ag[13]=Sg.y,Ag[14]=Tg.z,Ag[15]=Tg.x,Ag[16]=Sg.y,Ag[17]=Tg.z,Ag[18]=Tg.x,Ag[19]=Tg.y,Ag[20]=Tg.z,Ag[21]=Sg.x,Ag[22]=Tg.y,Ag[23]=Tg.z,Mg.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}(),hc.prototype.setFromObject=function(Eg){return this.object=Eg,this.update(),this},(yc.prototype=Object.create($l.prototype)).constructor=yc,yc.prototype.updateMatrixWorld=function(Eg){var bg=this.box;bg.isEmpty()||(bg.getCenter(this.position),bg.getSize(this.scale),this.scale.multiplyScalar(.5),js.prototype.updateMatrixWorld.call(this,Eg))},(xc.prototype=Object.create(Kl.prototype)).constructor=xc,xc.prototype.updateMatrixWorld=function(Eg){var bg=-this.plane.constant;1e-8>Math.abs(bg)&&(bg=1e-8),this.scale.set(.5*this.size,.5*this.size,bg),this.lookAt(this.plane.normal),js.prototype.updateMatrixWorld.call(this,Eg)};var mg,ug;(vc.prototype=Object.create(js.prototype)).constructor=vc,vc.prototype.setDirection=function(){var bg=new Wo,Eg;return function(Tg){.99999<Tg.y?this.quaternion.set(0,0,0,1):-.99999>Tg.y?this.quaternion.set(1,0,0,0):(bg.set(Tg.z,0,-Tg.x).normalize(),Eg=Math.acos(Tg.y),this.quaternion.setFromAxisAngle(bg,Eg))}}(),vc.prototype.setLength=function(Eg,bg,Tg){void 0===bg&&(bg=.2*Eg),void 0===Tg&&(Tg=.2*bg),this.line.scale.set(1,Math.max(0,Eg-bg),1),this.line.updateMatrix(),this.cone.scale.set(Tg,bg,Tg),this.cone.position.y=Eg,this.cone.updateMatrix()},vc.prototype.setColor=function(Eg){this.line.material.color.copy(Eg),this.cone.material.color.copy(Eg)},(_c.prototype=Object.create($l.prototype)).constructor=_c;var gg=new Wo,fg=new Ec,hg=new Ec,yg=new Ec;(bc.prototype=Object.create(Ep.prototype)).constructor=bc,bc.prototype.isCatmullRomCurve3=!0,bc.prototype.getPoint=function(Eg,bg){var Tg=bg||new Wo,Sg=this.points,Mg=Sg.length,Ag=(Mg-(this.closed?0:1))*Eg,wg=Math.floor(Ag),Rg=Ag-wg;this.closed?wg+=0<wg?0:(Math.floor(Math.abs(wg)/Sg.length)+1)*Sg.length:0==Rg&&wg===Mg-1&&(wg=Mg-2,Rg=1);var Lg,Pg,Cg,Ig;if(this.closed||0<wg?Lg=Sg[(wg-1)%Mg]:(gg.subVectors(Sg[0],Sg[1]).add(Sg[0]),Lg=gg),Pg=Sg[wg%Mg],Cg=Sg[(wg+1)%Mg],this.closed||wg+2<Mg?Ig=Sg[(wg+2)%Mg]:(gg.subVectors(Sg[Mg-1],Sg[Mg-2]).add(Sg[Mg-1]),Ig=gg),void 0===this.type||'centripetal'===this.type||'chordal'===this.type){var Ug='chordal'===this.type?.5:.25,Dg=Math.pow(Lg.distanceToSquared(Pg),Ug),Ng=Math.pow(Pg.distanceToSquared(Cg),Ug),Bg=Math.pow(Cg.distanceToSquared(Ig),Ug);1e-4>Ng&&(Ng=1),1e-4>Dg&&(Dg=Ng),1e-4>Bg&&(Bg=Ng),fg.initNonuniformCatmullRom(Lg.x,Pg.x,Cg.x,Ig.x,Dg,Ng,Bg),hg.initNonuniformCatmullRom(Lg.y,Pg.y,Cg.y,Ig.y,Dg,Ng,Bg),yg.initNonuniformCatmullRom(Lg.z,Pg.z,Cg.z,Ig.z,Dg,Ng,Bg)}else if('catmullrom'===this.type){var Fg=void 0===this.tension?.5:this.tension;fg.initCatmullRom(Lg.x,Pg.x,Cg.x,Ig.x,Fg),hg.initCatmullRom(Lg.y,Pg.y,Cg.y,Ig.y,Fg),yg.initCatmullRom(Lg.z,Pg.z,Cg.z,Ig.z,Fg)}return Tg.set(fg.calc(Rg),hg.calc(Rg),yg.calc(Rg)),Tg},(Tc.prototype=Object.create(Ep.prototype)).constructor=Tc,Tc.prototype.isCubicBezierCurve3=!0,Tc.prototype.getPoint=function(Eg,bg){var Tg=bg||new Wo,Sg=this.v0,Mg=this.v1,Ag=this.v2,wg=this.v3;return Tg.set(_p(Eg,Sg.x,Mg.x,Ag.x,wg.x),_p(Eg,Sg.y,Mg.y,Ag.y,wg.y),_p(Eg,Sg.z,Mg.z,Ag.z,wg.z)),Tg},(Sc.prototype=Object.create(Ep.prototype)).constructor=Sc,Sc.prototype.isQuadraticBezierCurve3=!0,Sc.prototype.getPoint=function(Eg,bg){var Tg=bg||new Wo,Sg=this.v0,Mg=this.v1,Ag=this.v2;return Tg.set(vp(Eg,Sg.x,Mg.x,Ag.x),vp(Eg,Sg.y,Mg.y,Ag.y),vp(Eg,Sg.z,Mg.z,Ag.z)),Tg},(Mc.prototype=Object.create(Ep.prototype)).constructor=Mc,Mc.prototype.isLineCurve3=!0,Mc.prototype.getPoint=function(Eg,bg){var Tg=bg||new Wo;return 1===Eg?Tg.copy(this.v2):(Tg.copy(this.v2).sub(this.v1),Tg.multiplyScalar(Eg).add(this.v1)),Tg},Mc.prototype.getPointAt=function(Eg,bg){return this.getPoint(Eg,bg)},(Ac.prototype=Object.create(Sp.prototype)).constructor=Ac,Ac.prototype.isArcCurve=!0;Ep.create=function(Eg,bg){return console.log('THREE.Curve.create() has been deprecated'),Eg.prototype=Object.create(Ep.prototype),Eg.prototype.constructor=Eg,Eg.prototype.getPoint=bg,Eg},Object.assign(Tp.prototype,{createPointsGeometry:function createPointsGeometry(Eg){console.warn('THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.');var bg=this.getPoints(Eg);return this.createGeometry(bg)},createSpacedPointsGeometry:function createSpacedPointsGeometry(Eg){console.warn('THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.');var bg=this.getSpacedPoints(Eg);return this.createGeometry(bg)},createGeometry:function createGeometry(Eg){console.warn('THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.');for(var bg=new Js,Tg=0,Sg=Eg.length,Mg;Tg<Sg;Tg++)Mg=Eg[Tg],bg.vertices.push(new Wo(Mg.x,Mg.y,Mg.z||0));return bg}}),wc.prototype=Object.create(bc.prototype),Rc.prototype=Object.create(bc.prototype),Lc.prototype=Object.create(bc.prototype),Object.assign(Lc.prototype,{initFromArray:function initFromArray(){console.error('THREE.Spline: .initFromArray() has been removed.')},getControlPointsArray:function getControlPointsArray(){console.error('THREE.Spline: .getControlPointsArray() has been removed.')},reparametrizeByArcLength:function reparametrizeByArcLength(){console.error('THREE.Spline: .reparametrizeByArcLength() has been removed.')}}),cc.prototype.setColors=function(){console.error('THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.')},sc.prototype.update=function(){console.error('THREE.SkeletonHelper: update() no longer needs to be called.')},Object.assign(Cs.prototype,{center:function center(Eg){return console.warn('THREE.Box2: .center() has been renamed to .getCenter().'),this.getCenter(Eg)},empty:function empty(){return console.warn('THREE.Box2: .empty() has been renamed to .isEmpty().'),this.isEmpty()},isIntersectionBox:function isIntersectionBox(Eg){return console.warn('THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox().'),this.intersectsBox(Eg)},size:function size(Eg){return console.warn('THREE.Box2: .size() has been renamed to .getSize().'),this.getSize(Eg)}}),Object.assign(zs.prototype,{center:function center(Eg){return console.warn('THREE.Box3: .center() has been renamed to .getCenter().'),this.getCenter(Eg)},empty:function empty(){return console.warn('THREE.Box3: .empty() has been renamed to .isEmpty().'),this.isEmpty()},isIntersectionBox:function isIntersectionBox(Eg){return console.warn('THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox().'),this.intersectsBox(Eg)},isIntersectionSphere:function isIntersectionSphere(Eg){return console.warn('THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere().'),this.intersectsSphere(Eg)},size:function size(Eg){return console.warn('THREE.Box3: .size() has been renamed to .getSize().'),this.getSize(Eg)}}),vl.prototype.center=function(Eg){return console.warn('THREE.Line3: .center() has been renamed to .getCenter().'),this.getCenter(Eg)},Object.assign(Iu,{random16:function random16(){return console.warn('THREE.Math: .random16() has been deprecated. Use Math.random() instead.'),Math.random()},nearestPowerOfTwo:function nearestPowerOfTwo(Eg){return console.warn('THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo().'),Iu.floorPowerOfTwo(Eg)},nextPowerOfTwo:function nextPowerOfTwo(Eg){return console.warn('THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo().'),Iu.ceilPowerOfTwo(Eg)}}),Object.assign(Xo.prototype,{flattenToArrayOffset:function flattenToArrayOffset(Eg,bg){return console.warn('THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead.'),this.toArray(Eg,bg)},multiplyVector3:function multiplyVector3(Eg){return console.warn('THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead.'),Eg.applyMatrix3(this)},multiplyVector3Array:function multiplyVector3Array(){console.error('THREE.Matrix3: .multiplyVector3Array() has been removed.')},applyToBuffer:function applyToBuffer(Eg){return console.warn('THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead.'),this.applyToBufferAttribute(Eg)},applyToVector3Array:function applyToVector3Array(){console.error('THREE.Matrix3: .applyToVector3Array() has been removed.')}}),Object.assign(Ho.prototype,{extractPosition:function extractPosition(Eg){return console.warn('THREE.Matrix4: .extractPosition() has been renamed to .copyPosition().'),this.copyPosition(Eg)},flattenToArrayOffset:function flattenToArrayOffset(Eg,bg){return console.warn('THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead.'),this.toArray(Eg,bg)},getPosition:function(){var Eg;return function(){return void 0==Eg&&(Eg=new Wo),console.warn('THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.'),Eg.setFromMatrixColumn(this,3)}}(),setRotationFromQuaternion:function setRotationFromQuaternion(Eg){return console.warn('THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion().'),this.makeRotationFromQuaternion(Eg)},multiplyToArray:function multiplyToArray(){console.warn('THREE.Matrix4: .multiplyToArray() has been removed.')},multiplyVector3:function multiplyVector3(Eg){return console.warn('THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead.'),Eg.applyMatrix4(this)},multiplyVector4:function multiplyVector4(Eg){return console.warn('THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead.'),Eg.applyMatrix4(this)},multiplyVector3Array:function multiplyVector3Array(){console.error('THREE.Matrix4: .multiplyVector3Array() has been removed.')},rotateAxis:function rotateAxis(Eg){console.warn('THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead.'),Eg.transformDirection(this)},crossVector:function crossVector(Eg){return console.warn('THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead.'),Eg.applyMatrix4(this)},translate:function translate(){console.error('THREE.Matrix4: .translate() has been removed.')},rotateX:function rotateX(){console.error('THREE.Matrix4: .rotateX() has been removed.')},rotateY:function rotateY(){console.error('THREE.Matrix4: .rotateY() has been removed.')},rotateZ:function rotateZ(){console.error('THREE.Matrix4: .rotateZ() has been removed.')},rotateByAxis:function rotateByAxis(){console.error('THREE.Matrix4: .rotateByAxis() has been removed.')},applyToBuffer:function applyToBuffer(Eg){return console.warn('THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead.'),this.applyToBufferAttribute(Eg)},applyToVector3Array:function applyToVector3Array(){console.error('THREE.Matrix4: .applyToVector3Array() has been removed.')},makeFrustum:function makeFrustum(Eg,bg,Tg,Sg,Mg,Ag){return console.warn('THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead.'),this.makePerspective(Eg,bg,Sg,Tg,Mg,Ag)}}),Hs.prototype.isIntersectionLine=function(Eg){return console.warn('THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine().'),this.intersectsLine(Eg)},Vo.prototype.multiplyVector3=function(Eg){return console.warn('THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead.'),Eg.applyQuaternion(this)},Object.assign(xl.prototype,{isIntersectionBox:function isIntersectionBox(Eg){return console.warn('THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox().'),this.intersectsBox(Eg)},isIntersectionPlane:function isIntersectionPlane(Eg){return console.warn('THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane().'),this.intersectsPlane(Eg)},isIntersectionSphere:function isIntersectionSphere(Eg){return console.warn('THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere().'),this.intersectsSphere(Eg)}}),Object.assign(Lp.prototype,{extrude:function extrude(Eg){return console.warn('THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead.'),new yd(this,Eg)},makeGeometry:function makeGeometry(Eg){return console.warn('THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead.'),new pl(this,Eg)}}),Object.assign(Go.prototype,{fromAttribute:function fromAttribute(Eg,bg,Tg){return console.warn('THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute().'),this.fromBufferAttribute(Eg,bg,Tg)},distanceToManhattan:function distanceToManhattan(Eg){return console.warn('THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo().'),this.manhattanDistanceTo(Eg)},lengthManhattan:function lengthManhattan(){return console.warn('THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength().'),this.manhattanLength()}}),Object.assign(Wo.prototype,{setEulerFromRotationMatrix:function setEulerFromRotationMatrix(){console.error('THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.')},setEulerFromQuaternion:function setEulerFromQuaternion(){console.error('THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.')},getPositionFromMatrix:function getPositionFromMatrix(Eg){return console.warn('THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition().'),this.setFromMatrixPosition(Eg)},getScaleFromMatrix:function getScaleFromMatrix(Eg){return console.warn('THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale().'),this.setFromMatrixScale(Eg)},getColumnFromMatrix:function getColumnFromMatrix(Eg,bg){return console.warn('THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn().'),this.setFromMatrixColumn(bg,Eg)},applyProjection:function applyProjection(Eg){return console.warn('THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead.'),this.applyMatrix4(Eg)},fromAttribute:function fromAttribute(Eg,bg,Tg){return console.warn('THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute().'),this.fromBufferAttribute(Eg,bg,Tg)},distanceToManhattan:function distanceToManhattan(Eg){return console.warn('THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo().'),this.manhattanDistanceTo(Eg)},lengthManhattan:function lengthManhattan(){return console.warn('THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength().'),this.manhattanLength()}}),Object.assign(Yo.prototype,{fromAttribute:function fromAttribute(Eg,bg,Tg){return console.warn('THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute().'),this.fromBufferAttribute(Eg,bg,Tg)},lengthManhattan:function lengthManhattan(){return console.warn('THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength().'),this.manhattanLength()}}),Js.prototype.computeTangents=function(){console.warn('THREE.Geometry: .computeTangents() has been removed.')},Object.assign(js.prototype,{getChildByName:function getChildByName(Eg){return console.warn('THREE.Object3D: .getChildByName() has been renamed to .getObjectByName().'),this.getObjectByName(Eg)},renderDepth:function renderDepth(){console.warn('THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.')},translate:function translate(Eg,bg){return console.warn('THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead.'),this.translateOnAxis(bg,Eg)}}),Object.defineProperties(js.prototype,{eulerOrder:{get:function get(){return console.warn('THREE.Object3D: .eulerOrder is now .rotation.order.'),this.rotation.order},set:function set(Eg){console.warn('THREE.Object3D: .eulerOrder is now .rotation.order.'),this.rotation.order=Eg}},useQuaternion:{get:function get(){console.warn('THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.')},set:function set(){console.warn('THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.')}}}),Object.defineProperties(Yl.prototype,{objects:{get:function get(){return console.warn('THREE.LOD: .objects has been renamed to .levels.'),this.levels}}}),Object.defineProperty(ql.prototype,'useVertexTexture',{get:function get(){console.warn('THREE.Skeleton: useVertexTexture has been removed.')},set:function set(){console.warn('THREE.Skeleton: useVertexTexture has been removed.')}}),Object.defineProperty(Ep.prototype,'__arcLengthDivisions',{get:function get(){return console.warn('THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions.'),this.arcLengthDivisions},set:function set(Eg){console.warn('THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions.'),this.arcLengthDivisions=Eg}}),Fl.prototype.setLens=function(Eg,bg){console.warn('THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup.'),void 0!==bg&&(this.filmGauge=bg),this.setFocalLength(Eg)},Object.defineProperties(Wd.prototype,{onlyShadow:{set:function set(){console.warn('THREE.Light: .onlyShadow has been removed.')}},shadowCameraFov:{set:function set(Eg){console.warn('THREE.Light: .shadowCameraFov is now .shadow.camera.fov.'),this.shadow.camera.fov=Eg}},shadowCameraLeft:{set:function set(Eg){console.warn('THREE.Light: .shadowCameraLeft is now .shadow.camera.left.'),this.shadow.camera.left=Eg}},shadowCameraRight:{set:function set(Eg){console.warn('THREE.Light: .shadowCameraRight is now .shadow.camera.right.'),this.shadow.camera.right=Eg}},shadowCameraTop:{set:function set(Eg){console.warn('THREE.Light: .shadowCameraTop is now .shadow.camera.top.'),this.shadow.camera.top=Eg}},shadowCameraBottom:{set:function set(Eg){console.warn('THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom.'),this.shadow.camera.bottom=Eg}},shadowCameraNear:{set:function set(Eg){console.warn('THREE.Light: .shadowCameraNear is now .shadow.camera.near.'),this.shadow.camera.near=Eg}},shadowCameraFar:{set:function set(Eg){console.warn('THREE.Light: .shadowCameraFar is now .shadow.camera.far.'),this.shadow.camera.far=Eg}},shadowCameraVisible:{set:function set(){console.warn('THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.')}},shadowBias:{set:function set(Eg){console.warn('THREE.Light: .shadowBias is now .shadow.bias.'),this.shadow.bias=Eg}},shadowDarkness:{set:function set(){console.warn('THREE.Light: .shadowDarkness has been removed.')}},shadowMapWidth:{set:function set(Eg){console.warn('THREE.Light: .shadowMapWidth is now .shadow.mapSize.width.'),this.shadow.mapSize.width=Eg}},shadowMapHeight:{set:function set(Eg){console.warn('THREE.Light: .shadowMapHeight is now .shadow.mapSize.height.'),this.shadow.mapSize.height=Eg}}}),Object.defineProperties(Qs.prototype,{length:{get:function get(){return console.warn('THREE.BufferAttribute: .length has been deprecated. Use .count instead.'),this.array.length}}}),Object.assign(dl.prototype,{addIndex:function addIndex(Eg){console.warn('THREE.BufferGeometry: .addIndex() has been renamed to .setIndex().'),this.setIndex(Eg)},addDrawCall:function addDrawCall(Eg,bg,Tg){void 0!==Tg&&console.warn('THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset.'),console.warn('THREE.BufferGeometry: .addDrawCall() is now .addGroup().'),this.addGroup(Eg,bg)},clearDrawCalls:function clearDrawCalls(){console.warn('THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups().'),this.clearGroups()},computeTangents:function computeTangents(){console.warn('THREE.BufferGeometry: .computeTangents() has been removed.')},computeOffsets:function computeOffsets(){console.warn('THREE.BufferGeometry: .computeOffsets() has been removed.')}}),Object.defineProperties(dl.prototype,{drawcalls:{get:function get(){return console.error('THREE.BufferGeometry: .drawcalls has been renamed to .groups.'),this.groups}},offsets:{get:function get(){return console.warn('THREE.BufferGeometry: .offsets has been renamed to .groups.'),this.groups}}}),Object.defineProperties(Xp.prototype,{dynamic:{set:function set(){console.warn('THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.')}},onUpdate:{value:function value(){return console.warn('THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead.'),this}}}),Object.defineProperties(Ns.prototype,{wrapAround:{get:function get(){console.warn('THREE.Material: .wrapAround has been removed.')},set:function set(){console.warn('THREE.Material: .wrapAround has been removed.')}},wrapRGB:{get:function get(){return console.warn('THREE.Material: .wrapRGB has been removed.'),new Ps}},shading:{get:function get(){console.error('THREE.'+this.type+': .shading has been removed. Use the boolean .flatShading instead.')},set:function set(Eg){console.warn('THREE.'+this.type+': .shading has been removed. Use the boolean .flatShading instead.'),this.flatShading=1===Eg}}}),Object.defineProperties(Ud.prototype,{metal:{get:function get(){return console.warn('THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead.'),!1},set:function set(){console.warn('THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead')}}}),Object.defineProperties(yl.prototype,{derivatives:{get:function get(){return console.warn('THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives.'),this.extensions.derivatives},set:function set(Eg){console.warn('THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives.'),this.extensions.derivatives=Eg}}}),Object.assign(Hl.prototype,{getCurrentRenderTarget:function getCurrentRenderTarget(){return console.warn('THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget().'),this.getRenderTarget()},getMaxAnisotropy:function getMaxAnisotropy(){return console.warn('THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy().'),this.capabilities.getMaxAnisotropy()},getPrecision:function getPrecision(){return console.warn('THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision.'),this.capabilities.precision},resetGLState:function resetGLState(){return console.warn('THREE.WebGLRenderer: .resetGLState() is now .state.reset().'),this.state.reset()},supportsFloatTextures:function supportsFloatTextures(){return console.warn('THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( \'OES_texture_float\' ).'),this.extensions.get('OES_texture_float')},supportsHalfFloatTextures:function supportsHalfFloatTextures(){return console.warn('THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( \'OES_texture_half_float\' ).'),this.extensions.get('OES_texture_half_float')},supportsStandardDerivatives:function supportsStandardDerivatives(){return console.warn('THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( \'OES_standard_derivatives\' ).'),this.extensions.get('OES_standard_derivatives')},supportsCompressedTextureS3TC:function supportsCompressedTextureS3TC(){return console.warn('THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( \'WEBGL_compressed_texture_s3tc\' ).'),this.extensions.get('WEBGL_compressed_texture_s3tc')},supportsCompressedTexturePVRTC:function supportsCompressedTexturePVRTC(){return console.warn('THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( \'WEBGL_compressed_texture_pvrtc\' ).'),this.extensions.get('WEBGL_compressed_texture_pvrtc')},supportsBlendMinMax:function supportsBlendMinMax(){return console.warn('THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( \'EXT_blend_minmax\' ).'),this.extensions.get('EXT_blend_minmax')},supportsVertexTextures:function supportsVertexTextures(){return console.warn('THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures.'),this.capabilities.vertexTextures},supportsInstancedArrays:function supportsInstancedArrays(){return console.warn('THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( \'ANGLE_instanced_arrays\' ).'),this.extensions.get('ANGLE_instanced_arrays')},enableScissorTest:function enableScissorTest(Eg){console.warn('THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest().'),this.setScissorTest(Eg)},initMaterial:function initMaterial(){console.warn('THREE.WebGLRenderer: .initMaterial() has been removed.')},addPrePlugin:function addPrePlugin(){console.warn('THREE.WebGLRenderer: .addPrePlugin() has been removed.')},addPostPlugin:function addPostPlugin(){console.warn('THREE.WebGLRenderer: .addPostPlugin() has been removed.')},updateShadowMap:function updateShadowMap(){console.warn('THREE.WebGLRenderer: .updateShadowMap() has been removed.')}}),Object.defineProperties(Hl.prototype,{shadowMapEnabled:{get:function get(){return this.shadowMap.enabled},set:function set(Eg){console.warn('THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled.'),this.shadowMap.enabled=Eg}},shadowMapType:{get:function get(){return this.shadowMap.type},set:function set(Eg){console.warn('THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type.'),this.shadowMap.type=Eg}},shadowMapCullFace:{get:function get(){return this.shadowMap.cullFace},set:function set(Eg){console.warn('THREE.WebGLRenderer: .shadowMapCullFace is now .shadowMap.cullFace.'),this.shadowMap.cullFace=Eg}}}),Object.defineProperties(Vs.prototype,{cullFace:{get:function get(){return this.renderReverseSided?Uc:Ic},set:function set(Eg){var bg=Eg!==Ic;console.warn('WebGLRenderer: .shadowMap.cullFace is deprecated. Set .shadowMap.renderReverseSided to '+bg+'.'),this.renderReverseSided=bg}}}),Object.defineProperties(qo.prototype,{wrapS:{get:function get(){return console.warn('THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS.'),this.texture.wrapS},set:function set(Eg){console.warn('THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS.'),this.texture.wrapS=Eg}},wrapT:{get:function get(){return console.warn('THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT.'),this.texture.wrapT},set:function set(Eg){console.warn('THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT.'),this.texture.wrapT=Eg}},magFilter:{get:function get(){return console.warn('THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter.'),this.texture.magFilter},set:function set(Eg){console.warn('THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter.'),this.texture.magFilter=Eg}},minFilter:{get:function get(){return console.warn('THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter.'),this.texture.minFilter},set:function set(Eg){console.warn('THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter.'),this.texture.minFilter=Eg}},anisotropy:{get:function get(){return console.warn('THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy.'),this.texture.anisotropy},set:function set(Eg){console.warn('THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy.'),this.texture.anisotropy=Eg}},offset:{get:function get(){return console.warn('THREE.WebGLRenderTarget: .offset is now .texture.offset.'),this.texture.offset},set:function set(Eg){console.warn('THREE.WebGLRenderTarget: .offset is now .texture.offset.'),this.texture.offset=Eg}},repeat:{get:function get(){return console.warn('THREE.WebGLRenderTarget: .repeat is now .texture.repeat.'),this.texture.repeat},set:function set(Eg){console.warn('THREE.WebGLRenderTarget: .repeat is now .texture.repeat.'),this.texture.repeat=Eg}},format:{get:function get(){return console.warn('THREE.WebGLRenderTarget: .format is now .texture.format.'),this.texture.format},set:function set(Eg){console.warn('THREE.WebGLRenderTarget: .format is now .texture.format.'),this.texture.format=Eg}},type:{get:function get(){return console.warn('THREE.WebGLRenderTarget: .type is now .texture.type.'),this.texture.type},set:function set(Eg){console.warn('THREE.WebGLRenderTarget: .type is now .texture.type.'),this.texture.type=Eg}},generateMipmaps:{get:function get(){return console.warn('THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps.'),this.texture.generateMipmaps},set:function set(Eg){console.warn('THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps.'),this.texture.generateMipmaps=Eg}}}),Bp.prototype.load=function(Eg){console.warn('THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.');var bg=this;return new Up().load(Eg,function(Tg){bg.setBuffer(Tg)}),this},zp.prototype.getData=function(){return console.warn('THREE.AudioAnalyser: .getData() is now .getFrequencyData().'),this.getFrequencyData()};No.WebGLRenderTargetCube=Zo,No.WebGLRenderTarget=qo,No.WebGLRenderer=Hl,No.ShaderLib=Xu,No.UniformsLib=Vu,No.UniformsUtils=Wu,No.ShaderChunk=ku,No.FogExp2=Ol,No.Fog=Vl,No.Scene=Wl,No.LensFlare=kl,No.Sprite=jl,No.LOD=Yl,No.SkinnedMesh=Jl,No.Skeleton=ql,No.Bone=Zl,No.Mesh=El,No.LineSegments=$l,No.LineLoop=ed,No.Line=Kl,No.Points=rd,No.Group=ad,No.VideoTexture=id,No.DataTexture=Jo,No.CompressedTexture=od,No.CubeTexture=Qo,No.CanvasTexture=Us,No.DepthTexture=nd,No.Texture=jo,No.CompressedTextureLoader=zd,No.DataTextureLoader=Gd,No.CubeTextureLoader=Od,No.TextureLoader=Vd,No.ObjectLoader=yp,No.MaterialLoader=up,No.BufferGeometryLoader=gp,No.DefaultLoadingManager=tg,No.LoadingManager=Bd,No.JSONLoader=hp,No.ImageLoader=Hd,No.FontLoader=Ip,No.FileLoader=Fd,No.Loader=fp,No.Cache=eg,No.AudioLoader=Up,No.SpotLightShadow=jd,No.SpotLight=Yd,No.PointLight=qd,No.RectAreaLight=Kd,No.HemisphereLight=kd,No.DirectionalLightShadow=Zd,No.DirectionalLight=Jd,No.AmbientLight=Qd,No.LightShadow=Xd,No.Light=Wd,No.StereoCamera=Dp,No.PerspectiveCamera=Fl,No.OrthographicCamera=qs,No.ArrayCamera=zl,No.Camera=Ys,No.AudioListener=Np,No.PositionalAudio=Fp,No.AudioContext=cg,No.AudioAnalyser=zp,No.Audio=Bp,No.VectorKeyframeTrack=ip,No.StringKeyframeTrack=lp,No.QuaternionKeyframeTrack=np,No.NumberKeyframeTrack=sp,No.ColorKeyframeTrack=pp,No.BooleanKeyframeTrack=dp,No.PropertyMixer=Gp,No.PropertyBinding=Op,No.KeyframeTrack=cp,No.AnimationUtils=ag,No.AnimationObjectGroup=Vp,No.AnimationMixer=kp,No.AnimationClip=mp,No.Uniform=Xp,No.InstancedBufferGeometry=jp,No.BufferGeometry=dl,No.Geometry=Js,No.InterleavedBufferAttribute=Yp,No.InstancedInterleavedBuffer=Zp,No.InterleavedBuffer=qp,No.InstancedBufferAttribute=Jp,No.Face3=Zs,No.Object3D=js,No.Raycaster=Qp,No.Layers=Xs,No.EventDispatcher=Fo,No.Clock=ec,No.QuaternionLinearInterpolant=op,No.LinearInterpolant=tp,No.DiscreteInterpolant=rp,No.CubicInterpolant=ep,No.Interpolant=$d,No.Triangle=_l,No.Math=Iu,No.Spherical=tc,No.Cylindrical=rc,No.Plane=Hs,No.Frustum=Os,No.Sphere=Gs,No.Ray=xl,No.Matrix4=Ho,No.Matrix3=Xo,No.Box3=zs,No.Box2=Cs,No.Line3=vl,No.Euler=ks,No.Vector4=Yo,No.Vector3=Wo,No.Vector2=Go,No.Quaternion=Vo,No.Color=Ps,No.ImmediateRenderObject=ac,No.VertexNormalsHelper=ic,No.SpotLightHelper=oc,No.SkeletonHelper=sc,No.PointLightHelper=lc,No.RectAreaLightHelper=dc,No.HemisphereLightHelper=pc,No.GridHelper=cc,No.PolarGridHelper=mc,No.FaceNormalsHelper=uc,No.DirectionalLightHelper=gc,No.CameraHelper=fc,No.BoxHelper=hc,No.Box3Helper=yc,No.PlaneHelper=xc,No.ArrowHelper=vc,No.AxesHelper=_c,No.CatmullRomCurve3=bc,No.CubicBezierCurve3=Tc,No.QuadraticBezierCurve3=Sc,No.LineCurve3=Mc,No.ArcCurve=Ac,No.EllipseCurve=Sp,No.SplineCurve=Mp,No.CubicBezierCurve=Ap,No.QuadraticBezierCurve=wp,No.LineCurve=bp,No.Shape=Lp,No.Path=Rp,No.ShapePath=Pp,No.Font=Cp,No.CurvePath=Tp,No.Curve=Ep,No.ShapeUtils=Qu,No.SceneUtils={createMultiMaterialObject:function createMultiMaterialObject(Eg,bg){for(var Tg=new ad,Sg=0,Mg=bg.length;Sg<Mg;Sg++)Tg.add(new El(Eg,bg[Sg]));return Tg},detach:function detach(Eg,bg,Tg){Eg.applyMatrix(bg.matrixWorld),bg.remove(Eg),Tg.add(Eg)},attach:function attach(Eg,bg,Tg){Eg.applyMatrix(new Ho().getInverse(Tg.matrixWorld)),bg.remove(Eg),Tg.add(Eg)}},No.WebGLUtils=Gl,No.ParametricGeometry=sd,No.ParametricBufferGeometry=ld,No.TetrahedronGeometry=cd,No.TetrahedronBufferGeometry=md,No.OctahedronGeometry=ud,No.OctahedronBufferGeometry=gd,No.IcosahedronGeometry=fd,No.IcosahedronBufferGeometry=hd,No.PolyhedronGeometry=dd,No.PolyhedronBufferGeometry=pd,No.TextGeometry=vd,No.TextBufferGeometry=_d,No.SphereGeometry=Ed,No.SphereBufferGeometry=bd,No.RingGeometry=Td,No.RingBufferGeometry=Sd,No.PlaneGeometry=gl,No.PlaneBufferGeometry=fl,No.ExtrudeGeometry=yd,No.ExtrudeBufferGeometry=xd,No.ShapeGeometry=pl,No.ShapeBufferGeometry=cl,No.ConeGeometry=wd,No.ConeBufferGeometry=Rd,No.CylinderGeometry=Md,No.CylinderBufferGeometry=Ad,No.CircleGeometry=Ld,No.CircleBufferGeometry=Pd,No.BoxGeometry=ml,No.BoxBufferGeometry=ul,No.ShadowMaterial=Cd,No.SpriteMaterial=Xl,No.MeshPhongMaterial=Ud,No.MeshLambertMaterial=Dd,No.MeshBasicMaterial=hl,No.Material=Ns,No.Float64BufferAttribute=nl,No.Float32BufferAttribute=ol,No.Uint32BufferAttribute=il,No.Int32BufferAttribute=al,No.Uint16BufferAttribute=rl,No.Int16BufferAttribute=tl,No.Uint8ClampedBufferAttribute=el,No.Uint8BufferAttribute=$s,No.Int8BufferAttribute=Ks,No.BufferAttribute=Qs,No.REVISION=Pc,No.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2},No.CullFaceNone=Cc,No.CullFaceBack=Ic,No.CullFaceFront=Uc,No.CullFaceFrontBack=3,No.FrontFaceDirectionCW=Dc,No.FrontFaceDirectionCCW=1,No.BasicShadowMap=0,No.PCFShadowMap=Nc,No.PCFSoftShadowMap=Bc,No.FrontSide=Fc,No.BackSide=zc,No.DoubleSide=Gc,No.FlatShading=1,No.SmoothShading=2,No.NoColors=Hc,No.FaceColors=Oc,No.VertexColors=Vc,No.NoBlending=Wc,No.NormalBlending=kc,No.AdditiveBlending=Xc,No.SubtractiveBlending=jc,No.MultiplyBlending=Yc,No.CustomBlending=qc,No.AddEquation=Zc,No.SubtractEquation=Jc,No.ReverseSubtractEquation=Qc,No.MinEquation=Kc,No.MaxEquation=$c,No.ZeroFactor=em,No.OneFactor=tm,No.SrcColorFactor=rm,No.OneMinusSrcColorFactor=am,No.SrcAlphaFactor=im,No.OneMinusSrcAlphaFactor=om,No.DstAlphaFactor=nm,No.OneMinusDstAlphaFactor=sm,No.DstColorFactor=lm,No.OneMinusDstColorFactor=dm,No.SrcAlphaSaturateFactor=pm,No.NeverDepth=cm,No.AlwaysDepth=mm,No.LessDepth=um,No.LessEqualDepth=gm,No.EqualDepth=fm,No.GreaterEqualDepth=hm,No.GreaterDepth=ym,No.NotEqualDepth=xm,No.MultiplyOperation=vm,No.MixOperation=_m,No.AddOperation=Em,No.NoToneMapping=bm,No.LinearToneMapping=Tm,No.ReinhardToneMapping=Sm,No.Uncharted2ToneMapping=Mm,No.CineonToneMapping=Am,No.UVMapping=300,No.CubeReflectionMapping=wm,No.CubeRefractionMapping=Rm,No.EquirectangularReflectionMapping=Lm,No.EquirectangularRefractionMapping=Pm,No.SphericalReflectionMapping=Cm,No.CubeUVReflectionMapping=Im,No.CubeUVRefractionMapping=Um,No.RepeatWrapping=Dm,No.ClampToEdgeWrapping=Nm,No.MirroredRepeatWrapping=Bm,No.NearestFilter=Fm,No.NearestMipMapNearestFilter=zm,No.NearestMipMapLinearFilter=Gm,No.LinearFilter=Hm,No.LinearMipMapNearestFilter=Om,No.LinearMipMapLinearFilter=Vm,No.UnsignedByteType=Wm,No.ByteType=km,No.ShortType=Xm,No.UnsignedShortType=jm,No.IntType=Ym,No.UnsignedIntType=qm,No.FloatType=Zm,No.HalfFloatType=Jm,No.UnsignedShort4444Type=Qm,No.UnsignedShort5551Type=Km,No.UnsignedShort565Type=$m,No.UnsignedInt248Type=eu,No.AlphaFormat=tu,No.RGBFormat=ru,No.RGBAFormat=au,No.LuminanceFormat=iu,No.LuminanceAlphaFormat=ou,No.RGBEFormat=au,No.DepthFormat=su,No.DepthStencilFormat=lu,No.RGB_S3TC_DXT1_Format=du,No.RGBA_S3TC_DXT1_Format=pu,No.RGBA_S3TC_DXT3_Format=cu,No.RGBA_S3TC_DXT5_Format=mu,No.RGB_PVRTC_4BPPV1_Format=uu,No.RGB_PVRTC_2BPPV1_Format=gu,No.RGBA_PVRTC_4BPPV1_Format=fu,No.RGBA_PVRTC_2BPPV1_Format=hu,No.RGB_ETC1_Format=yu,No.LoopOnce=2200,No.LoopRepeat=xu,No.LoopPingPong=2202,No.InterpolateDiscrete=2300,No.InterpolateLinear=2301,No.InterpolateSmooth=2302,No.ZeroCurvatureEnding=vu,No.ZeroSlopeEnding=2401,No.WrapAroundEnding=2402,No.TrianglesDrawMode=_u,No.TriangleStripDrawMode=Eu,No.TriangleFanDrawMode=bu,No.LinearEncoding=Tu,No.sRGBEncoding=Su,No.GammaEncoding=Mu,No.RGBEEncoding=Au,No.LogLuvEncoding=3003,No.RGBM7Encoding=wu,No.RGBM16Encoding=Ru,No.RGBDEncoding=Lu,No.BasicDepthPacking=Pu,No.RGBADepthPacking=Cu,No.CubeGeometry=ml,No.Face4=function(Eg,bg,Tg,Sg,Mg,Ag,wg){return console.warn('THREE.Face4 has been removed. A THREE.Face3 will be created instead.'),new Zs(Eg,bg,Tg,Mg,Ag,wg)},No.LineStrip=0,No.LinePieces=1,No.MeshFaceMaterial=function(Eg){return console.warn('THREE.MeshFaceMaterial has been removed. Use an Array instead.'),Eg},No.MultiMaterial=function(Eg){return void 0===Eg&&(Eg=[]),console.warn('THREE.MultiMaterial has been removed. Use an Array instead.'),Eg.isMultiMaterial=!0,Eg.materials=Eg,Eg.clone=function(){return Eg.slice()},Eg},No.PointCloud=function(Eg,bg){return console.warn('THREE.PointCloud has been renamed to THREE.Points.'),new rd(Eg,bg)},No.Particle=function(Eg){return console.warn('THREE.Particle has been renamed to THREE.Sprite.'),new jl(Eg)},No.ParticleSystem=function(Eg,bg){return console.warn('THREE.ParticleSystem has been renamed to THREE.Points.'),new rd(Eg,bg)},No.PointCloudMaterial=function(Eg){return console.warn('THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial.'),new td(Eg)},No.ParticleBasicMaterial=function(Eg){return console.warn('THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial.'),new td(Eg)},No.ParticleSystemMaterial=function(Eg){return console.warn('THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial.'),new td(Eg)},No.Vertex=function(Eg,bg,Tg){return console.warn('THREE.Vertex has been removed. Use THREE.Vector3 instead.'),new Wo(Eg,bg,Tg)},No.DynamicBufferAttribute=function(Eg,bg){return console.warn('THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead.'),new Qs(Eg,bg).setDynamic(!0)},No.Int8Attribute=function(Eg,bg){return console.warn('THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead.'),new Ks(Eg,bg)},No.Uint8Attribute=function(Eg,bg){return console.warn('THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead.'),new $s(Eg,bg)},No.Uint8ClampedAttribute=function(Eg,bg){return console.warn('THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead.'),new el(Eg,bg)},No.Int16Attribute=function(Eg,bg){return console.warn('THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead.'),new tl(Eg,bg)},No.Uint16Attribute=function(Eg,bg){return console.warn('THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead.'),new rl(Eg,bg)},No.Int32Attribute=function(Eg,bg){return console.warn('THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead.'),new al(Eg,bg)},No.Uint32Attribute=function(Eg,bg){return console.warn('THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead.'),new il(Eg,bg)},No.Float32Attribute=function(Eg,bg){return console.warn('THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead.'),new ol(Eg,bg)},No.Float64Attribute=function(Eg,bg){return console.warn('THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead.'),new nl(Eg,bg)},No.ClosedSplineCurve3=wc,No.SplineCurve3=Rc,No.Spline=Lc,No.AxisHelper=function(Eg){return console.warn('THREE.AxisHelper has been renamed to THREE.AxesHelper.'),new _c(Eg)},No.BoundingBoxHelper=function(Eg,bg){return console.warn('THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead.'),new hc(Eg,bg)},No.EdgesHelper=function(Eg,bg){return console.warn('THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead.'),new $l(new EdgesGeometry(Eg.geometry),new Ql({color:void 0===bg?16777215:bg}))},No.WireframeHelper=function(Eg,bg){return console.warn('THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead.'),new $l(new WireframeGeometry(Eg.geometry),new Ql({color:void 0===bg?16777215:bg}))},No.XHRLoader=function(Eg){return console.warn('THREE.XHRLoader has been renamed to THREE.FileLoader.'),new Fd(Eg)},No.BinaryTextureLoader=function(Eg){return console.warn('THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader.'),new Gd(Eg)},No.GeometryUtils={merge:function merge(Eg,bg,Tg){console.warn('THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.');var Sg;bg.isMesh&&(bg.matrixAutoUpdate&&bg.updateMatrix(),Sg=bg.matrix,bg=bg.geometry),Eg.merge(bg,Sg,Tg)},center:function center(Eg){return console.warn('THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead.'),Eg.center()}},No.ImageUtils={crossOrigin:void 0,loadTexture:function loadTexture(Eg,bg,Tg,Sg){console.warn('THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.');var Mg=new Vd;Mg.setCrossOrigin(this.crossOrigin);var Ag=Mg.load(Eg,Tg,void 0,Sg);return bg&&(Ag.mapping=bg),Ag},loadTextureCube:function loadTextureCube(Eg,bg,Tg,Sg){console.warn('THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.');var Mg=new Od;Mg.setCrossOrigin(this.crossOrigin);var Ag=Mg.load(Eg,Tg,void 0,Sg);return bg&&(Ag.mapping=bg),Ag},loadCompressedTexture:function loadCompressedTexture(){console.error('THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.')},loadCompressedTextureCube:function loadCompressedTextureCube(){console.error('THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.')}},No.Projector=function(){console.error('THREE.Projector has been moved to /examples/js/renderers/Projector.js.'),this.projectVector=function(Eg,bg){console.warn('THREE.Projector: .projectVector() is now vector.project().'),Eg.project(bg)},this.unprojectVector=function(Eg,bg){console.warn('THREE.Projector: .unprojectVector() is now vector.unproject().'),Eg.unproject(bg)},this.pickingRay=function(){console.error('THREE.Projector: .pickingRay() is now raycaster.setFromCamera().')}},No.CanvasRenderer=function(){console.error('THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js'),this.domElement=document.createElement('canvas'),this.clear=function(){},this.render=function(){},this.setClearColor=function(){},this.setSize=function(){}}}(THREE);